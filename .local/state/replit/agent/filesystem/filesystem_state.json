{"file_contents":{"README.md":{"content":"# KeyAuth Source Code -> Please star :star2:\n\n> [!WARNING]  \n> AS OF JANUARY 29th, 2024 - THIS REPOSITORY IS NO LONGER BEING UPDATED!\n\n[KeyAuth](https://keyauth.win) is an open source authentication system with [cloud-hosted subscriptions](https://keyauth.win/app/?page=upgrade) available as well.\n<br>\n*You're not allowed to sell KeyAuth. source made avaliable only for you to use*\n\nTo submit a suggestion or a bug, please go to https://keyauth.cc/app/?page=forms and submit a form!\n\n[![CodeFactor](https://www.codefactor.io/repository/github/keyauth/keyauth-source-code/badge)](https://www.codefactor.io/repository/github/keyauth/keyauth-source-code)\n[![Telegram Chat](https://img.shields.io/endpoint?color=neon&style=flat-square&url=https%3A%2F%2Ftg.sumanjay.workers.dev%2Fkeyauth)](https://t.me/KeyAuth)\n[![Twitter](https://img.shields.io/twitter/follow/KeyAuth?cacheSeconds=3600)](https://twitter.com/KeyAuth)\n\n[![Screenshot](https://cdn.keyauth.cc/v3/imgs/Screenshot%20from%202025-07-04%2012-07-30.png)](https://keyauth.cc)\n\n## Bugs ##\n\nIf the default example that isn't added to your software isn't functioning how it should, please go to https://keyauth.cc/app/?page=forms and submit a bug report in the `Report a Bug` modal.\n\nHowever, we do **NOT** provide support for adding KeyAuth to your project. If you can't figure this out you should use Google or YouTube to learn more about the programming language you want to sell a program in.\n\n## Copyright License\n\nKeyAuth is licensed under **Elastic License 2.0**\n\n* You may not provide the software to third parties as a hosted or managed\nservice, where the service provides users with access to any substantial set of\nthe features or functionality of the software.\n\n* You may not move, change, disable, or circumvent the license key functionality\nin the software, and you may not remove or obscure any functionality in the\nsoftware that is protected by the license key.\n\n* You may not alter, remove, or obscure any licensing, copyright, or other notices\nof the licensor in the software. Any use of the licensor’s trademarks is subject\nto applicable law.\n\nThank you for your compliance, we work hard on the development of KeyAuth and do not appreciate our copyright being infringed.\n\n## Requirements ##\n\n- Web server (Apache or Nginx)\n- MySQL or MariaDB\n- Redis\n- PHP\n\nNo setup support given to non-enterprise users. However for $79.99 you can purchase access to the source code of paid features (developer and seller plan features), setup support 1-on-1 with the owner of KeyAuth, and a tutorial video on how to host KeyAuth for 100% free forever (good preformance & secure also) \n\nPurchase enterprise today --> https://keyauth.win/app/?page=upgrade\n\n## Updates ##\n\nhttps://keyauth.canny.io/changelog\n\nLooking for a Discord bot made by the KeyAuth & RestoreCord founder that you can use to backup your Discord members, server settings, and messages? Go to https://vaultcord.com\n","size_bytes":2939},"stats.php":{"content":"<?php\nheader(\"Access-Control-Allow-Origin: *\");\nheader('Content-Type: application/json; charset=utf-8');\n\ninclude 'includes/misc/autoload.phtml';\n\n$row = misc\\cache\\fetch('KeyAuthStats', \"SELECT FORMAT((SELECT COUNT(*) FROM `accounts`), '') AS 'numAccs', FORMAT((SELECT COUNT(DISTINCT `ip_address`) FROM `sessions` WHERE `is_active` = 1 AND `expires_at` > NOW()), '') AS 'numOnlineUsers', FORMAT((SELECT COUNT(*) FROM `keys`), '') AS 'numKeys', FORMAT((SELECT COUNT(*) FROM `apps`), '') AS 'numApps';\", [], 0, 3600);\n\n$numAccs = $row['numAccs'];\n$numOnlineUsers = $row['numOnlineUsers'];\n$numApps = $row['numApps'];\n$numKeys = $row['numKeys'];\n\ndie(json_encode(array(\n    \"accounts\" => $numAccs,\n    \"applications\" => $numApps,\n    \"licenses\" => $numKeys,\n    \"activeUsers\" => $numOnlineUsers\n)));","size_bytes":797},"api/index.php":{"content":"<?php\r\nheader(\"Location: https://keyauth.readme.io/\");\r\nexit();\r\n","size_bytes":65},"app/black-fetch.php":{"content":"<?php\ninclude '../includes/misc/autoload.phtml';\n\nset_exception_handler(function ($exception) {\n        error_log(\"\\n--------------------------------------------------------------\\n\");\n        error_log($exception);\n        error_log(\"\\nRequest data:\");\n        error_log(print_r($_POST, true));\n        error_log(\"\\n--------------------------------------------------------------\");\n        http_response_code(500);\n        $errorMsg = str_replace($databaseUsername, \"REDACTED\", $exception->getMessage());\n        die(\"Error: \" . $errorMsg);\n});\n\nif (session_status() === PHP_SESSION_NONE) {\n        session_start();\n}\n\nif ($_SESSION['role'] == \"Reseller\") {\n        die(\"Resellers can't access this.\");\n}\n\nif (!isset($_SESSION['app'])) {\n        die(\"Application not selected.\");\n}\n\nif (isset($_POST['draw'])) {\n\n        // credits to https://makitweb.com/datatables-ajax-pagination-with-search-and-sort-php/\n\n        $draw = intval($_POST['draw']);\n        $row = intval($_POST['start']);\n        $rowperpage = intval($_POST['length']); // Rows display per page\n        $columnIndex = misc\\etc\\sanitize($_POST['order'][0]['column']); // Column index\n        $columnName = misc\\etc\\sanitize($_POST['columns'][$columnIndex]['data']); // Column name\n        $columnSortOrder = misc\\etc\\sanitize($_POST['order'][0]['dir']); // asc or desc\n        $searchValue = misc\\etc\\sanitize($_POST['search']['value']); // Search value\n\n        // whitelist certain column names and sort orders to prevent SQL injection\n        if (!in_array($columnName, array(\"type\"))) {\n                die(\"Column name is not whitelisted.\");\n        }\n\n        if (!in_array($columnSortOrder, array(\"desc\", \"asc\"))) {\n                die(\"Column sort order is not whitelisted.\");\n        }\n\n        if (!is_null($searchValue)) {\n                $query = misc\\mysql\\query(\"select * from `bans` WHERE (`ip` like ? or `hwid` like ? or `type` like ? ) and app = ? order by `\" . $columnName . \"` \" . $columnSortOrder . \" limit \" . $row . \",\" . $rowperpage, [\"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", $_SESSION['app']]);\n        }\n        else {\n                $query = misc\\mysql\\query(\"select * from `bans` WHERE app = ? order by `\" . $columnName . \"` \" . $columnSortOrder . \" limit \" . $row . \",\" . $rowperpage, [$_SESSION['app']]);\n        }\n        \n        $data = array();\n\n       while ($row = mysqli_fetch_assoc($query->result)) {\n                $data[] = array(\n                        \"data\" => '<span class=\"blur-sm hover:blur-none\">' . ($row[\"hwid\"] ?? $row[\"ip\"]) . '</span>',\n                        \"type\" => $row[\"type\"],\n                        \"actions\" => \n                        '<form method=\"POST\">\n                        <td>\n                        <div x-data=\"{ open: false }\" class=\"z-0\">\n                        <button x-on:click=\"open = true\" class=\"flex items-center border border-gray-700 rounded-lg focus:opacity-60 text-white focus:text-white font-semibold rounded focus:outline-none focus:shadow-inner py-2 px-4\" type=\"button\">\n                                <span class=\"mr-1\">Actions</span>\n                                <svg class=\"fill-current h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\"  style=\"margin-top:3px\">\n                                <path d=\"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z\"/>\n                                </svg>\n                        </button>\n                        <ul x-show=\"open\" x-on:click.away=\"open = false\" class=\"bg-[#09090d] text-white rounded shadow-lg absolute py-2 mt-1\" style=\"min-width:15rem\">\n                                <li>\n                                        <button name=\"deleteblack\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-red-700\"\n                                        value=\"' . ($row[\"hwid\"] ?? $row[\"ip\"]) . '\">\n                                        Delete Blacklist\n                                        </button>\n                                        <input type=\"hidden\" name=\"type\" value=\"' . $row[\"type\"] . '\"></div>\n                                </li>\n                                </ul>\n                                </div>\n                        </td>\n                        </tr>\n                        </form>',\n                );\n        }\n\n        ## Response\n        $response = array(\n                \"draw\" => intval($draw),\n                \"aaData\" => $data\n        );\n\n        die(json_encode($response));\n}\n\ndie(\"Request not from datatables, aborted.\");\n","size_bytes":4586},"app/download-types.php":{"content":"<?php\n\ninclude '../includes/misc/autoload.phtml';\n\nsession_start();\n\nif ($_SESSION['role'] == \"Reseller\") {\n    die(\"Resellers can't access this.\");\n}\n\nif (!isset($_SESSION['app'])) {\n    die(\"Application not selected.\");\n}\n\nswitch ($_POST['type'] ?? $_GET['type']) {\n    case 'users':\n       $jsonarray = json_encode(\n            array(\n                \"users\" => array(),\n                \"subscription\" => array()\n            )\n        );\n        \n        $jsondata = json_decode($jsonarray);\n        \n        $userquery = misc\\mysql\\query(\"SELECT * FROM `users` WHERE `app` = ?\", [$_SESSION['app']]);\n        \n        while ($row = mysqli_fetch_array($userquery->result)) {\n        \n            $userjson = array(\n                \"username\" => $row[\"username\"],\n                \"email\" => $row[\"email\"],\n                \"password\" => $row[\"password\"],\n                \"hwid\" => $row[\"hwid\"],\n                \"banned\" => $row[\"banned\"],\n                \"ip\" => $row[\"ip\"]\n            );\n        \n            array_push($jsondata->users, $userjson);\n        }\n        \n        $subscriptionquery = misc\\mysql\\query(\"SELECT * FROM `subs` WHERE `app` = ? \", [$_SESSION['app']]);\n        \n        while ($row = mysqli_fetch_array($subscriptionquery->result)) {\n        \n            $subjson = array(\n                \"user\" => $row[\"user\"],\n                \"subscription\" => \"default\",\n                \"expiry\" => $row[\"expiry\"]\n            );\n        \n            array_push($jsondata->subscription, $subjson);\n        }\n        \n        $newjson = json_encode($jsondata);\n        \n        header('Content-Description: File Transfer');\n        header('Content-Type: application/octet-stream');\n        header('Content-Disposition: attachment; filename=\"KeyAuthUsers.json\"');\n        header('Expires: 0');\n        header('Cache-Control: must-revalidate');\n        header('Pragma: public');\n        header('Content-Length: ' . strlen($newjson));\n        \n        \n        die($newjson);   \n    case 'licenses':\n       $query = misc\\mysql\\query(\"SELECT * FROM `keys` WHERE `app` = ?\",[$_SESSION['app']]);\n\n        // Create an array to hold the keys\n        $keysArray = array();\n        \n        while ($row = mysqli_fetch_array($query->result)) {\n            // Add each key to the array\n            $keysArray[] = array(\n                \"key\" => $row['key'],\n                \"level\" => $row['level'],\n                \"expiry\" => $row['expires'] / 86400\n            );\n        }\n        \n        // Convert the array to a JSON string\n        $jsonData = json_encode($keysArray);\n        \n        header('Content-Description: File Transfer');\n        header('Content-Type: application/json'); // Set the content type to JSON\n        header('Content-Disposition: attachment; filename=\"KeyAuthKeys.json\"');\n        header('Expires: 0');\n        header('Cache-Control: must-revalidate');\n        header('Pragma: public');\n        header('Content-Length: ' . strlen($jsonData));\n        \n        echo $jsonData;\n        \n        die($stringData);\n    case 'logs':\n        $jsonarray = json_encode(\n            array(\n                \"logs\" => array()\n            )\n        );\n        \n        $jsondata = json_decode($jsonarray);\n        \n        $userlogquery = misc\\mysql\\query(\"SELECT * FROM `logs` WHERE `logapp` = ?\", [$_SESSION['app']]);\n        \n        while ($row = mysqli_fetch_array($userlogquery->result)) {\n        \n            $userlogjson = array(\n                \"logdate\" => $row[\"logdate\"],\n                \"logdata\" => $row[\"logdata\"],\n                \"credential\" => $row[\"credential\"],\n                \"pcuser\" => $row[\"pcuser\"]\n            );\n        \n            array_push($jsondata->logs, $userlogjson);\n        }\n        \n        \n        $newjson = json_encode($jsondata);\n        \n        header('Content-Description: File Transfer');\n        header('Content-Type: application/octet-stream');\n        header('Content-Disposition: attachment; filename=\"KeyAuthUserLogs.json\"');\n        header('Expires: 0');\n        header('Cache-Control: must-revalidate');\n        header('Pragma: public');\n        header('Content-Length: ' . strlen($newjson));\n        \n        \n        die($newjson);     \n    case 'auditLog':\n        $jsonarray = json_encode(\n            array(\n                \"auditLog\" => array()\n            )\n        );\n        \n        $jsondata = json_decode($jsonarray);\n        \n        $userquery = misc\\mysql\\query(\"SELECT * FROM `auditLog` WHERE `app` = ?\", [$_SESSION['app']]);\n        \n        while ($row = mysqli_fetch_array($userquery->result)) {\n        \n            $userjson = array(\n                \"id\" => $row[\"id\"],\n                \"user\" => $row[\"user\"],\n                \"event\" => $row[\"event\"],\n                \"time\" => $row[\"time\"],\n            );\n        \n            array_push($jsondata->auditLog, $userjson);\n        }\n        \n        \n        $newjson = json_encode($jsondata);\n        \n        header('Content-Description: File Transfer');\n        header('Content-Type: application/octet-stream');\n        header('Content-Disposition: attachment; filename=\"KeyAuthAuditLogs.json\"');\n        header('Expires: 0');\n        header('Cache-Control: must-revalidate');\n        header('Pragma: public');\n        header('Content-Length: ' . strlen($newjson));\n        \n        die($newjson);     \n    default:\n        echo 'Invalid Type or Type does not Exist';\n}\n","size_bytes":5416},"app/index.php":{"content":"<?php\ninclude '../includes/misc/autoload.phtml';\ninclude '../includes/dashboard/autoload.phtml';\n\nif (session_status() === PHP_SESSION_NONE) {\n    session_start();\n}\n\nob_start();\n\nif (!isset($_SESSION['username'])) {\n    $_SESSION['oldUrl'] = $_SERVER['REQUEST_URI'];\n    header(\"Location: ../login/\");\n    exit();\n}\n\nset_exception_handler(function ($exception) {\n    error_log(\"\\n--------------------------------------------------------------\\n\");\n    error_log($exception);\n    error_log(\"\\nRequest data:\");\n    error_log(print_r($_POST, true));\n    error_log(\"\\n--------------------------------------------------------------\");\n    http_response_code(500);\n    $errorMsg = str_replace($databaseUsername, \"REDACTED\", $exception->getMessage());\n    \\dashboard\\primary\\error($errorMsg);\n});\n\n$username = $_SESSION['username'];\n$query = misc\\mysql\\query(\"SELECT * FROM `accounts` WHERE `username` = ?\",[$username]);\n$row = mysqli_fetch_array($query->result);\n\n$banned = $row['banned'];\n$lastreset = $row['lastreset'];\nif (!is_null($banned) || $_SESSION['logindate'] < $lastreset || $query->num_rows < 1) {\n    echo \"<meta http-equiv='Refresh' Content='0; url=../login/'>\";\n    session_destroy();\n    exit();\n}\n$role = $row['role'];\n$permissions = $row['permissions'];\n$admin = $row['admin'];\n$staff = $row['staff'];\n$formBanned = $row['formBanned'];\n$twofactor = $row['twofactor'];\n$_SESSION['role'] = $role;\n$_SESSION['ownerid'] = $row['ownerid']; // Set ownerid in session\n\n$expires = $row['expires'];\nif (in_array($role, array(\"developer\", \"seller\"))) {\n    $_SESSION['timeleft'] = dashboard\\primary\\expireCheck($username, $expires);\n    \n    // If subscription is expired, show warning but don't permanently change role\n    if (isset($_SESSION['subscription_expired']) && $_SESSION['subscription_expired']) {\n        // Store a notification for the user about expired subscription\n        $_SESSION['subscription_warning'] = \"Your subscription has expired. Please renew to continue using premium features.\";\n    }\n}\n\n\nif (empty($_SESSION['app'])) // no app selected yet\n{\n    $query = misc\\mysql\\query(\"SELECT `secret`, `name`, `banned`, `sellerkey` FROM `apps` WHERE `owner` = ? AND `ownerid` = ?\",[$_SESSION['username'], $_SESSION['ownerid']]); // select all apps where owner is current user\n    if ($query->num_rows == 1) // if the user only owns one app, load that app (they can still change app after it's loaded)\n    {\n        $row = mysqli_fetch_array($query->result);\n        $_SESSION['name'] = $row[\"name\"];\n        $_SESSION[\"selectedApp\"] = $row[\"name\"];\n        $_SESSION['app'] = $row[\"secret\"];\n        $_SESSION['sellerkey'] = $row[\"sellerkey\"];\n    }\n}\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<!--begin::Head-->\n\n<!DOCTYPE html>\n<html lang=\"en\" class=\"bg-[#09090d] text-white overflow-x-hidden dark\">\n\n<head>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    \n    <link rel=\"stylesheet\" href=\"https://cdn.keyauth.cc/v3/scripts/highlight.css\">\n    \n    <script src=\"https://cdn.keyauth.cc/v3/scripts/highlight.min.js\"></script>\n    <script src=\"https://cdn.keyauth.cc/dashboard/unixtolocal.js\"></script>\n\n    <link href=\"https://cdn.lineicons.com/4.0/lineicons.css\" rel=\"stylesheet\" />\n    <link rel=\"shortcut icon\" type=\"image/jpg\" href=\"https://cdn.keyauth.cc/front/assets/img/favicon.png\">\n\n    <link href=\"https://cdn.keyauth.cc/v2/assets/plugins/custom/datatables/datatables.bundle.css\" rel=\"stylesheet\"\n        type=\"text/css\" />\n\n    <title>GenZ Auth - Open Source Auth</title>\n\n    <script>\n    if (window.history.replaceState) {\n        window.history.replaceState(null, null, window.location.href);\n    }\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.keyauth.cc/v3/dist/dashboard.css\">\n    \n    <link rel=\"stylesheet\"\n        href=\"https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0\" />\n\n    <link rel=\"stylesheet\" href=\"https://cdn.keyauth.cc/v3/dist/output.css\">\n    <link rel=\"stylesheet\" href=\"assets/modern-theme.css\">\n    <link rel=\"stylesheet\" href=\"assets/mobile-fixes.css\">\n    <script src=\"https://cdn.keyauth.cc/v3/dist/flowbite.js\"></script>\n    <script src=\"assets/modern-ui.js?v=<?php echo time(); ?>\"></script>\n\n    <script defer src=\"https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js\"></script>\n    <script src=\"https://cdn.keyauth.cc/v3/scripts/jquery.min.js\"></script>\n</head>\n<!--end::Head-->\n<!--begin::Body-->\n<body>\n    <div data-loader id=\"loader\" class=\"bg-[#0f0f17]\" style=\"display: none !important;\">\n        <div class=\"text-center grid h-screen place-items-center\">\n            <div role=\"status\" class=\"mt-96\">\n                <svg aria-hidden=\"true\" class=\"inline w-8 h-8 mr-2 text-[#09090d] animate-spin fill-blue-600\"\n                    viewBox=\"0 0 100 101\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                    <path\n                        d=\"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z\"\n                        fill=\"currentColor\" />\n                    <path\n                        d=\"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z\"\n                        fill=\"currentFill\" />\n                </svg>\n            </div>\n            <div class=\"block mt-32\">\n                <span class=\"text-xs font-semibold text-gray-500\">\n                    Loading taking a while? <a href=\"?page=manage-apps\" class=\"text-blue-500 hover:underline\">Please\n                        feel free to return.</a>\n                </span>\n            </div>\n            <?php\n            if (!isset($_SESSION['app'])) { ?>\n            <a href=\"?page=manage-apps\">\n                <?php } ?>\n        </div>\n    </div>\n\n    <?php include 'layout/master.php' ?>\n\n    <script src=\"https://cdn.keyauth.cc/v2/assets/plugins/global/plugins.bundle.js\"></script>\n    <script src=\"https://cdn.keyauth.cc/v2/assets/js/scripts.bundle.js\"></script>\n\n    <script src=\"https://cdn.keyauth.cc/dashboard/webauthn.js\"></script>\n    <script src=\"https://cdn.keyauth.cc/dashboard/unixtolocal.js\"></script>\n\n    <script src=\"https://cdn.jsdelivr.net/npm/sweetalert2@11\"></script>\n\n    <link href=\"https://cdn.lineicons.com/4.0/lineicons.css\" rel=\"stylesheet\" />\n\n    <script src=\"https://cdn.keyauth.cc/v2/assets/plugins/custom/datatables/datatables.bundle.js\"></script>\n    <script src=\"https://cdn.keyauth.cc/v2/assets/plugins/custom/datatables/datatables.js\"></script>\n\n    <script src=\"https://cdn.keyauth.cc/v3/scripts/sidebar.js\"></script>\n    <script src=\"https://cdn.keyauth.cc/v3/dist/dashboard.min.js\"></script>\n    \n    <script>\n    // Hide loader when page is fully loaded\n    window.addEventListener('load', function() {\n        const loader = document.getElementById('loader');\n        if (loader) {\n            loader.style.display = 'none';\n            console.log('Loader hidden on window load');\n        }\n    });\n    \n    // Also try hiding on DOMContentLoaded as backup\n    if (document.readyState === 'loading') {\n        document.addEventListener('DOMContentLoaded', function() {\n            const loader = document.getElementById('loader');\n            if (loader) {\n                loader.style.display = 'none';\n                console.log('Loader hidden on DOMContentLoaded');\n            }\n        });\n    } else {\n        // DOM already loaded, hide immediately\n        const loader = document.getElementById('loader');\n        if (loader) {\n            loader.style.display = 'none';\n            console.log('Loader hidden immediately');\n        }\n    }\n    </script>\n</body>\n\n</html>\n","size_bytes":8413},"app/license-fetch.php":{"content":"<?php\n\nuse function misc\\etc\\timeconversion;\n\ninclude '../includes/misc/autoload.phtml';\n\nset_exception_handler(function ($exception) {\n        error_log(\"\\n--------------------------------------------------------------\\n\");\n        error_log($exception);\n        error_log(\"\\nRequest data:\");\n        error_log(print_r($_POST, true));\n        error_log(\"\\n--------------------------------------------------------------\");\n        http_response_code(500);\n        die(\"Error: \" . $exception->getMessage());\n});\n\nif (session_status() === PHP_SESSION_NONE) {\n        session_start();\n}\n\nif ($_SESSION['role'] == \"Reseller\") {\n        die(\"Resellers can't access this.\");\n}\n\nif (!isset($_SESSION['app'])) {\n        dashboard\\primary\\error(\"Application not selected\");\n        die(\"Application not selected.\");\n}\n\nif (isset($_POST['draw'])) {\n\n        // credits to https://makitweb.com/datatables-ajax-pagination-with-search-and-sort-php/\n\n        $draw = intval($_POST['draw']);\n        $row = intval($_POST['start']);\n        $rowperpage = intval($_POST['length']); // Rows display per page\n        $columnIndex = misc\\etc\\sanitize($_POST['order'][0]['column']); // Column index\n        $columnName = misc\\etc\\sanitize($_POST['columns'][$columnIndex]['data']); // Column name\n        $columnSortOrder = misc\\etc\\sanitize($_POST['order'][0]['dir']); // asc or desc\n        $searchValue = misc\\etc\\sanitize($_POST['search']['value']); // Search value\n\n        // whitelist certain column names and sort orders to prevent SQL injection\n        if (!in_array($columnName, array(\"key\", \"gendate\", \"genby\", \"expires\", \"note\", \"usedon\", \"usedby\", \"status\"))) {\n                die(\"Column name is not whitelisted.\");\n        }\n\n        if (!in_array($columnSortOrder, array(\"desc\", \"asc\"))) {\n                die(\"Column sort order is not whitelisted.\");\n        }\n\n        if (!is_null($searchValue)) {\n                $query = misc\\mysql\\query(\"select * from `keys` WHERE (`key` like ? or `note` like ? or `genby` like ? or `usedby` like ? ) and app = ? order by `\" . $columnName . \"` \" . $columnSortOrder . \" limit \" . $row . \",\" . $rowperpage, [\"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", $_SESSION['app']]);\n        }\n        else {\n                $query = misc\\mysql\\query(\"select * from `keys` WHERE app = ? order by `\" . $columnName . \"` \" . $columnSortOrder . \" limit \" . $row . \",\" . $rowperpage, [$_SESSION['app']]);\n        }\n        \n        $data = array();\n\n        while ($row = mysqli_fetch_assoc($query->result)) {\n\n                ## If only one or two keys exists then we will use custom margin to fix the bugging menu\n                $banBtns = \"\";\n                if ($row['status'] == \"Banned\") {\n                        $banBtns = '<button class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-red-700\" name=\"unbankey\" value=\"' . $row['key'] . '\">Unban Key</button>';\n                } else {\n                        $banBtns = '<button class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-blue-700\" type=\"button\" onclick=\"bankey(\\'' . $row[\"key\"] . '\\')\">Ban Key</button>';\n                }\n\n                $MarginManager = \"\";\n                if ($query->num_rows < 2) {\n                        $MarginManager = \"margin-bottom: 20px;\";\n                } else {\n                        $MarginManager = \"margin-bottom: 0px;\";\n                }\n\n                $data[] = array(\n                        \"key\" => $row['key'],\n                        \"gendate\" => '<div id=\"' . $row['key'] . '-gendate\"><script>document.getElementById(\"' . $row['key'] . '-gendate\").textContent=convertTimestamp(' . $row[\"gendate\"] . ');</script></div>',\n                        \"genby\" => $row['genby'],\n                        \"expires\" => timeconversion($row[\"expires\"]),\n                        \"note\" => $row['note'] ?? 'N/A',\n                        \"usedon\" => (!is_null($row[\"usedon\"])) ? '<div id=\"' . $row['key'] . '-usedon\"><script>document.getElementById(\"' . $row['key'] . '-usedon\").textContent=convertTimestamp(' . $row[\"usedon\"] . ');</script></div>' : 'N/A',\n                        \"usedby\" => ($row[\"usedby\"] == $row['key']) ? 'Same as key' : $row[\"usedby\"] ?? 'N/A',\n                        \"status\" => '<span class=\"border ' . (($row['status'] == \"Not Used\") ? 'border-white text-white' : 'border-blue-700 text-blue-800') . ' text-xs font-medium mr-2 px-2.5 py-0.5 rounded\">' . $row['status'] . '</span>',\n                                    \n                        \"actions\" => '\n                                <form method=\"POST\" style=\"' . $MarginManager . '\">\n                                        <td>\n                                                <div x-data=\"{ open: false }\" class=\"z-0\">\n                                                <button x-on:click=\"open = true\" class=\"flex items-center border border-gray-700 rounded-lg focus:opacity-60 text-white focus:text-white font-semibold rounded focus:outline-none focus:shadow-inner py-2 px-4\" type=\"button\">\n                                                        <span class=\"mr-1\">Actions</span>\n                                                        <svg class=\"fill-current h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\"  style=\"margin-top:3px\">\n                                                        <path d=\"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z\"/>\n                                                        </svg>\n                                                </button>\n                                                <ul x-show=\"open\" x-on:click.away=\"open = false\" class=\"bg-[#09090d] text-white rounded shadow-lg absolute py-2 mt-1\" style=\"min-width:15rem\">\n                                                        <li>\n                                                                <button type=\"button\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-blue-700\"\n                                                                onclick=\"delkey(\\'' . $row[\"key\"] . '\\')\">\n                                                                Delete Key\n                                                                </button>\n                                                        </li>\n                                                        <li>\n                                                                ' . $banBtns . '\n                                                        </li>\n                                                        <li>\n                                                                <button class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-blue-700\"\n                                                                name=\"editkey\" value=\"' . $row['key'] . '\">\n                                                                Edit Key\n                                                                </button>\n                                                        </li>\n                                                </ul>\n                                                </div>\n                                        </td>\n                                        </tr>\n                                </form> \n                                ',\n                        );       \n        }\n\n        ## Response\n        $response = array(\n                \"draw\" => intval($draw),\n                \"aaData\" => $data\n        );\n\n        die(json_encode($response));\n}\n\ndie(\"Request not from datatables, aborted.\");\n","size_bytes":7623},"app/log-fetch.php":{"content":"<?php\ninclude '../includes/misc/autoload.phtml';\n\nset_exception_handler(function ($exception) {\n        error_log(\"\\n--------------------------------------------------------------\\n\");\n        error_log($exception);\n        error_log(\"\\nRequest data:\");\n        error_log(print_r($_POST, true));\n        error_log(\"\\n--------------------------------------------------------------\");\n        http_response_code(500);\n        die(\"Error: \" . $exception->getMessage());\n});\n\nif (session_status() === PHP_SESSION_NONE) {\n        session_start();\n}\n\nif ($_SESSION['role'] == \"Reseller\") {\n        die(\"Resellers can't access this.\");\n}\n\nif (!isset($_SESSION['app'])) {\n        dashboard\\primary\\error(\"Application not selected\");\n        die(\"Application not selected.\");\n}\n\nif (isset($_POST['draw'])) {\n\n        // credits to https://makitweb.com/datatables-ajax-pagination-with-search-and-sort-php/\n\n        $draw = intval($_POST['draw']);\n        $row = intval($_POST['start']);\n        $rowperpage = intval($_POST['length']); // Rows display per page\n        $columnIndex = misc\\etc\\sanitize($_POST['order'][0]['column']); // Column index\n        $columnName = misc\\etc\\sanitize($_POST['columns'][$columnIndex]['data']); // Column name\n        $columnSortOrder = misc\\etc\\sanitize($_POST['order'][0]['dir']); // asc or desc\n        $searchValue = misc\\etc\\sanitize($_POST['search']['value']); // Search value\n\n        // whitelist certain column names and sort orders to prevent SQL injection\n        if (!in_array($columnName, array(\"logdate\", \"logdata\", \"credential\", \"pcuser\"))) {\n                die(\"Column name is not whitelisted.\");\n        }\n\n        if (!in_array($columnSortOrder, array(\"desc\", \"asc\"))) {\n                die(\"Column sort order is not whitelisted.\");\n        }\n\n        if (!is_null($searchValue)) {\n                $query = misc\\mysql\\query(\"select * from `logs` WHERE (`logdata` like ? or `credential` like ? or `pcuser` like ? ) and logapp = ? order by `\" . $columnName . \"` \" . $columnSortOrder . \" limit \" . $row . \",\" . $rowperpage, [\"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", $_SESSION['app']]);\n        }\n        else {\n                $query = misc\\mysql\\query(\"select * from `logs` WHERE logapp = ? order by `\" . $columnName . \"` \" . $columnSortOrder . \" limit \" . $row . \",\" . $rowperpage, [$_SESSION['app']]);\n        }\n        \n        $data = array();\n\n        while ($row = mysqli_fetch_assoc($query->result)) {\n                $data[] = array(\n                        \"logdate\" => '<div id=\"' . $row['id'] . '-logdate\"><script>document.getElementById(\"' . $row['id'] . '-logdate\").textContent=convertTimestamp(' . $row[\"logdate\"] . ');</script></div>',\n                        \"logdata\" => $row['logdata'],\n                        \"credential\" => $row['credential'] ?? 'N/A',\n                        \"pcuser\" => $row['pcuser'] ?? 'N/A',\n                );\n        }\n\n        ## Response\n        $response = array(\n                \"draw\" => intval($draw),\n                \"aaData\" => $data\n        );\n\n        die(json_encode($response));\n}\n\ndie(\"Request not from datatables, aborted.\");\n","size_bytes":3164},"app/reseller-license-fetch.php":{"content":"<?php\ninclude '../includes/misc/autoload.phtml';\n\nset_exception_handler(function ($exception) {\n        error_log(\"\\n--------------------------------------------------------------\\n\");\n        error_log($exception);\n            error_log(\"\\nRequest data:\");\n            error_log(print_r($_POST, true));\n            error_log(\"\\n--------------------------------------------------------------\");\n        http_response_code(500);\n        die(\"Error: \" . $exception->getMessage());\n});\n\nif (session_status() === PHP_SESSION_NONE) {\n        session_start();\n}\n\nif (!isset($_SESSION['app'])) {\n        dashboard\\primary\\error(\"Application not selected\");\n        die(\"Application not selected.\");\n}\n\nif (isset($_POST['draw'])) {\n\n        // credits to https://makitweb.com/datatables-ajax-pagination-with-search-and-sort-php/\n\n        $draw = intval($_POST['draw']);\n        $row = intval($_POST['start']);\n        $rowperpage = intval($_POST['length']); // Rows display per page\n        $columnIndex = misc\\etc\\sanitize($_POST['order'][0]['column']); // Column index\n        $columnName = misc\\etc\\sanitize($_POST['columns'][$columnIndex]['data']); // Column name\n        $columnSortOrder = misc\\etc\\sanitize($_POST['order'][0]['dir']); // asc or desc\n        $searchValue = misc\\etc\\sanitize($_POST['search']['value']); // Search value\n\n        // whitelist certain column names and sort orders to prevent SQL injection\n        if (!in_array($columnName, array(\"key\", \"gendate\", \"expires\", \"note\", \"usedon\", \"usedby\", \"status\"))) {\n                die(\"Column name is not whitelisted.\");\n        }\n\n        if (!in_array($columnSortOrder, array(\"desc\", \"asc\"))) {\n                die(\"Column sort order is not whitelisted.\");\n        }\n\n        if (!is_null($searchValue)) {\n                $query = misc\\mysql\\query(\"select * from `keys` WHERE (`key` like ? or `note` like ? or `usedby` like ? ) and app = ? and genby = ? order by `\" . $columnName . \"` \" . $columnSortOrder . \" limit \" . $row . \",\" . $rowperpage, [\"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", $_SESSION['app'], $_SESSION['username']]);\n        }\n        else {\n                $query = misc\\mysql\\query(\"select * from `keys` WHERE app = ? and genby = ? order by `\" . $columnName . \"` \" . $columnSortOrder . \" limit \" . $row . \",\" . $rowperpage, [$_SESSION['app'], $_SESSION['username']]);\n        }\n        \n        $data = array();\n\n        while ($row = mysqli_fetch_assoc($query->result)) {\n                $data[] = array(\n                        \"key\" => $row['key'],\n                        \"gendate\" => '<div id=\"' . $row['key'] . '-gendate\"><script>document.getElementById(\"' . $row['key'] . '-gendate\").textContent=convertTimestamp(' . $row[\"gendate\"] . ');</script></div>',\n                        \"expires\" => ($row[\"expires\"] / 86400) . ' Day(s)',\n                        \"note\" => $row['note'] ?? 'N/A',\n                        \"usedon\" => (!is_null($row[\"usedon\"])) ? '<div id=\"' . $row['key'] . '-usedon\"><script>document.getElementById(\"' . $row['key'] . '-usedon\").textContent=convertTimestamp(' . $row[\"usedon\"] . ');</script></div>' : 'N/A',\n                        \"usedby\" => ($row[\"usedby\"] == $row['key']) ? 'Same as key' : $row[\"usedby\"] ?? 'N/A',\n                        \"status\" => '<label class=\"' . (($row['status'] == \"Not Used\") ? 'badge badge-light-success' : 'badge badge-light-danger') . '\">' . $row['status'] . '</label>',\n                        \"actions\" => '\n                        <form method=\"POST\">\n                        <td>\n                                        <div x-data=\"{ open: false }\" class=\"z-0\">\n                                        <button x-on:click=\"open = true\" class=\"flex items-center border border-gray-700 rounded-lg focus:opacity-60 text-white focus:text-white font-semibold rounded focus:outline-none focus:shadow-inner py-2 px-4\" type=\"button\">\n                                                <span class=\"mr-1\">Actions</span>\n                                                <svg class=\"fill-current h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\"  style=\"margin-top:3px\">\n                                                <path d=\"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z\"/>\n                                                </svg>\n                                        </button>\n                                        <ul x-show=\"open\" x-on:click.away=\"open = false\" class=\"bg-[#09090d] text-white rounded shadow-lg absolute py-2 mt-1\" style=\"min-width:15rem\">\n                                                <li>\n                                                        <button type=\"button\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-blue-700\"\n                                                        onclick=\"delkey(\\'' . $row[\"key\"] . '\\')\">\n                                                        Delete Key\n                                                        </button>\n                                                </li>\n                                                <li>\n                                                        <button type=\"button\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-blue-700\"\n                                                        onclick=\"bankey(\\'' . $row[\"key\"] . '\\')\">\n                                                        Ban Key\n                                                        </button>\n                                                </li>\n                                                <li>\n                                                        <button class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-blue-700\"\n                                                        name=\"unbankey\" value=\"' . $row['key'] . '\">\n                                                        Unban Key\n                                                        </button>\n                                                </li>\n                                        </ul>\n                                        </div>\n\n\n                                        </td>\n                                        </tr>\n                                        </form>',\n                );\n        }\n\n        ## Response\n        $response = array(\n                \"draw\" => intval($draw),\n                \"aaData\" => $data\n        );\n\n        die(json_encode($response));\n}\n\ndie(\"Request not from datatables, aborted.\");\n","size_bytes":6543},"app/reseller-user-fetch.php":{"content":"<?php\ninclude '../includes/misc/autoload.phtml';\n\nset_exception_handler(function ($exception) {\n        error_log(\"\\n--------------------------------------------------------------\\n\");\n        error_log($exception);\n        error_log(\"\\nRequest data:\");\n        error_log(print_r($_POST, true));\n        error_log(\"\\n--------------------------------------------------------------\");\n        http_response_code(500);\n        die(\"Error: \" . $exception->getMessage());\n});\n\nif (session_status() === PHP_SESSION_NONE) {\n        session_start();\n}\n\nif (!isset($_SESSION['app'])) {\n        dashboard\\primary\\error(\"Application not selected\");\n        die(\"Application not selected.\");\n}\n\nif (isset($_POST['draw'])) {\n\n        // credits to https://makitweb.com/datatables-ajax-pagination-with-search-and-sort-php/\n\n        $draw = intval($_POST['draw']);\n        $row = intval($_POST['start']);\n        $rowperpage = intval($_POST['length']); // Rows display per page\n        $columnIndex = misc\\etc\\sanitize($_POST['order'][0]['column']); // Column index\n        $columnName = misc\\etc\\sanitize($_POST['columns'][$columnIndex]['data']); // Column name\n        $columnSortOrder = misc\\etc\\sanitize($_POST['order'][0]['dir']); // asc or desc\n        $searchValue = misc\\etc\\sanitize($_POST['search']['value']); // Search value\n\n        // whitelist certain column names and sort orders to prevent SQL injection\n        if (!in_array($columnName, array(\"username\", \"hwid\", \"ip\", \"createdate\", \"lastlogin\", \"banned\"))) {\n                die(\"Column name is not whitelisted.\");\n        }\n\n        if (!in_array($columnSortOrder, array(\"desc\", \"asc\"))) {\n                die(\"Column sort order is not whitelisted.\");\n        }\n\n        if (!is_null($searchValue)) {\n                $query = misc\\mysql\\query(\"select * from `users` WHERE (`username` like ? or `hwid` like ? or `ip` like ? or `banned` like ? ) and app = ? and owner = ? order by `\" . $columnName . \"` \" . $columnSortOrder . \" limit \" . $row . \",\" . $rowperpage, [\"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", $_SESSION['app'], $_SESSION['username']]);\n        }\n        else {\n                $query = misc\\mysql\\query(\"select * from `users` WHERE app = ? and owner = ? order by `\" . $columnName . \"` \" . $columnSortOrder . \" limit \" . $row . \",\" . $rowperpage, [$_SESSION['app'], $_SESSION['username']]);\n        }\n        \n        $data = array();\n\n        while ($row = mysqli_fetch_assoc($query->result)) {\n\n                ## Add Extra Margin to buttons if value is 1 or 2, because datatables with ajax breaks it.\n                $MarginManager = \"\";\n                if ($query->num_rows < 2) {\n                        $MarginManager = \"margin-bottom: 80;\";\n                } else {\n                        $MarginManager = \"margin-bottom: 0px;\";\n                }\n\n                $data[] = array(\n                        \"username\" => $row['username'],\n                        \"hwid\" => '<span class=\"blur-sm hover:blur-none\">' . $row['hwid'] ?? 'N/A',\n                        \"ip\" => '<span class=\"blur-sm hover:blur-none\">' . $row['ip'] ?? 'N/A',\n                        \"createdate\" => '<div id=\"' . $row['username'] . '-createdate\"><script>document.getElementById(\"' . $row['username'] . '-createdate\").textContent=convertTimestamp(' . $row[\"createdate\"] . ');</script></div>',\n                        \"lastlogin\" => '<div id=\"' . $row['username'] . '-lastlogin\"><script>document.getElementById(\"' . $row['username'] . '-lastlogin\").textContent=convertTimestamp(' . $row[\"lastlogin\"] . ');</script></div>',\n                        \"banned\" => $row['banned'] ?? 'N/A',\n                        \"actions\" => '\n                        <form method=\"POST\" style=\"' . $MarginManager . '\">\n                        <td>\n                                                <div x-data=\"{ open: false }\" class=\"z-0\">\n                                                <button x-on:click=\"open = true\" class=\"flex items-center border border-gray-700 rounded-lg focus:opacity-60 text-white focus:text-white font-semibold rounded focus:outline-none focus:shadow-inner py-2 px-4\" type=\"button\">\n                                                        <span class=\"mr-1\">Actions</span>\n                                                        <svg class=\"fill-current h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\"  style=\"margin-top:3px\">\n                                                        <path d=\"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z\"/>\n                                                        </svg>\n                                                </button>\n                                                <ul x-show=\"open\" x-on:click.away=\"open = false\" class=\"bg-[#09090d] text-white rounded shadow-lg absolute py-2 mt-1\" style=\"min-width:15rem\">\n                                                        <li>\n                                                                <button name=\"deleteuser\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-blue-700\"\n                                                                value=\"' . $row[\"username\"] . '\">\n                                                                Delete User\n                                                                </button>\n                                                        </li>\n                                                        <li>\n                                                                <button name=\"resetuser\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-red-700\"\n                                                                value=\"' . $row[\"username\"] . '\">\n                                                                Reset User\n                                                                </button>\n                                                        </li>\n                                                        <li>\n                                                                <button type=\"button\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-blue-700\"\n                                                                onclick=\"banuser(\\'' . $row[\"username\"] . '\\')\">\n                                                                Ban User\n                                                                </button>\n                                                        </li>\n                                                        <li>\n                                                                <button name=\"edituser\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-blue-700\"\n                                                                value=\"' . $row['username'] . '\">\n                                                                Edit User\n                                                                </button>\n                                                        </li>\n                                                </ul>\n                                                </div>\n                                                \n                                                \n                                                \n                                                \n                                                \n                                                \n                                                </td></tr></form>',\n                );\n        }\n\n        ## Response\n        $response = array(\n                \"draw\" => intval($draw),\n                \"aaData\" => $data\n        );\n\n        die(json_encode($response));\n}\n\ndie(\"Request not from datatables, aborted.\");\n","size_bytes":7799},"app/session-fetch.php":{"content":"<?php\ninclude '../includes/misc/autoload.phtml';\n\nset_exception_handler(function ($exception) {\n        error_log(\"\\n--------------------------------------------------------------\\n\");\n        error_log($exception);\n        error_log(\"\\nRequest data:\");\n        error_log(print_r($_POST, true));\n        error_log(\"\\n--------------------------------------------------------------\");\n        http_response_code(500);\n        die(\"Error: \" . $exception->getMessage());\n});\n\nif (session_status() === PHP_SESSION_NONE) {\n        session_start();\n}\n\nif ($_SESSION['role'] == \"Reseller\") {\n        die(\"Resellers can't access this.\");\n}\n\nif (!isset($_SESSION['app'])) {\n        dashboard\\primary\\error(\"Application not selected\");\n        die(\"Application not selected.\");\n}\n\nif (isset($_POST['draw'])) {\n\n        // credits to https://makitweb.com/datatables-ajax-pagination-with-search-and-sort-php/\n\n        $draw = intval($_POST['draw']);\n        $row = intval($_POST['start']);\n        $rowperpage = intval($_POST['length']); // Rows display per page\n        $columnIndex = misc\\etc\\sanitize($_POST['order'][0]['column']); // Column index\n        $columnName = misc\\etc\\sanitize($_POST['columns'][$columnIndex]['data']); // Column name\n        $columnSortOrder = misc\\etc\\sanitize($_POST['order'][0]['dir']); // asc or desc\n        $searchValue = misc\\etc\\sanitize($_POST['search']['value']); // Search value\n\n        // whitelist certain column names and sort orders to prevent SQL injection\n        if (!in_array($columnName, array(\"id\", \"credential\", \"expiry\", \"validated\", \"ip\"))) {\n                die(\"Column name is not whitelisted.\");\n        }\n\n        if (!in_array($columnSortOrder, array(\"desc\", \"asc\"))) {\n                die(\"Column sort order is not whitelisted.\");\n        }\n\n        if (!is_null($searchValue)) {\n                $query = misc\\mysql\\query(\"select * from `sessions` WHERE (`id` like ? or `credential` like ? or `ip` like ? ) and app = ? order by `\" . $columnName . \"` \" . $columnSortOrder . \" limit \" . $row . \",\" . $rowperpage, [\"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", $_SESSION['app']]);\n        }\n        else {\n                $query = misc\\mysql\\query(\"select * from `sessions` WHERE app = ? order by `\" . $columnName . \"` \" . $columnSortOrder . \" limit \" . $row . \",\" . $rowperpage, [$_SESSION['app']]);\n        }\n        \n        $data = array();\n\n        while ($row = mysqli_fetch_assoc($query->result)) {\n                $data[] = array(\n                        \"id\" => $row['id'],\n                        \"credential\" => $row[\"credential\"] ?? 'N/A',\n                        \"expiry\" => '<div id=\"' . $row['id'] . '-expiry\"><script>document.getElementById(\"' . $row['id'] . '-expiry\").textContent=convertTimestamp(' . $row[\"expiry\"] . ');</script></div>',\n                        \"validated\" => ($row['validated'] ? 1 : 0) ? 'true' : 'false',\n                        \"ip\" => '<span class=\"blur-sm hover:blur-none\">' . ($row['ip'] ?? 'N/A') . '</span>',\n                        \"actions\" => \n                        '<form method=\"POST\">\n                        <td>\n\n\n                        <div x-data=\"{ open: false }\" class=\"z-0\">\n                        <button x-on:click=\"open = true\" class=\"flex items-center border border-gray-700 rounded-lg focus:opacity-60 text-white focus:text-white font-semibold rounded focus:outline-none focus:shadow-inner py-2 px-4\" type=\"button\">\n                                <span class=\"mr-1\">Actions</span>\n                                <svg class=\"fill-current h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\"  style=\"margin-top:3px\">\n                                <path d=\"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z\"/>\n                                </svg>\n                        </button>\n                        <ul x-show=\"open\" x-on:click.away=\"open = false\" class=\"bg-[#09090d] text-white rounded shadow-lg absolute py-2 mt-1\" style=\"min-width:15rem\">\n                                <li>\n                                        <button name=\"kill\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-red-700\"\n                                        value=\"' . $row[\"id\"] . '\">\n                                        Kill Session\n                                        </button>\n                                </li>\n                                </ul>\n                                </div>\n                                </tr>\n                        </td>\n                        </tr>\n                        </form>',\n                );\n        }\n\n        ## Response\n        $response = array(\n                \"draw\" => intval($draw),\n                \"aaData\" => $data\n        );\n\n        die(json_encode($response));\n}\n\ndie(\"Request not from datatables, aborted.\");\n","size_bytes":4876},"app/token-fetch.php":{"content":"<?php\n\ninclude '../includes/misc/autoload.phtml';\n\nset_exception_handler(function ($exception) {\n\terror_log(\"\\n--------------------------------------------------------------\\n\");\n\terror_log($exception);\n\terror_log(\"\\nRequest data:\");\n\terror_log(print_r($_POST, true));\n\terror_log(\"\\n--------------------------------------------------------------\");\n\thttp_response_code(500);\n\tdie(\"Error: \" . $exception->getMessage());\n});\n\nif (session_status() === PHP_SESSION_NONE) {\n\tsession_start();\n}\n\nif ($_SESSION['role'] == \"Reseller\") {\n\tdie(\"Resellers can't access this.\");\n}\n\nif ($_SESSION['role'] == \"Manager\") {\n\tdie(\"Managers can't access this.\");\n}\n\nif (!isset($_SESSION['app'])) {\n\tdashboard\\primary\\error(\"Application not selected\");\n\tdie(\"Application not selected.\");\n}\n\nif (isset($_POST['draw'])) {\n\n\t// credits to https://makitweb.com/datatables-ajax-pagination-with-search-and-sort-php/\n\n\t$draw = intval($_POST['draw']);\n\t$row = intval($_POST['start']);\n\t$rowperpage = intval($_POST['length']); // Rows display per page\n\t$columnIndex = misc\\etc\\sanitize($_POST['order'][0]['column']); // Column index\n\t$columnName = misc\\etc\\sanitize($_POST['columns'][$columnIndex]['data']); // Column name\n\t$columnSortOrder = misc\\etc\\sanitize($_POST['order'][0]['dir']); // asc or desc\n\t$searchValue = misc\\etc\\sanitize($_POST['search']['value']); // Search value\n\n\t## Total number of records without filtering\n\t$sel = misc\\mysql\\query(\"SELECT count(1) AS allcount FROM `tokens` WHERE app = ?\", [$_SESSION['app']]);\n\t$records = mysqli_fetch_assoc($sel->result);\n\t$totalRecords = $records['allcount'];\n\n\t$totalRecordwithFilter = $totalRecords;\n\tif (!is_null($searchValue)) { // don't double query if no search value was provided\n\t\t## Total number of record with filtering\n\t\t$sel = misc\\mysql\\query(\"SELECT count(1) AS allcount FROM `tokens` WHERE 1 AND (`token` LIKE ? OR `assigned` LIKE ? OR `status` LIKE ? OR `reason` LIKE ? ) AND app = ?\", [\"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", $_SESSION['app']]);\n\t\t$records = mysqli_fetch_assoc($sel->result);\n\t\t$totalRecordwithFilter = $records['allcount'];\n\t}\n\n\t// whitelist certain column names and sort orders to prevent SQL injection\n\tif (!in_array($columnName, array(\"app\", \"token\", \"assigned\", \"banned\", \"reason\", \"hash\", \"type\", \"status\"))) {\n\t\tdie(\"Column name is not whitelisted.\");\n\t}\n\n\tif (!in_array($columnSortOrder, array(\"desc\", \"asc\"))) {\n\t\tdie(\"Column sort order is not whitelisted.\");\n\t}\n\n\t## Fetch records\n\tif (!is_null($searchValue)){\n\t\t$query = misc\\mysql\\query(\"SELECT * FROM `tokens` WHERE (`token` LIKE ? OR `assigned` LIKE ? OR `status` LIKE ? or `reason` LIKE ?) AND `app` = ? order by `\" . $columnName . \"` \" . $columnSortOrder . \" limit \" . $row . \",\" . $rowperpage, [\"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", $_SESSION['app']]);\n\t} else {\n\t\t$query = misc\\mysql\\query(\"SELECT * FROM `tokens` WHERE `app` = ? order by `\" . $columnName . \"` \" . $columnSortOrder . \" limit \" . $row . \",\" . $rowperpage, [$_SESSION['app']]);\n\t}\n\t\n\t$data = array();\n\t\n\twhile ($row = mysqli_fetch_assoc($query->result)) {\n\n\t\t## If only one or two keys exists then we will use custom margin to fix the bugging menu\n\t\t$banBtns = \"\";\n\t\tif ($row['banned']) {\n\t\t\t$banBtns = '<button class=\"btn menu-link px-3\" style=\"font-size:0.95rem;\" name=\"unbankey\" value=\"' . $row['key'] . '\">Unban</button>';\n\t\t} else {\n\t\t\t$banBtns = '<a class=\"menu-link px-3\" data-bs-toggle=\"modal\" data-bs-target=\"#ban-key\" onclick=\"bankey(\\'' . $row[\"key\"] . '\\')\">Ban</a>';\n\t\t}\n\n\t\t$MarginManager = \"\";\n\t\tif ($totalRecordwithFilter < 2) {\n\t\t\t$MarginManager = \"margin-bottom: 20px;\";\n\t\t} else {\n\t\t\t$MarginManager = \"margin-bottom: 0px;\";\n\t\t}\n\n\t\t$data[] = array(\n\t\t\t\"app\" => $_SESSION['name'],\n\t\t\t\"token\" => $row['token'],\n\t\t\t\"assigned\" => $row['assigned'] ?? \"N\\A\",\n\t\t\t\"banned\" => '<label class=\"' . ($row['banned'] == 1 ? 'text-red-700' : 'text-green-700') . '\">' . ($row['banned'] == 1 ? 'banned' : 'unbanned') . '</label>',\n            \"reason\" => is_null($row['reason']) ? 'N/A' : $row['reason'],\n\t\t\t\"hash\" => is_null($row['hash']) ? 'N/A' : $row['reason'],\n\t\t\t\"type\" => $row['type'],\n\t\t\t\"status\" => $row['status'],\n\t\t);\n\t}\n\n\t## Response\n\t$response = array(\n\t\t\"draw\" => intval($draw),\n\t\t\"iTotalRecords\" => $totalRecords,\n\t\t\"iTotalDisplayRecords\" => $totalRecordwithFilter,\n\t\t\"aaData\" => $data\n\t);\n\tdie(json_encode($response));\n}\n\ndie(\"Request not from datatables, aborted.\");\n\n\n?>","size_bytes":4490},"app/user-fetch.php":{"content":"<?php\ninclude '../includes/misc/autoload.phtml';\n\nset_exception_handler(function ($exception) {\n        error_log(\"\\n--------------------------------------------------------------\\n\");\n        error_log($exception);\n        error_log(\"\\nRequest data:\");\n        error_log(print_r($_POST, true));\n        error_log(\"\\n--------------------------------------------------------------\");\n        http_response_code(500);\n        die(\"Error: \" . $exception->getMessage());\n});\n\nif (session_status() === PHP_SESSION_NONE) {\n        session_start();\n}\n\nif ($_SESSION['role'] == \"Reseller\") {\n        die(\"Resellers can't access this.\");\n}\n\nif (!isset($_SESSION['app'])) {\n        dashboard\\primary\\error(\"Application not selected\");\n        die(\"Application not selected.\");\n}\n\nif (isset($_POST['draw'])) {\n\n        // credits to https://makitweb.com/datatables-ajax-pagination-with-search-and-sort-php/\n\n        $draw = intval($_POST['draw']);\n        $row = intval($_POST['start']);\n        $rowperpage = intval($_POST['length']); // Rows display per page\n        $columnIndex = misc\\etc\\sanitize($_POST['order'][0]['column']); // Column index\n        $columnName = misc\\etc\\sanitize($_POST['columns'][$columnIndex]['data']); // Column name\n        $columnSortOrder = misc\\etc\\sanitize($_POST['order'][0]['dir']); // asc or desc\n        $searchValue = misc\\etc\\sanitize($_POST['search']['value']); // Search value\n\n        // whitelist certain column names and sort orders to prevent SQL injection\n        if (!in_array($columnName, array(\"username\", \"hwid\", \"ip\", \"createdate\", \"lastlogin\", \"banned\"))) {\n                die(\"Column name is not whitelisted.\");\n        }\n\n        if (!in_array($columnSortOrder, array(\"desc\", \"asc\"))) {\n                die(\"Column sort order is not whitelisted.\");\n        }\n\n        if (!is_null($searchValue)) {\n                $query = misc\\mysql\\query(\"select * from `users` WHERE (`username` like ? or `hwid` like ? or `ip` like ? or `banned` like ? ) and app = ? order by `\" . $columnName . \"` \" . $columnSortOrder . \" limit \" . $row . \",\" . $rowperpage, [\"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", $_SESSION['app']]);\n        }\n        else {\n                $query = misc\\mysql\\query(\"select * from `users` WHERE app = ? order by `\" . $columnName . \"` \" . $columnSortOrder . \" limit \" . $row . \",\" . $rowperpage, [$_SESSION['app']]);\n        }\n        \n        $data = array();\n\n        while ($row = mysqli_fetch_assoc($query->result)) {\n\n                ## If User is banned show only unban and if not show only ban.\n                $banBtns = \"\";\n                if ($row['banned'] ? true : false) {\n                        $banned = $row['banned'];\n                        $banBtns = '<button class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-red-700\" name=\"unbanuser\" value=\"' . urlencode($row['username']) . '\">Unban User</button>';\n                } else {\n                        $banned = \"N/A\";\n                        $banBtns = '<button class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-blue-700\" type=\"button\" onclick=\"banuser(\\'' . urlencode($row[\"username\"]) . '\\')\">Ban User</button>';\n                                   \n                }\n\n                ## Add Extra Margin to buttons if value is 1 or 2, because datatables with ajax breaks it.\n                $MarginManager = \"\";\n                if ($query->num_rows < 2) {\n                        $MarginManager = \"margin-bottom: 120px;\";\n                } else {\n                        $MarginManager = \"margin-bottom: 0px;\";\n                }\n\n                $data[] = array(\n                        \"username\" => $row['username'],\n                        \"hwid\" => '<span class=\"blur-sm hover:blur-none\">' . ($row['hwid'] ?? 'N/A') . '</span>',\n                        \"ip\" => '<span class=\"blur-sm hover:blur-none\">' . ($row['ip'] ?? 'N/A') . '</span>',\n                        \"createdate\" => '<div id=\"' . $row['username'] . '-createdate\"><script>document.getElementById(\"' . $row['username'] . '-createdate\").textContent=convertTimestamp(' . $row[\"createdate\"] . ');</script></div>',\n                        \"lastlogin\" => '<div id=\"' . $row['username'] . '-lastlogin\"><script>document.getElementById(\"' . $row['username'] . '-lastlogin\").textContent=convertTimestamp(' . $row[\"lastlogin\"] . ');</script></div>',\n                        \"banned\" => $banned,\n                        \"actions\" => '<tr><form method=\"POST\">\n                        <td>\n\n                        <div x-data=\"{ open: false }\" class=\"z-0\">\n                                                <button x-on:click=\"open = true\" class=\"flex items-center border border-gray-700 rounded-lg focus:opacity-60 text-white focus:text-white font-semibold rounded focus:outline-none focus:shadow-inner py-2 px-4\" type=\"button\">\n                                                        <span class=\"mr-1\">Actions</span>\n                                                        <svg class=\"fill-current h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\"  style=\"margin-top:3px\">\n                                                        <path d=\"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z\"/>\n                                                        </svg>\n                                                </button>\n                                                <ul x-show=\"open\" x-on:click.away=\"open = false\" class=\"bg-[#09090d] text-white rounded shadow-lg absolute py-2 mt-1\" style=\"min-width:15rem\">\n                                                        <li>\n                                                                <button name=\"deleteuser\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-red-700\"\n                                                                value=\"' . urlencode($row[\"username\"]) . '\">\n                                                                Delete User\n                                                                </button>\n                                                        </li>\n                                                        <li>\n                                                                <button name=\"resetuser\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-red-700\"\n                                                                value=\"' . $row[\"username\"] . '\">\n                                                                Reset User HWID\n                                                                </button>\n                                                        </li>\n                                                        <li>\n                                                                ' . $banBtns . '\n                                                        </li>\n                                                        <li>\n                                                                <button name=\"pauseuser\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-red-700\"\n                                                                value=\"' . $row['username'] . '\">\n                                                                Pause User\n                                                                </button>\n                                                        </li>\n                                                        <li>\n                                                                <button name=\"unpauseuser\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-red-700\"\n                                                                value=\"' . $row['username'] . '\">\n                                                                Unpause User\n                                                                </button>\n                                                        </li>\n                                                        <li>\n                                                                <button name=\"edituser\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-blue-700\"\n                                                                value=\"' . urlencode($row['username']) . '\">\n                                                                Edit User\n                                                                </button>\n                                                        </li>\n                                                </ul>\n                                                </div>\n                        </td>\n                </tr>\n                    </form>'\n                        );\n        }\n\n        ## Response\n        $response = array(\n                \"draw\" => $draw,\n                \"aaData\" => $data\n        );\n\n        die(json_encode($response));\n}\n\ndie(\"Request not from datatables, aborted.\");\n","size_bytes":8989},"app/var-fetch.php":{"content":"<?php\ninclude '../includes/misc/autoload.phtml';\n\nset_exception_handler(function ($exception) {\n        error_log(\"\\n--------------------------------------------------------------\\n\");\n        error_log($exception);\n        error_log(\"\\nRequest data:\");\n        error_log(print_r($_POST, true));\n        error_log(\"\\n--------------------------------------------------------------\");\n        http_response_code(500);\n        die(\"Error: \" . $exception->getMessage());\n});\n\nif (session_status() === PHP_SESSION_NONE) {\n        session_start();\n}\n\nif ($_SESSION['role'] == \"Reseller\") {\n        die(\"Resellers can't access this.\");\n}\n\nif (!isset($_SESSION['app'])) {\n        dashboard\\primary\\error(\"Application not selected\");\n        die(\"Application not selected.\");\n}\n\nif (isset($_POST['draw'])) {\n\n        // credits to https://makitweb.com/datatables-ajax-pagination-with-search-and-sort-php/\n\n        $draw = intval($_POST['draw']);\n        $row = intval($_POST['start']);\n        $rowperpage = intval($_POST['length']); // Rows display per page\n        $columnIndex = misc\\etc\\sanitize($_POST['order'][0]['column']); // Column index\n        $columnName = misc\\etc\\sanitize($_POST['columns'][$columnIndex]['data']); // Column name\n        $columnSortOrder = misc\\etc\\sanitize($_POST['order'][0]['dir']); // asc or desc\n        $searchValue = misc\\etc\\sanitize($_POST['search']['value']); // Search value\n\n        // whitelist certain column names and sort orders to prevent SQL injection\n        if (!in_array($columnName, array(\"varid\", \"msg\", \"authed\"))) {\n                die(\"Column name is not whitelisted.\");\n        }\n\n        if (!in_array($columnSortOrder, array(\"desc\", \"asc\"))) {\n                die(\"Column sort order is not whitelisted.\");\n        }\n\n        if (!is_null($searchValue)) {\n                $query = misc\\mysql\\query(\"select * from `vars` WHERE (`varid` like ? or `msg` like ? ) and app = ? order by `\" . $columnName . \"` \" . $columnSortOrder . \" limit \" . $row . \",\" . $rowperpage, [\"%\" . $searchValue . \"%\", \"%\" . $searchValue . \"%\", $_SESSION['app']]);\n        }\n        else {\n                $query = misc\\mysql\\query(\"select * from `vars` WHERE app = ? order by `\" . $columnName . \"` \" . $columnSortOrder . \" limit \" . $row . \",\" . $rowperpage, [$_SESSION['app']]);\n        }\n        \n        $data = array();\n\n        while ($row = mysqli_fetch_assoc($query->result)) {\n                $data[] = array(\n                        \"varid\" => $row[\"varid\"],\n                        \"msg\" => $row[\"msg\"],\n                        \"authed\" => $row[\"authed\"] ? \"True\" : \"False\",\n                        \"actions\" => \n                        '<form method=\"POST\">\n                                <td>\n                                <div x-data=\"{ open: false }\" class=\"z-0\">\n                                <button x-on:click=\"open = true\" class=\"flex items-center border border-gray-700 rounded-lg focus:opacity-60 text-white focus:text-white font-semibold rounded focus:outline-none focus:shadow-inner py-2 px-4\" type=\"button\">\n                                        <span class=\"mr-1\">Actions</span>\n                                        <svg class=\"fill-current h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\"  style=\"margin-top:3px\">\n                                        <path d=\"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z\"/>\n                                        </svg>\n                                </button>\n                                <ul x-show=\"open\" x-on:click.away=\"open = false\" class=\"bg-[#09090d] text-white rounded shadow-lg absolute py-2 mt-1\" style=\"min-width:15rem\">\n                                        <li>\n                                                <button name=\"deletevar\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-red-700\"\n                                                value=\"' . misc\\etc\\sanitize($row[\"varid\"]) . '\">\n                                                Delete Global Variable\n                                                </button>\n                                        </li>\n                                        <li>\n                                                <button name=\"editvar\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-blue-700\"\n                                                value=\"' . misc\\etc\\sanitize($row[\"varid\"]) . '\">\n                                                Edit Global Variable\n                                                </button>\n                                        </li>\n                                        </ul>\n                                        </div>\n                                </td>\n                                </tr>\n                        </form>',\n                );\n        }\n\n        ## Response\n        $response = array(\n                \"draw\" => intval($draw),\n                \"aaData\" => $data\n        );\n\n        die(json_encode($response));\n}\n\ndie(\"Request not from datatables, aborted.\");\n","size_bytes":5068},"auth/GoogleAuthenticator.php":{"content":"<?php\n\n/**\n * PHP Class for handling Google Authenticator 2-factor authentication\n *\n * @author Michael Kliewe\n * @copyright 2019 Michael Kliewe\n * @license http://www.opensource.org/licenses/bsd-license.php BSD License\n * \n */\n\nclass GoogleAuthenticator\n{\n    protected $_codeLength = 6;\n\n    /**\n     * Create new secret.\n     * 40 characters, randomly chosen from the allowed base32 characters.\n     *\n     * @param int $secretLength\n     * @return string\n     */\n    public function createSecret($secretLength = 40)\n    {\n        $validChars = $this->_getBase32LookupTable();\n        unset($validChars[32]);\n\n        $secret = '';\n        for ($i = 0; $i < $secretLength; $i++) {\n            $secret .= $validChars[array_rand($validChars)];\n        }\n        return $secret;\n    }\n\n    /**\n     * Calculate the code, with given secret and point in time\n     *\n     * @param string $secret\n     * @param int|null $timeSlice\n     * @return string\n     */\n    public function getCode($secret, $timeSlice = null)\n    {\n        if ($timeSlice === null) {\n            $timeSlice = floor(time() / 30);\n        }\n\n        $secretkey = $this->_base32Decode($secret);\n\n        // Pack time into binary string\n        $time = chr(0).chr(0).chr(0).chr(0).pack('N*', $timeSlice);\n        // Hash it with users secret key\n        $hm = hash_hmac('SHA1', $time, $secretkey, true);\n        // Use last nipple of result as index/offset\n        $offset = ord(substr($hm, -1)) & 0x0F;\n        // grab 4 bytes of the result\n        $hashpart = substr($hm, $offset, 4);\n\n        // Unpak binary value\n        $value = unpack('N', $hashpart);\n        $value = $value[1];\n        // Only 32 bits\n        $value = $value & 0x7FFFFFFF;\n\n        $modulo = pow(10, $this->_codeLength);\n        return str_pad($value % $modulo, $this->_codeLength, '0', STR_PAD_LEFT);\n    }\n\n    /**\n     * Get QR-Code URL for image, from google charts\n     *\n     * @param string $name\n     * @param string $secret\n     * @param string $title\n     * @return string\n     */\n    public function getQRCodeGoogleUrl($name, $secret, $title = null) {\n        $urlencoded = urlencode('otpauth://totp/'.$name.'?secret='.$secret.'');\n    if(isset($title)) {\n                $urlencoded .= urlencode('&issuer='.urlencode($title));\n        }\n        return 'https://chart.googleapis.com/chart?chs=200x200&chld=M|0&cht=qr&chl='.$urlencoded.'';\n    }\n\n    /**\n     * Check if the code is correct. This will accept codes starting from $discrepancy*30sec ago to $discrepancy*30sec from now\n     *\n     * @param string $secret\n     * @param string $code\n     * @param int $discrepancy This is the allowed time drift in 30 second units (8 means 4 minutes before or after)\n     * @param int|null $currentTimeSlice time slice if we want use other that time()\n     * @return bool\n     */\n    public function verifyCode($secret, $code, $discrepancy = 1, $currentTimeSlice = null)\n    {\n        if ($currentTimeSlice === null) {\n            $currentTimeSlice = floor(time() / 30);\n        }\n\n        for ($i = -$discrepancy; $i <= $discrepancy; $i++) {\n            $calculatedCode = $this->getCode($secret, $currentTimeSlice + $i);\n            if ($calculatedCode == $code ) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    /**\n     * Set the code length, should be >=6\n     *\n     * @param int $length\n     * @return GoogleAuthenticator\n     */\n    public function setCodeLength($length)\n    {\n        $this->_codeLength = $length;\n        return $this;\n    }\n\n    /**\n     * Helper class to decode base32\n     *\n     * @param $secret\n     * @return bool|string\n     */\n    protected function _base32Decode($secret)\n    {\n        if (empty($secret)) return '';\n\n        $base32chars = $this->_getBase32LookupTable();\n        $base32charsFlipped = array_flip($base32chars);\n\n        $paddingCharCount = substr_count($secret, $base32chars[32]);\n        $allowedValues = array(6, 4, 3, 1, 0);\n        if (!in_array($paddingCharCount, $allowedValues)) return false;\n        for ($i = 0; $i < 4; $i++){\n            if ($paddingCharCount == $allowedValues[$i] &&\n                substr($secret, -($allowedValues[$i])) != str_repeat($base32chars[32], $allowedValues[$i])) return false;\n        }\n        $secret = str_replace('=','', $secret);\n        $secret = str_split($secret);\n        $binaryString = \"\";\n        for ($i = 0; $i < count($secret); $i = $i+8) {\n            $x = \"\";\n            if (!in_array($secret[$i], $base32chars)) return false;\n            for ($j = 0; $j < 8; $j++) {\n                $x .= str_pad(base_convert(@$base32charsFlipped[@$secret[$i + $j]], 10, 2), 5, '0', STR_PAD_LEFT);\n            }\n            $eightBits = str_split($x, 8);\n            for ($z = 0; $z < count($eightBits); $z++) {\n                $binaryString .= ( ($y = chr(base_convert($eightBits[$z], 2, 10))) || ord($y) == 48 ) ? $y:\"\";\n            }\n        }\n        return $binaryString;\n    }\n\n    /**\n     * Get array with all 32 characters for decoding from/encoding to base32\n     *\n     * @return array\n     */\n    protected function _getBase32LookupTable()\n    {\n        return array(\n            'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', //  7\n            'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', // 15\n            'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', // 23\n            'Y', 'Z', '2', '3', '4', '5', '6', '7', // 31\n            '='  // padding char\n        );\n    }\n}\n","size_bytes":5448},"includes/VerifyEmail.class.php":{"content":"<?php\n\n/** \n * Class to validate the email address \n * \n * @author CodexWorld.com <contact@codexworld.com> \n * @copyright Copyright (c) 2018, CodexWorld.com\n * @url https://www.codexworld.com\n */ \nclass VerifyEmail { \n\n    protected $stream = false; \n\n    /** \n     * SMTP port number \n     * @var int \n     */ \n    protected $port = 25; \n\n    /** \n     * Email address for request \n     * @var string \n     */ \n    protected $from = 'noreply@keyauth.com'; \n\n    /** \n     * The connection timeout, in seconds. \n     * @var int \n     */ \n    protected $max_connection_timeout = 1; \n\n    /** \n     * Timeout value on stream, in seconds. \n     * @var int \n     */ \n    protected $stream_timeout = 1; \n\n    /** \n     * Wait timeout on stream, in seconds. \n     * * 0 - not wait \n     * @var int \n     */ \n    protected $stream_timeout_wait = 0; \n\n    /** \n     * Whether to throw exceptions for errors. \n     * @type boolean \n     * @access protected \n     */ \n    protected $exceptions = false; \n\n    /** \n     * The number of errors encountered. \n     * @type integer \n     * @access protected \n     */ \n    protected $error_count = 0; \n\n    /** \n     * class debug output mode. \n     * @type boolean \n     */ \n    public $Debug = false; \n\n    /** \n     * How to handle debug output. \n     * Options: \n     * * `echo` Output plain-text as-is, appropriate for CLI \n     * * `html` Output escaped, line breaks converted to `<br>`, appropriate for browser output \n     * * `log` Output to error log as configured in php.ini \n     * @type string \n     */ \n    public $Debugoutput = 'html'; \n\n    /** \n     * SMTP RFC standard line ending. \n     */ \n    const CRLF = \"\\r\\n\"; \n\n    /** \n     * Holds the most recent error message. \n     * @type string \n     */ \n    public $ErrorInfo = ''; \n\n    /** \n     * Constructor. \n     * @param boolean $exceptions Should we throw external exceptions? \n     */ \n    public function __construct($exceptions = false) { \n        $this->exceptions = (boolean) $exceptions; \n    }\n\n    /** \n     * Get array of MX records for host. Sort by weight information. \n     * @param string $hostname The Internet host name. \n     * @return array Array of the MX records found. \n     */ \n    public function getMXrecords($hostname) { \n        $mxhosts = array(); \n        $mxweights = array(); \n        if (getmxrr($hostname, $mxhosts, $mxweights) === FALSE) { \n            $this->set_error('MX records not found or an error occurred'); \n            $this->edebug($this->ErrorInfo); \n        } else { \n            array_multisort($mxweights, $mxhosts); \n        } \n        /** \n         * Add A-record as last chance (e.g. if no MX record is there). \n         * Thanks Nicht Lieb. \n         * @link http://www.faqs.org/rfcs/rfc2821.html RFC 2821 - Simple Mail Transfer Protocol \n         */ \n        if (empty($mxhosts)) { \n            $mxhosts[] = $hostname; \n        } \n        return $mxhosts; \n    } \n\n    /** \n     * Parses input string to array(0=>user, 1=>domain) \n     * @param string $email \n     * @param boolean $only_domain \n     * @return string|array \n     * @access private \n     */ \n    public static function parse_email($email, $only_domain = TRUE) { \n        sscanf($email, \"%[^@]@%s\", $user, $domain); \n        return ($only_domain) ? $domain : array($user, $domain); \n    } \n\n    /** \n     * Add an error message to the error container. \n     * @access protected \n     * @param string $msg \n     * @return void \n     */ \n    protected function set_error($msg) { \n        $this->error_count++; \n        $this->ErrorInfo = $msg; \n    } \n\n    /** \n     * Check if an error occurred. \n     * @access public \n     * @return boolean True if an error did occur. \n     */ \n    public function isError() { \n        return ($this->error_count > 0); \n    } \n\n    /** \n     * Output debugging info \n     * Only generates output if debug output is enabled \n     * @see verifyEmail::$Debugoutput \n     * @see verifyEmail::$Debug \n     * @param string $str \n     */ \n    protected function edebug($str) { \n        if (!$this->Debug) { \n            return; \n        } \n        switch ($this->Debugoutput) { \n            case 'log': \n                //Don't output, just log \n                error_log($str); \n                break; \n            case 'html': \n                //Cleans up output a bit for a better looking, HTML-safe output \n                echo htmlentities( \n                        preg_replace('/[\\r\\n]+/', '', $str), ENT_QUOTES, 'UTF-8' \n                ) \n                . \"<br>\\n\"; \n                break; \n            case 'echo': \n            default: \n                //Normalize line breaks \n                $str = preg_replace('/(\\r\\n|\\r|\\n)/ms', \"\\n\", $str); \n                echo gmdate('Y-m-d H:i:s') . \"\\t\" . str_replace( \n                        \"\\n\", \"\\n \\t \", trim($str) \n                ) . \"\\n\"; \n        } \n    } \n\n    /** \n     * Validate email\n     * @param string $email Email address \n     * @return boolean True if the valid email also exist \n     */ \n    public function check($email) { \n        $result = FALSE; \n\n        $this->error_count = 0; // Reset errors \n        $this->stream = FALSE; \n\n        $mxs = $this->getMXrecords(self::parse_email($email)); \n        $timeout = ceil($this->max_connection_timeout / count($mxs));\n        $i = 0;\n        foreach ($mxs as $host) {\n            $i++;\n            if($i == 1) { // only check first MX record\n                /** \n                * suppress error output from stream socket client... \n                * Thanks Michael. \n                */ \n                $this->stream = @stream_socket_client(\"tcp://\" . $host . \":\" . $this->port, $errno, $errstr, $timeout); \n                if ($this->stream === FALSE) { \n                    if ($errno == 0) { \n                        $this->set_error(\"Problem initializing the socket\"); \n                        $this->edebug($this->ErrorInfo); \n                        if ($this->exceptions) { \n                            throw new verifyEmailException($this->ErrorInfo); \n                        } \n                        return FALSE; \n                    } else { \n                        $this->edebug($host . \":\" . $errstr); \n                    } \n                } else { \n                    stream_set_timeout($this->stream, $this->stream_timeout); \n                    stream_set_blocking($this->stream, 1); \n    \n                    if ($this->_streamCode($this->_streamResponse()) == '220') { \n                        $this->edebug(\"Connection success {$host}\"); \n                        break; \n                    } else { \n                        fclose($this->stream); \n                        $this->stream = FALSE; \n                    } \n                }\n            }\n        } \n\n        if ($this->stream === FALSE) { \n            $this->set_error(\"All connection fails\"); \n            $this->edebug($this->ErrorInfo); \n            if ($this->exceptions) { \n                throw new verifyEmailException($this->ErrorInfo); \n            } \n            return FALSE; \n        } \n\n        $this->_streamQuery(\"HELO \" . self::parse_email($this->from)); \n        $this->_streamResponse(); \n        $this->_streamQuery(\"MAIL FROM: <{$this->from}>\"); \n        $this->_streamResponse(); \n        $this->_streamQuery(\"RCPT TO: <{$email}>\"); \n        $resp = $this->_streamResponse();\n        $code = $this->_streamCode($resp); \n        if (strpos($resp, \"Client host rejected\") !== false) {\n            $this->edebug(\"The email server doesn't like us :(\");\n            return TRUE;\n            // server is blocking our server. AWS is far less likely to have these issues, so allow it\n        }\n        if (strpos($resp, \"Protocol error\") !== false) {\n            $this->edebug(\"Allowing exception for protonmail\");\n            return TRUE;\n            // protonmail returning this\n        }\n        \n        //$this->_streamResponse(); \n        $this->_streamQuery(\"RSET\"); \n        //$this->_streamResponse();\n        $this->_streamQuery(\"QUIT\"); \n        fclose($this->stream); \n       \n        switch ($code) { \n            case '250': \n            /** \n             * http://www.ietf.org/rfc/rfc0821.txt \n             * 250 Requested mail action okay, completed \n             * email address was accepted \n             */\n                return TRUE;\n            case '450': \n                return FALSE;\n            case '451': \n                return FALSE;\n            case '452': \n                /** \n                 * http://www.ietf.org/rfc/rfc0821.txt \n                 * 450 Requested action not taken: the remote mail server \n                 * does not want to accept mail from your server for \n                 * some reason (IP address, blacklisting, etc..) \n                 * Thanks Nicht Lieb. \n                 * 451 Requested action aborted: local error in processing \n                 * 452 Requested action not taken: insufficient system storage \n                 * email address was greylisted (or some temporary error occured on the MTA) \n                 * i believe that e-mail exists \n                 */ \n                return FALSE;\n            case '550':\n                return FALSE; \n            default : \n                return FALSE; \n        } \n    } \n\n    /** \n     * writes the contents of string to the file stream pointed to by handle \n     * If an error occurs, returns FALSE. \n     * @access protected \n     * @param string $string The string that is to be written \n     * @return string Returns a result code, as an integer. \n     */ \n    protected function _streamQuery($query) { \n        $this->edebug($query); \n        return stream_socket_sendto($this->stream, $query . self::CRLF); \n    } \n\n    /** \n     * Reads all the line long the answer and analyze it. \n     * If an error occurs, returns FALSE \n     * @access protected \n     * @return string Response \n     */ \n    protected function _streamResponse($timed = 0) { \n        $reply = stream_get_line($this->stream, 1); \n        $status = stream_get_meta_data($this->stream); \n\n        if (!empty($status['timed_out'])) { \n            $this->edebug(\"Timed out while waiting for data! (timeout {$this->stream_timeout} seconds)\"); \n        } \n\n        if ($reply === FALSE && $status['timed_out'] && $timed < $this->stream_timeout_wait) { \n            return $this->_streamResponse($timed + $this->stream_timeout); \n        } \n\n\n        if ($reply !== FALSE && $status['unread_bytes'] > 0) { \n            $reply .= stream_get_line($this->stream, $status['unread_bytes'], self::CRLF); \n        } \n        $this->edebug($reply); \n        return $reply; \n    } \n\n    /** \n     * Get Response code from Response \n     * @param string $str \n     * @return string \n     */ \n    protected function _streamCode($str) { \n        preg_match('/^(?<code>[0-9]{3})(\\s|-)(.*)$/ims', $str, $matches); \n        $code = isset($matches['code']) ? $matches['code'] : false; \n        return $code; \n    } \n\n} \n\n/** \n * verifyEmail exception handler \n */ \nclass verifyEmailException extends Exception { \n\n    /** \n     * Prettify error message output \n     * @return string \n     */ \n    public function errorMessage() {\n        $errorMsg = $this->getMessage(); \n        return $errorMsg; \n    } \n\n}\n\n$mail = new VerifyEmail();\n\n?>","size_bytes":11303},"includes/credentials.example.php":{"content":"<?php\n/*\nAll sensitive credentials stored here.\n\nNOTE: change this file name from credentials.example.php to credentials.php\n*/\n\nerror_reporting(0);\n\n$databaseHost = \"localhost\";\n$databaseUsername = \"root\";\n$databasePassword = \"\";\n$databaseName = \"main\";\n\n$mysqlRequireSSL = false; // in case the MySQL server requires SSL\n\n\n$logwebhook = \"\"; // discord webhook which receives login logs and keys created\n\n$adminwebhook = \"\"; // discord webhook which receives admin actions\n\n$redisServers = []; // URLs to purge redis keys from each server (used on live KeyAuth website only)\n\n$redisPass = \"\";\n\n$keyauthStatsToken = \"\"; // discord bot token for KeyAuth Stats\n\n$webhookun = \"KeyAuth Logs\"; // webhook username\n\n$adminwebhookun = \"KeyAuth Admin Logs\"; // admin webhook's username\n\n$awsAccessKey = \"\"; // used for AWS SES to send emails\n\n$awsSecretKey = \"\"; // used for AWS SES to send emails\n","size_bytes":890},"login/index.php":{"content":"<?php\nrequire '../includes/misc/autoload.phtml';\nrequire '../includes/dashboard/autoload.phtml';\nrequire '../includes/api/shared/autoload.phtml';\n\nob_start();\n\nif (session_status() === PHP_SESSION_NONE) {\n    session_start();\n}\n\nif (isset($_SESSION['username'])) {\n    header(\"Location: ../app/\");\n    exit();\n}\n\nset_exception_handler(function ($exception) {\n    error_log(\"\\n--------------------------------------------------------------\\n\");\n    error_log($exception);\n    error_log(\"\\nRequest data:\");\n    error_log(print_r($_POST, true));\n    error_log(\"\\n--------------------------------------------------------------\");\n    http_response_code(500);\n    \\dashboard\\primary\\error($exception->getMessage());\n});\n\n$istwofa = $_SESSION[\"temp_istwofamode\"] ? true : false;\n\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\" class=\"bg-[#09090d] text-white overflow-x-hidden\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n\n    <meta name=\"title\" content=\"GenZ Auth - Open Source Auth\">\n\n    <meta content=\"Secure your software against piracy, an issue causing $422 million in losses annually - Fair pricing & Features not seen in competitors\" name=\"description\" />\n    <meta content=\"GenZ Auth\" name=\"author\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <meta name=\"keywords\" content=\"GenZ Auth, Cloud Authentication, Key Authentication,Authentication, API authentication,Security, Encryption authentication, Authenticated encryption, Cybersecurity, Developer, SaaS, Software Licensing, Licensing\" />\n    <meta property=\"og:description\" content=\"Secure your software against piracy, an issue causing $422 million in losses annually - Fair pricing & Features not seen in competitors\" />\n    <meta property=\"og:image\" content=\"https://cdn.keyauth.cc/front/assets/img/favicon.png\" />\n    <meta property=\"og:site_name\" content=\"GenZ Auth | Secure your software from piracy.\" />\n    <link rel=\"shortcut icon\" type=\"image/jpg\" href=\"https://cdn.keyauth.cc/front/assets/img/favicon.png\">\n\n    <!-- Schema.org markup for Google+ -->\n    <meta itemprop=\"name\" content=\"GenZ Auth - Open Source Auth\">\n    <meta itemprop=\"description\" content=\"Secure your software against piracy, an issue causing $422 million in losses annually - Fair pricing & Features not seen in competitors\">\n    <meta itemprop=\"image\" content=\"https://cdn.keyauth.cc/front/assets/img/favicon.png\">\n\n    <!-- Twitter Card data -->\n    <meta name=\"twitter:card\" content=\"product\">\n    <meta name=\"twitter:site\" content=\"@keyauth\">\n    <meta name=\"twitter:title\" content=\"GenZ Auth - Open Source Auth\">\n\n    <meta name=\"twitter:description\" content=\"Secure your software against piracy, an issue causing $422 million in losses annually - Fair pricing & Features not seen in competitors\">\n    <meta name=\"twitter:creator\" content=\"@keyauth\">\n    <meta name=\"twitter:image\" content=\"https://cdn.keyauth.cc/front/assets/img/favicon.png\">\n\n    <!-- Open Graph data -->\n    <meta property=\"og:title\" content=\"GenZ Auth - Open Source Auth\" />\n    <meta property=\"og:type\" content=\"website\" />\n    <meta property=\"og:url\" content=\"./\" />\n\n    <title>GenZ Auth - Login</title>\n\n    <!-- Canonical SEO -->\n    <link rel=\"canonical\" href=\"https://keyauth.cc\" />\n\n    <link rel=\"stylesheet\" href=\"https://cdn.keyauth.cc/v3/scripts/animate.min.css\" />\n    <link rel=\"stylesheet\" href=\"https://cdn.keyauth.cc/v3/dist/output.css\">\n\n</head>\n\n<body>\n    <header>\n        <nav class=\"border-gray-200 px-4 lg:px-6 py-2.5 mb-14\">\n            <div class=\"flex flex-wrap justify-between items-center mx-auto max-w-screen-xl\">\n                <a href=\"../\" class=\"flex items-center\">\n                    <span class=\"text-2xl font-bold text-white\">GenZ Auth</span>\n                </a>\n                <div class=\"flex items-center lg:order-2\">\n                    <a href=\"../login\" class=\"text-white focus:ring-0 font-medium rounded-lg text-sm px-4 py-2 lg:px-5 lg:py-2.5 mr-2 hover:opacity-60 transition duration-200 focus:outline-none focus:ring-gray-800\">\n                        Client Area\n                    </a>\n                    <a href=\"../register\" class=\"text-white focus:ring-0 font-medium rounded-lg text-sm px-4 py-2 lg:px-5 lg:py-2.5 mr-2 bg-blue-600 hover:opacity-80 focus:outline-none focus:ring-blue-800 transition duration-200\">\n                        Onboard Now\n                    </a>\n                    <button data-collapse-toggle=\"mmenu\" type=\"button\" class=\"inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200  \" aria-controls=\"mmenu\" aria-expanded=\"false\">\n                        <span class=\"sr-only\">Open main menu</span>\n                        <svg class=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\">\n                            <path fill-rule=\"evenodd\" d=\"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z\" clip-rule=\"evenodd\"></path>\n                        </svg>\n                        <svg class=\"hidden w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\">\n                            <path fill-rule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clip-rule=\"evenodd\"></path>\n                        </svg>\n                    </button>\n                </div>\n                <div class=\"hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1\" id=\"mmenu\">\n                    <ul class=\"flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0\">\n                        <li>\n                            <a href=\"../\" class=\"block py-2 pr-4 pl-3 border-b lg:hover:bg-transparent lg:border-0 lg:p-0 text-gray-400 hover:bg-gray-700 hover:text-white lg:hover:bg-transparent border-gray-700 transition duration-200\" aria-current=\"page\">Home</a>\n                        </li>\n                        <li>\n                            <a href=\"../#features\" class=\"block py-2 pr-4 pl-3 border-b lg:hover:bg-transparent lg:border-0 lg:p-0 text-gray-400 hover:bg-gray-700 hover:text-white lg:hover:bg-transparent border-gray-700 transition duration-200\">Features</a>\n                        </li>\n                        <li>\n                            <a href=\"../#plans\" class=\"block py-2 pr-4 pl-3 border-b lg:hover:bg-transparent lg:border-0 lg:p-0 text-gray-400 hover:bg-gray-700 hover:text-white lg:hover:bg-transparent border-gray-700 transition duration-200\">\n                                Plans\n                            </a>\n                        </li>\n                        <li>\n                            <a href=\"../#team\" class=\"block py-2 pr-4 pl-3 border-b lg:hover:bg-transparent lg:border-0 lg:p-0 text-gray-400 hover:bg-gray-700 hover:text-white lg:hover:bg-transparent border-gray-700 transition duration-200\">\n                                Our Team\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </nav>\n    </header>\n\n    <section>\n        <div class=\"relative z-10 flex flex-wrap md:-m-8 ml-8 md:ml-24\">\n            <div class=\"w-full md:w-1/2 md:p-8\">\n                <div class=\"md:max-w-lg md:mx-auto md:pt-36\">\n                    <h2 class=\"mb-7 md:mb-12 text-3xl md:text-6xl font-bold font-heading tracking-px-n leading-tight text-center\">\n                        Welcome back to <span class=\"text-transparent bg-clip-text bg-gradient-to-r to-blue-600 from-sky-400 inline-block\">GenZ Auth</span>\n                        👋\n                    </h2>\n\n                    <h3 class=\"mb-9 text-sm md:text-xl font-bold font-heading leading-normal\">\n                        The best authentication platform for your software.\n                    </h3>\n                </div>\n            </div>\n            <div class=\"w-full md:w-1/2 md:p-8 -ml-4 md:-ml-12\">\n                <div class=\"p-2 md:p-4 py-16 flex flex-col justify-center h-full\">\n                    <form class=\"md:max-w-md md:ml-32 space-y-4 md:space-y-6\" method=\"post\" data-postform=\"1\">\n                        <?php\n\n                        if ($istwofa) {\n                        ?>\n                            <script>\n                                let username = \"<?= $_SESSION[\"temp_username\"]; ?>\"\n                                let password = \"<?= $_SESSION[\"temp_password\"]; ?>\"\n                            </script>\n\n                            <input type=\"hidden\" id=\"username\" name=\"username\" value=\"${username}\">\n                            <input type=\"hidden\" id=\"password\" name=\"password\" value=\"${password}\">\n\n                            <script>\n                                document.getElementById(\"username\").value = username;\n                                document.getElementById(\"password\").value = password;\n                            </script>\n\n                            <div class=\"relative mb-4\" data-twofactor=\"1\">\n                                <input type=\"text\" id=\"keyauthtwofactor\" name=\"keyauthtwofactor\" class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-border-gray-300 appearance-none focus:ring-0  peer\" placeholder=\" \" autocomplete=\"on\">\n                                <label for=\"keyauthtwofactor\" class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#09090d] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">2FA\n                                    <span class=\"text-xs\">(Two Factor Authentication)</span></label>\n                            </div>\n\n                            <button name=\"login\" data-loginbutton=\"1\" class=\"text-white border-2 hover:bg-white hover:text-black focus:ring-0 focus:outline-none transition duration-200 font-medium rounded-lg text-sm px-5 py-2.5 text-center items-center mb-3 w-full mt-10\">\n                                <span class=\"inline-flex\">\n                                    Submit 2FA Code\n                                    <svg class=\"w-3.5 h-3.5 ml-2 mt-1\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 14 10\">\n                                        <path stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M1 5h12m0 0L9 1m4 4L9 9\"></path>\n                                    </svg></span>\n                            </button>\n\n                        <?php\n                        } else {\n                        ?>\n                            <div class=\"relative mb-4\" data-username=\"1\">\n                                <input type=\"text\" id=\"username\" name=\"username\" class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-border-gray-300 appearance-none focus:ring-0  peer\" placeholder=\" \" autocomplete=\"on\" required=\"\">\n                                <label for=\"username\" class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#09090d] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Username</label>\n                            </div>\n\n                            <div class=\"relative mb-4\" data-password=\"1\">\n                                <input type=\"password\" id=\"password\" name=\"password\" class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-border-gray-300 appearance-none focus:ring-0  peer\" placeholder=\" \" autocomplete=\"on\" required=\"\">\n                                <label for=\"password\" class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#09090d] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Password</label>\n                            </div>\n\n                            <div class=\"relative mb-4\" data-twofactor=\"1\">\n                                <input type=\"text\" id=\"keyauthtwofactor\" name=\"keyauthtwofactor\" class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-border-gray-300 appearance-none focus:ring-0  peer\" placeholder=\" \" autocomplete=\"on\">\n                                <label for=\"keyauthtwofactor\" class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#09090d] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">2FA\n                                    <span class=\"text-xs\">(Two Factor Authentication)</span></label>\n                            </div>\n\n                            <button name=\"login\" data-loginbutton=\"1\" class=\"text-white border-2 hover:bg-white hover:text-black focus:ring-0 focus:outline-none transition duration-200 font-medium rounded-lg text-sm px-5 py-2.5 text-center items-center mb-3 w-full mt-10\">\n                                <span class=\"inline-flex\">\n                                    Login Now\n                                    <svg class=\"w-3.5 h-3.5 ml-2 mt-1\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 14 10\">\n                                        <path stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M1 5h12m0 0L9 1m4 4L9 9\"></path>\n                                    </svg></span>\n                            </button>\n\n                            <div class=\"text-sm font-medium text-white mb-4\">\n                                Forgot your password? <a href=\"../forgot/\" class=\"hover:underline text-blue-500\">Reset\n                                    It</a> Now!\n                            </div>\n\n                            <div class=\"text-sm font-medium text-white\">\n                                Need an Account? <a href=\"../register/\" class=\"hover:underline text-blue-500\">Register</a>\n                            </div>\n\n                            <?php\n                            require_once __DIR__ . '/../auth/google-config.php';\n                            $googleAuthUrl = getGoogleAuthUrl();\n                            if ($googleAuthUrl):\n                            ?>\n                            <div class=\"relative flex items-center my-4\">\n                                <div class=\"flex-grow border-t border-gray-700\"></div>\n                                <span class=\"flex-shrink mx-4 text-gray-400 text-xs\">Or</span>\n                                <div class=\"flex-grow border-t border-gray-700\"></div>\n                            </div>\n                            <a href=\"<?= htmlspecialchars($googleAuthUrl); ?>\" class=\"flex items-center justify-center gap-2 text-gray-800 bg-white hover:opacity-90 font-medium rounded-lg text-sm px-5 py-2.5 w-full border border-gray-300 transition duration-200\">\n                                <svg class=\"w-5 h-5\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                                    <path d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\" fill=\"#4285F4\"/>\n                                    <path d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\" fill=\"#34A853\"/>\n                                    <path d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\" fill=\"#FBBC05\"/>\n                                    <path d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\" fill=\"#EA4335\"/>\n                                </svg>\n                                Continue with Google\n                            </a>\n                            <?php endif; ?>\n                        <?php\n                        }\n\n                        ?>\n                    </form>\n                </div>\n            </div>\n        </div>\n    </section>\n\n    <footer class=\"mt-32\">\n        <div class=\"p-4 py-6 mx-auto max-w-screen-xl md:p-8 lg:-10 pt-32 md:pt-0\">\n            <div class=\"grid grid-cols-2 gap-8 lg:grid-cols-6\">\n                <div class=\"col-span-2\">\n                    <a href=\"../\" class=\"flex items-center mb-2 text-2xl font-semibold text-white lg:mb-0\">\n                        GenZ Auth LLC\n                    </a>\n                    <p class=\"my-4 font-light text-gray-400\">\n                        GenZ Auth is a game-changing, affordable and easy to use licensing solution for your software.\n                    </p>\n                    <ul class=\"flex mt-5 space-x-6\">\n                        <li>\n                            <a target=\"_blank\" href=\"https://youtube.com/keyauth\" class=\"hover:text-white text-gray-400\">\n                                <svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                                    <path d=\"M21.593 7.203a2.506 2.506 0 0 0-1.762-1.766c-1.566-.43-7.83-.437-7.83-.437s-6.265-.007-7.832.404a2.56 2.56 0 0 0-1.766 1.778c-.413 1.566-.417 4.814-.417 4.814s-.004 3.264.406 4.814c.23.857.905 1.534 1.763 1.765 1.582.43 7.83.437 7.83.437s6.265.007 7.831-.403a2.515 2.515 0 0 0 1.767-1.763c.414-1.565.417-4.812.417-4.812s.02-3.265-.407-4.831ZM9.996 15.005l.005-6 5.207 3.005-5.212 2.995Z\">\n                                    </path>\n                                </svg>\n                            </a>\n                        </li>\n                        <li>\n                            <a target=\"_blank\" href=\"https://github.com/KeyAuth/\" class=\"hover:text-white text-gray-400\">\n                                <svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                                    <path fill-rule=\"evenodd\" d=\"M12.026 2a9.973 9.973 0 0 0-9.974 9.974c0 4.406 2.857 8.145 6.82 9.465.5.09.68-.217.68-.481 0-.237-.008-.865-.011-1.696-2.775.602-3.361-1.338-3.361-1.338-.452-1.152-1.107-1.459-1.107-1.459-.905-.619.069-.605.069-.605 1.002.07 1.527 1.028 1.527 1.028.89 1.524 2.336 1.084 2.902.829.09-.645.35-1.085.635-1.334-2.214-.251-4.542-1.107-4.542-4.93 0-1.087.389-1.979 1.024-2.675-.101-.253-.446-1.268.099-2.64 0 0 .837-.269 2.742 1.021a9.582 9.582 0 0 1 2.496-.336 9.555 9.555 0 0 1 2.496.336c1.906-1.291 2.742-1.021 2.742-1.021.545 1.372.203 2.387.099 2.64.64.696 1.024 1.587 1.024 2.675 0 3.833-2.33 4.675-4.552 4.922.355.308.675.916.675 1.846 0 1.334-.012 2.41-.012 2.737 0 .267.178.577.687.479C19.146 20.115 22 16.379 22 11.974 22 6.465 17.535 2 12.026 2Z\" clip-rule=\"evenodd\"></path>\n                                </svg>\n                            </a>\n                        </li>\n                        <li>\n                            <a target=\"_blank\" href=\"https://twitter.com/KeyAuth\" class=\"hover:text-white text-gray-400\">\n                                <svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                                    <path d=\"M19.633 7.994c.013.175.013.349.013.523 0 5.325-4.053 11.46-11.46 11.46A11.38 11.38 0 0 1 2 18.169c.324.037.636.05.973.05a8.07 8.07 0 0 0 5.001-1.721 4.036 4.036 0 0 1-3.767-2.793c.249.037.499.062.761.062.361 0 .724-.05 1.061-.137a4.027 4.027 0 0 1-3.23-3.953v-.05a4.05 4.05 0 0 0 1.82.51 4.022 4.022 0 0 1-1.796-3.353c0-.748.199-1.434.548-2.032a11.457 11.457 0 0 0 8.306 4.215c-.062-.3-.1-.611-.1-.923a4.024 4.024 0 0 1 4.028-4.028c1.16 0 2.207.486 2.943 1.272a7.957 7.957 0 0 0 2.556-.973c-.3.93-.93 1.72-1.771 2.22a8.074 8.074 0 0 0 2.319-.624 8.646 8.646 0 0 1-2.019 2.083Z\">\n                                    </path>\n                                </svg>\n                            </a>\n                        </li>\n                        <li>\n                            <a target=\"_blank\" href=\"#\" class=\"hover:text-white text-gray-400\">\n                                <svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                                    <path d=\"M11.999 7.375a4.624 4.624 0 1 0 0 9.248 4.624 4.624 0 0 0 0-9.248Zm0 7.627a3.004 3.004 0 1 1 0-6.008 3.004 3.004 0 0 1 0 6.008Z\">\n                                    </path>\n                                    <path d=\"M16.805 8.289a1.078 1.078 0 1 0 0-2.156 1.078 1.078 0 0 0 0 2.156Z\"></path>\n                                    <path d=\"M20.533 6.114A4.605 4.605 0 0 0 17.9 3.482a6.607 6.607 0 0 0-2.186-.42c-.963-.042-1.268-.054-3.71-.054s-2.755 0-3.71.054a6.554 6.554 0 0 0-2.184.42 4.6 4.6 0 0 0-2.633 2.632A6.585 6.585 0 0 0 3.058 8.3c-.043.962-.056 1.267-.056 3.71 0 2.442 0 2.753.056 3.71.015.748.156 1.486.419 2.187a4.61 4.61 0 0 0 2.634 2.632 6.583 6.583 0 0 0 2.185.45c.963.042 1.268.055 3.71.055s2.755 0 3.71-.055a6.616 6.616 0 0 0 2.186-.42 4.613 4.613 0 0 0 2.633-2.632c.263-.7.404-1.438.419-2.186.043-.962.056-1.267.056-3.71s0-2.753-.056-3.71a6.583 6.583 0 0 0-.421-2.217Zm-1.218 9.532a5.046 5.046 0 0 1-.311 1.688 2.987 2.987 0 0 1-1.712 1.71c-.535.2-1.1.305-1.67.312-.95.044-1.218.055-3.654.055-2.438 0-2.687 0-3.655-.055a4.961 4.961 0 0 1-1.67-.311 2.985 2.985 0 0 1-1.718-1.711 5.08 5.08 0 0 1-.311-1.67c-.043-.95-.053-1.217-.053-3.653 0-2.437 0-2.686.053-3.655a5.038 5.038 0 0 1 .311-1.687c.305-.79.93-1.41 1.719-1.712a5.01 5.01 0 0 1 1.669-.311c.95-.043 1.218-.055 3.655-.055s2.687 0 3.654.055a4.96 4.96 0 0 1 1.67.31 2.99 2.99 0 0 1 1.712 1.713 5.06 5.06 0 0 1 .311 1.669c.043.95.054 1.218.054 3.655 0 2.436 0 2.698-.043 3.654h-.011v-.001Z\">\n                                    </path>\n                                </svg>\n                            </a>\n                        </li>\n                        <li>\n                            <a target=\"_blank\" href=\"https://www.tiktok.com/@keyauth\" class=\"hover:text-white text-gray-400\">\n                                <svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                                    <path d=\"M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64c.298-.002.595.042.88.13V9.4A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1h-.04Z\">\n                                    </path>\n                                </svg>\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n                <div class=\"lg:mx-auto\">\n                    <h3 class=\"mb-6 text-sm font-semibold uppercase text-white\">Links</h3>\n                    <ul class=\"text-gray-500 \">\n                        <li class=\"mb-4\">\n                            <a href=\"https://www.youtube.com/keyauth\" target=\"_blank\" class=\"hover:underline\">Youtube</a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a href=\"https://linkedin.com\" target=\"_blank\" class=\"hover:underline\">Linkedin</a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a href=\"https://github.com/keyauth\" target=\"_blank\" class=\"hover:underline\">GitHub</a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a href=\"https://keyauth.readme.io\" target=\"_blank\" class=\"hover:underline\">Documentation</a>\n                        </li>\n                    </ul>\n                </div>\n                <div class=\"lg:mx-auto\">\n                    <h2 class=\"mb-6 text-sm font-semibold uppercase text-white\">\n                        Most Used Examples\n                    </h2>\n                    <ul class=\"text-gray-500 \">\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"https://github.com/KeyAuth/GenZ Auth-CPP-Example\" class=\"hover:underline\">\n                                C++ <span class=\"text-xs\">(CPP)</span>\n                            </a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"https://github.com/KeyAuth/GenZ Auth-CSHARP-Example\" class=\"hover:underline\">C# <span class=\"text-xs\">(CSharp)</span></a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"https://github.com/mazkdevf/KeyAuth-JS-Example\" class=\"hover:underline\">JavaScript <span class=\"text-xs\">(JS)</span></a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"https://github.com/KeyAuth/GenZ Auth-Python-Example\" class=\"hover:underline\">Python <span class=\"text-xs\">(PY)</span></a>\n                        </li>\n                    </ul>\n                </div>\n                <div class=\"lg:mx-auto\">\n                    <h2 class=\"mb-6 text-sm font-semibold uppercase text-white\">Other & Support</h2>\n                    <ul class=\"text-gray-500 \">\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"https://keyauth.tawk.help\" class=\"hover:underline\">\n                                Support Center\n                            </a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"../free-trial/\" class=\"hover:underline\">\n                                Demo Accounts\n                            </a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"https://t.me/keyauth\" class=\"hover:underline\">\n                                Telegram\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n                <div class=\"lg:mx-auto\">\n                    <h2 class=\"mb-6 text-sm font-semibold uppercase text-white\">Legal</h2>\n                    <ul class=\"text-gray-500 \">\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"../terms\" class=\"hover:underline\">Terms of Service</a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"../terms#privacy\" class=\"hover:underline\">Privacy Policy</a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"https://github.com/KeyAuth/GenZ Auth-Source-Code/blob/main/LICENSE\" class=\"hover:underline\">Licensing</a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"../gdpr\" class=\"hover:underline\">GDPR</a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n            <hr class=\"my-6 border-[#0f0f17] sm:mx-auto lg:my-8\">\n\n            <span class=\"block mb-6 text-sm text-gray-400 lg:mb-0 text-center\">© 2020 - 2023 <a href=\"../\" class=\"hover:underline\">GenZ Auth LLC</a>. All Rights Reserved.\n            </span>\n        </div>\n    </footer>\n\n    <!-- jqeury -->\n    <script src=\"https://cdn.keyauth.cc/v3/scripts/jquery.min.js\"></script>\n\n    <!--Flowbite JS-->\n    <script src=\"https://cdn.keyauth.cc/v3/dist/flowbite.js\"></script>\n\n\n    <?php\n    if (isset($_POST['login'])) {\n        $username = misc\\etc\\sanitize($_POST['username']);\n        $password = misc\\etc\\sanitize($_POST['password']);\n\n        $query = misc\\mysql\\query(\"SELECT * FROM `accounts` WHERE `username` = ?\", [$username]);\n\n        if ($query->num_rows < 1) {\n            dashboard\\primary\\error(\"Account doesn't exist!\");\n            return;\n        }\n        while ($row = mysqli_fetch_array($query->result)) {\n            $user = $row['username'];\n            $pass = $row['password'];\n            $id = $row['ownerid'];\n            $email = $row['email'];\n            $role = $row['role'];\n            $app = misc\\etc\\sanitize($row['app']);\n            $banned = $row['banned'];\n            $locked = $row['locked'];\n            $img = $row['img'];\n\n            $owner = misc\\etc\\sanitize($row['owner']);\n            $twofactor_optional = $row['twofactor'];\n            $acclogs = $row['acclogs'];\n            $google_Code = $row['googleAuthCode'];\n\n            $regionSaved = $row['region'];\n            $asNumSaved = $row['asNum'];\n            $emailVerify = $row['emailVerify'];\n            $securityKey = $row['securityKey'];\n        }\n\n        if (!is_null($banned)) {\n            dashboard\\primary\\error(\"Banned: Reason: \" . misc\\etc\\sanitize($banned));\n            return;\n        }\n\n        if (!password_verify($password, $pass)) {\n            dashboard\\primary\\error(\"Password is invalid!\");\n            return;\n        }\n        \n        if ($locked) {\n            header(\"location: ./accShare/\");\n            die();\n        }\n        \n        if (misc\\etc\\isBreached($password)) {\n            dashboard\\primary\\wh_log($logwebhook, \"{$username} attempted to login with leaked password `{$password}`\", $webhookun);\n            dashboard\\primary\\error(\"Password has been leaked in a data breach (not from us)! You must click Forgot Password and change password.\");\n            return;\n        }\n        \n        $ip = api\\shared\\primary\\getIp();\n        \n        /*\n        * Email verification\n        * For paid customers, checks if ISP and region (aka state) match. If not, they must verify it's them via an email.\n        * Customers can opt to disable email verification.\n        * This code is also used to notify the GenZ Auth owner of account sharing, since that's against our ToS.\n        */\n        if (in_array($role, array(\"developer\", \"seller\")) && $username != \"demoseller\" && $username != \"demodeveloper\" && !empty($awsAccessKey)) {\n            $url = \"http://ip-api.com/json/{$ip}?fields=16910340\"; // returns fields: region,as,proxy,hosting\n\n            $curl = curl_init($url);\n            curl_setopt($curl, CURLOPT_URL, $url);\n            curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);\n\n            $resp = curl_exec($curl);\n            $httpcode = curl_getinfo($curl, CURLINFO_HTTP_CODE);\n            \n            if($httpcode == 429) {\n                dashboard\\primary\\wh_log($logwebhook, \"<@1138519014734319706> IP checking is rate limited\", $webhookun);\n                dashboard\\primary\\error(\"Login location is rate-limited! Please try again in a minute or so.\");\n                return;\n            }\n            else {\n                $json = json_decode($resp, true);\n                $region = $json[\"region\"];\n                $asNum = explode(\" \", $json[\"as\"])[0];\n                if (!is_null($asNumSaved)) {\n                    if ($asNum != $asNumSaved || $region != $regionSaved) {\n                        // if user not using VPN and IP location changed, notify GenZ Auth owner of account sharing\n                        if(!$json->proxy && !$json->hosting && $region != $regionSaved) {\n                            dashboard\\primary\\wh_log($logwebhook, \"user `{$username}` detected account sharing **IP Address:** `{$ip}` **Old AS:** {$asNumSaved} **New AS:** {$asNum} **Old Region:** {$regionSaved} **New Region:** {$region}\", $webhookun);\n                            if(!$emailVerify) {\n                                misc\\mysql\\query(\"UPDATE `accounts` SET `region` = ?,`asNum` = ?,`lastip` = ? WHERE `username` = ?\",[$region, $asNum, $ip, $username]);\n                            }\n                        }\n                        \n                        if($emailVerify) { // only require email verification if enabled.\n                            if ($twofactor_optional) {\n                                // 2FA verification on new login location\n                                $twofactor = misc\\etc\\sanitize($_POST['keyauthtwofactor']);\n                                if (empty($twofactor)) {\n                                    dashboard\\primary\\error(\"Please enter 2FA code!\");\n                                    return;\n                                }\n        \n                                require_once '../auth/GoogleAuthenticator.php';\n                                $gauth = new GoogleAuthenticator();\n                                $checkResult = $gauth->verifyCode($google_Code, $twofactor, 2);\n        \n                                if (!$checkResult) {\n                                    dashboard\\primary\\error(\"Invalid 2FA code! Make sure your device time settings are synced.\");\n                                    return;\n                                }\n                                \n                                misc\\mysql\\query(\"UPDATE `accounts` SET `region` = ?,`asNum` = ?,`lastip` = ? WHERE `username` = ?\",[$region, $asNum, $ip, $username]);\n                            } else {\n                                // email verification on new login location\n                                header(\"location: ./emailVerify/\");\n                                die();\n                            }\n                        }\n                    }\n                }\n                else {\n                    misc\\mysql\\query(\"UPDATE `accounts` SET `region` = ?,`asNum` = ?,`lastip` = ? WHERE `username` = ?\",[$region, $asNum, $ip, $username]);\n                }\n            }\n        }\n        \n        if((!$emailVerify || $role == \"tester\") && $twofactor_optional) {\n            require_once '../auth/GoogleAuthenticator.php';\n            $gauth = new GoogleAuthenticator();\n            $twofactor = misc\\etc\\sanitize($_POST['keyauthtwofactor']);\n            $checkResult = $gauth->verifyCode($google_Code, $twofactor, 2);\n\n            if (!$checkResult) {\n                dashboard\\primary\\error(\"Invalid 2FA code! Make sure your device time settings are synced.\");\n                return;\n            }\n        }\n\n        $_SESSION['username'] = $username;\n        $_SESSION['ownerid'] = $id;\n        $_SESSION['role'] = $role;\n        $_SESSION['logindate'] = time();\n        $_SESSION['img'] = $img;\n        \n        if($securityKey) {\n            // set a temporary session variable to be used until the user completes WebAuthn\n            unset($_SESSION['username']);\n            $_SESSION['pendingUsername'] = $username;\n            header(\"location: ./securityKey.html\");\n            die();\n        }\n\n        if ($role == \"Reseller\" || $role == \"Manager\") {\n            ($query = misc\\mysql\\query(\"SELECT `secret`, `ownerid` FROM `apps` WHERE `name` = ? AND `owner` = ?\",[$app, $owner]));\n            if ($query->num_rows < 1) {\n                dashboard\\primary\\error(\"Application you're assigned to no longer exists!\");\n                return;\n            }\n            while ($row = mysqli_fetch_array($query->result)) {\n                $secret = $row[\"secret\"];\n                $ownerid = $row[\"ownerid\"];\n            }\n            $_SESSION['app'] = $secret;\n            $_SESSION['name'] = $app;\n            $_SESSION['ownerid'] = $ownerid;\n        }\n        \n        if ($acclogs) // check if account logs enabled\n        {\n            $ua = misc\\etc\\sanitize($_SERVER['HTTP_USER_AGENT']);\n            misc\\mysql\\query(\"INSERT INTO `acclogs`(`username`, `date`, `ip`, `useragent`) VALUES (?, ?, ?, ?);\",[$username, time(), $ip, $ua]); // insert ip log\n            $ts = time() - 604800;\n            misc\\mysql\\query(\"DELETE FROM `acclogs` WHERE `username` = ? AND `date` < ?\",[$username, $ts]); // delete any account logs more than a week old\n        }\n        \n        if(strtolower($username) != \"itsnetworking\") {\n            dashboard\\primary\\wh_log($logwebhook, \"{$username} has logged into GenZ Auth with IP `{$ip}`\", $webhookun);\n        }\n\n        if ($role == \"Reseller\") {\n            header(\"location: ../app/?page=reseller-licenses\");\n        } else if (!is_null($_SESSION['oldUrl'])) {\n            header(\"location: \" . $_SESSION['oldUrl']);\n        } else {\n            header(\"location: ../app/\");\n        }\n    }?>\n</body>\n\n</html>\n","size_bytes":36940},"register/index.php":{"content":"<?php\nrequire '../includes/misc/autoload.phtml';\nrequire '../includes/dashboard/autoload.phtml';\nrequire '../includes/api/shared/autoload.phtml';\nob_start();\nif (session_status() === PHP_SESSION_NONE) {\n    session_start();\n}\n\nif (isset($_SESSION['username'])) {\n    header(\"Location: ../app/\");\n    exit();\n}\nset_exception_handler(function ($exception) {\n    error_log(\"\\n--------------------------------------------------------------\\n\");\n    error_log($exception);\n    error_log(\"\\nRequest data:\");\n    error_log(print_r($_POST, true));\n    error_log(\"\\n--------------------------------------------------------------\");\n    http_response_code(500);\n    \\dashboard\\primary\\error($exception->getMessage());\n});\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\" class=\"bg-[#09090d] text-white overflow-x-hidden\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n\n    <meta name=\"title\" content=\"GenZ Auth - Open Source Auth\">\n\n    <meta content=\"Secure your software against piracy, an issue causing $422 million in losses annually - Fair pricing & Features not seen in competitors\" name=\"description\" />\n    <meta content=\"GenZ Auth\" name=\"author\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <meta name=\"keywords\" content=\"GenZ Auth, Cloud Authentication, Key Authentication,Authentication, API authentication,Security, Encryption authentication, Authenticated encryption, Cybersecurity, Developer, SaaS, Software Licensing, Licensing\" />\n    <meta property=\"og:description\" content=\"Secure your software against piracy, an issue causing $422 million in losses annually - Fair pricing & Features not seen in competitors\" />\n    <meta property=\"og:image\" content=\"https://cdn.keyauth.cc/front/assets/img/favicon.png\" />\n    <meta property=\"og:site_name\" content=\"GenZ Auth | Secure your software from piracy.\" />\n    <link rel=\"shortcut icon\" type=\"image/jpg\" href=\"https://cdn.keyauth.cc/front/assets/img/favicon.png\">\n\n    <!-- Schema.org markup for Google+ -->\n    <meta itemprop=\"name\" content=\"GenZ Auth - Open Source Auth\">\n    <meta itemprop=\"description\" content=\"Secure your software against piracy, an issue causing $422 million in losses annually - Fair pricing & Features not seen in competitors\">\n    <meta itemprop=\"image\" content=\"https://cdn.keyauth.cc/front/assets/img/favicon.png\">\n\n    <!-- Twitter Card data -->\n    <meta name=\"twitter:card\" content=\"product\">\n    <meta name=\"twitter:site\" content=\"@keyauth\">\n    <meta name=\"twitter:title\" content=\"GenZ Auth - Open Source Auth\">\n\n    <meta name=\"twitter:description\" content=\"Secure your software against piracy, an issue causing $422 million in losses annually - Fair pricing & Features not seen in competitors\">\n    <meta name=\"twitter:creator\" content=\"@keyauth\">\n    <meta name=\"twitter:image\" content=\"https://cdn.keyauth.cc/front/assets/img/favicon.png\">\n\n    <!-- Open Graph data -->\n    <meta property=\"og:title\" content=\"GenZ Auth - Open Source Auth\" />\n    <meta property=\"og:type\" content=\"website\" />\n    <meta property=\"og:url\" content=\"./\" />\n\n    <title>GenZ Auth - Register</title>\n\n    <!-- Canonical SEO -->\n    <link rel=\"canonical\" href=\"https://keyauth.cc\" />\n\n    <link rel=\"stylesheet\" href=\"https://cdn.keyauth.cc/v3/scripts/animate.min.css\" />\n    <link rel=\"stylesheet\" href=\"https://cdn.keyauth.cc/v3/dist/output.css\">\n\n    <script>\n    if (window.history.replaceState) {\n        window.history.replaceState(null, null, window.location.href);\n    }\n    </script>\n</head>\n\n<body>\n    <header class=\"\">\n        <nav class=\"border-gray-200 px-4 lg:px-6 py-2.5 mb-14\">\n            <div class=\"flex flex-wrap justify-between items-center mx-auto max-w-screen-xl\">\n                <a href=\"../\" class=\"flex items-center\">\n                    <span class=\"text-2xl font-bold text-white\">GenZ Auth</span>\n                </a>\n                <div class=\"flex items-center lg:order-2\">\n                    <a href=\"../login\" class=\"text-white focus:ring-0 font-medium rounded-lg text-sm px-4 py-2 lg:px-5 lg:py-2.5 mr-2 hover:opacity-60 transition duration-200 focus:outline-none focus:ring-gray-800\">\n                        Client Area\n                    </a>\n                    <a href=\"../register\" class=\"text-white focus:ring-0 font-medium rounded-lg text-sm px-4 py-2 lg:px-5 lg:py-2.5 mr-2 bg-blue-600 hover:opacity-80 focus:outline-none focus:ring-primary-800 transition duration-200\">\n                        Onboard Now\n                    </a>\n                    <button data-collapse-toggle=\"mmenu\" type=\"button\" class=\"inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200   \" aria-controls=\"mmenu\" aria-expanded=\"false\">\n                        <span class=\"sr-only\">Open main menu</span>\n                        <svg class=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\">\n                            <path fill-rule=\"evenodd\" d=\"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z\" clip-rule=\"evenodd\"></path>\n                        </svg>\n                        <svg class=\"hidden w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\">\n                            <path fill-rule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clip-rule=\"evenodd\"></path>\n                        </svg>\n                    </button>\n                </div>\n                <div class=\"hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1\" id=\"mmenu\">\n                    <ul class=\"flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0\">\n                        <li>\n                            <a href=\"../\" class=\"block py-2 pr-4 pl-3 border-b lg:hover:bg-transparent lg:border-0 lg:p-0 text-gray-400 hover:bg-gray-700 hover:text-white lg:hover:bg-transparent border-gray-700 transition duration-200\" aria-current=\"page\">Home</a>\n                        </li>\n                        <li>\n                            <a href=\"../#features\" class=\"block py-2 pr-4 pl-3 border-b lg:hover:bg-transparent lg:border-0 lg:p-0 text-gray-400 hover:bg-gray-700 hover:text-white lg:hover:bg-transparent border-gray-700 transition duration-200\">Features</a>\n                        </li>\n                        <li>\n                            <a href=\"../#plans\" class=\"block py-2 pr-4 pl-3 border-b lg:hover:bg-transparent lg:border-0 lg:p-0 text-gray-400 hover:bg-gray-700 hover:text-white lg:hover:bg-transparent border-gray-700 transition duration-200\">\n                                Plans\n                            </a>\n                        </li>\n                        <li>\n                            <a href=\"../#team\" class=\"block py-2 pr-4 pl-3 border-b lg:hover:bg-transparent lg:border-0 lg:p-0 text-gray-400 hover:bg-gray-700 hover:text-white lg:hover:bg-transparent border-gray-700 transition duration-200\">\n                                Our Team\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </nav>\n    </header>\n\n    <section>\n        <div class=\"relative flex flex-wrap md:-m-8 ml-8 md:ml-24\">\n            <div class=\"w-full md:w-1/2 md:p-8\">\n                <div class=\"md:max-w-lg md:mx-auto md:pt-36\">\n                <h2\n                    class=\"mb-7 md:mb-12 text-3xl md:text-6xl font-bold font-heading tracking-px-n leading-tight text-center\">\n                        Welcome to <span class=\"text-transparent bg-clip-text bg-gradient-to-r to-blue-600 from-sky-400\">GenZ Auth</span>!\n                    </h2>\n                    <h3 class=\"mb-9 text-sm md:text-xl font-bold font-heading leading-normal\">\n                        The best authentication platform for your software.\n                    </h3>\n                </div>\n            </div>\n            <div class=\"w-full md:w-1/2 md:p-8 -ml-4 md:-ml-0\">\n                <div class=\"p-4 py-16 flex flex-col justify-center h-full md:-ml-32\">\n                    <form class=\"md:max-w-lg md:ml-48 space-y-4 md:space-y-6\" method=\"post\">\n                        <div class=\"relative mb-4\">\n                            <input type=\"text\" id=\"username\" name=\"username\" class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-border-gray-300 appearance-none focus:ring-0 peer\" placeholder=\" \" autocomplete=\"on\" required>\n                            <label for=\"username\" class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#09090d] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Username</label>\n                        </div>\n                        <div class=\"relative mb-4\">\n                            <input type=\"email\" id=\"email\" name=\"email\" class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-border-gray-300 appearance-none focus:ring-0 peer\" placeholder=\" \" autocomplete=\"on\" required>\n                            <label for=\"email\" class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#09090d] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Email</label>\n                        </div>\n\n                        <div class=\"relative mb-4\">\n                            <input type=\"password\" id=\"password\" name=\"password\" class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-border-gray-300 appearance-none focus:ring-0 peer\" placeholder=\" \" data-popover-target=\"popover-password\" data-popover-placement=\"bottom\" autocomplete=\"on\" required>\n                            <label for=\"password\" class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#09090d] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Password</label>\n                        </div>\n\n                        <div class=\"relative mb-4\">\n                            <input type=\"password\" id=\"confirmpassword\" name=\"confirmpassword\" class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-border-gray-300 appearance-none focus:ring-0 peer\" placeholder=\" \" data-popover-target=\"popover-password\" data-popover-placement=\"bottom\" autocomplete=\"on\" required>\n                            <label for=\"confirmpassword\" class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#09090d] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Confirm Password</label>\n                        </div>\n\n                        <div data-popover id=\"popover-password\" role=\"tooltip\" class=\"absolute invisible inline-block text-sm text-white transition-opacity duration-300 bg-[#09090d] border border-[#0f0f17] rounded-lg shadow-sm opacity-0 w-72\">\n                            <div class=\"p-3 space-y-2\">\n                                <h3 class=\"font-semibold text-white\">Must have at least 12 characters</h3>\n                                <div class=\"grid grid-cols-4 gap-2\">\n                                    <div class=\"h-1 bg-gray-200\" id=\"pass_strength_one\"></div>\n                                    <div class=\"h-1 bg-gray-200\" id=\"pass_strength_two\"></div>\n                                    <div class=\"h-1 bg-gray-200\" id=\"pass_strength_three\"></div>\n                                    <div class=\"h-1 bg-gray-200\" id=\"pass_strength_four\"></div>\n                                </div>\n                                <p>It’s better to have:</p>\n                                <ul>\n                                    <li class=\"flex items-center mb-1\">\n                                        <svg class=\"w-3.5 h-3.5 mr-2 text-green-400  \" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 16 12\">\n                                            <path stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M1 5.917 5.724 10.5 15 1.5\" />\n                                        </svg>\n                                        Upper & lower case letters\n                                    </li>\n                                    <li class=\"flex items-center mb-1\">\n                                        <svg class=\"w-3.5 h-3.5 mr-2 text-green-400  \" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 16 12\">\n                                            <path stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M1 5.917 5.724 10.5 15 1.5\" />\n                                        </svg>\n                                        A symbol(s) (#$&)\n                                    </li>\n                                </ul>\n                            </div>\n                            <div data-popper-arrow></div>\n                        </div>\n                        <div>\n                            <div class=\"flex justify-between mb-2\">\n                                <span class=\"text-sm font-medium text-white\">I Agree To:</span>\n                            </div>\n                            <ul class=\"items-center w-full text-sm font-medium border-1 rounded-lg sm:flex bg-[#0f0f17] text-white\">\n                                <li class=\"w-full border-b border-gray-700 sm:border-b-0 sm:border-r\">\n                                    <div class=\"flex items-center pl-3\">\n                                        <input name=\"wontshareCB\" id=\"wontshareCB\" type=\"checkbox\" value=\"\" class=\"w-4 h-4 rounded focus:ring-blue-600 ring-offset-gray-700 focus:ring-offset-gray-700 focus:ring-0 bg-[#09090d] border-[#09090d]\">\n                                        <label for=\"wontshareCB\" class=\"w-full py-3 ml-2 text-sm font-medium text-gray-300\">Not\n                                            share my account</label>\n                                    </div>\n                                </li>\n                                <li class=\"w-full border-b border-gray-700 sm:border-b-0 sm:border-r \">\n                                    <div class=\"flex items-center pl-3\">\n                                        <input name=\"wontdisputeCB\" id=\"wontdisputeCB\" type=\"checkbox\" value=\"\" class=\"w-4 h-4 rounded focus:ring-blue-600 ring-offset-gray-700 focus:ring-offset-gray-700 focus:ring-0 bg-[#09090d] border-[#09090d]\">\n                                        <label for=\"wontdisputeCB\" class=\"w-full py-3 ml-2 text-sm font-medium text-gray-300\">Not make\n                                            any disputes (contact support)</label>\n                                    </div>\n                                </li>\n                                <li class=\"w-full border-b border-gray-700 sm:border-b-0\">\n                                    <div class=\"flex items-center pl-3\">\n                                        <input name=\"tosCB\" id=\"tosCB\" type=\"checkbox\" value=\"\" class=\"w-4 h-4 rounded focus:ring-blue-600 ring-offset-gray-700 focus:ring-offset-gray-700 focus:ring-0 bg-[#09090d] border-[#09090d]\">\n                                        <label for=\"tosCB\" class=\"w-full py-3 ml-2 text-sm font-medium text-gray-300\">Follow\n                                            <a href=\"/terms\" target=\"_blank\" class=\"text-blue-600  hover:underline\">Terms and\n                                                Conditions</a></label>\n                                    </div>\n                                </li>\n                            </ul>\n                        </div>\n\n                        <button name=\"register\" class=\"text-white border-2 hover:bg-white hover:text-black focus:ring-0 focus:outline-none transition duration-200 font-medium rounded-lg text-sm px-5 py-2.5 text-center items-center mb-3 w-full mt-10\">\n                        <span class=\"inline-flex\">\n                                    Register Now\n                                    <svg class=\"w-3.5 h-3.5 ml-2 mt-1\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 14 10\">\n                                        <path stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M1 5h12m0 0L9 1m4 4L9 9\"></path>\n                                    </svg></span>\n                        </button>\n\n                        <div class=\"text-sm font-medium text-white mb-4\">\n                            Need a good password manager? Use <a href=\"https://bitwarden.com/\" target=\"_blank\" class=\"hover:underline text-blue-500\">Bitwarden</a> it's free!\n                        </div>\n\n                        <div class=\"text-sm font-medium text-white\">\n                            Have an Account? <a href=\"../login\" class=\"hover:underline text-blue-500\">Login</a>\n                        </div>\n\n                        <?php\n                        require_once __DIR__ . '/../auth/google-config.php';\n                        $googleAuthUrl = getGoogleAuthUrl();\n                        if ($googleAuthUrl):\n                        ?>\n                        <div class=\"relative flex items-center my-4\">\n                            <div class=\"flex-grow border-t border-gray-700\"></div>\n                            <span class=\"flex-shrink mx-4 text-gray-400 text-xs\">Or</span>\n                            <div class=\"flex-grow border-t border-gray-700\"></div>\n                        </div>\n                        <a href=\"<?= htmlspecialchars($googleAuthUrl); ?>\" class=\"flex items-center justify-center gap-2 text-gray-800 bg-white hover:opacity-90 font-medium rounded-lg text-sm px-5 py-2.5 w-full border border-gray-300 transition duration-200\">\n                            <svg class=\"w-5 h-5\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                                <path d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\" fill=\"#4285F4\"/>\n                                <path d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\" fill=\"#34A853\"/>\n                                <path d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\" fill=\"#FBBC05\"/>\n                                <path d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\" fill=\"#EA4335\"/>\n                            </svg>\n                            Continue with Google\n                        </a>\n                        <?php endif; ?>\n\n\n                    </form>\n                </div>\n            </div>\n        </div>\n    </section>\n\n    <footer class=\"mt-32\">\n        <div class=\"p-4 py-6 mx-auto max-w-screen-xl md:p-8 lg:-10 pt-32 md:pt-0\">\n            <div class=\"grid grid-cols-2 gap-8 lg:grid-cols-6\">\n                <div class=\"col-span-2\">\n                    <a href=\"../\" class=\"flex items-center mb-2 text-2xl font-semibold text-white lg:mb-0\">\n                        GenZ Auth LLC\n                    </a>\n                    <p class=\"my-4 font-light text-gray-400\">\n                        GenZ Auth is a game-changing, affordable and easy to use licensing solution for your software.\n                    </p>\n                    <ul class=\"flex mt-5 space-x-6\">\n                        <li>\n                            <a target=\"_blank\" href=\"https://youtube.com/keyauth\" class=\"hover:text-white text-gray-400\">\n                                <svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                                    <path d=\"M21.593 7.203a2.506 2.506 0 0 0-1.762-1.766c-1.566-.43-7.83-.437-7.83-.437s-6.265-.007-7.832.404a2.56 2.56 0 0 0-1.766 1.778c-.413 1.566-.417 4.814-.417 4.814s-.004 3.264.406 4.814c.23.857.905 1.534 1.763 1.765 1.582.43 7.83.437 7.83.437s6.265.007 7.831-.403a2.515 2.515 0 0 0 1.767-1.763c.414-1.565.417-4.812.417-4.812s.02-3.265-.407-4.831ZM9.996 15.005l.005-6 5.207 3.005-5.212 2.995Z\">\n                                    </path>\n                                </svg>\n                            </a>\n                        </li>\n                        <li>\n                            <a target=\"_blank\" href=\"https://github.com/KeyAuth/\" class=\"hover:text-white text-gray-400\">\n                                <svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                                    <path fill-rule=\"evenodd\" d=\"M12.026 2a9.973 9.973 0 0 0-9.974 9.974c0 4.406 2.857 8.145 6.82 9.465.5.09.68-.217.68-.481 0-.237-.008-.865-.011-1.696-2.775.602-3.361-1.338-3.361-1.338-.452-1.152-1.107-1.459-1.107-1.459-.905-.619.069-.605.069-.605 1.002.07 1.527 1.028 1.527 1.028.89 1.524 2.336 1.084 2.902.829.09-.645.35-1.085.635-1.334-2.214-.251-4.542-1.107-4.542-4.93 0-1.087.389-1.979 1.024-2.675-.101-.253-.446-1.268.099-2.64 0 0 .837-.269 2.742 1.021a9.582 9.582 0 0 1 2.496-.336 9.555 9.555 0 0 1 2.496.336c1.906-1.291 2.742-1.021 2.742-1.021.545 1.372.203 2.387.099 2.64.64.696 1.024 1.587 1.024 2.675 0 3.833-2.33 4.675-4.552 4.922.355.308.675.916.675 1.846 0 1.334-.012 2.41-.012 2.737 0 .267.178.577.687.479C19.146 20.115 22 16.379 22 11.974 22 6.465 17.535 2 12.026 2Z\" clip-rule=\"evenodd\"></path>\n                                </svg>\n                            </a>\n                        </li>\n                        <li>\n                            <a target=\"_blank\" href=\"https://twitter.com/KeyAuth\" class=\"hover:text-white text-gray-400\">\n                                <svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                                    <path d=\"M19.633 7.994c.013.175.013.349.013.523 0 5.325-4.053 11.46-11.46 11.46A11.38 11.38 0 0 1 2 18.169c.324.037.636.05.973.05a8.07 8.07 0 0 0 5.001-1.721 4.036 4.036 0 0 1-3.767-2.793c.249.037.499.062.761.062.361 0 .724-.05 1.061-.137a4.027 4.027 0 0 1-3.23-3.953v-.05a4.05 4.05 0 0 0 1.82.51 4.022 4.022 0 0 1-1.796-3.353c0-.748.199-1.434.548-2.032a11.457 11.457 0 0 0 8.306 4.215c-.062-.3-.1-.611-.1-.923a4.024 4.024 0 0 1 4.028-4.028c1.16 0 2.207.486 2.943 1.272a7.957 7.957 0 0 0 2.556-.973c-.3.93-.93 1.72-1.771 2.22a8.074 8.074 0 0 0 2.319-.624 8.646 8.646 0 0 1-2.019 2.083Z\">\n                                    </path>\n                                </svg>\n                            </a>\n                        </li>\n                        <li>\n                            <a target=\"_blank\" href=\"#\" class=\"hover:text-white text-gray-400\">\n                                <svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                                    <path d=\"M11.999 7.375a4.624 4.624 0 1 0 0 9.248 4.624 4.624 0 0 0 0-9.248Zm0 7.627a3.004 3.004 0 1 1 0-6.008 3.004 3.004 0 0 1 0 6.008Z\">\n                                    </path>\n                                    <path d=\"M16.805 8.289a1.078 1.078 0 1 0 0-2.156 1.078 1.078 0 0 0 0 2.156Z\"></path>\n                                    <path d=\"M20.533 6.114A4.605 4.605 0 0 0 17.9 3.482a6.607 6.607 0 0 0-2.186-.42c-.963-.042-1.268-.054-3.71-.054s-2.755 0-3.71.054a6.554 6.554 0 0 0-2.184.42 4.6 4.6 0 0 0-2.633 2.632A6.585 6.585 0 0 0 3.058 8.3c-.043.962-.056 1.267-.056 3.71 0 2.442 0 2.753.056 3.71.015.748.156 1.486.419 2.187a4.61 4.61 0 0 0 2.634 2.632 6.583 6.583 0 0 0 2.185.45c.963.042 1.268.055 3.71.055s2.755 0 3.71-.055a6.616 6.616 0 0 0 2.186-.42 4.613 4.613 0 0 0 2.633-2.632c.263-.7.404-1.438.419-2.186.043-.962.056-1.267.056-3.71s0-2.753-.056-3.71a6.583 6.583 0 0 0-.421-2.217Zm-1.218 9.532a5.046 5.046 0 0 1-.311 1.688 2.987 2.987 0 0 1-1.712 1.71c-.535.2-1.1.305-1.67.312-.95.044-1.218.055-3.654.055-2.438 0-2.687 0-3.655-.055a4.961 4.961 0 0 1-1.67-.311 2.985 2.985 0 0 1-1.718-1.711 5.08 5.08 0 0 1-.311-1.67c-.043-.95-.053-1.217-.053-3.653 0-2.437 0-2.686.053-3.655a5.038 5.038 0 0 1 .311-1.687c.305-.79.93-1.41 1.719-1.712a5.01 5.01 0 0 1 1.669-.311c.95-.043 1.218-.055 3.655-.055s2.687 0 3.654.055a4.96 4.96 0 0 1 1.67.31 2.99 2.99 0 0 1 1.712 1.713 5.06 5.06 0 0 1 .311 1.669c.043.95.054 1.218.054 3.655 0 2.436 0 2.698-.043 3.654h-.011v-.001Z\">\n                                    </path>\n                                </svg>\n                            </a>\n                        </li>\n                        <li>\n                            <a target=\"_blank\" href=\"https://www.tiktok.com/@keyauth\" class=\"hover:text-white text-gray-400\">\n                                <svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                                    <path d=\"M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64c.298-.002.595.042.88.13V9.4A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1h-.04Z\">\n                                    </path>\n                                </svg>\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n                <div class=\"lg:mx-auto\">\n                    <h3 class=\"mb-6 text-sm font-semibold uppercase text-white\">Links</h3>\n                    <ul class=\"text-gray-500 \">\n                        <li class=\"mb-4\">\n                            <a href=\"https://www.youtube.com/keyauth\" target=\"_blank\" class=\"hover:underline\">Youtube</a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a href=\"https://linkedin.com\" target=\"_blank\" class=\"hover:underline\">Linkedin</a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a href=\"https://github.com/keyauth\" target=\"_blank\" class=\"hover:underline\">GitHub</a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a href=\"https://keyauth.readme.io\" target=\"_blank\" class=\"hover:underline\">Documentation</a>\n                        </li>\n                    </ul>\n                </div>\n                <div class=\"lg:mx-auto\">\n                    <h2 class=\"mb-6 text-sm font-semibold uppercase text-white\">\n                        Most Used Examples\n                    </h2>\n                    <ul class=\"text-gray-500 \">\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"https://github.com/KeyAuth/GenZ Auth-CPP-Example\" class=\"hover:underline\">\n                                C++ <span class=\"text-xs\">(CPP)</span>\n                            </a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"https://github.com/KeyAuth/GenZ Auth-CSHARP-Example\" class=\"hover:underline\">C# <span class=\"text-xs\">(CSharp)</span></a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"https://github.com/mazkdevf/KeyAuth-JS-Example\" class=\"hover:underline\">JavaScript <span class=\"text-xs\">(JS)</span></a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"https://github.com/KeyAuth/GenZ Auth-Python-Example\" class=\"hover:underline\">Python <span class=\"text-xs\">(PY)</span></a>\n                        </li>\n                    </ul>\n                </div>\n                <div class=\"lg:mx-auto\">\n                    <h2 class=\"mb-6 text-sm font-semibold uppercase text-white\">Other & Support</h2>\n                    <ul class=\"text-gray-500 \">\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"https://keyauth.tawk.help\" class=\"hover:underline\">\n                                Support Center\n                            </a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"../free-trial/\" class=\"hover:underline\">\n                                Demo Accounts\n                            </a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"https://t.me/keyauth\" class=\"hover:underline\">\n                                Telegram\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n                <div class=\"lg:mx-auto\">\n                    <h2 class=\"mb-6 text-sm font-semibold uppercase text-white\">Legal</h2>\n                    <ul class=\"text-gray-500 \">\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"../terms\" class=\"hover:underline\">Terms of Service</a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"../terms#privacy\" class=\"hover:underline\">Privacy Policy</a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"https://github.com/KeyAuth/GenZ Auth-Source-Code/blob/main/LICENSE\" class=\"hover:underline\">Licensing</a>\n                        </li>\n                        <li class=\"mb-4\">\n                            <a target=\"_blank\" href=\"../gdpr\" class=\"hover:underline\">GDPR</a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n            <hr class=\"my-6 border-[#0f0f17] sm:mx-auto lg:my-8\">\n\n            <span class=\"block mb-6 text-sm text-gray-400 lg:mb-0 text-center\">© 2020 - 2023 <a href=\"../\" class=\"hover:underline\">GenZ Auth LLC</a>. All Rights Reserved.\n            </span>\n        </div>\n    </footer>\n\n    <!-- jqeury -->\n    <script src=\"https://cdn.keyauth.cc/v3/scripts/jquery.min.js\"></script>\n\n    <!--Flowbite JS-->\n    <script src=\"https://cdn.keyauth.cc/v3/dist/flowbite.js\"></script>\n    <script>\n        $(\"#password\").on(\"input\", function() {\n            var value = $(this).val();\n            var strength = 0;\n            if (value.length > 12) {\n                strength += 15;\n            }\n            if (value.match(/[a-z]+/)) {\n                strength += 25;\n            }\n            if (value.match(/[A-Z]+/)) {\n                strength += 25;\n            }\n            if (value.match(/[0-9]+/)) {\n                strength += 25;\n            }\n\n            if (value.match(/[!@#$%^&*()_+\\-=\\[\\]{};':\"\\\\|,.<>\\/?]+/)) {\n                strength += 25;\n            }\n\n            if (value.length === 0) {\n                $(\"#pass_strength_one, #pass_strength_two, #pass_strength_three, #pass_strength_four\").css(\"background-color\", \"#ffffff\");\n            } else if (strength >= 1 && strength <= 25) {\n                $(\"#pass_strength_one\").css(\"background-color\", \"#ff0000\");\n                $(\"#pass_strength_two, #pass_strength_three, #pass_strength_four\").css(\"background-color\", \"#ffffff\");\n            } else if (strength >= 26 && strength <= 50) {\n                $(\"#pass_strength_one, #pass_strength_two\").css(\"background-color\", \"#ff5a00\");\n                $(\"#pass_strength_three, #pass_strength_four\").css(\"background-color\", \"#ffffff\");\n            } else if (strength >= 51 && strength <= 75) {\n                $(\"#pass_strength_one, #pass_strength_two, #pass_strength_three\").css(\"background-color\", \"#6acc1a\");\n                $(\"#pass_strength_four\").css(\"background-color\", \"#ffffff\");\n            } else if (strength >= 76 && strength <= 100) {\n                $(\"#pass_strength_one, #pass_strength_two, #pass_strength_three, #pass_strength_four\").css(\"background-color\", \"#0c9b18\");\n            }\n        });\n    </script>\n\n    <?php\n    if (isset($_POST['register'])) {\n        $username = misc\\etc\\sanitize($_POST['username']);\n        $password = misc\\etc\\sanitize($_POST['password']);\n        $confirmPass = misc\\etc\\sanitize($_POST['confirmpassword']);\n        $email = misc\\etc\\sanitize($_POST['email']);\n        $pattern = '/\\b(http|https)\\b|\\.(com|win|rar|zip|gov|uk|gg|business|org|cc)\\b/i';\n        if (empty($username) || empty($password) || empty($email)) {\n            dashboard\\primary\\error(\"You must specify username, password, and email.\");\n            return;\n        }\n        if(preg_match($pattern, $username)){\n            dashboard\\primary\\error(\"Username can not contain link features.\");\n            return;\n        }\n        if (!isset($_POST['wontshareCB'])) {\n            dashboard\\primary\\error(\"You must agree to not share your account with anyone\");\n            return;\n        }\n        if (!isset($_POST['wontdisputeCB'])) {\n            dashboard\\primary\\error(\"You must agree you won't dispute any charges. (contact support first)\");\n            return;\n        }\n        if (!isset($_POST['tosCB'])) {\n            dashboard\\primary\\error(\"You must agree to the Terms of Service and Privacy Policy\");\n            return;\n        }\n        if($password !== $confirmPass){\n            dashboard\\primary\\error(\"Passwords do not match!\");\n            return;\n        }\n        if (strlen($password) >= 33){\n            dashboard\\primary\\error(\"Password must be less than 33 characters!\");\n            return;\n        }\n        $uppercase = preg_match('@[A-Z]@', $password);\n        $lowercase = preg_match('@[a-z]@', $password);\n        $number = preg_match('@[0-9]@', $password);\n        if (!$uppercase || !$lowercase || !$number || strlen($password) < 12) {\n            dashboard\\primary\\error(\"Password must have at least one capital letter, one lowercase letter, one number, and be at least 12 characters long.\");\n            return;\n        }\n        if (misc\\etc\\isPhonyEmail($email)) {\n            dashboard\\primary\\error(\"Please use a real email. You will need email access to reset password, new login location if you have enabled, etc.\");\n            dashboard\\primary\\wh_log($logwebhook, \"{$username} has failed email validation with `{$email}`\", $webhookun);\n            return;\n        }\n        if (misc\\etc\\isBreached($password)) {\n            dashboard\\primary\\wh_log($logwebhook, \"{$username} attempted to register with leaked password `{$password}`\", $webhookun);\n            dashboard\\primary\\error(\"Password has been leaked in a data breach (not from us)! Please use different password.\");\n            return;\n        }\n        $query = misc\\mysql\\query(\"SELECT 1 FROM `accounts` WHERE `username` = ?\", [$username]);\n        if ($query->num_rows == 1) {\n            dashboard\\primary\\error(\"Username already taken!\");\n            return;\n        }\n        $query = misc\\mysql\\query(\"SELECT `username` FROM `accounts` WHERE `email` = SHA1(?)\", [$email]);\n        if ($query->num_rows > 0) {\n            dashboard\\primary\\error('Email already used by username: ' . mysqli_fetch_array($query->result)['username'] . '');\n            return;\n        }\n        $pass_encrypted = password_hash($password, PASSWORD_BCRYPT);\n        $ownerid = misc\\etc\\generateRandomString();\n        $ip = api\\shared\\primary\\getIp();\n        misc\\mysql\\query(\"INSERT INTO `accounts` (`username`, `email`, `password`, `ownerid`, `role`, `registrationip`) VALUES (?, SHA1(LOWER(?)), ?, ?, 'tester', ?)\", [$username, $email, $pass_encrypted, $ownerid, $ip]);\n        dashboard\\primary\\wh_log($logwebhook, \"{$username} has registered successfully\", $webhookun);\n        $htmlContent = \"<html>\n                                        <body>\n                                                <h1>Welcome!</h1>\n                                                <p>Please join our Telegram group for updates and chat <a href=\\\"https://t.me/keyauth\\\">https://t.me/keyauth</a></p>\n                                                <p>GenZ Auth code can be seen here <a href=\\\"https://github.com/GenZ Auth/\\\">https://github.com/GenZ Auth/</a></p>\n                                                <p>GenZ Auth API documentation can be seen here <a href=\\\"https://keyauth.readme.io/\\\">https://keyauth.readme.io/</a></p>\n                                                <p>Please leave a review on TrustPilot if you enjoy GenZ Auth <a href=\\\"https://trustpilot.com/review/keyauth.com\\\">https://trustpilot.com/review/keyauth.com</a></p>\n                                                <p style=\\\"margin-top: 20px;\\\">Thanks,<br><b>GenZ Auth.</b></p>\n                                        </body>\n                                        </html>\";\n        misc\\email\\send($username, $email, $htmlContent, \"Welcome to GenZ Auth\");\n        $_SESSION['logindate'] = time();\n        $_SESSION['username'] = $username;\n        $_SESSION['ownerid'] = $ownerid;\n        $_SESSION['role'] = 'tester';\n        $_SESSION['img'] = 'https://cdn.keyauth.cc/front/assets/img/favicon.png';\n        header(\"location: ../app/\");\n    }\n    ?>\n</body>\n\n</html>\n","size_bytes":38014},"telegram/index.php":{"content":"<?php\n        header(\"Location: https://t.me/KeyAuth\");\n        exit();\n?>","size_bytes":74},"api/1.0/index.php":{"content":"<?php\r\ninclude '../../includes/misc/autoload.phtml';\r\ninclude '../../includes/api/shared/autoload.phtml';\r\ninclude '../../includes/api/1.0/autoload.phtml';\r\n\r\nheader(\"Access-Control-Allow-Origin: *\"); // allow browser applications to request API\r\n\r\nset_exception_handler(function ($exception) {\r\n    error_log(\"\\n--------------------------------------------------------------\\n\");\r\n    error_log($exception);\r\n    error_log(\"\\nRequest data:\");\r\n    error_log(print_r($_POST, true));\r\n    error_log(\"\\n--------------------------------------------------------------\");\r\n    http_response_code(500);\r\n    $errorMsg = str_replace($databaseUsername, \"REDACTED\", $exception->getMessage());\r\n    die(json_encode(array(\"success\" => false, \"message\" => \"Error: \" . $errorMsg)));\r\n});\r\n\r\nif(empty($_POST['ownerid'])) {\r\n    die(json_encode(array(\"success\" => false, \"message\" => \"No OwnerID specified. Select app & copy code snippet from https://keyauth.cc/app/\")));\r\n}\r\n\r\nif(empty($_POST['name'])) {\r\n    die(json_encode(array(\"success\" => false, \"message\" => \"No app name specified. Select app & copy code snippet from https://keyauth.cc/app/\")));\r\n}\r\n\r\nif(strlen(hex2bin($_POST['ownerid'])) != 10) {\r\n    die(json_encode(array(\"success\" => false, \"message\" => \"OwnerID should be 10 characters long. Select app & copy code snippet from https://keyauth.cc/app/\")));\r\n}\r\n\r\n$ownerid = misc\\etc\\sanitize(hex2bin($_POST['ownerid'])); // ownerid of account that owns application\r\n$name = misc\\etc\\sanitize(hex2bin($_POST['name'])); // application name\r\n$row = misc\\cache\\fetch('KeyAuthApp:' . $name . ':' . $ownerid, \"SELECT * FROM `apps` WHERE `ownerid` = ? AND `name` = ?\", [$ownerid, $name], 0);\r\n\r\nif ($row == \"not_found\") {\r\n    die(\"KeyAuth_Invalid\");\r\n}\r\n\r\n// app settings\r\n$secret = $row['secret'];\r\n$hwidenabled = $row['hwidcheck'];\r\n$vpnblock = $row['vpnblock'];\r\n$status = $row['enabled'];\r\n$paused = $row['paused'];\r\n$currentver = $row['ver'];\r\n$download = $row['download'];\r\n$webhook = $row['webhook'];\r\n$appdisabled = $row['appdisabled'];\r\n$hashcheck = $row['hashcheck'];\r\n$serverhash = $row['hash'];\r\n$sessionexpiry = $row['session'];\r\n$forceHwid = $row['forceHwid'];\r\n\r\n$banned = $row['banned'];\r\n$owner = $row['owner'];\r\n$name = $row['name'];\r\n\r\n// custom error messages\r\n$usernametaken = $row['usernametaken'];\r\n$keynotfound = $row['keynotfound'];\r\n$keyused = $row['keyused'];\r\n$nosublevel = $row['nosublevel'];\r\n$usernamenotfound = $row['usernamenotfound'];\r\n$passmismatch = $row['passmismatch'];\r\n$hwidmismatch = $row['hwidmismatch'];\r\n$noactivesubs = $row['noactivesubs'];\r\n$hwidblacked = $row['hwidblacked'];\r\n$pausedsub = $row['pausedsub'];\r\n$vpnblocked = $row['vpnblocked'];\r\n$keybanned = $row['keybanned'];\r\n$userbanned = $row['userbanned'];\r\n$sessionunauthed = $row['sessionunauthed'];\r\n$hashcheckfail = $row['hashcheckfail'];\r\n\r\n// why using null coalescing operators? because if I add a field and it's not in redis cache, it'll be NULL\r\n$loggedInMsg = $row['loggedInMsg'] ?? \"Logged in!\";\r\n$pausedApp = $row['pausedApp'] ?? \"Application is currently paused, please wait for the developer to say otherwise.\";\r\n$unTooShort = $row['unTooShort'] ?? \"Username too short, try longer one.\";\r\n$pwLeaked = $row['pwLeaked'] ?? \"This password has been leaked in a data breach (not from us), please use a different one.\";\r\n$chatHitDelay = $row['chatHitDelay'] ?? \"Chat slower, you've hit the delay limit\";\r\n$minHwid = $row['minHwid'] ?? 20;\r\n\r\nif ($banned) {\r\n    die(api\\v1_0\\Encrypt(json_encode(array(\r\n        \"success\" => false,\r\n        \"message\" => \"This application has been banned from KeyAuth.cc for violating terms.\" // yes we self promote to customers of those who break ToS. Should've followed terms :shrug:\r\n    )), $secret));\r\n}\r\n\r\nif ($_GET['host'] == \"keyauth.business\") {\r\n    die(api\\v1_0\\Encrypt(json_encode(array(\r\n        \"success\" => false,\r\n        \"message\" => \"Please tell the developer of this program to use latest API domain. This domain is old, it will expire in a month.\"\r\n    )), $secret));\r\n}\r\n\r\nswitch (hex2bin($_POST['type'])) {\r\n    case 'init':\r\n        $ip = api\\shared\\primary\\getIp();\r\n        if ($vpnblock) {\r\n            if (api\\shared\\primary\\vpnCheck($ip)) {\r\n                $row = misc\\cache\\fetch('KeyAuthWhitelist:' . $secret . ':' . $ip, \"SELECT 1 FROM `whitelist` WHERE `ip` = ? AND `app` = ?\", [$ip, $secret], 0);\r\n                if ($row == \"not_found\") {\r\n                    die(api\\v1_0\\Encrypt(json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"$vpnblocked\"\r\n                    )), $secret));\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!$status) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$appdisabled\"\r\n            )), $secret));\r\n        }\r\n\r\n        if ($paused) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$pausedApp\"\r\n            )), $secret));\r\n        }\r\n\r\n        $ver = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['ver'], $secret));\r\n\r\n        if ($ver != $currentver) {\r\n            // auto-update system\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"invalidver\",\r\n                \"download\" => \"$download\"\r\n            ), JSON_UNESCAPED_SLASHES), $secret));\r\n        }\r\n\r\n        $hash = misc\\etc\\sanitize($_POST['hash']);\r\n\r\n        if ($hashcheck) {\r\n            if (strpos($serverhash, $hash) === false) {\r\n                if (is_null($serverhash)) {\r\n                    misc\\mysql\\query(\"UPDATE `apps` SET `hash` = ? WHERE `secret` = ?\", [$hash, $secret]);\r\n                    misc\\cache\\purge('KeyAuthApp:' . $name . ':' . $ownerid); // flush cache for application so new hash takes precedent\r\n                } else {\r\n                    die(api\\v1_0\\Encrypt(json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"$hashcheckfail\"\r\n                    )), $secret));\r\n                }\r\n            }\r\n        }\r\n\r\n        $enckey = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['enckey'], $secret));\r\n\r\n        $newSession = false;\r\n        $duplicateSession = misc\\cache\\select(\"KeyAuthSessionDupe:$secret:$ip\");\r\n        if($duplicateSession) {\r\n            $sessionid = $duplicateSession;\r\n            $updateSession = misc\\cache\\update('KeyAuthState:'.$secret.':'.$sessionid.'', array(\"enckey\" => $enckey));\r\n            if(!$updateSession) {\r\n                $sessionid = misc\\etc\\generateRandomString();\r\n                $newSession = true;\r\n            }\r\n        }\r\n        else {\r\n            $sessionid = misc\\etc\\generateRandomString();\r\n            $newSession = true;\r\n        }\r\n\r\n        // $row = misc\\cache\\fetch('KeyAuthAppStats:' . $secret, \"SELECT (SELECT COUNT(1) FROM `users` WHERE `app` = ?) AS 'numUsers', (SELECT COUNT(1) FROM `sessions` WHERE `app` = ? AND `validated` = 1 AND `expiry` > ?) AS 'numOnlineUsers', (SELECT COUNT(1) FROM `keys` WHERE `app` = ?) AS 'numKeys' FROM dual\", [$secret, $secret, time(), $secret], 0, 3600);\r\n\r\n        $numUsers = \"N/A - Use fetchStats() function in latest example\";\r\n        $numOnlineUsers = \"N/A - Use fetchStats() function in latest example\";\r\n        $numKeys = \"N/A - Use fetchStats() function in latest example\";\r\n\r\n        echo api\\v1_0\\Encrypt(json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"Initialized\",\r\n            \"sessionid\" => $sessionid,\r\n            \"appinfo\" => array(\r\n                \"numUsers\" => \"$numUsers\",\r\n                \"numOnlineUsers\" => \"$numOnlineUsers\",\r\n                \"numKeys\" => \"$numKeys\",\r\n                \"version\" => \"$currentver\",\r\n                \"customerPanelLink\" => \"https://keyauth.cc/panel/$owner/$name/\"\r\n            )\r\n        )), $secret);\r\n\r\n        fastcgi_finish_request();\r\n\r\n        if($newSession) {\r\n            misc\\cache\\insert(\"KeyAuthState:$secret:$sessionid\", serialize(array(\"credential\" => NULL, \"enckey\" => $enckey, \"validated\" => 0)), $sessionexpiry);\r\n            $time = time() + $sessionexpiry;\r\n            misc\\mysql\\query(\"INSERT INTO `sessions` (`id`, `app`, `expiry`, `created_at`, `enckey`,`ip`) VALUES (?, ?, ?, ?, ?, ?)\", [$sessionid, $secret, $time, time(), $enckey, $ip]);\r\n            $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n            $enckey = $session[\"enckey\"];\r\n            misc\\cache\\insert(\"KeyAuthSessionDupe:$secret:$ip\", $sessionid, $sessionexpiry);\r\n        }\r\n\r\n    case 'register':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize(hex2bin($_POST['sessionid']));\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        // Read in username\r\n        $username = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['username'], $enckey));\r\n\r\n        if(strlen($username) > 70) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Username must be shorter than 70 characters\"\r\n            )), $enckey));\r\n        }\r\n\r\n        // Read in license key\r\n        $checkkey = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['key'], $enckey));\r\n\r\n        if(strlen($checkkey) > 70) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Key must be shorter than 70 characters\"\r\n            )), $enckey));\r\n        }\r\n\r\n        // Read in password\r\n        $password = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['pass'], $enckey));\r\n\r\n        // Read in email\r\n        $email = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['email'], $enckey));\r\n\r\n        // Read in hwid\r\n        $hwid = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['hwid'], $enckey));\r\n\r\n        $resp = api\\v1_0\\register($username, $checkkey, $password, $email, $hwid, $secret);\r\n        switch ($resp) {\r\n            case 'username_taken':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$usernametaken\"\r\n                )), $enckey));\r\n            case 'key_not_found':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keynotfound\"\r\n                )), $enckey));\r\n            case 'un_too_short':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$unTooShort\"\r\n                )), $enckey));\r\n            case 'pw_leaked':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$pwLeaked\"\r\n                )), $enckey));\r\n            case 'key_already_used':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keyused\"\r\n                )), $enckey));\r\n            case 'key_banned':\r\n                if (strpos($keybanned, '{reason}') !== false) {\r\n                    $query = misc\\mysql\\query(\"SELECT `banned` FROM `keys` WHERE `app` = ? AND `key` = ?\", [$secret, $checkkey]);\r\n                    $row = mysqli_fetch_array($query->result);\r\n                    $reason = $row['banned'];\r\n                    $keybanned = str_replace(\"{reason}\", $reason, $keybanned);\r\n                }\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keybanned\"\r\n                )), $enckey));\r\n            case 'hwid_blacked':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$hwidblacked\"\r\n                )), $enckey));\r\n            case 'no_subs_for_level':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$nosublevel\"\r\n                )), $enckey));\r\n            default:\r\n                misc\\mysql\\query(\"UPDATE `sessions` SET `credential` = ?,`validated` = 1 WHERE `id` = ? AND `app` = ?\", [$username, $sessionid, $secret]);\r\n                misc\\cache\\update('KeyAuthState:'.$secret.':'.$sessionid.'', array(\"validated\" => 1, \"credential\" => $username));\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => true,\r\n                    \"message\" => \"$loggedInMsg\",\r\n                    \"info\" => $resp\r\n                )), $enckey));\r\n        }\r\n    case 'upgrade':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize(hex2bin($_POST['sessionid']));\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        // Read in username\r\n        $username = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['username'], $enckey));\r\n\r\n        // Read in key\r\n        $checkkey = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['key'], $enckey));\r\n\r\n\r\n        // search for key\r\n        $query = misc\\mysql\\query(\"SELECT `banned`, `expires`, `status`, `level` FROM `keys` WHERE `key` = ? AND `app` = ?\", [$checkkey, $secret]);\r\n\r\n        // check if key exists\r\n        if ($query->num_rows < 1) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$keynotfound\"\r\n            )), $enckey));\r\n        }\r\n        // if key does exist\r\n        elseif ($query->num_rows > 0) {\r\n            // get key info\r\n            while ($row = mysqli_fetch_array($query->result)) {\r\n                $expires = $row['expires'];\r\n                $status = $row['status'];\r\n                $level = $row['level'];\r\n                $banned = $row['banned'];\r\n            }\r\n\r\n            // check if used\r\n            if ($status == \"Used\") {\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keyused\"\r\n                )), $enckey));\r\n            }\r\n\r\n            if (!is_null($banned)) {\r\n                if (strpos($keybanned, '{reason}') !== false) {\r\n                    $keybanned = str_replace(\"{reason}\", $banned, $keybanned);\r\n                }\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keybanned\"\r\n                )), $enckey));\r\n            }\r\n\r\n            // add current time to key time\r\n            $expiry = $expires + time();\r\n\r\n            $query = misc\\mysql\\query(\"SELECT `name` FROM `subscriptions` WHERE `app` = ? AND `level` = ?\", [$secret, $level]);\r\n            $subName = mysqli_fetch_array($query->result)['name'];\r\n\r\n            $resp = misc\\user\\extend($username, $subName, $expiry, 0, $secret);\r\n            switch ($resp) {\r\n                case 'missing':\r\n                    die(api\\v1_0\\Encrypt(json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"$usernamenotfound\"\r\n                    )), $enckey));\r\n                case 'sub_missing':\r\n                    die(api\\v1_0\\Encrypt(json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"$nosublevel\"\r\n                    )), $enckey));\r\n                case 'failure':\r\n                    die(api\\v1_0\\Encrypt(json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"Failed to upgrade for some reason.\"\r\n                    )), $enckey));\r\n                case 'success':\r\n                    // set key to used, and set usedby\r\n                    misc\\mysql\\query(\"UPDATE `keys` SET `status` = 'Used', `usedon` = ?, `usedby` = ? WHERE `key` = ? AND `app` = ?\", [time(), $username, $checkkey, $secret]);\r\n                    misc\\cache\\purge('KeyAuthKeys:' . $secret . ':' . $checkkey);\r\n                    misc\\cache\\purge('KeyAuthSubs:' . $secret . ':' . $username);\r\n                    die(api\\v1_0\\Encrypt(json_encode(array(\r\n                        \"success\" => true,\r\n                        \"message\" => \"Upgraded successfully\"\r\n                    )), $enckey));\r\n                default:\r\n                    die(api\\v1_0\\Encrypt(json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"Unhandled Error! Contact us if you need help\"\r\n                    )), $enckey));\r\n            }\r\n        }\r\n\r\n    case 'login':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize(hex2bin($_POST['sessionid']));\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        // Read in username\r\n        $username = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['username'], $enckey));\r\n\r\n        // Read in HWID\r\n        $hwid = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['hwid'], $enckey));\r\n\r\n        // Read in password\r\n        $password = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['pass'], $enckey));\r\n\r\n        if(strlen($hwid) < $minHwid && !is_null($hwid)) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"HWID must be {$minHwid} or more characters, change this in app settings.\"\r\n            )), $enckey));\r\n        }\r\n\r\n        if($forceHwid && is_null($hwid)) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Force HWID is enabled, disable in app settings if you want to use blank HWIDs\"\r\n            )), $enckey));\r\n        }\r\n\r\n        $resp = api\\v1_0\\login($username, $password, $hwid, $secret, $hwidenabled);\r\n        switch ($resp) {\r\n            case 'un_not_found':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$usernamenotfound\"\r\n                )), $enckey));\r\n            case 'pw_mismatch':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$passmismatch\"\r\n                )), $enckey));\r\n            case 'user_banned':\r\n                if (strpos($userbanned, '{reason}') !== false) {\r\n                    $query = misc\\mysql\\query(\"SELECT `banned` FROM `users` WHERE `app` = ? AND `username` = ?\", [$secret, $username]);\r\n                    $row = mysqli_fetch_array($query->result);\r\n                    $reason = $row['banned'];\r\n                    $userbanned = str_replace(\"{reason}\", $reason, $userbanned);\r\n                }\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$userbanned\"\r\n                )), $enckey));\r\n            case 'hwid_mismatch':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$hwidmismatch\"\r\n                )), $enckey));\r\n            case 'hwid_blacked':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$hwidblacked\"\r\n                )), $enckey));\r\n            case 'sub_paused':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$pausedsub\"\r\n                )), $enckey));\r\n            case 'no_active_subs':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$noactivesubs\"\r\n                )), $enckey));\r\n            default:\r\n                misc\\mysql\\query(\"UPDATE `sessions` SET `validated` = 1,`credential` = ? WHERE `id` = ? AND `app` = ?\", [$username, $sessionid, $secret]);\r\n                misc\\cache\\update('KeyAuthState:'.$secret.':'.$sessionid.'', array(\"validated\" => 1, \"credential\" => $username));\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => true,\r\n                    \"message\" => \"$loggedInMsg\",\r\n                    \"info\" => $resp\r\n                )), $enckey));\r\n        }\r\n\r\n    case 'license':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize(hex2bin($_POST['sessionid']));\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n        $checkkey = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['key'], $enckey));\r\n\r\n        if(strlen($checkkey) > 70) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Key must be shorter than 70 characters\"\r\n            )), $enckey));\r\n        }\r\n\r\n        $hwid = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['hwid'], $enckey));\r\n\r\n        if(strlen($hwid) < $minHwid && !is_null($hwid)) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"HWID must be {$minHwid} or more characters, change this in app settings.\"\r\n            )), $enckey));\r\n        }\r\n\r\n        if($forceHwid && is_null($hwid)) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Force HWID is enabled, disable in app settings if you want to use blank HWIDs\"\r\n            )), $enckey));\r\n        }\r\n\r\n        $resp = api\\v1_0\\login($checkkey, $checkkey, $hwid, $secret, $hwidenabled);\r\n        switch ($resp) {\r\n            case 'un_not_found':\r\n                break; // user not registered yet or user was deleted\r\n            case 'hwid_mismatch':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$hwidmismatch\"\r\n                )), $enckey));\r\n            case 'user_banned':\r\n                if (strpos($userbanned, '{reason}') !== false) {\r\n                    $query = misc\\mysql\\query(\"SELECT `banned` FROM `users` WHERE `app` = ? AND `username` = ?\", [$secret, $checkkey]);\r\n                    $row = mysqli_fetch_array($query->result);\r\n                    $reason = $row['banned'];\r\n                    $userbanned = str_replace(\"{reason}\", $reason, $userbanned);\r\n                }\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$userbanned\"\r\n                )), $enckey));\r\n            case 'pw_mismatch':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$passmismatch\"\r\n                )), $enckey));\r\n            case 'sub_paused':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$pausedsub\"\r\n                )), $enckey));\r\n            case 'hwid_blacked':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$hwidblacked\"\r\n                )), $enckey));\r\n            case 'no_active_subs':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$noactivesubs\"\r\n                )), $enckey));\r\n            default:\r\n                misc\\mysql\\query(\"UPDATE `sessions` SET `validated` = 1,`credential` = ? WHERE `id` = ?\", [$checkkey, $sessionid]);\r\n                misc\\cache\\update('KeyAuthState:'.$secret.':'.$sessionid.'', array(\"validated\" => 1, \"credential\" => $checkkey));\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => true,\r\n                    \"message\" => \"$loggedInMsg\",\r\n                    \"info\" => $resp\r\n                )), $enckey));\r\n        }\r\n\r\n        // if login didn't work, attempt to register\r\n        $resp = api\\v1_0\\register($checkkey, $checkkey, $checkkey, NULL, $hwid, $secret);\r\n        switch ($resp) {\r\n            case 'username_taken':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$usernametaken\"\r\n                )), $enckey));\r\n            case 'key_not_found':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keynotfound\"\r\n                )), $enckey));\r\n            case 'un_too_short':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"Username too short, try longer one.\"\r\n                )), $enckey));\r\n            case 'pw_leaked':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$pwLeaked\"\r\n                )), $enckey));\r\n            case 'key_already_used':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keyused\"\r\n                )), $enckey));\r\n            case 'key_banned':\r\n                if (strpos($keybanned, '{reason}') !== false) {\r\n                    $query = misc\\mysql\\query(\"SELECT `banned` FROM `keys` WHERE `app` = ? AND `key` = ?\", [$secret, $checkkey]);\r\n                    $row = mysqli_fetch_array($query->result);\r\n                    $reason = $row['banned'];\r\n                    $keybanned = str_replace(\"{reason}\", $reason, $keybanned);\r\n                }\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keybanned\"\r\n                )), $enckey));\r\n            case 'hwid_blacked':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$hwidblacked\"\r\n                )), $enckey));\r\n            case 'no_subs_for_level':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$nosublevel\"\r\n                )), $enckey));\r\n            default:\r\n                misc\\mysql\\query(\"UPDATE `sessions` SET `validated` = 1,`credential` = ? WHERE `id` = ?\", [$checkkey, $sessionid]);\r\n                misc\\cache\\update('KeyAuthState:'.$secret.':'.$sessionid.'', array(\"validated\" => 1, \"credential\" => $checkkey));\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => true,\r\n                    \"message\" => \"$loggedInMsg\",\r\n                    \"info\" => $resp\r\n                )), $enckey));\r\n        }\r\n    case 'fetchOnline':\r\n        $sessionid = misc\\etc\\sanitize(hex2bin($_POST['sessionid']));\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        $rows = misc\\cache\\fetch('KeyAuthOnlineUsers:' . $secret, \"SELECT DISTINCT CONCAT(LEFT(`credential`, 10), IF(LENGTH(`credential`) > 10, REPEAT('*', LENGTH(`credential`) - 10), '')) AS `credential` FROM `sessions` WHERE `validated` = 1 AND `app` = ?\", [$secret], 1, 1800);\r\n\r\n        if ($rows == \"not_found\") {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"No online users found!\"\r\n            )), $enckey));\r\n        }\r\n\r\n        die(api\\v1_0\\Encrypt(json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"Successfully fetched online users.\",\r\n            \"users\" => $rows\r\n        )), $enckey));\r\n    case 'setvar':\r\n        $sessionid = misc\\etc\\sanitize(hex2bin($_POST['sessionid']));\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n        if (!$session[\"validated\"]) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            )), $enckey));\r\n        }\r\n\r\n        $var = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['var'], $enckey));\r\n        $data = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['data'], $enckey));\r\n\r\n        if(is_null($var)) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"No variable name provided\"\r\n            )), $enckey));\r\n        }\r\n\r\n        if(is_null($data)) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"No variable data provided\"\r\n            )), $enckey));\r\n        }\r\n\r\n        if(strlen($data) > 500) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Variable data must be 500 characters or less\"\r\n            )), $enckey));\r\n        }\r\n\r\n        $row = misc\\cache\\fetch('KeyAuthUserVar:' . $secret . ':' . $var . ':' . $session[\"credential\"], \"SELECT `data`, `readOnly` FROM `uservars` WHERE `name` = ? AND `user` = ? AND `app` = ?\", [$var, $session[\"credential\"], $secret], 0);\r\n\r\n        if ($row != \"not_found\") {\r\n            $readOnly = $row[\"readOnly\"];\r\n            if ($readOnly) {\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"Variable is read only\"\r\n                )), $enckey));\r\n            }\r\n        }\r\n\r\n        $query = misc\\mysql\\query(\"REPLACE INTO `uservars` (`name`, `data`, `user`, `app`) VALUES (?, ?, ?, ?)\", [$var, $data, $session[\"credential\"], $secret]);\r\n\r\n        if ($query->affected_rows != 0) {\r\n            misc\\cache\\purge('KeyAuthUserVar:' . $secret . ':' . $var . ':' . $session[\"credential\"]);\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"Successfully set variable\"\r\n            )), $enckey));\r\n        } else {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Failed to set variable\"\r\n            )), $enckey));\r\n        }\r\n    case 'getvar':\r\n        $sessionid = misc\\etc\\sanitize(hex2bin($_POST['sessionid']));\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n        if (!$session[\"validated\"]) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            )), $enckey));\r\n        }\r\n\r\n        $var = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['var'], $enckey));\r\n\r\n        $row = misc\\cache\\fetch('KeyAuthUserVar:' . $secret . ':' . $var . ':' . $session[\"credential\"], \"SELECT `data`, `readOnly` FROM `uservars` WHERE `name` = ? AND `user` = ? AND `app` = ?\", [$var, $session[\"credential\"], $secret], 0);\r\n\r\n        if ($row == \"not_found\") {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Variable not found for user\"\r\n            )), $enckey));\r\n        }\r\n\r\n        $data = $row['data'];\r\n        die(api\\v1_0\\Encrypt(json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"Successfully retrieved variable\",\r\n            \"response\" => $data\r\n        )), $enckey));\r\n    case 'var':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize(hex2bin($_POST['sessionid']));\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        $varid = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['varid'], $enckey));\r\n        $row = misc\\cache\\fetch('KeyAuthVar:' . $secret . ':' . $varid, \"SELECT `msg`, `authed` FROM `vars` WHERE `varid` = ? AND `app` = ?\", [$varid, $secret], 0);\r\n        if ($row == \"not_found\") {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Variable not found.\"\r\n            )), $enckey));\r\n        }\r\n\r\n        $msg = $row['msg'];\r\n        $authed = $row['authed'];\r\n\r\n        if ($authed) // if variable requires user to be authenticated\r\n\r\n        {\r\n            if (!$session[\"validated\"]) {\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$sessionunauthed\"\r\n                )), $enckey));\r\n            }\r\n        }\r\n        die(api\\v1_0\\Encrypt(json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"$msg\"\r\n        )), $enckey));\r\n    case 'checkblacklist':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize(hex2bin($_POST['sessionid']));\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        $hwid = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['hwid'], $enckey));\r\n        $ip = api\\shared\\primary\\getIp();\r\n        $row = misc\\cache\\fetch('KeyAuthBlacklist:' . $secret . ':' . $ip . ':' . $hwid, \"SELECT 1 FROM `bans` WHERE (`hwid` = ? OR `ip` = ?) AND `app` = ?\", [$hwid, $ip, $secret], 0);\r\n\r\n        if ($row != \"not_found\") {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"Client is blacklisted\"\r\n            )), $enckey));\r\n        } else {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Client is not blacklisted\"\r\n            )), $enckey));\r\n        }\r\n    case 'chatget':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize(hex2bin($_POST['sessionid']));\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n        if (!$session[\"validated\"]) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            )), $enckey));\r\n        }\r\n\r\n        $channel = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['channel'], $enckey));\r\n        $rows = misc\\cache\\fetch('KeyAuthChatMsgs:' . $secret . ':' . $channel, \"SELECT `author`, `message`, `timestamp` FROM `chatmsgs` WHERE `channel` = ? AND `app` = ?\", [$channel, $secret], 1);\r\n\r\n        if ($rows == \"not_found\") {\r\n            $rows = [];\r\n        }\r\n\r\n        die(api\\v1_0\\Encrypt(json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"Successfully retrieved chat messages\",\r\n            \"messages\" => $rows\r\n        )), $enckey));\r\n    case 'chatsend':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize(hex2bin($_POST['sessionid']));\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n        if (!$session[\"validated\"]) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            )), $enckey));\r\n        }\r\n\r\n        $channel = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['channel'], $enckey));\r\n        $query = misc\\mysql\\query(\"SELECT `delay` FROM `chats` WHERE `name` = ? AND `app` = ?\", [$channel, $secret]);\r\n\r\n        if ($query->num_rows < 1) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Chat channel not found\"\r\n            )), $enckey));\r\n        }\r\n\r\n        $row = mysqli_fetch_array($query->result);\r\n        $delay = $row['delay'];\r\n        $credential = $session[\"credential\"];\r\n        $query = misc\\mysql\\query(\"SELECT `timestamp` FROM `chatmsgs` WHERE `author` = ? AND `channel` = ? AND `app` = ? ORDER BY `id` DESC LIMIT 1\", [$credential, $channel, $secret]);\r\n\r\n        $row = mysqli_fetch_array($query->result);\r\n        $time = $row['timestamp'];\r\n\r\n        if (time() - $time < $delay) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$chatHitDelay\"\r\n            )), $enckey));\r\n        }\r\n\r\n        $query = misc\\mysql\\query(\"SELECT `time` FROM `chatmutes` WHERE `user` = ? AND `app` = ?\", [$credential, $secret]);\r\n        if ($query->num_rows != 0) {\r\n            $row = mysqli_fetch_array($query->result);\r\n            $unmuted = $row[\"time\"];\r\n            $unmuted = date(\"F j, Y, g:i a\", $unmuted);\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"You're muted from chat until $unmuted\"\r\n            )), $enckey));\r\n        }\r\n\r\n        $message = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['message'], $enckey));\r\n\r\n        if (is_null($message)) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Message can't be blank\"\r\n            )), $enckey));\r\n        }\r\n\r\n        if(strlen($message) > 2000) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Message too long!\"\r\n            )), $enckey));\r\n        }\r\n\r\n        misc\\mysql\\query(\"INSERT INTO `chatmsgs` (`author`, `message`, `timestamp`, `channel`,`app`) VALUES (?, ?, ?, ?, ?)\", [$credential, $message, time(), $channel, $secret]);\r\n        misc\\mysql\\query(\"DELETE FROM `chatmsgs` WHERE `app` = ? AND `channel` = ? AND `id` NOT IN ( SELECT `id` FROM ( SELECT `id` FROM `chatmsgs` WHERE `channel` = ? AND `app` = ? ORDER BY `id` DESC LIMIT 50) foo );\", [$secret, $channel, $channel, $secret]);\r\n        misc\\cache\\purge('KeyAuthChatMsgs:' . $secret . ':' . $channel);\r\n        die(api\\v1_0\\Encrypt(json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"Successfully sent chat message\"\r\n        )), $enckey));\r\n    case 'log':\r\n        // client isn't expecting a response body, just flush output right away so program can move on to rest of the code quicker\r\n        fastcgi_finish_request();\r\n\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize(hex2bin($_POST['sessionid']));\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        $credential = $session[\"credential\"];\r\n\r\n        $currtime = time();\r\n\r\n        $msg = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['message'], $enckey));\r\n\r\n        if(is_null($msg)) {\r\n            die();\r\n        }\r\n\r\n        if(strlen($msg) > 275) {\r\n            die(\"Log data too long\");\r\n        }\r\n\r\n        $pcuser = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['pcuser'], $enckey));\r\n\r\n        if (is_null($webhook)) {\r\n            $roleCheck = misc\\cache\\fetch('KeyAuthSellerCheck:' . $owner, \"SELECT `role`,`expires` FROM `accounts` WHERE `username` = ?\", [$owner], 0);\r\n            if($roleCheck['role'] == \"tester\") {\r\n                $query = misc\\mysql\\query(\"SELECT count(*) AS 'numLogs' FROM `logs` WHERE `logapp` = ?\",[$secret]);\r\n                $row = mysqli_fetch_array($query->result);\r\n                $numLogs = $row[\"numLogs\"];\r\n                if($numLogs >= 20) {\r\n                    die();\r\n                }\r\n            }\r\n\r\n            misc\\mysql\\query(\"INSERT INTO `logs` (`logdate`, `logdata`, `credential`, `pcuser`,`logapp`) VALUES (?, ?, NULLIF(?, ''), NULLIF(?, ''), ?)\", [$currtime, $msg, $credential, $pcuser, $secret]);\r\n            die();\r\n        }\r\n\r\n        $credential = $session[\"credential\"] ?? \"N/A\";\r\n\r\n        $msg = \"📜 Log: \" . $msg;\r\n\r\n        $ip = api\\shared\\primary\\getIp();\r\n\r\n        $json_data = json_encode([\r\n            // Embeds Array\r\n            \"embeds\" => [\r\n                [\r\n                    // Embed Title\r\n                    \"title\" => $msg,\r\n\r\n                    // Embed left border color in HEX\r\n                    \"color\" => hexdec(\"00ffe1\"),\r\n\r\n                    // Additional Fields array\r\n                    \"fields\" => [[\"name\" => \"🔐 Credential:\", \"value\" => \"```\" . $credential . \"```\"], [\"name\" => \"💻 PC Name:\", \"value\" => \"```\" . $pcuser . \"```\", \"inline\" => true], [\"name\" => \"🌎 Client IP:\", \"value\" => \"```\" . $ip . \"```\", \"inline\" => true]]\r\n                ]\r\n            ]\r\n\r\n        ], JSON_UNESCAPED_SLASHES | JSON_UNESCAPED_UNICODE);\r\n\r\n        $ch = curl_init($webhook);\r\n\r\n        curl_setopt($ch, CURLOPT_HTTPHEADER, array(\r\n            'Content-type: application/json'\r\n        ));\r\n\r\n        curl_setopt($ch, CURLOPT_POST, 1);\r\n\r\n        curl_setopt($ch, CURLOPT_POSTFIELDS, $json_data);\r\n\r\n        curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);\r\n\r\n        curl_setopt($ch, CURLOPT_HEADER, 0);\r\n\r\n        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\r\n\r\n        $response = curl_exec($ch);\r\n\r\n        curl_close($ch);\r\n        die();\r\n\r\n    case 'webhook':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize(hex2bin($_POST['sessionid']));\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        $webid = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['webid'], $enckey));\r\n\r\n        $row = misc\\cache\\fetch('KeyAuthWebhook:' . $secret . ':' . $webid, \"SELECT `baselink`, `useragent`, `authed` FROM `webhooks` WHERE `webid` = ? AND `app` = ?\", [$webid, $secret], 0);\r\n        if ($row == \"not_found\") {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Webhook Not Found.\"\r\n            )), $enckey));\r\n        }\r\n\r\n        $baselink = $row['baselink'];\r\n\r\n        $useragent = $row['useragent'];\r\n\r\n        $authed = $row['authed'];\r\n\r\n        if ($authed) // if variable requires user to be authenticated\r\n\r\n        {\r\n            if (!$session[\"validated\"]) {\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$sessionunauthed\"\r\n                )), $enckey));\r\n            }\r\n        }\r\n\r\n        $params = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['params'], $enckey));\r\n        $body = api\\v1_0\\Decrypt($_POST['body'], $enckey);\r\n        $contType = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['conttype'], $enckey));\r\n\r\n        $url = $baselink .= urldecode($params);\r\n\r\n        $ch = curl_init($url);\r\n\r\n        curl_setopt($ch, CURLOPT_USERAGENT, $useragent);\r\n\r\n        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\r\n\r\n        if (!is_null($body)) curl_setopt($ch, CURLOPT_POSTFIELDS, $body);\r\n\r\n        if (!is_null($contType)) curl_setopt($ch, CURLOPT_HTTPHEADER, array(\r\n            'Content-Type: ' . $contType\r\n        ));\r\n\r\n        $response = curl_exec($ch);\r\n        die(api\\v1_0\\Encrypt(json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"Webhook request successful\",\r\n            \"response\" => \"$response\"\r\n        )), $enckey));\r\n    case 'file':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize(hex2bin($_POST['sessionid']));\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        $fileid = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['fileid'], $enckey));\r\n\r\n        $row = misc\\cache\\fetch('KeyAuthFile:' . $secret . ':' . $fileid, \"SELECT `name`, `url`, `authed` FROM `files` WHERE `app` = ? AND `id` = ?\", [$secret, $fileid], 0);\r\n\r\n        if ($row == \"not_found\") {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"File not Found\"\r\n            )), $enckey));\r\n        }\r\n\r\n        $filename = $row['name'];\r\n        $url = $row['url'];\r\n        $authed = $row['authed'];\r\n\r\n        if ($authed) // if file requires user to be authenticated\r\n\r\n        {\r\n            if (!$session[\"validated\"]) {\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$sessionunauthed\"\r\n                )), $enckey));\r\n            }\r\n        }\r\n\r\n        ini_set('memory_limit', '-1');\r\n\r\n        $ch = curl_init($url);\r\n        curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);\r\n        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\r\n        $data = curl_exec($ch);\r\n        $statusCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);\r\n\r\n        if ($statusCode == 403 || $statusCode == 404) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"File no longer works, please notify the application developer.\"\r\n            )), $enckey));\r\n        }\r\n        $contents = bin2hex($data);\r\n        die(api\\v1_0\\Encrypt(json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"File download successful\",\r\n            \"contents\" => \"$contents\"\r\n        )), $enckey));\r\n\r\n    case 'ban':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize(hex2bin($_POST['sessionid']));\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        $credential = $session[\"credential\"];\r\n        if (!$session[\"validated\"]) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            )), $enckey));\r\n        }\r\n\r\n        $reason = misc\\etc\\sanitize($_POST['reason']) ?? \"User banned from triggering ban function in the client\";\r\n\r\n        if(strlen($reason) > 99) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Reason must be 99 characters or less\"\r\n            )), $enckey));\r\n        }\r\n\r\n        $hwid = misc\\etc\\sanitize(api\\v1_0\\Decrypt($_POST['hwid'], $enckey));\r\n        if (!empty($hwid)) {\r\n            misc\\blacklist\\add($hwid, \"Hardware ID\", $secret);\r\n        }\r\n        $ip = api\\shared\\primary\\getIp();\r\n        misc\\blacklist\\add($ip, \"IP Address\", $secret);\r\n\r\n        misc\\mysql\\query(\"UPDATE `users` SET `banned` = ? WHERE `username` = ? AND `app` = ?\", [$reason, $credential, $secret]);\r\n\r\n        if ($query->affected_rows != 0) {\r\n            misc\\cache\\purge('KeyAuthUser:' . $secret . ':' . $credential);\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"Successfully Banned User\"\r\n            )), $enckey));\r\n        } else {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Failed to ban user.\"\r\n            )), $enckey));\r\n        }\r\n    case 'check':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize(hex2bin($_POST['sessionid']));\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        $credential = $session[\"credential\"];\r\n        if (!$session[\"validated\"]) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            )), $enckey));\r\n        } else {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"Session is validated.\"\r\n            )), $enckey));\r\n        }\r\n    case 'changeUsername':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize(hex2bin($_POST['sessionid']));\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        if (!$session[\"validated\"]) {\r\n            die(api\\v1_0\\Encrypt(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            )), $enckey));\r\n        }\r\n\r\n        $credential = $session[\"credential\"];\r\n\r\n        $resp = misc\\user\\changeUsername($credential, $_POST['newUsername'], $secret);\r\n        switch ($resp) {\r\n            case 'already_used':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"Username already used!\"\r\n                )), $enckey));\r\n            case 'failure':\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"Failed to change username!\"\r\n                )), $enckey));\r\n            case 'success':\r\n                misc\\session\\killSingular($sessionid, $secret);\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => true,\r\n                    \"message\" => \"Successfully changed username, user logged out.\"\r\n                )), $enckey));\r\n            default:\r\n                die(api\\v1_0\\Encrypt(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"Unhandled Error! Contact us if you need help\"\r\n                )), $enckey));\r\n        }\r\n    default:\r\n        die(json_encode(array(\r\n            \"success\" => false,\r\n            \"message\" => \"Unhandled Type\"\r\n        )));\r\n}\r\n","size_bytes":49051},"api/1.1/index.php":{"content":"<?php\r\ninclude '../../includes/misc/autoload.phtml';\r\ninclude '../../includes/api/shared/autoload.phtml';\r\ninclude '../../includes/api/1.0/autoload.phtml';\r\n\r\nheader(\"Access-Control-Allow-Origin: *\"); // allow browser applications to request API\r\nheader('Content-Type: application/json; charset=utf-8');\r\n\r\nset_exception_handler(function ($exception) {\r\n    error_log(\"\\n--------------------------------------------------------------\\n\");\r\n    error_log($exception);\r\n    error_log(\"\\nRequest data:\");\r\n    error_log(print_r($_POST, true));\r\n    error_log(\"\\n--------------------------------------------------------------\");\r\n    http_response_code(500);\r\n    $errorMsg = str_replace($databaseUsername, \"REDACTED\", $exception->getMessage());\r\n    die(json_encode(array(\"success\" => false, \"message\" => \"Error: \" . $errorMsg)));\r\n});\r\n\r\nif(empty(($_POST['ownerid'] ?? $_GET['ownerid']))) {\r\n    die(json_encode(array(\"success\" => false, \"message\" => \"No OwnerID specified. Select app & copy code snippet from https://keyauth.cc/app/\")));\r\n}\r\n\r\nif(empty(($_POST['name'] ?? $_GET['name']))) {\r\n    die(json_encode(array(\"success\" => false, \"message\" => \"No app name specified. Select app & copy code snippet from https://keyauth.cc/app/\")));\r\n}\r\n\r\nif(strlen(($_POST['ownerid'] ?? $_GET['ownerid'])) != 10) {\r\n    die(json_encode(array(\"success\" => false, \"message\" => \"OwnerID should be 10 characters long. Select app & copy code snippet from https://keyauth.cc/app/\")));\r\n}\r\n\r\n$ownerid = misc\\etc\\sanitize($_POST['ownerid'] ?? $_GET['ownerid']); // ownerid of account that owns application\r\n$name = misc\\etc\\sanitize($_POST['name'] ?? $_GET['name']); // application name\r\n$row = misc\\cache\\fetch('KeyAuthApp:' . $name . ':' . $ownerid, \"SELECT * FROM `apps` WHERE `ownerid` = ? AND `name` = ?\", [$ownerid, $name], 0);\r\n\r\nif ($row == \"not_found\") {\r\n    die(\"KeyAuth_Invalid\");\r\n}\r\n\r\n// app settings\r\n$secret = $row['secret'];\r\n$hwidenabled = $row['hwidcheck'];\r\n$vpnblock = $row['vpnblock'];\r\n$status = $row['enabled'];\r\n$paused = $row['paused'];\r\n$currentver = $row['ver'];\r\n$download = $row['download'];\r\n$webhook = $row['webhook'];\r\n$appdisabled = $row['appdisabled'];\r\n$hashcheck = $row['hashcheck'];\r\n$serverhash = $row['hash'];\r\n$sessionexpiry = $row['session'];\r\n$forceHwid = $row['forceHwid'];\r\n\r\n$banned = $row['banned'];\r\n$owner = $row['owner'];\r\n$name = $row['name'];\r\n\r\n// custom error messages\r\n$usernametaken = $row['usernametaken'];\r\n$keynotfound = $row['keynotfound'];\r\n$keyused = $row['keyused'];\r\n$nosublevel = $row['nosublevel'];\r\n$usernamenotfound = $row['usernamenotfound'];\r\n$passmismatch = $row['passmismatch'];\r\n$hwidmismatch = $row['hwidmismatch'];\r\n$noactivesubs = $row['noactivesubs'];\r\n$hwidblacked = $row['hwidblacked'];\r\n$pausedsub = $row['pausedsub'];\r\n$vpnblocked = $row['vpnblocked'];\r\n$keybanned = $row['keybanned'];\r\n$userbanned = $row['userbanned'];\r\n$sessionunauthed = $row['sessionunauthed'];\r\n$hashcheckfail = $row['hashcheckfail'];\r\n\r\n// why using null coalescing operators? because if I add a field and it's not in redis cache, it'll be NULL\r\n$loggedInMsg = $row['loggedInMsg'] ?? \"Logged in!\";\r\n$pausedApp = $row['pausedApp'] ?? \"Application is currently paused, please wait for the developer to say otherwise.\";\r\n$unTooShort = $row['unTooShort'] ?? \"Username too short, try longer one.\";\r\n$pwLeaked = $row['pwLeaked'] ?? \"This password has been leaked in a data breach (not from us), please use a different one.\";\r\n$chatHitDelay = $row['chatHitDelay'] ?? \"Chat slower, you've hit the delay limit\";\r\n$minHwid = $row['minHwid'] ?? 20;\r\n\r\nif ($banned) {\r\n    die(json_encode(array(\r\n        \"success\" => false,\r\n        \"message\" => \"This application has been banned from KeyAuth.cc for violating terms.\" // yes we self promote to customers of those who break ToS. Should've followed terms :shrug:\r\n    )));\r\n}\r\n\r\nswitch ($_POST['type'] ?? $_GET['type']) {\r\n    case 'init':\r\n        $ip = api\\shared\\primary\\getIp();\r\n        if ($vpnblock) {\r\n            if (api\\shared\\primary\\vpnCheck($ip)) {\r\n                $row = misc\\cache\\fetch('KeyAuthWhitelist:' . $secret . ':' . $ip, \"SELECT 1 FROM `whitelist` WHERE `ip` = ? AND `app` = ?\", [$ip, $secret], 0);\r\n                if ($row == \"not_found\") {\r\n                    die(json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"$vpnblocked\"\r\n                    )));\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!$status) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$appdisabled\"\r\n            )));\r\n        }\r\n\r\n        if ($paused) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$pausedApp\"\r\n            )));\r\n        }\r\n\r\n        $ver = misc\\etc\\sanitize($_POST['ver'] ?? $_GET['ver']);\r\n        if (!empty($ver)) {\r\n            if ($ver != $currentver) {\r\n                // auto-update system\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"invalidver\",\r\n                    \"download\" => \"$download\"\r\n                ), JSON_UNESCAPED_SLASHES));\r\n            }\r\n        }\r\n\r\n        $hash = misc\\etc\\sanitize($_POST['hash'] ?? $_GET['hash']);\r\n\r\n        if ($hashcheck) {\r\n            if (strpos($serverhash, $hash) === false) {\r\n                if (is_null($serverhash)) {\r\n                    misc\\mysql\\query(\"UPDATE `apps` SET `hash` = ? WHERE `secret` = ?\", [$hash, $secret]);\r\n                    misc\\cache\\purge('KeyAuthApp:' . $name . ':' . $ownerid); // flush cache for application so new hash takes precedent\r\n                } else {\r\n                    die(json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"$hashcheckfail\"\r\n                    )));\r\n                }\r\n            }\r\n        }\r\n\r\n        $newSession = false;\r\n        $duplicateSession = misc\\cache\\select(\"KeyAuthSessionDupe:$secret:$ip\");\r\n        if($duplicateSession) {\r\n            $sessionid = $duplicateSession;\r\n            $updateSession = misc\\cache\\update('KeyAuthState:'.$secret.':'.$sessionid.'', array(\"validated\" => 0));\r\n            if(!$updateSession) {\r\n                $sessionid = misc\\etc\\generateRandomString();\r\n                $newSession = true;\r\n            }\r\n        }\r\n        else {\r\n            $sessionid = misc\\etc\\generateRandomString();\r\n            $newSession = true;\r\n        }\r\n        \r\n        // $row = misc\\cache\\fetch('KeyAuthAppStats:' . $secret, \"SELECT (SELECT COUNT(1) FROM `users` WHERE `app` = ?) AS 'numUsers', (SELECT COUNT(1) FROM `sessions` WHERE `app` = ? AND `validated` = 1 AND `expiry` > ?) AS 'numOnlineUsers', (SELECT COUNT(1) FROM `keys` WHERE `app` = ?) AS 'numKeys' FROM dual\", [$secret, $secret, time(), $secret], 0, 3600);\r\n\r\n        $numUsers = \"N/A - Use fetchStats() function in latest example\";\r\n        $numOnlineUsers = \"N/A - Use fetchStats() function in latest example\";\r\n        $numKeys = \"N/A - Use fetchStats() function in latest example\";\r\n\r\n        echo json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"Initialized\",\r\n            \"sessionid\" => $sessionid,\r\n            \"appinfo\" => array(\r\n                \"numUsers\" => \"$numUsers\",\r\n                \"numOnlineUsers\" => \"$numOnlineUsers\",\r\n                \"numKeys\" => \"$numKeys\",\r\n                \"version\" => \"$currentver\",\r\n                \"customerPanelLink\" => \"https://keyauth.cc/panel/$owner/$name/\"\r\n            )\r\n        ));\r\n\r\n        fastcgi_finish_request();\r\n\r\n        if($newSession) {\r\n            misc\\cache\\insert(\"KeyAuthState:$secret:$sessionid\", serialize(array(\"credential\" => NULL, \"enckey\" => NULL, \"validated\" => 0)), $sessionexpiry);\r\n            $time = time() + $sessionexpiry;\r\n            misc\\mysql\\query(\"INSERT INTO `sessions` (`id`, `app`, `expiry`, `created_at`, `ip`) VALUES (?, ?, ?, ?, ?)\", [$sessionid, $secret, $time, time(), $ip]);\r\n            misc\\cache\\insert(\"KeyAuthSessionDupe:$secret:$ip\", $sessionid, $sessionexpiry);\r\n        }\r\n\r\n    case 'register':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n\r\n        // Read in username\r\n        $username = misc\\etc\\sanitize($_POST['username'] ?? $_GET['username']);\r\n\r\n        if(strlen($username) > 70) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Username must be shorter than 70 characters\"\r\n            )));\r\n        }\r\n\r\n        // Read in license key\r\n        $checkkey = misc\\etc\\sanitize($_POST['key'] ?? $_GET['key']);\r\n\r\n        if(strlen($checkkey) > 70) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Key must be shorter than 70 characters\"\r\n            )));\r\n        }\r\n\r\n        // Read in password\r\n        $password = misc\\etc\\sanitize($_POST['pass'] ?? $_GET['pass']);\r\n\r\n        // Read in email\r\n        $email = misc\\etc\\sanitize($_POST['email'] ?? $_GET['email']);\r\n\r\n        // Read in hwid\r\n        $hwid = misc\\etc\\sanitize($_POST['hwid'] ?? $_GET['hwid']);\r\n\r\n        $resp = api\\v1_0\\register($username, $checkkey, $password, $email, $hwid, $secret);\r\n        switch ($resp) {\r\n            case 'username_taken':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$usernametaken\"\r\n                )));\r\n            case 'key_not_found':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keynotfound\"\r\n                )));\r\n            case 'un_too_short':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$unTooShort\"\r\n                )));\r\n            case 'pw_leaked':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$pwLeaked\"\r\n                )));\r\n            case 'key_already_used':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keyused\"\r\n                )));\r\n            case 'key_banned':\r\n                if (strpos($keybanned, '{reason}') !== false) {\r\n                    $query = misc\\mysql\\query(\"SELECT `banned` FROM `keys` WHERE `app` = ? AND `key` = ?\", [$secret, $checkkey]);\r\n                    $row = mysqli_fetch_array($query->result);\r\n                    $reason = $row['banned'];\r\n                    $keybanned = str_replace(\"{reason}\", $reason, $keybanned);\r\n                }\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keybanned\"\r\n                )));\r\n            case 'hwid_blacked':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$hwidblacked\"\r\n                )));\r\n            case 'no_subs_for_level':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$nosublevel\"\r\n                )));\r\n            default:\r\n                misc\\mysql\\query(\"UPDATE `sessions` SET `credential` = ?,`validated` = 1 WHERE `id` = ?\", [$username, $sessionid]);\r\n                misc\\cache\\update('KeyAuthState:'.$secret.':'.$sessionid.'', array(\"validated\" => 1, \"credential\" => $username));\r\n\r\n                $ip = api\\shared\\primary\\getIp();\r\n                die(json_encode(array(\r\n                    \"success\" => true,\r\n                    \"message\" => \"$loggedInMsg\",\r\n                    \"info\" => $resp\r\n                )));\r\n        }\r\n    case 'upgrade':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n\r\n        // Read in username\r\n        $username = misc\\etc\\sanitize($_POST['username'] ?? $_GET['username']);\r\n\r\n        // Read in key\r\n        $checkkey = misc\\etc\\sanitize($_POST['key'] ?? $_GET['key']);\r\n\r\n\r\n        // search for key\r\n        $query = misc\\mysql\\query(\"SELECT `banned`, `expires`, `status`, `level` FROM `keys` WHERE `key` = ? AND `app` = ?\", [$checkkey, $secret]);\r\n\r\n        // check if key exists\r\n        if ($query->num_rows < 1) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$keynotfound\"\r\n            )));\r\n        }\r\n\r\n        // if key does exist\r\n        elseif ($query->num_rows > 0) {\r\n\r\n            // get key info\r\n            while ($row = mysqli_fetch_array($query->result)) {\r\n                $expires = $row['expires'];\r\n                $status = $row['status'];\r\n                $level = $row['level'];\r\n                $banned = $row['banned'];\r\n            }\r\n\r\n            // check if used\r\n            if ($status == \"Used\") {\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keyused\"\r\n                )));\r\n            }\r\n\r\n            if (!is_null($banned)) {\r\n                if (strpos($keybanned, '{reason}') !== false) {\r\n                    $keybanned = str_replace(\"{reason}\", $banned, $keybanned);\r\n                }\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keybanned\"\r\n                )));\r\n            }\r\n\r\n            // add current time to key time\r\n            $expiry = $expires + time();\r\n\r\n            $query = misc\\mysql\\query(\"SELECT `name` FROM `subscriptions` WHERE `app` = ? AND `level` = ?\", [$secret, $level]);\r\n            $subName = mysqli_fetch_array($query->result)['name'];\r\n\r\n            $resp = misc\\user\\extend($username, $subName, $expiry, 0, $secret);\r\n            switch ($resp) {\r\n                case 'missing':\r\n                    die(json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"$usernamenotfound\"\r\n                    )));\r\n                case 'sub_missing':\r\n                    die(json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"$nosublevel\"\r\n                    )));\r\n                case 'failure':\r\n                    die(json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"Failed to upgrade for some reason.\"\r\n                    )));\r\n                case 'success':\r\n                    // set key to used, and set usedby\r\n                    misc\\mysql\\query(\"UPDATE `keys` SET `status` = 'Used', `usedon` = ?, `usedby` = ? WHERE `key` = ? AND `app` = ?\", [time(), $username, $checkkey, $secret]);\r\n                    misc\\cache\\purge('KeyAuthKeys:' . $secret . ':' . $checkkey);\r\n                    misc\\cache\\purge('KeyAuthSubs:' . $secret . ':' . $username);\r\n                    die(json_encode(array(\r\n                        \"success\" => true,\r\n                        \"message\" => \"Upgraded successfully\"\r\n                    )));\r\n                default:\r\n                    die(json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"Unhandled Error! Contact us if you need help\"\r\n                    )));\r\n            }\r\n        }\r\n\r\n    case 'login':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n\r\n        // Read in username\r\n        $username = misc\\etc\\sanitize($_POST['username'] ?? $_GET['username']);\r\n\r\n        // Read in HWID\r\n        $hwid = misc\\etc\\sanitize($_POST['hwid'] ?? $_GET['hwid']);\r\n\r\n        // Read in password\r\n        $password = misc\\etc\\sanitize($_POST['pass'] ?? $_GET['pass']);\r\n\r\n        // optional param for web loader\r\n        $token = misc\\etc\\sanitize($_POST['token'] ?? $_GET['token']);\r\n\r\n        if(strlen($hwid) < $minHwid && !is_null($hwid)) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"HWID must be {$minHwid} or more characters, change this in app settings.\"\r\n            )));\r\n        }\r\n\r\n        if($forceHwid && is_null($hwid)) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Force HWID is enabled, disable in app settings if you want to use blank HWIDs\"\r\n            )));\r\n        }\r\n\r\n        $resp = api\\v1_0\\login($username, $password, $hwid, $secret, $hwidenabled, $token);\r\n        switch ($resp) {\r\n            case 'un_not_found':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$usernamenotfound\"\r\n                )));\r\n            case 'pw_mismatch':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$passmismatch\"\r\n                )));\r\n            case 'user_banned':\r\n                if (strpos($userbanned, '{reason}') !== false) {\r\n                    $query = misc\\mysql\\query(\"SELECT `banned` FROM `users` WHERE `app` = ? AND `username` = ?\", [$secret, $username]);\r\n                    $row = mysqli_fetch_array($query->result);\r\n                    $reason = $row['banned'];\r\n                    $userbanned = str_replace(\"{reason}\", $reason, $userbanned);\r\n                }\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$userbanned\"\r\n                )));\r\n            case 'hwid_mismatch':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$hwidmismatch\"\r\n                )));\r\n            case 'hwid_blacked':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$hwidblacked\"\r\n                )));\r\n            case 'sub_paused':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$pausedsub\"\r\n                )));\r\n            case 'no_active_subs':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$noactivesubs\"\r\n                )));\r\n            default:\r\n                misc\\mysql\\query(\"UPDATE `sessions` SET `validated` = 1,`credential` = ? WHERE `id` = ?\", [$username, $sessionid]);\r\n                misc\\cache\\update('KeyAuthState:'.$secret.':'.$sessionid.'', array(\"validated\" => 1, \"credential\" => $username));\r\n\r\n                $ip = api\\shared\\primary\\getIp();\r\n                die(json_encode(array(\r\n                    \"success\" => true,\r\n                    \"message\" => \"$loggedInMsg\",\r\n                    \"info\" => $resp\r\n                )));\r\n        }\r\n\r\n    case 'license':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $checkkey = misc\\etc\\sanitize($_POST['key'] ?? $_GET['key']);\r\n\r\n        if(strlen($checkkey) > 70) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Key must be shorter than 70 characters\"\r\n            )));\r\n        }\r\n\r\n        $hwid = misc\\etc\\sanitize($_POST['hwid'] ?? $_GET['hwid']);\r\n\r\n        if(strlen($hwid) < $minHwid && !is_null($hwid)) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"HWID must be {$minHwid} or more characters, change this in app settings.\"\r\n            )));\r\n        }\r\n        \r\n        if($forceHwid && is_null($hwid)) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Force HWID is enabled, disable in app settings if you want to use blank HWIDs\"\r\n            )));\r\n        }\r\n\r\n        $resp = api\\v1_0\\login($checkkey, $checkkey, $hwid, $secret, $hwidenabled);\r\n        switch ($resp) {\r\n            case 'un_not_found':\r\n                break; // user not registered yet or user was deleted\r\n            case 'hwid_mismatch':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$hwidmismatch\"\r\n                )));\r\n            case 'user_banned':\r\n                if (strpos($userbanned, '{reason}') !== false) {\r\n                    $query = misc\\mysql\\query(\"SELECT `banned` FROM `users` WHERE `app` = ? AND `username` = ?\", [$secret, $checkkey]);\r\n                    $row = mysqli_fetch_array($query->result);\r\n                    $reason = $row['banned'];\r\n                    $userbanned = str_replace(\"{reason}\", $reason, $userbanned);\r\n                }\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$userbanned\"\r\n                )));\r\n            case 'pw_mismatch':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$passmismatch\"\r\n                )));\r\n            case 'sub_paused':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$pausedsub\"\r\n                )));\r\n            case 'hwid_blacked':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$hwidblacked\"\r\n                )));\r\n            case 'no_active_subs':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$noactivesubs\"\r\n                )));\r\n            default:\r\n                misc\\mysql\\query(\"UPDATE `sessions` SET `validated` = 1,`credential` = ? WHERE `id` = ?\", [$checkkey, $sessionid]);\r\n                misc\\cache\\update('KeyAuthState:'.$secret.':'.$sessionid.'', array(\"validated\" => 1, \"credential\" => $checkkey));\r\n\r\n                $ip = api\\shared\\primary\\getIp();\r\n                die(json_encode(array(\r\n                    \"success\" => true,\r\n                    \"message\" => \"$loggedInMsg\",\r\n                    \"info\" => $resp\r\n                )));\r\n        }\r\n\r\n        // if login didn't work, attempt to register\r\n        $resp = api\\v1_0\\register($checkkey, $checkkey, $checkkey, NULL, $hwid, $secret);\r\n        switch ($resp) {\r\n            case 'username_taken':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$usernametaken\"\r\n                )));\r\n            case 'key_not_found':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keynotfound\"\r\n                )));\r\n            case 'un_too_short':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$unTooShort\"\r\n                )));\r\n            case 'pw_leaked':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$pwLeaked\"\r\n                )));\r\n            case 'key_already_used':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keyused\"\r\n                )));\r\n            case 'key_banned':\r\n                if (strpos($keybanned, '{reason}') !== false) {\r\n                    $query = misc\\mysql\\query(\"SELECT `banned` FROM `keys` WHERE `app` = ? AND `key` = ?\", [$secret, $checkkey]);\r\n                    $row = mysqli_fetch_array($query->result);\r\n                    $reason = $row['banned'];\r\n                    $keybanned = str_replace(\"{reason}\", $reason, $keybanned);\r\n                }\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keybanned\"\r\n                )));\r\n            case 'hwid_blacked':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$hwidblacked\"\r\n                )));\r\n            case 'no_subs_for_level':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$nosublevel\"\r\n                )));\r\n            default:\r\n                misc\\mysql\\query(\"UPDATE `sessions` SET `validated` = 1,`credential` = ? WHERE `id` = ?\", [$checkkey, $sessionid]);\r\n                misc\\cache\\update('KeyAuthState:'.$secret.':'.$sessionid.'', array(\"validated\" => 1, \"credential\" => $checkkey));\r\n\r\n                $ip = api\\shared\\primary\\getIp();\r\n                die(json_encode(array(\r\n                    \"success\" => true,\r\n                    \"message\" => \"$loggedInMsg\",\r\n                    \"info\" => $resp\r\n                )));\r\n        }\r\n    case 'fetchOnline':\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n\r\n        $rows = misc\\cache\\fetch('KeyAuthOnlineUsers:' . $secret, \"SELECT DISTINCT CONCAT(LEFT(`credential`, 10), IF(LENGTH(`credential`) > 10, REPEAT('*', LENGTH(`credential`) - 10), '')) AS `credential` FROM `sessions` WHERE `validated` = 1 AND `app` = ?\", [$secret], 1, 1800);\r\n\r\n        if ($rows == \"not_found\") {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"No online users found!\"\r\n            )));\r\n        }\r\n\r\n        die(json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"Successfully fetched online users.\",\r\n            \"users\" => $rows\r\n        )));\r\n    case 'setvar':\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        if (!$session[\"validated\"]) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            )));\r\n        }\r\n\r\n        $var = misc\\etc\\sanitize($_POST['var'] ?? $_GET['var']);\r\n        $data = misc\\etc\\sanitize($_POST['data'] ?? $_GET['data']);\r\n\r\n        if(is_null($var)) {\r\n            die(json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"No variable name provided\"\r\n            )));\r\n        }\r\n\r\n        if(is_null($data)) {\r\n            die(json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"No variable data provided\"\r\n            )));\r\n        }\r\n\r\n        if(strlen($data) > 500) {\r\n            die(json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"Variable data must be 500 characters or less\"\r\n            )));\r\n        }\r\n\r\n        $row = misc\\cache\\fetch('KeyAuthUserVar:' . $secret . ':' . $var . ':' . $session[\"credential\"], \"SELECT `data`, `readOnly` FROM `uservars` WHERE `name` = ? AND `user` = ? AND `app` = ?\", [$var, $session[\"credential\"], $secret], 0);\r\n\r\n        if ($row != \"not_found\") {\r\n            $readOnly = $row[\"readOnly\"];\r\n            if ($readOnly) {\r\n                die(json_encode(array(\r\n                    \"success\" => true,\r\n                    \"message\" => \"Variable is read only\"\r\n                )));\r\n            }\r\n        }\r\n\r\n        $query = misc\\mysql\\query(\"REPLACE INTO `uservars` (`name`, `data`, `user`, `app`) VALUES (?, ?, ?, ?)\", [$var, $data, $session[\"credential\"], $secret]);\r\n\r\n        if ($query->affected_rows != 0) {\r\n            misc\\cache\\purge('KeyAuthUserVar:' . $secret . ':' . $var . ':' . $session[\"credential\"]);\r\n            die(json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"Successfully set variable\"\r\n            )));\r\n        } else {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Failed to set variable\"\r\n            )));\r\n        }\r\n    case 'getvar':\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        if (!$session[\"validated\"]) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            )));\r\n        }\r\n\r\n        $var = misc\\etc\\sanitize($_POST['var'] ?? $_GET['var']);\r\n\r\n        $row = misc\\cache\\fetch('KeyAuthUserVar:' . $secret . ':' . $var . ':' . $session[\"credential\"], \"SELECT `data`, `readOnly` FROM `uservars` WHERE `name` = ? AND `user` = ? AND `app` = ?\", [$var, $session[\"credential\"], $secret], 0);\r\n\r\n        if ($row == \"not_found\") {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Variable not found for user\"\r\n            )));\r\n        }\r\n\r\n        $data = $row['data'];\r\n        die(json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"Successfully retrieved variable\",\r\n            \"response\" => $data\r\n        )));\r\n    case 'var':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n\r\n        $varid = misc\\etc\\sanitize($_POST['varid'] ?? $_GET['varid']);\r\n\r\n        $row = misc\\cache\\fetch('KeyAuthVar:' . $secret . ':' . $varid, \"SELECT `msg`, `authed` FROM `vars` WHERE `varid` = ? AND `app` = ?\", [$varid, $secret], 0);\r\n\r\n        if ($row == \"not_found\") {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Variable not found.\"\r\n            )));\r\n        }\r\n\r\n        $msg = $row['msg'];\r\n        $authed = $row['authed'];\r\n\r\n        if ($authed) // if variable requires user to be authenticated\r\n\r\n        {\r\n            if (!$session[\"validated\"]) {\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$sessionunauthed\"\r\n                )));\r\n            }\r\n        }\r\n        die(json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"$msg\"\r\n        )));\r\n    case 'checkblacklist':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n\r\n        $hwid = misc\\etc\\sanitize($_POST['hwid'] ?? $_GET['hwid']);\r\n        $ip = api\\shared\\primary\\getIp();\r\n\r\n        $row = misc\\cache\\fetch('KeyAuthBlacklist:' . $secret . ':' . $ip . ':' . $hwid, \"SELECT 1 FROM `bans` WHERE (`hwid` = ? OR `ip` = ?) AND `app` = ?\", [$hwid, $ip, $secret], 0);\r\n\r\n        if ($row != \"not_found\") {\r\n            die(json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"Client is blacklisted\"\r\n            )));\r\n        } else {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Client is not blacklisted\"\r\n            )));\r\n        }\r\n    case 'chatget':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        if (!$session[\"validated\"]) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            )));\r\n        }\r\n\r\n        $channel = misc\\etc\\sanitize($_POST['channel'] ?? $_GET['channel']);\r\n        $rows = misc\\cache\\fetch('KeyAuthChatMsgs:' . $secret . ':' . $channel, \"SELECT `author`, `message`, `timestamp` FROM `chatmsgs` WHERE `channel` = ? AND `app` = ?\", [$channel, $secret], 1);\r\n\r\n        if ($rows == \"not_found\") {\r\n            $rows = [];\r\n        }\r\n\r\n        die(json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"Successfully retrieved chat messages\",\r\n            \"messages\" => $rows\r\n        )));\r\n    case 'chatsend':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        if (!$session[\"validated\"]) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            )));\r\n        }\r\n\r\n        $channel = misc\\etc\\sanitize($_POST['channel'] ?? $_GET['channel']);\r\n        $query = misc\\mysql\\query(\"SELECT `delay` FROM `chats` WHERE `name` = ? AND `app` = ?\", [$channel, $secret]);\r\n\r\n        if ($query->num_rows < 1) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Chat channel not found\"\r\n            )));\r\n        }\r\n\r\n        $row = mysqli_fetch_array($query->result);\r\n        $delay = $row['delay'];\r\n        $credential = $session[\"credential\"];\r\n        $query = misc\\mysql\\query(\"SELECT `timestamp` FROM `chatmsgs` WHERE `author` = ? AND `channel` = ? AND `app` = ? ORDER BY `id` DESC LIMIT 1\", [$credential, $channel, $secret]);\r\n\r\n        $row = mysqli_fetch_array($query->result);\r\n        $time = $row['timestamp'];\r\n\r\n        if (time() - $time < $delay) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$chatHitDelay\"\r\n            )));\r\n        }\r\n\r\n        $query = misc\\mysql\\query(\"SELECT `time` FROM `chatmutes` WHERE `user` = ? AND `app` = ?\", [$credential, $secret]);\r\n        if ($query->num_rows != 0) {\r\n            $row = mysqli_fetch_array($query->result);\r\n            $unmuted = $row[\"time\"];\r\n            $unmuted = date(\"F j, Y, g:i a\", $unmuted);\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"You're muted from chat until $unmuted\"\r\n            )));\r\n        }\r\n\r\n        $message = misc\\etc\\sanitize($_POST['message'] ?? $_GET['message']);\r\n\r\n        if (is_null($message)) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Message can't be blank\"\r\n            )));\r\n        }\r\n\r\n        if(strlen($message) > 2000) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Message too long!\"\r\n            )));\r\n        }\r\n\r\n        misc\\mysql\\query(\"INSERT INTO `chatmsgs` (`author`, `message`, `timestamp`, `channel`,`app`) VALUES (?, ?, ?, ?, ?)\", [$credential, $message, time(), $channel, $secret]);\r\n        misc\\mysql\\query(\"DELETE FROM `chatmsgs` WHERE `app` = ? AND `channel` = ? AND `id` NOT IN ( SELECT `id` FROM ( SELECT `id` FROM `chatmsgs` WHERE `channel` = ? AND `app` = ? ORDER BY `id` DESC LIMIT 50) foo );\", [$secret, $channel, $channel, $secret]);\r\n        misc\\cache\\purge('KeyAuthChatMsgs:' . $secret . ':' . $channel);\r\n        die(json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"Successfully sent chat message\"\r\n        )));\r\n    case 'log':\r\n        // client isn't expecting a response body, just flush output right away so program can move on to rest of the code quicker\r\n        fastcgi_finish_request();\r\n\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n\r\n        $credential = $session[\"credential\"];\r\n\r\n        $currtime = time();\r\n\r\n        $msg = misc\\etc\\sanitize($_POST['message'] ?? $_GET['message']);\r\n\r\n        if(is_null($msg)) {\r\n            die();\r\n        }\r\n\r\n        if(strlen($msg) > 275) {\r\n            die(\"Log data too long\");\r\n        }\r\n\r\n        $pcuser = misc\\etc\\sanitize($_POST['pcuser'] ?? $_GET['pcuser']);\r\n\r\n        if (is_null($webhook)) {\r\n            $roleCheck = misc\\cache\\fetch('KeyAuthSellerCheck:' . $owner, \"SELECT `role`,`expires` FROM `accounts` WHERE `username` = ?\", [$owner], 0);\r\n            if($roleCheck['role'] == \"tester\") {\r\n                $query = misc\\mysql\\query(\"SELECT count(*) AS 'numLogs' FROM `logs` WHERE `logapp` = ?\",[$secret]);\r\n                $row = mysqli_fetch_array($query->result);\r\n                $numLogs = $row[\"numLogs\"];\r\n                if($numLogs >= 20) {\r\n                    die();\r\n                }\r\n            }\r\n            \r\n            misc\\mysql\\query(\"INSERT INTO `logs` (`logdate`, `logdata`, `credential`, `pcuser`,`logapp`) VALUES (?, ?, NULLIF(?, ''), NULLIF(?, ''), ?)\", [$currtime, $msg, $credential, $pcuser, $secret]);\r\n            die();\r\n        }\r\n\r\n        $credential = $session[\"credential\"] ?? \"N/A\";\r\n\r\n        $msg = \"📜 Log: \" . $msg;\r\n\r\n        $ip = api\\shared\\primary\\getIp();\r\n\r\n        $json_data = json_encode([\r\n            // Embeds Array\r\n            \"embeds\" => [\r\n                [\r\n                    // Embed Title\r\n                    \"title\" => $msg,\r\n\r\n                    // Embed left border color in HEX\r\n                    \"color\" => hexdec(\"00ffe1\"),\r\n\r\n                    // Additional Fields array\r\n                    \"fields\" => [[\"name\" => \"🔐 Credential:\", \"value\" => \"```\" . $credential . \"```\"], [\"name\" => \"💻 PC Name:\", \"value\" => \"```\" . $pcuser . \"```\", \"inline\" => true], [\"name\" => \"🌎 Client IP:\", \"value\" => \"```\" . $ip . \"```\", \"inline\" => true]]\r\n                ]\r\n            ]\r\n\r\n        ], JSON_UNESCAPED_SLASHES | JSON_UNESCAPED_UNICODE);\r\n\r\n        $ch = curl_init($webhook);\r\n\r\n        curl_setopt($ch, CURLOPT_HTTPHEADER, array(\r\n            'Content-type: application/json'\r\n        ));\r\n\r\n        curl_setopt($ch, CURLOPT_POST, 1);\r\n\r\n        curl_setopt($ch, CURLOPT_POSTFIELDS, $json_data);\r\n\r\n        curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);\r\n\r\n        curl_setopt($ch, CURLOPT_HEADER, 0);\r\n\r\n        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\r\n\r\n        $response = curl_exec($ch);\r\n\r\n        // If you need to debug, or find out why you can't send message uncomment line below, and execute script.\r\n        // echo $response;\r\n        curl_close($ch);\r\n        die();\r\n\r\n    case 'webhook':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n\r\n        $webid = misc\\etc\\sanitize($_POST['webid'] ?? $_GET['webid']);\r\n        $row = misc\\cache\\fetch('KeyAuthWebhook:' . $secret . ':' . $webid, \"SELECT `baselink`, `useragent`, `authed` FROM `webhooks` WHERE `webid` = ? AND `app` = ?\", [$webid, $secret], 0);\r\n        if ($row == \"not_found\") {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Webhook Not Found.\"\r\n            )));\r\n        }\r\n\r\n        $baselink = $row['baselink'];\r\n        $useragent = $row['useragent'];\r\n        $authed = $row['authed'];\r\n\r\n        if ($authed) // if variable requires user to be authenticated\r\n\r\n        {\r\n            if (!$session[\"validated\"]) {\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$sessionunauthed\"\r\n                )));\r\n            }\r\n        }\r\n\r\n        $params = misc\\etc\\sanitize($_POST['params'] ?? $_GET['params']);\r\n        $body = $_POST['body'] ?? $_GET['body'];\r\n        $contType = misc\\etc\\sanitize($_POST['conttype'] ?? $_GET['conttype']);\r\n\r\n        $url = $baselink .= urldecode($params);\r\n\r\n        $ch = curl_init($url);\r\n\r\n        curl_setopt($ch, CURLOPT_USERAGENT, $useragent);\r\n\r\n        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\r\n\r\n        if (!is_null($body) && !empty($body))\r\n            curl_setopt($ch, CURLOPT_POSTFIELDS, $body);\r\n\r\n        if (!is_null($contType))\r\n            curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type: ' . $contType));\r\n\r\n        $response = curl_exec($ch);\r\n\r\n        die(json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"Webhook request successful\",\r\n            \"response\" => \"$response\"\r\n        )));\r\n    case 'file':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n\r\n        $fileid = misc\\etc\\sanitize($_POST['fileid'] ?? $_GET['fileid']);\r\n\r\n        $row = misc\\cache\\fetch('KeyAuthFile:' . $secret . ':' . $fileid, \"SELECT `name`, `url`, `authed` FROM `files` WHERE `app` = ? AND `id` = ?\", [$secret, $fileid], 0);\r\n\r\n        if ($row == \"not_found\") {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"File not Found\"\r\n            )));\r\n        }\r\n\r\n        $filename = $row['name'];\r\n        $url = $row['url'];\r\n        $authed = $row['authed'];\r\n\r\n        if ($authed) // if file requires user to be authenticated\r\n\r\n        {\r\n            if (!$session[\"validated\"]) {\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$sessionunauthed\"\r\n                )));\r\n            }\r\n        }\r\n\r\n        ini_set('memory_limit', '-1');\r\n\r\n        $ch = curl_init($url);\r\n        curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);\r\n        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\r\n        $data = curl_exec($ch);\r\n        $statusCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);\r\n\r\n        if ($statusCode == 403 || $statusCode == 404) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"File no longer works, please notify the application developer.\"\r\n            )));\r\n        }\r\n        $contents = bin2hex($data);\r\n\r\n        die(json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"File download successful\",\r\n            \"contents\" => \"$contents\"\r\n        )));\r\n\r\n    case 'ban':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n\r\n        $credential = $session[\"credential\"];\r\n        if (!$session[\"validated\"]) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            )));\r\n        }\r\n\r\n        $reason = misc\\etc\\sanitize($_POST['reason'] ?? $_GET['reason']) ?? \"User banned from triggering ban function in the client\";\r\n\r\n        if(strlen($reason) > 99) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Reason must be 99 characters or less\"\r\n            )));\r\n        }\r\n\r\n        $hwid = misc\\etc\\sanitize($_POST['hwid'] ?? $_GET['hwid']);\r\n        if (!empty($hwid)) {\r\n            misc\\blacklist\\add($hwid, \"Hardware ID\", $secret);\r\n        }\r\n        $ip = api\\shared\\primary\\getIp();\r\n        misc\\blacklist\\add($ip, \"IP Address\", $secret);\r\n\r\n        misc\\mysql\\query(\"UPDATE `users` SET `banned` = ? WHERE `username` = ? AND `app` = ?\", [$reason, $credential, $secret]);\r\n        if ($query->affected_rows != 0) {\r\n            misc\\cache\\purge('KeyAuthUser:' . $secret . ':' . $credential);\r\n            die(json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"Successfully Banned User\"\r\n            )));\r\n        } else {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Failed to ban user.\"\r\n            )));\r\n        }\r\n    case 'check':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n\r\n        $credential = $session[\"credential\"];\r\n        if (!$session[\"validated\"]) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            )));\r\n        } else {\r\n            die(json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"Session is validated.\"\r\n            )));\r\n        }\r\n    case 'changeUsername':\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n\r\n        if (!$session[\"validated\"]) {\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            )));\r\n        }\r\n\r\n        $credential = $session[\"credential\"];\r\n\r\n        $resp = misc\\user\\changeUsername($credential, $_POST['newUsername'] ?? $_GET['newUsername'], $secret);\r\n        switch ($resp) {\r\n            case 'already_used':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"Username already used!\"\r\n                )));\r\n            case 'failure':\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"Failed to change username!\"\r\n                )));\r\n            case 'success':\r\n                misc\\session\\killSingular($sessionid, $secret);\r\n                die(json_encode(array(\r\n                    \"success\" => true,\r\n                    \"message\" => \"Successfully changed username, user logged out.\"\r\n                )));\r\n            default:\r\n                die(json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"Unhandled Error! Contact us if you need help\"\r\n                )));\r\n        }\r\n    default:\r\n        die(json_encode(array(\r\n            \"success\" => false,\r\n            \"message\" => \"The value inputted for type paramater was not found\"\r\n        )));\r\n}\r\n","size_bytes":45894},"api/1.2/index.php":{"content":"<?php\r\ninclude '../../includes/misc/autoload.phtml';\r\ninclude '../../includes/api/shared/autoload.phtml';\r\ninclude '../../includes/api/1.0/autoload.phtml';\r\n\r\nheader(\"Access-Control-Allow-Origin: *\"); // allow browser applications to request API\r\nheader('Content-Type: application/json; charset=utf-8');\r\n\r\nset_exception_handler(function ($exception) {\r\n    error_log(\"\\n--------------------------------------------------------------\\n\");\r\n    error_log($exception);\r\n    error_log(\"\\nRequest data:\");\r\n    error_log(print_r($_POST, true));\r\n    error_log(\"\\n--------------------------------------------------------------\");\r\n    http_response_code(500);\r\n    $errorMsg = str_replace($databaseUsername, \"REDACTED\", $exception->getMessage());\r\n    die(json_encode(array(\"success\" => false, \"message\" => \"Error: \" . $errorMsg)));\r\n});\r\n\r\nif(empty(($_POST['ownerid'] ?? $_GET['ownerid']))) {\r\n    die(json_encode(array(\"success\" => false, \"message\" => \"No OwnerID specified. Select app & copy code snippet from https://keyauth.cc/app/\")));\r\n}\r\n\r\nif(empty(($_POST['name'] ?? $_GET['name']))) {\r\n    die(json_encode(array(\"success\" => false, \"message\" => \"No app name specified. Select app & copy code snippet from https://keyauth.cc/app/\")));\r\n}\r\n\r\nif(strlen(($_POST['ownerid'] ?? $_GET['ownerid'])) != 10) {\r\n    die(json_encode(array(\"success\" => false, \"message\" => \"OwnerID should be 10 characters long. Select app & copy code snippet from https://keyauth.cc/app/\")));\r\n}\r\n\r\nif (misc\\cache\\rateLimit(\"KeyAuthAppLimit:\" . ($_POST['ownerid'] ?? $_GET['ownerid']), 1, 60, 200)) {\r\n    die(json_encode(array(\"success\" => false, \"message\" => \"This application has sent too many requests. Try again in a minute.\")));\r\n}\r\n\r\n$ownerid = misc\\etc\\sanitize($_POST['ownerid'] ?? $_GET['ownerid']); // ownerid of account that owns application\r\n$name = misc\\etc\\sanitize($_POST['name'] ?? $_GET['name']); // application name\r\n$row = misc\\cache\\fetch('KeyAuthApp:' . $name . ':' . $ownerid, \"SELECT * FROM `apps` WHERE `ownerid` = ? AND `name` = ?\", [$ownerid, $name], 0);\r\n\r\nif ($row == \"not_found\") {\r\n    die(\"KeyAuth_Invalid\");\r\n}\r\n\r\n// app settings\r\n$secret = $row['secret'];\r\n$hwidenabled = $row['hwidcheck'];\r\n$vpnblock = $row['vpnblock'];\r\n$status = $row['enabled'];\r\n$paused = $row['paused'];\r\n$currentver = $row['ver'];\r\n$download = $row['download'];\r\n$webhook = $row['webhook'];\r\n$appdisabled = $row['appdisabled'];\r\n$hashcheck = $row['hashcheck'];\r\n$serverhash = $row['hash'];\r\n$sessionexpiry = $row['session'];\r\n$forceEncryption = $row['forceEncryption'];\r\n$forceHwid = $row['forceHwid'];\r\n$tokensystem = $row['tokensystem'];\r\n\r\n$banned = $row['banned'];\r\n$owner = $row['owner'];\r\n$name = $row['name'];\r\n\r\n// custom error messages\r\n$usernametaken = $row['usernametaken'];\r\n$keynotfound = $row['keynotfound'];\r\n$keyused = $row['keyused'];\r\n$nosublevel = $row['nosublevel'];\r\n$usernamenotfound = $row['usernamenotfound'];\r\n$passmismatch = $row['passmismatch'];\r\n$hwidmismatch = $row['hwidmismatch'];\r\n$noactivesubs = $row['noactivesubs'];\r\n$hwidblacked = $row['hwidblacked'];\r\n$pausedsub = $row['pausedsub'];\r\n$vpnblocked = $row['vpnblocked'];\r\n$keybanned = $row['keybanned'];\r\n$userbanned = $row['userbanned'];\r\n$sessionunauthed = $row['sessionunauthed'];\r\n$hashcheckfail = $row['hashcheckfail'];\r\n$invalid_token = $row['tokeninvalid'];\r\n\r\n// why using null coalescing operators? because if I add a field and it's not in redis cache, it'll be NULL\r\n$loggedInMsg = $row['loggedInMsg'] ?? \"Logged in!\";\r\n$pausedApp = $row['pausedApp'] ?? \"Application is currently paused, please wait for the developer to say otherwise.\";\r\n$unTooShort = $row['unTooShort'] ?? \"Username too short, try longer one.\";\r\n$pwLeaked = $row['pwLeaked'] ?? \"This password has been leaked in a data breach (not from us), please use a different one.\";\r\n$chatHitDelay = $row['chatHitDelay'] ?? \"Chat slower, you've hit the delay limit\";\r\n$minHwid = $row['minHwid'] ?? 20;\r\n\r\nif($ownerid == \"hTmfnZOYPe\") {\r\n    $response = json_encode(array(\r\n        \"success\" => false,\r\n        \"message\" => \"Jao é um golpista, prova aqui https://keyauth.cc/jao/\"\r\n    ));\r\n\r\n    $sig = hash_hmac('sha256', $response, $secret);\r\n    header(\"signature: {$sig}\");\r\n\r\n    die($response);\r\n}\r\n\r\nif ($banned) {\r\n    die(json_encode(array(\r\n        \"success\" => false,\r\n        \"message\" => \"This application has been banned from KeyAuth.cc for violating terms.\" // yes we self promote to customers of those who break ToS. Should've followed terms :shrug:\r\n    )));\r\n}\r\n\r\nswitch ($_POST['type'] ?? $_GET['type']) {\r\n    case 'init':\r\n        if(strlen($_POST['enckey']) > 35) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"The paramater \\\"enckey\\\" is too long. Must be 35 characters or less.\"\r\n            ));\r\n\r\n            $sig = hash_hmac('sha256', $response, $secret);\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        if ($forceEncryption) {\r\n            if (!isset($_POST['enckey']) && !isset($_GET['enckey'])) {\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"No encryption key supplied, encryption is forced.\"\r\n                ));\r\n\r\n                $sig = hash_hmac('sha256', $response, $secret);\r\n                header(\"signature: {$sig}\");\r\n\r\n                die($response);\r\n            }\r\n        }\r\n        $ip = api\\shared\\primary\\getIp();\r\n        if ($vpnblock) {\r\n            if (api\\shared\\primary\\vpnCheck($ip)) {\r\n                $row = misc\\cache\\fetch('KeyAuthWhitelist:' . $secret . ':' . $ip, \"SELECT 1 FROM `whitelist` WHERE `ip` = ? AND `app` = ?\", [$ip, $secret], 0);\r\n                if ($row == \"not_found\") {\r\n                    $response = json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"$vpnblocked\"\r\n                    ));\r\n\r\n                    $sig = hash_hmac('sha256', $response, $secret);\r\n                    header(\"signature: {$sig}\");\r\n\r\n                    die($response);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!$status) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$appdisabled\"\r\n            ));\r\n\r\n            $sig = hash_hmac('sha256', $response, $secret);\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        if ($paused) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$pausedApp\"\r\n            ));\r\n\r\n            $sig = hash_hmac('sha256', $response, $secret);\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        if ($tokensystem) {\r\n\r\n            list($token, $thash) = [misc\\etc\\sanitize($_POST[\"token\"] ?? $_GET[\"token\"]) , misc\\etc\\sanitize($_POST[\"thash\"] ?? $_GET[\"thash\"])];\r\n\r\n            if (!isset($token)) {\r\n\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"Token Must Be Provided\"\r\n                ));\r\n\r\n                $sig = hash_hmac('sha256', $response, $secret);\r\n                header(\"signature: {$sig}\"); \r\n\r\n                die($response);\r\n            }\r\n\r\n            if (!isset($thash)) {\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"Hash Must Be Provided\"\r\n                ));\r\n\r\n                $sig = hash_hmac('sha256', $response, $secret);\r\n                header(\"signature: {$sig}\"); \r\n\r\n                die($response);\r\n            }\r\n\r\n            $verification = misc\\token\\checktoken(\"check_data\", $token, $secret, null, $thash);\r\n\r\n            switch ($verification) {\r\n                case str_contains($verification, 'token_blacklisted'):\r\n                    $reason = str_ireplace(\"token_blacklisted, \", \"\", $verification);       \r\n                    $response = json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"The Token Has Been Blacklisted For The Following Reason: \" . $reason . \" Contact Application Developer If This Is A Mistake\"\r\n                    ));\r\n\r\n                    $sig = hash_hmac('sha256', $response, $secret);\r\n                    header(\"signature: {$sig}\"); \r\n\r\n                    die($response);\r\n                case 'invalid_token':\r\n\r\n                    $response = json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => $invalid_token\r\n                    ));\r\n\r\n                    $sig = hash_hmac('sha256', $response, $secret);\r\n                    header(\"signature: {$sig}\"); \r\n                \r\n                    die($response);\r\n\r\n                case 'hash_mismatch':\r\n\r\n                    $response = json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"Token File Hashes Must Be The Same\"\r\n                    ));\r\n\r\n                    $sig = hash_hmac('sha256', $response, $secret);\r\n                    header(\"signature: {$sig}\"); \r\n                \r\n                    die($response);\r\n                \r\n                case 'success':\r\n                    break;\r\n                \r\n                default:\r\n\r\n                    $response = json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"Unknown Error Occured\"\r\n                    ));\r\n\r\n                    $sig = hash_hmac('sha256', $response, $secret);\r\n                    header(\"signature: {$sig}\"); \r\n                \r\n                    die($response);\r\n\r\n            }\r\n        }\r\n\r\n        $ver = misc\\etc\\sanitize($_POST['ver'] ?? $_GET['ver']);\r\n        if (!empty($ver)) {\r\n            if ($ver != $currentver) {\r\n                // auto-update system\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"invalidver\",\r\n                    \"download\" => \"$download\"\r\n                ), JSON_UNESCAPED_SLASHES);\r\n\r\n                $sig = hash_hmac('sha256', $response, $secret);\r\n                header(\"signature: {$sig}\");\r\n\r\n                die($response);\r\n            }\r\n        }\r\n\r\n        $hash = misc\\etc\\sanitize($_POST['hash'] ?? $_GET['hash']);\r\n\r\n        if ($hashcheck) {\r\n            if (strpos($serverhash, $hash) === false) {\r\n                if (is_null($serverhash)) {\r\n                    misc\\mysql\\query(\"UPDATE `apps` SET `hash` = ? WHERE `secret` = ?\", [$hash, $secret]);\r\n                    misc\\cache\\purge('KeyAuthApp:' . $name . ':' . $ownerid); // flush cache for application so new hash takes precedent\r\n                } else {\r\n                    $response = json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"$hashcheckfail\"\r\n                    ));\r\n\r\n                    $sig = hash_hmac('sha256', $response, $secret);\r\n                    header(\"signature: {$sig}\");\r\n\r\n                    die($response);\r\n                }\r\n            }\r\n        }\r\n\r\n        $enckey = !is_null($_POST['enckey'] ?? $_GET['enckey']) ? misc\\etc\\sanitize($_POST['enckey'] ?? $_GET['enckey']) . \"-\" . $secret : NULL;\r\n        $newSession = false;\r\n        $duplicateSession = misc\\cache\\select(\"KeyAuthSessionDupe:$secret:$ip\");\r\n        if($duplicateSession) {\r\n            $sessionid = $duplicateSession;\r\n\r\n            $updateSession = misc\\cache\\update('KeyAuthState:'.$secret.':'.$sessionid.'', array(\"validated\" => 0, \"enckey\" => $enckey));\r\n            if(!$updateSession) {\r\n                $sessionid = misc\\etc\\generateRandomString();\r\n                $newSession = true;\r\n            }\r\n        }\r\n        else {\r\n            $sessionid = misc\\etc\\generateRandomString();\r\n            $newSession = true;\r\n        }\r\n\r\n        // $row = misc\\cache\\fetch('KeyAuthAppStats:' . $secret, \"SELECT (SELECT COUNT(1) FROM `users` WHERE `app` = ?) AS 'numUsers', (SELECT COUNT(1) FROM `sessions` WHERE `app` = ? AND `validated` = 1 AND `expiry` > ?) AS 'numOnlineUsers', (SELECT COUNT(1) FROM `keys` WHERE `app` = ?) AS 'numKeys' FROM dual\", [$secret, $secret, time(), $secret], 0, 3600);\r\n\r\n        $numUsers = \"N/A - Use fetchStats() function in latest example\";\r\n        $numOnlineUsers = \"N/A - Use fetchStats() function in latest example\";\r\n        $numKeys = \"N/A - Use fetchStats() function in latest example\";\r\n\r\n        $resp = json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"Initialized\",\r\n            \"sessionid\" => $sessionid,\r\n            \"appinfo\" => array(\r\n                \"numUsers\" => \"$numUsers\",\r\n                \"numOnlineUsers\" => \"$numOnlineUsers\",\r\n                \"numKeys\" => \"$numKeys\",\r\n                \"version\" => \"$currentver\",\r\n                \"customerPanelLink\" => \"https://keyauth.cc/panel/$owner/$name/\"\r\n            ),\r\n            \"newSession\" => $newSession,\r\n            \"nonce\" => misc\\etc\\generateRandomString(32)\r\n        ));\r\n\r\n        $sig = !is_null($enckey) ? hash_hmac('sha256', $resp, $secret)  : 'No encryption key supplied';\r\n        header(\"signature: {$sig}\");\r\n\r\n        echo $resp;\r\n\r\n        if (function_exists('fastcgi_finish_request')) { fastcgi_finish_request(); }\r\n\r\n        if($newSession) {\r\n            misc\\cache\\insert(\"KeyAuthState:$secret:$sessionid\", serialize(array(\"credential\" => NULL, \"enckey\" => $enckey, \"validated\" => 0)), $sessionexpiry);\r\n            $time = time() + $sessionexpiry;\r\n            misc\\mysql\\query(\"INSERT INTO `sessions` (`id`, `app`, `expiry`, `created_at`, `enckey`, `ip`) VALUES (?, ?, ?, ?, NULLIF(?, ''), ?)\", [$sessionid, $secret, $time, time(), $enckey, $ip]);\r\n            misc\\cache\\insert(\"KeyAuthSessionDupe:$secret:$ip\", $sessionid, $sessionexpiry);\r\n        }\r\n        break;\n\r\n    case 'register':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        // Read in username\r\n        $username = misc\\etc\\sanitize($_POST['username'] ?? $_GET['username']);\r\n\r\n        if(strlen($username) > 70) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Username must be shorter than 70 characters\"\r\n            ));\r\n\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : NULL;\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        // Read in license key\r\n        $checkkey = misc\\etc\\sanitize($_POST['key'] ?? $_GET['key']);\r\n\r\n        if(strlen($checkkey) > 70) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Key must be shorter than 70 characters\"\r\n            ));\r\n\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : NULL;\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        // Read in password\r\n        $password = misc\\etc\\sanitize($_POST['pass'] ?? $_GET['pass']);\r\n\r\n        // Read in email\r\n        $email = misc\\etc\\sanitize($_POST['email'] ?? $_GET['email']);\r\n\r\n        // Read in hwid\r\n        $hwid = misc\\etc\\sanitize($_POST['hwid'] ?? $_GET['hwid']);\r\n\r\n        $registerSuccess = false;\r\n\r\n        $resp = api\\v1_0\\register($username, $checkkey, $password, $email, $hwid, $secret);\r\n        switch ($resp) {\r\n            case 'username_taken':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$usernametaken\"\r\n                ));\r\n                break;\r\n            case 'key_not_found':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keynotfound\"\r\n                ));\r\n                break;\r\n            case 'un_too_short':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$unTooShort\"\r\n                ));\r\n                break;\r\n            case 'pw_leaked':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$pwLeaked\"\r\n                ));\r\n                break;\r\n            case 'key_already_used':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keyused\"\r\n                ));\r\n                break;\r\n            case 'key_banned':\r\n                if (strpos($keybanned, '{reason}') !== false) {\r\n                    $query = misc\\mysql\\query(\"SELECT `banned` FROM `keys` WHERE `app` = ? AND `key` = ?\", [$secret, $checkkey]);\r\n                    $row = mysqli_fetch_array($query->result);\r\n                    $reason = $row['banned'];\r\n                    $keybanned = str_replace(\"{reason}\", $reason, $keybanned);\r\n                }\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keybanned\"\r\n                ));\r\n                break;\r\n            case 'hwid_blacked':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$hwidblacked\"\r\n                ));\r\n                break;\r\n            case 'no_subs_for_level':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$nosublevel\"\r\n                ));\r\n                break;\r\n            default:\r\n                $registerSuccess = true;\r\n\r\n                $response = json_encode(array(\r\n                    \"success\" => true,\r\n                    \"message\" => \"$loggedInMsg\",\r\n                    \"info\" => $resp,\r\n                    \"nonce\" => misc\\etc\\generateRandomString(32)\r\n                ));\r\n                break;\r\n        }\r\n        $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : NULL;\r\n        header(\"signature: {$sig}\");\r\n\r\n        echo $response;\r\n\r\n        if (function_exists('fastcgi_finish_request')) { fastcgi_finish_request(); }\r\n\r\n        if ($registerSuccess) {\r\n            misc\\cache\\update('KeyAuthState:'.$secret.':'.$sessionid.'', array(\"validated\" => 1, \"credential\" => $username));\r\n            misc\\mysql\\query(\"UPDATE `sessions` SET `credential` = ?,`validated` = 1 WHERE `id` = ?\", [$username, $sessionid]);\r\n        }\r\n        die();\r\n    case 'upgrade':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        // Read in username\r\n        $username = misc\\etc\\sanitize($_POST['username'] ?? $_GET['username']);\r\n\r\n        // Read in key\r\n        $checkkey = misc\\etc\\sanitize($_POST['key'] ?? $_GET['key']);\r\n\r\n\r\n        // search for key\r\n        $query = misc\\mysql\\query(\"SELECT `banned`, `expires`, `status`, `level` FROM `keys` WHERE `key` = ? AND `app` = ?\", [$checkkey, $secret]);\r\n\r\n        // check if key exists\r\n        if ($query->num_rows < 1) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$keynotfound\"\r\n            ));\r\n\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : NULL;\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        // if key does exist\r\n        elseif ($query->num_rows > 0) {\r\n\r\n            // get key info\r\n            while ($row = mysqli_fetch_array($query->result)) {\r\n                $expires = $row['expires'];\r\n                $status = $row['status'];\r\n                $level = $row['level'];\r\n                $banned = $row['banned'];\r\n            }\r\n\r\n            // check if used\r\n            if ($status == \"Used\") {\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keyused\"\r\n                ));\r\n\r\n                $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : NULL;\r\n                header(\"signature: {$sig}\");\r\n\r\n                die($response);\r\n            }\r\n\r\n            if (!is_null($banned)) {\r\n                if (strpos($keybanned, '{reason}') !== false) {\r\n                    $keybanned = str_replace(\"{reason}\", $banned, $keybanned);\r\n                }\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keybanned\"\r\n                ));\r\n\r\n                $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : NULL;\r\n                header(\"signature: {$sig}\");\r\n\r\n                die($response);\r\n            }\r\n\r\n            // add current time to key time\r\n            $expiry = $expires + time();\r\n\r\n            $query = misc\\mysql\\query(\"SELECT `name` FROM `subscriptions` WHERE `app` = ? AND `level` = ?\", [$secret, $level]);\r\n            $subName = mysqli_fetch_array($query->result)['name'];\r\n\r\n            $resp = misc\\user\\extend($username, $subName, $expiry, 0, $secret);\r\n            switch ($resp) {\r\n                case 'missing':\r\n                    $response = json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"$usernamenotfound\"\r\n                    ));\r\n                    break;\r\n                case 'sub_missing':\r\n                    $response = json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"$nosublevel\"\r\n                    ));\r\n                    break;\r\n                case 'failure':\r\n                    $response = json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"Failed to upgrade for some reason.\"\r\n                    ));\r\n                    break;\r\n                case 'success':\r\n                    // set key to used, and set usedby\r\n                    misc\\mysql\\query(\"UPDATE `keys` SET `status` = 'Used', `usedon` = ?, `usedby` = ? WHERE `key` = ? AND `app` = ?\", [time(), $username, $checkkey, $secret]);\r\n                    misc\\cache\\purge('KeyAuthKeys:' . $secret . ':' . $checkkey);\r\n                    misc\\cache\\purge('KeyAuthSubs:' . $secret . ':' . $username);\r\n                    $response = json_encode(array(\r\n                        \"success\" => true,\r\n                        \"message\" => \"Upgraded successfully\",\r\n                        \"nonce\" => misc\\etc\\generateRandomString(32)\r\n                    ));\r\n                    break;\r\n                default:\r\n                    $response = json_encode(array(\r\n                        \"success\" => false,\r\n                        \"message\" => \"Unhandled Error! Contact us if you need help\"\r\n                    ));\r\n                    break;\r\n            }\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n    case 'login':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        // Read in username\r\n        $username = misc\\etc\\sanitize($_POST['username'] ?? $_GET['username']);\r\n\r\n        // Read in HWID\r\n        $hwid = misc\\etc\\sanitize($_POST['hwid'] ?? $_GET['hwid']);\r\n\r\n        // Read in password\r\n        $password = misc\\etc\\sanitize($_POST['pass'] ?? $_GET['pass']);\r\n\r\n        // optional param for web loader\r\n        $token = misc\\etc\\sanitize($_POST['token'] ?? $_GET['token']);\r\n\r\n        if(strlen($hwid) < $minHwid && !is_null($hwid)) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"HWID must be {$minHwid} or more characters, change this in app settings.\"\r\n            ));\r\n\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : NULL;\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        if($forceHwid && is_null($hwid)) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Force HWID is enabled, disable in app settings if you want to use blank HWIDs\"\r\n            ));\r\n\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : NULL;\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        $resp = api\\v1_0\\login($username, $password, $hwid, $secret, $hwidenabled, $token);\r\n        switch ($resp) {\r\n            case 'un_not_found':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$usernamenotfound\"\r\n                ));\r\n                break;\r\n            case 'pw_mismatch':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$passmismatch\"\r\n                ));\r\n                break;\r\n            case 'user_banned':\r\n                if (strpos($userbanned, '{reason}') !== false) {\r\n                    $query = misc\\mysql\\query(\"SELECT `banned` FROM `users` WHERE `app` = ? AND `username` = ?\", [$secret, $username]);\r\n                    $row = mysqli_fetch_array($query->result);\r\n                    $reason = $row['banned'];\r\n                    $userbanned = str_replace(\"{reason}\", $reason, $userbanned);\r\n                }\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$userbanned\"\r\n                ));\r\n                break;\r\n            case 'hwid_mismatch':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$hwidmismatch\"\r\n                ));\r\n                break;\r\n            case 'hwid_blacked':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$hwidblacked\"\r\n                ));\r\n                break;\r\n            case 'sub_paused':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$pausedsub\"\r\n                ));\r\n                break;\r\n            case 'no_active_subs':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$noactivesubs\"\r\n                ));\r\n                break;\r\n            default:\r\n                misc\\mysql\\query(\"UPDATE `sessions` SET `validated` = 1,`credential` = ? WHERE `id` = ?\", [$username, $sessionid]);\r\n                misc\\cache\\update('KeyAuthState:'.$secret.':'.$sessionid.'', array(\"validated\" => 1, \"credential\" => $username));\r\n\r\n                $ip = api\\shared\\primary\\getIp();\r\n                $response = json_encode(array(\r\n                    \"success\" => true,\r\n                    \"message\" => \"$loggedInMsg\",\r\n                    \"info\" => $resp,\r\n                    \"nonce\" => misc\\etc\\generateRandomString(32)\r\n                ));\r\n                break;\r\n        }\r\n        $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n        header(\"signature: {$sig}\");\r\n\r\n        die($response);\r\n    case 'license':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n        $checkkey = misc\\etc\\sanitize($_POST['key'] ?? $_GET['key']);\r\n\r\n        if(strlen($checkkey) > 70) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Key must be shorter than 70 characters\"\r\n            ));\r\n\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : NULL;\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        $hwid = misc\\etc\\sanitize($_POST['hwid'] ?? $_GET['hwid']);\r\n\r\n        if(strlen($hwid) < $minHwid && !is_null($hwid)) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"HWID must be {$minHwid} or more characters, change this in app settings.\"\r\n            ));\r\n\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : NULL;\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        if($forceHwid && is_null($hwid)) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Force HWID is enabled, disable in app settings if you want to use blank HWIDs\"\r\n            ));\r\n\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : NULL;\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        $resp = api\\v1_0\\login($checkkey, $checkkey, $hwid, $secret, $hwidenabled);\r\n\r\n        switch ($resp) {\r\n            case 'un_not_found':\r\n                break; // user not registered yet or user was deleted\r\n\r\n            case 'hwid_mismatch':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$hwidmismatch\"\r\n                ));\r\n                break;\r\n            case 'user_banned':\r\n                if (strpos($userbanned, '{reason}') !== false) {\r\n                    $query = misc\\mysql\\query(\"SELECT `banned` FROM `users` WHERE `app` = ? AND `username` = ?\", [$secret, $checkkey]);\r\n                    $row = mysqli_fetch_array($query->result);\r\n                    $reason = $row['banned'];\r\n                    $userbanned = str_replace(\"{reason}\", $reason, $userbanned);\r\n                }\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$userbanned\"\r\n                ));\r\n                break;\r\n            case 'pw_mismatch':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$passmismatch\"\r\n                ));\r\n                break;\r\n            case 'sub_paused':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$pausedsub\"\r\n                ));\r\n                break;\r\n            case 'hwid_blacked':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$hwidblacked\"\r\n                ));\r\n                break;\r\n            case 'no_active_subs':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$noactivesubs\"\r\n                ));\r\n                break;\r\n            default:\r\n                misc\\mysql\\query(\"UPDATE `sessions` SET `validated` = 1,`credential` = ? WHERE `id` = ?\", [$checkkey, $sessionid]);\r\n                misc\\cache\\update('KeyAuthState:'.$secret.':'.$sessionid.'', array(\"validated\" => 1, \"credential\" => $checkkey));\r\n\r\n                $ip = api\\shared\\primary\\getIp();\r\n                $response = json_encode(array(\r\n                    \"success\" => true,\r\n                    \"message\" => \"$loggedInMsg\",\r\n                    \"info\" => $resp,\r\n                    \"nonce\" => misc\\etc\\generateRandomString(32)\r\n                ));\r\n                break;\r\n        }\r\n        if (isset($response)) {\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        // if login didn't work, attempt to register\r\n        $resp = api\\v1_0\\register($checkkey, $checkkey, $checkkey, NULL, $hwid, $secret);\r\n        switch ($resp) {\r\n            case 'username_taken':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$usernametaken\"\r\n                ));\r\n                break;\r\n            case 'key_not_found':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keynotfound\"\r\n                ));\r\n                break;\r\n            case 'un_too_short':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$unTooShort\"\r\n                ));\r\n                break;\r\n            case 'pw_leaked':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$pwLeaked\"\r\n                ));\r\n                break;\r\n            case 'key_already_used':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keyused\"\r\n                ));\r\n                break;\r\n            case 'key_banned':\r\n                if (strpos($keybanned, '{reason}') !== false) {\r\n                    $query = misc\\mysql\\query(\"SELECT `banned` FROM `keys` WHERE `app` = ? AND `key` = ?\", [$secret, $checkkey]);\r\n                    $row = mysqli_fetch_array($query->result);\r\n                    $reason = $row['banned'];\r\n                    $keybanned = str_replace(\"{reason}\", $reason, $keybanned);\r\n                }\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$keybanned\"\r\n                ));\r\n                break;\r\n            case 'hwid_blacked':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$hwidblacked\"\r\n                ));\r\n                break;\r\n            case 'no_subs_for_level':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$nosublevel\"\r\n                ));\r\n                break;\r\n            default:\r\n                misc\\mysql\\query(\"UPDATE `sessions` SET `validated` = 1,`credential` = ? WHERE `id` = ?\", [$checkkey, $sessionid]);\r\n                misc\\cache\\update('KeyAuthState:'.$secret.':'.$sessionid.'', array(\"validated\" => 1, \"credential\" => $checkkey));\r\n                $response = json_encode(array(\r\n                    \"success\" => true,\r\n                    \"message\" => \"$loggedInMsg\",\r\n                    \"info\" => $resp,\r\n                    \"nonce\" => misc\\etc\\generateRandomString(32)\r\n                ));\r\n        }\r\n        $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n        header(\"signature: {$sig}\");\r\n\r\n        die($response);\r\n    case 'forgot':\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        $un = misc\\etc\\sanitize($_POST['username'] ?? $_GET['username']);\r\n        $email = strtolower(misc\\etc\\sanitize($_POST['email'] ?? $_GET['email']));\r\n\r\n        $row = misc\\cache\\fetch('KeyAuthUser:' . $secret . ':' . $un, \"SELECT * FROM `users` WHERE `username` = ? AND `app` = ?\", [$un, $secret], 0);\r\n        if ($row == \"not_found\") {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"No user found with that username!\"\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        $emailHashed = $row['email'];\r\n\r\n        if (sha1($email) != $emailHashed) {\r\n            if(is_null($emailHashed)) {\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"Email address not provided during register, ask developer to edit your account and change email.\"\r\n                ));\r\n            }\r\n            else {\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"Email address doesn't match!\"\r\n                ));\r\n            }\r\n        } else {\r\n            $algos = array(\r\n                'ripemd128',\r\n                'md5',\r\n                'md4',\r\n                'tiger128,4',\r\n                'haval128,3',\r\n                'haval128,4',\r\n                'haval128,5'\r\n            );\r\n            $emailSecret = hash($algos[array_rand($algos)], misc\\etc\\generateRandomString());\r\n\r\n            misc\\mysql\\query(\"INSERT INTO `resetUsers` (`secret`, `email`, `username`, `app`, `time`) VALUES (?, SHA1(?), ?, ?, ?)\", [$emailSecret, $email, $un, $secret, time()]);\r\n\r\n            $body = '<div class=\"f-fallback\">\r\n                <h1>Hello <i>'.$un.'</i>,</h1>\r\n                <p>You recently requested to reset your password for the software '.$name.'. Use the button below to reset it. <strong>The link is only valid for the next 24 hours.</strong></p>\r\n                <!-- Action -->\r\n                <table class=\"body-action\" align=\"center\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\">\r\n                  <tr>\r\n                    <td align=\"center\">\r\n                      <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\">\r\n                        <tr>\r\n                          <td align=\"center\">\r\n                            <a href=\"https://keyauth.cc/resetUser/?secret='.$emailSecret.'\" style=\"color:white;background-color: #3869D4;border-top: 10px solid #3869D4;border-right: 18px solid #3869D4;border-bottom: 10px solid #3869D4;border-left: 18px solid #3869D4;display: inline-block;text-decoration: none;border-radius: 3px;-webkit-text-size-adjust: none;box-sizing: border-box;\" target=\"_blank\">Reset Password</a>\r\n                          </td>\r\n                        </tr>\r\n                      </table>\r\n                    </td>\r\n                  </tr>\r\n                </table>\r\n                <p>Thanks,\r\n                  <br>The KeyAuth team</p>\r\n            </div>';\r\n            misc\\email\\send($un, $email, $body, \"KeyAuth - Password Reset for {$name}\");\r\n            $response = json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"Successfully sent email to change password.\",\r\n                \"nonce\" => misc\\etc\\generateRandomString(32)\r\n            ));\r\n        }\r\n\r\n        $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n        header(\"signature: {$sig}\");\r\n\r\n        die($response);\r\n    case 'fetchOnline':\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        $rows = misc\\cache\\fetch('KeyAuthOnlineUsers:' . $secret, \"SELECT DISTINCT CONCAT(LEFT(`credential`, 10), IF(LENGTH(`credential`) > 10, REPEAT('*', LENGTH(`credential`) - 10), '')) AS `credential` FROM `sessions` WHERE `validated` = 1 AND `app` = ?\", [$secret], 1, 1800);\r\n\r\n        if ($rows == \"not_found\") {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"No online users found!\"\r\n            ));\r\n        }\r\n        else {\r\n            $response = json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"Successfully fetched online users.\",\r\n                \"users\" => $rows,\r\n                \"nonce\" => misc\\etc\\generateRandomString(32)\r\n            ));\r\n        }\r\n\r\n        $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n        header(\"signature: {$sig}\");\r\n\r\n        die($response);\r\n    case 'fetchStats':\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n    \r\n        $row = misc\\cache\\fetch('KeyAuthAppStats:' . $secret, \"SELECT (SELECT COUNT(1) FROM `users` WHERE `app` = ?) AS 'numUsers', (SELECT COUNT(1) FROM `sessions` WHERE `app` = ? AND `validated` = 1 AND `expiry` > ?) AS 'numOnlineUsers', (SELECT COUNT(1) FROM `keys` WHERE `app` = ?) AS 'numKeys' FROM dual\", [$secret, $secret, time(), $secret], 0, 3600);\r\n\r\n        $numUsers = $row['numUsers'];\r\n        $numOnlineUsers = $row['numOnlineUsers'];\r\n        $numKeys = $row['numKeys'];\r\n\r\n        $response = json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"Successfully fetched stats\",\r\n            \"appinfo\" => array(\r\n                \"numUsers\" => \"$numUsers\",\r\n                \"numOnlineUsers\" => \"$numOnlineUsers\",\r\n                \"numKeys\" => \"$numKeys\",\r\n                \"version\" => \"$currentver\",\r\n                \"customerPanelLink\" => \"https://keyauth.cc/panel/$owner/$name/\"\r\n            ),\r\n            \"nonce\" => misc\\etc\\generateRandomString(32)\r\n        ));\r\n    \r\n        $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n        header(\"signature: {$sig}\");\r\n    \r\n        die($response);\r\n    case 'setvar':\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n        if (!$session[\"validated\"]) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            ));\r\n\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        $var = misc\\etc\\sanitize($_POST['var'] ?? $_GET['var']);\r\n        $data = misc\\etc\\sanitize($_POST['data'] ?? $_GET['data']);\r\n\r\n        if(is_null($var)) {\r\n            $response = json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"No variable name provided\"\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n            die($response);\r\n        }\r\n\r\n        if(is_null($data)) {\r\n            $response = json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"No variable data provided\"\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n            die($response);\r\n        }\r\n\r\n        if(strlen($data) > 500) {\r\n            $response = json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"Variable data must be 500 characters or less\"\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n            die($response);\r\n        }\r\n\r\n        $row = misc\\cache\\fetch('KeyAuthUserVar:' . $secret . ':' . $var . ':' . $session[\"credential\"], \"SELECT `data`, `readOnly` FROM `uservars` WHERE `name` = ? AND `user` = ? AND `app` = ?\", [$var, $session[\"credential\"], $secret], 0);\r\n\r\n        if ($row != \"not_found\") {\r\n            $readOnly = $row[\"readOnly\"];\r\n            if ($readOnly) {\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"Variable is read only\"\r\n                ));\r\n                $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n                header(\"signature: {$sig}\");\r\n                die($response);\r\n            }\r\n        }\r\n\r\n        $query = misc\\mysql\\query(\"REPLACE INTO `uservars` (`name`, `data`, `user`, `app`) VALUES (?, ?, ?, ?)\", [$var, $data, $session[\"credential\"], $secret]);\r\n\r\n        if ($query->affected_rows != 0) {\r\n            misc\\cache\\purge('KeyAuthUserVar:' . $secret . ':' . $var . ':' . $session[\"credential\"]);\r\n            $response = json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"Successfully set variable\",\r\n                \"nonce\" => misc\\etc\\generateRandomString(32)\r\n            ));\r\n\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        } else {\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Failed to set variable\"\r\n            ));\r\n            die($response);\r\n        }\r\n    case 'getvar':\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n        if (!$session[\"validated\"]) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            ));\r\n\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        $var = misc\\etc\\sanitize($_POST['var'] ?? $_GET['var']);\r\n\r\n        $row = misc\\cache\\fetch('KeyAuthUserVar:' . $secret . ':' . $var . ':' . $session[\"credential\"], \"SELECT `data`, `readOnly` FROM `uservars` WHERE `name` = ? AND `user` = ? AND `app` = ?\", [$var, $session[\"credential\"], $secret], 0);\r\n\r\n        if ($row == \"not_found\") {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Variable not found for user\"\r\n            ));\r\n\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        $data = $row['data'];\r\n        $response = json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"Successfully retrieved variable\",\r\n            \"response\" => $data,\r\n            \"nonce\" => misc\\etc\\generateRandomString(32)\r\n        ));\r\n        $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n        header(\"signature: {$sig}\");\r\n\r\n        die($response);\r\n    case 'var':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        $varid = misc\\etc\\sanitize($_POST['varid'] ?? $_GET['varid']);\r\n\r\n        $row = misc\\cache\\fetch('KeyAuthVar:' . $secret . ':' . $varid, \"SELECT `msg`, `authed` FROM `vars` WHERE `varid` = ? AND `app` = ?\", [$varid, $secret], 0);\r\n\r\n        if ($row == \"not_found\") {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Variable not found.\"\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        $msg = $row['msg'];\r\n        $authed = $row['authed'];\r\n\r\n        if ($authed) // if variable requires user to be authenticated\r\n\r\n        {\r\n            if (!$session[\"validated\"]) {\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$sessionunauthed\"\r\n                ));\r\n                $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n                header(\"signature: {$sig}\");\r\n\r\n                die($response);\r\n            }\r\n        }\r\n        $response = json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"$msg\",\r\n            \"nonce\" => misc\\etc\\generateRandomString(32)\r\n        ));\r\n        $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n        header(\"signature: {$sig}\");\r\n\r\n        die($response);\r\n    case 'checkblacklist':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        $hwid = misc\\etc\\sanitize($_POST['hwid'] ?? $_GET['hwid']);\r\n        $ip = api\\shared\\primary\\getIp();\r\n\r\n        $row = misc\\cache\\fetch('KeyAuthBlacklist:' . $secret . ':' . $ip . ':' . $hwid, \"SELECT 1 FROM `bans` WHERE (`hwid` = ? OR `ip` = ?) AND `app` = ?\", [$hwid, $ip, $secret], 0);\r\n\r\n        if ($row != \"not_found\") {\r\n            $response = json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"Client is blacklisted\",\r\n                \"nonce\" => misc\\etc\\generateRandomString(32)\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        } else {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Client is not blacklisted\"\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n    case 'chatget':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n        if (!$session[\"validated\"]) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        $channel = misc\\etc\\sanitize($_POST['channel'] ?? $_GET['channel']);\r\n        $rows = misc\\cache\\fetch('KeyAuthChatMsgs:' . $secret . ':' . $channel, \"SELECT `author`, `message`, `timestamp` FROM `chatmsgs` WHERE `channel` = ? AND `app` = ?\", [$channel, $secret], 1);\r\n\r\n        if ($rows == \"not_found\") {\r\n            $rows = [];\r\n        }\r\n\r\n        $response = json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"Successfully retrieved chat messages\",\r\n            \"messages\" => $rows,\r\n            \"nonce\" => misc\\etc\\generateRandomString(32)\r\n        ));\r\n        $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n        header(\"signature: {$sig}\");\r\n\r\n        die($response);\r\n    case 'chatsend':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n        if (!$session[\"validated\"]) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        $channel = misc\\etc\\sanitize($_POST['channel'] ?? $_GET['channel']);\r\n        $query = misc\\mysql\\query(\"SELECT `delay` FROM `chats` WHERE `name` = ? AND `app` = ?\", [$channel, $secret]);\r\n\r\n        if ($query->num_rows < 1) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Chat channel not found\"\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        $row = mysqli_fetch_array($query->result);\r\n        $delay = $row['delay'];\r\n        $credential = $session[\"credential\"];\r\n        $query = misc\\mysql\\query(\"SELECT `timestamp` FROM `chatmsgs` WHERE `author` = ? AND `channel` = ? AND `app` = ? ORDER BY `id` DESC LIMIT 1\", [$credential, $channel, $secret]);\r\n\r\n        $row = mysqli_fetch_array($query->result);\r\n        $time = $row['timestamp'];\r\n\r\n        if (time() - $time < $delay) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$chatHitDelay\"\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        $query = misc\\mysql\\query(\"SELECT `time` FROM `chatmutes` WHERE `user` = ? AND `app` = ?\", [$credential, $secret]);\r\n        if ($query->num_rows != 0) {\r\n            $row = mysqli_fetch_array($query->result);\r\n            $unmuted = $row[\"time\"];\r\n            $unmuted = date(\"F j, Y, g:i a\", $unmuted);\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"You're muted from chat until $unmuted\"\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        $message = misc\\etc\\sanitize($_POST['message'] ?? $_GET['message']);\r\n\r\n        if (is_null($message)) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Message can't be blank\"\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        if(strlen($message) > 2000) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Message too long!\"\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        misc\\mysql\\query(\"INSERT INTO `chatmsgs` (`author`, `message`, `timestamp`, `channel`,`app`) VALUES (?, ?, ?, ?, ?)\", [$credential, $message, time(), $channel, $secret]);\r\n        misc\\mysql\\query(\"DELETE FROM `chatmsgs` WHERE `app` = ? AND `channel` = ? AND `id` NOT IN ( SELECT `id` FROM ( SELECT `id` FROM `chatmsgs` WHERE `channel` = ? AND `app` = ? ORDER BY `id` DESC LIMIT 50) foo );\", [$secret, $channel, $channel, $secret]);\r\n        misc\\cache\\purge('KeyAuthChatMsgs:' . $secret . ':' . $channel);\r\n        $response = json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"Successfully sent chat message\",\r\n            \"nonce\" => misc\\etc\\generateRandomString(32)\r\n        ));\r\n        $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n        header(\"signature: {$sig}\");\r\n\r\n        die($response);\r\n    case 'log':\r\n        // client isn't expecting a response body, just flush output right away so program can move on to rest of the code quicker\r\n        if (function_exists('fastcgi_finish_request')) { fastcgi_finish_request(); }\r\n\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        $credential = $session[\"credential\"];\r\n\r\n        $currtime = time();\r\n\r\n        $msg = misc\\etc\\sanitize($_POST['message'] ?? $_GET['message']);\r\n\r\n        if(is_null($msg)) {\r\n            die(\"No log data specified\");\r\n        }\r\n\r\n        if(strlen($msg) > 275) {\r\n            die(\"Log data too long\");\r\n        }\r\n\r\n        $pcuser = misc\\etc\\sanitize($_POST['pcuser'] ?? $_GET['pcuser']);\r\n\r\n        if (is_null($webhook)) {\r\n            $roleCheck = misc\\cache\\fetch('KeyAuthSellerCheck:' . $owner, \"SELECT `role`,`expires` FROM `accounts` WHERE `username` = ?\", [$owner], 0);\r\n            if($roleCheck['role'] == \"tester\") {\r\n                $query = misc\\mysql\\query(\"SELECT count(*) AS 'numLogs' FROM `logs` WHERE `logapp` = ?\",[$secret]);\r\n                $row = mysqli_fetch_array($query->result);\r\n                $numLogs = $row[\"numLogs\"];\r\n                if($numLogs >= 20) {\r\n                    die();\r\n                }\r\n            }\r\n            \r\n            misc\\mysql\\query(\"INSERT INTO `logs` (`logdate`, `logdata`, `credential`, `pcuser`,`logapp`) VALUES (?, ?, NULLIF(?, ''), NULLIF(?, ''), ?)\", [$currtime, $msg, $credential, $pcuser, $secret]);\r\n            die();\r\n        }\r\n\r\n        $credential = $session[\"credential\"] ?? \"N/A\";\r\n\r\n        $msg = \"📜 Log: \" . $msg;\r\n\r\n        $ip = api\\shared\\primary\\getIp();\r\n\r\n        $json_data = json_encode([\r\n            // Embeds Array\r\n            \"embeds\" => [\r\n                [\r\n                    // Embed Title\r\n                    \"title\" => $msg,\r\n\r\n                    // Embed left border color in HEX\r\n                    \"color\" => hexdec(\"00ffe1\"),\r\n\r\n                    // Additional Fields array\r\n                    \"fields\" => [[\"name\" => \"🔐 Credential:\", \"value\" => \"```\" . $credential . \"```\"], [\"name\" => \"💻 PC Name:\", \"value\" => \"```\" . $pcuser . \"```\", \"inline\" => true], [\"name\" => \"🌎 Client IP:\", \"value\" => \"```\" . $ip . \"```\", \"inline\" => true]]\r\n                ]\r\n            ]\r\n\r\n        ], JSON_UNESCAPED_SLASHES | JSON_UNESCAPED_UNICODE);\r\n\r\n        $ch = curl_init($webhook);\r\n\r\n        curl_setopt($ch, CURLOPT_HTTPHEADER, array(\r\n            'Content-type: application/json'\r\n        ));\r\n\r\n        curl_setopt($ch, CURLOPT_POST, 1);\r\n\r\n        curl_setopt($ch, CURLOPT_POSTFIELDS, $json_data);\r\n\r\n        curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);\r\n\r\n        curl_setopt($ch, CURLOPT_HEADER, 0);\r\n\r\n        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\r\n\r\n        $response = curl_exec($ch);\r\n\r\n        // If you need to debug, or find out why you can't send message uncomment line below, and execute script.\r\n        // echo $response;\r\n        curl_close($ch);\r\n        die();\r\n\r\n    case 'webhook':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        $webid = misc\\etc\\sanitize($_POST['webid'] ?? $_GET['webid']);\r\n        $row = misc\\cache\\fetch('KeyAuthWebhook:' . $secret . ':' . $webid, \"SELECT `baselink`, `useragent`, `authed` FROM `webhooks` WHERE `webid` = ? AND `app` = ?\", [$webid, $secret], 0);\r\n        if ($row == \"not_found\") {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Webhook Not Found.\"\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        $baselink = $row['baselink'];\r\n        $useragent = $row['useragent'];\r\n        $authed = $row['authed'];\r\n\r\n        if ($authed) // if variable requires user to be authenticated\r\n\r\n        {\r\n            if (!$session[\"validated\"]) {\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$sessionunauthed\"\r\n                ));\r\n                $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n                header(\"signature: {$sig}\");\r\n\r\n                die($response);\r\n            }\r\n        }\r\n\r\n        $params = misc\\etc\\sanitize($_POST['params'] ?? $_GET['params']);\r\n        $body = $_POST['body'] ?? $_GET['body'];\r\n        $contType = misc\\etc\\sanitize($_POST['conttype'] ?? $_GET['conttype']);\r\n\r\n        $url = $baselink .= urldecode($params);\r\n\r\n        $ch = curl_init($url);\r\n\r\n        curl_setopt($ch, CURLOPT_USERAGENT, $useragent);\r\n\r\n        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\r\n\r\n        if (!is_null($body) && !empty($body))\r\n            curl_setopt($ch, CURLOPT_POSTFIELDS, $body);\r\n\r\n        if (!is_null($contType))\r\n            curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type: ' . $contType));\r\n\r\n        $response = curl_exec($ch);\r\n\r\n        $resp = json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"Webhook request successful\",\r\n            \"response\" => \"$response\",\r\n            \"nonce\" => misc\\etc\\generateRandomString(32)\r\n        ));\r\n        $sig = !is_null($enckey) ? hash_hmac('sha256', $resp, $enckey)  : 'No encryption key supplied';\r\n        header(\"signature: {$sig}\");\r\n\r\n        die($resp);\r\n    case 'file':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        $fileid = misc\\etc\\sanitize($_POST['fileid'] ?? $_GET['fileid']);\r\n\r\n        $row = misc\\cache\\fetch('KeyAuthFile:' . $secret . ':' . $fileid, \"SELECT `name`, `url`, `authed` FROM `files` WHERE `app` = ? AND `id` = ?\", [$secret, $fileid], 0);\r\n\r\n        if ($row == \"not_found\") {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"File not Found\"\r\n            ));\r\n\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        $filename = $row['name'];\r\n        $url = $row['url'];\r\n        $authed = $row['authed'];\r\n\r\n        if ($authed) // if file requires user to be authenticated\r\n\r\n        {\r\n            if (!$session[\"validated\"]) {\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$sessionunauthed\"\r\n                ));\r\n\r\n                $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n                header(\"signature: {$sig}\");\r\n\r\n                die($response);\r\n            }\r\n        }\r\n\r\n        ini_set('memory_limit', '-1');\r\n\r\n        $ch = curl_init($url);\r\n        curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);\r\n        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\r\n        $data = curl_exec($ch);\r\n        $statusCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);\r\n\r\n        if ($statusCode == 403 || $statusCode == 404) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"File no longer works, please notify the application developer.\"\r\n            ));\r\n\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n        $contents = bin2hex($data);\r\n\r\n        $response = json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"File download successful\",\r\n            \"contents\" => \"$contents\",\r\n            \"nonce\" => misc\\etc\\generateRandomString(32)\r\n        ));\r\n        $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n        header(\"signature: {$sig}\");\r\n\r\n        die($response);\r\n\r\n    case 'ban':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        $credential = $session[\"credential\"];\r\n        if (!$session[\"validated\"]) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            ));\r\n\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        $reason = misc\\etc\\sanitize($_POST['reason'] ?? $_GET['reason']) ?? \"User banned from triggering ban function in the client\";\r\n\r\n        if(strlen($reason) > 99) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Reason must be 99 characters or less\"\r\n            ));\r\n\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        $hwid = misc\\etc\\sanitize($_POST['hwid'] ?? $_GET['hwid']);\r\n        if (!empty($hwid)) {\r\n            misc\\blacklist\\add($hwid, \"Hardware ID\", $secret);\r\n        }\r\n        $ip = api\\shared\\primary\\getIp();\r\n        misc\\blacklist\\add($ip, \"IP Address\", $secret);\r\n\r\n        misc\\mysql\\query(\"UPDATE `users` SET `banned` = ? WHERE `username` = ? AND `app` = ?\", [$reason, $credential, $secret]);\r\n        if ($query->affected_rows != 0) {\r\n            misc\\cache\\purge('KeyAuthUser:' . $secret . ':' . $credential);\r\n            $response = json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"Successfully Banned User\",\r\n                \"nonce\" => misc\\etc\\generateRandomString(32)\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        } else {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"Failed to ban user.\"\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n    case 'check':\r\n        // retrieve session info\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        $credential = $session[\"credential\"];\r\n        if (!$session[\"validated\"]) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        } else {\r\n            $response = json_encode(array(\r\n                \"success\" => true,\r\n                \"message\" => \"Session is validated.\",\r\n                \"nonce\" => misc\\etc\\generateRandomString(32)\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n    case 'changeUsername':\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n\r\n        if (!$session[\"validated\"]) {\r\n            $response = json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"$sessionunauthed\"\r\n            ));\r\n            $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n            header(\"signature: {$sig}\");\r\n\r\n            die($response);\r\n        }\r\n\r\n        $credential = $session[\"credential\"];\r\n\r\n        $resp = misc\\user\\changeUsername($credential, $_POST['newUsername'] ?? $_GET['newUsername'], $secret);\r\n        switch ($resp) {\r\n            case 'already_used':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"Username already used!\"\r\n                ));\r\n                break;\r\n            case 'failure':\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"Failed to change username!\"\r\n                ));\r\n                break;\r\n            case 'success':\r\n                misc\\session\\killSingular($sessionid, $secret);\r\n                $response = json_encode(array(\r\n                    \"success\" => true,\r\n                    \"message\" => \"Successfully changed username, user logged out.\",\r\n                    \"nonce\" => misc\\etc\\generateRandomString(32)\r\n                ));\r\n                break;\r\n            default:\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"Unhandled Error! Contact us if you need help\"\r\n                ));\r\n                break;\r\n        }\r\n        $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n        header(\"signature: {$sig}\");\r\n\r\n        die($response);\r\n    case 'logout':\r\n        $sessionid = misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']);\r\n        $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n        $enckey = $session[\"enckey\"];\r\n        misc\\session\\killSingular($sessionid, $secret);\r\n        $response = json_encode(array(\r\n            \"success\" => true,\r\n            \"message\" => \"Successfully logged out.\",\r\n            \"nonce\" => misc\\etc\\generateRandomString(32)\r\n        ));\r\n        $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n        header(\"signature: {$sig}\");\r\n\r\n        die($response);\r\n   case '2faenable':\r\n\r\n            list($sessionid, $code) = [misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']), misc\\etc\\sanitize($_POST[\"code\"] ?? $_GET[\"code\"])];\r\n            $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n            $enckey = $session[\"enckey\"];\r\n    \r\n            if (!$session[\"validated\"]) {\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$sessionunauthed\"\r\n                ));\r\n                $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n                header(\"signature: {$sig}\");\r\n    \r\n                die($response);\r\n            }\r\n    \r\n            $row = misc\\cache\\fetch('KeyAuthUser:' . $secret . ':' . $session[\"credential\"], \"SELECT * FROM `users` WHERE `username` = ? AND `app` = ?\", [$session[\"credential\"], $secret], 0);\r\n    \r\n            if ($row[\"2fa\"]) {\r\n    \r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"2fa is already enabled on this account\"\r\n                ));\r\n    \r\n                $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n                header(\"signature: {$sig}\");\r\n    \r\n                die($response);\r\n    \r\n            }\r\n    \r\n            include_once '../../auth/GoogleAuthenticator.php';     \r\n    \r\n            $_2fa = new GoogleAuthenticator();\r\n    \r\n            if (empty($code) || is_null($code)) {\r\n    \r\n                $secret_code = $_2fa->createSecret();\r\n    \r\n                misc\\cache\\insert('KeyAuthTwoFactorAuthentication:' . $session[\"credential\"], $secret_code, 300);\r\n    \r\n                $qrcode = str_replace(urlencode(\"https://chart.googleapis.com/chart?chs=200x200&chld=M|0&cht=qr&chl=\"), \" \", $_2fa->getQRCodeGoogleUrl($session[\"credential\"], $secret_code, 'KeyAuth'));\r\n    \r\n                $response = json_encode(array(\r\n                    \"success\" => true,\r\n                    \"2fa\" => array(\r\n                        \"secret_code\" => $secret_code,\r\n                        \"QRCode\" => \"otpauth://totp/\" . $session[\"credential\"] . \"?secret=\" . $secret_code . \"&issuer=KeyAuth\"\r\n                    )\r\n                ));\r\n    \r\n                $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n                header(\"signature: {$sig}\");\r\n    \r\n                die($response);\r\n    \r\n            }\r\n            else {\r\n    \r\n                $secret_code = misc\\cache\\select('KeyAuthTwoFactorAuthentication:' . $session[\"credential\"]);\r\n    \r\n                if (!$secret_code) {\r\n    \r\n                    $response = json_encode(array(\r\n                        \"success\" => true,\r\n                        \"message\" => \"2fa session has expired\"\r\n                    ));\r\n        \r\n                    $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n                    header(\"signature: {$sig}\");\r\n        \r\n                    die($response);\r\n    \r\n                }\r\n    \r\n                if ($_2fa->verifyCode($secret_code, $code, 2)) {\r\n    \r\n                    misc\\mysql\\query(\"UPDATE `users` SET `2fa` = ?, `googleAuthCode` = ? WHERE `app` = ? AND `username` = ?\", [1, $secret_code, $secret, $session[\"credential\"]]);\r\n                    misc\\cache\\purge('KeyAuthUser:' . $secret . ':' . $session[\"credential\"]);\r\n                    misc\\cache\\purge('KeyAuthTwoFactorAuthentication: ' . $session[\"credential\"]);\r\n    \r\n                    $response = json_encode(array(\r\n                        \"success\" => true,\r\n                        \"message\" => \"2fa successfully activated\"\r\n                    ));\r\n        \r\n                    $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n                    header(\"signature: {$sig}\");\r\n        \r\n                    die($response);\r\n    \r\n                }\r\n                else {\r\n    \r\n                    $response = json_encode(array(\r\n                        \"success\" => true,\r\n                        \"message\" => \"Invalid code please try again\"\r\n                    ));\r\n        \r\n                    $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n                    header(\"signature: {$sig}\");\r\n        \r\n                    die($response);\r\n    \r\n                }\r\n    \r\n            }\r\n        case '2fadisable':\r\n    \r\n            list($sessionid, $code) = [misc\\etc\\sanitize($_POST['sessionid'] ?? $_GET['sessionid']), misc\\etc\\sanitize($_POST[\"code\"] ?? $_GET[\"code\"])];\r\n    \r\n            if (empty($code) || is_null($code)) {\r\n    \r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"Please provide the 2fa code to disable 2fa\"\r\n                ));\r\n    \r\n                $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n                header(\"signature: {$sig}\");\r\n    \r\n                die($response);\r\n    \r\n            }\r\n            \r\n            $session = api\\shared\\primary\\getSession($sessionid, $secret);\r\n            $enckey = $session[\"enckey\"];\r\n    \r\n            if (!$session[\"validated\"]) {\r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"$sessionunauthed\"\r\n                ));\r\n                $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n                header(\"signature: {$sig}\");\r\n    \r\n                die($response);\r\n            }\r\n    \r\n            $row = misc\\cache\\fetch('KeyAuthUser:' . $secret . ':' . $session[\"credential\"], \"SELECT * FROM `users` WHERE `username` = ? AND `app` = ?\", [$session[\"credential\"], $secret], 0);\r\n    \r\n            if (!$row[\"2fa\"]) {\r\n    \r\n                $response = json_encode(array(\r\n                    \"success\" => false,\r\n                    \"message\" => \"2fa is not enabled on this account\"\r\n                ));\r\n    \r\n                $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n                header(\"signature: {$sig}\");\r\n    \r\n                die($response);\r\n    \r\n            }\r\n    \r\n            include_once '../../auth/GoogleAuthenticator.php';     \r\n    \r\n            $_2fa = new GoogleAuthenticator();\r\n    \r\n            $secret_code = $row[\"googleAuthCode\"];\r\n    \r\n            if ($_2fa->verifyCode($secret_code, $code, 2)) {\r\n    \r\n                misc\\mysql\\query(\"UPDATE `users` SET `2fa` = ?, `googleAuthCode` = ? WHERE `app` = ? AND `username` = ?\", [0, NULL, $secret, $row[\"username\"]]);\r\n                misc\\cache\\purge('KeyAuthUser:' . $secret . ':' . $session[\"credential\"]);\r\n    \r\n                $response = json_encode(array(\r\n                    \"success\" => true,\r\n                    \"message\" => \"2fa successfully activated\"\r\n                ));\r\n    \r\n                $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n                header(\"signature: {$sig}\");\r\n    \r\n                die($response);\r\n    \r\n            }\r\n            else {\r\n    \r\n                $response = json_encode(array(\r\n                    \"success\" => true,\r\n                    \"message\" => \"Invalid code please try again\"\r\n                ));\r\n    \r\n                $sig = !is_null($enckey) ? hash_hmac('sha256', $response, $enckey)  : 'No encryption key supplied';\r\n                header(\"signature: {$sig}\");\r\n    \r\n                die($response);\r\n    \r\n            }\r\n    \r\n        default:\r\n            die(json_encode(array(\r\n                \"success\" => false,\r\n                \"message\" => \"The value inputted for type paramater was not found\"\r\n            )));\r\n    }\r\n","size_bytes":79184},"app/layout/aside.php":{"content":"<?php\n\n$page = isset($_GET['page']) ? $_GET['page'] : \"manage-apps\";\n\n?>\n\n<style>\n/* Hide vertical scrollbar for Webkit-based browsers (e.g., Chrome, Safari) */\n*::-webkit-scrollbar {\n    width: 6px;\n}\n\n*::-webkit-scrollbar-track {\n    background: transparent;\n}\n\n*::-webkit-scrollbar-thumb {\n    background: rgba(96, 165, 250, 0.3);\n    border-radius: 10px;\n}\n\n*::-webkit-scrollbar-thumb:hover {\n    background: rgba(96, 165, 250, 0.5);\n}\n</style>\n\n<aside id=\"sidebar\"\n    class=\"flex hidden fixed top-0 left-0 z-20 flex-col flex-shrink-0 pt-16 w-64 h-full duration-200 lg:flex transition-width\"\n    aria-label=\"Sidebar\">\n    <div class=\"flex relative flex-col flex-1 pt-0 min-h-0 bg-gradient-to-b from-[#0f0f17] via-[#1a1a24] to-[#0f0f17] border-r border-gray-800/50 backdrop-blur-xl\">\n        <div class=\"flex overflow-y-auto flex-col flex-1 pt-5 pb-4\">\n            <div class=\"flex-1 px-3 space-y-1 bg-transparent mt-8\">\n                <?php require '../app/layout/profile.php';?>\n                <div class=\"mb-4 border-b border-gray-800/50\">\n                    <ul class=\"grid grid-cols-2 -mb-px text-sm font-medium text-center\" id=\"myTab\"\n                        data-tabs-toggle=\"#myTabContent\" role=\"tablist\">\n                        <?php if (isset($_SESSION[\"app\"])){ ?>\n                        <li class=\"mr-1\" role=\"presentation\">\n                            <button class=\"inline-block p-4 rounded-t-lg text-gray-400 hover:text-white hover:bg-gradient-to-r hover:from-blue-600/10 hover:to-purple-600/10 transition-all duration-300 w-full\" id=\"app-tab\"\n                                data-tabs-target=\"#app\" type=\"button\" role=\"tab\" aria-controls=\"app\" data-tbt=\"app\"\n                                aria-selected=\"false\" data-popover-target=\"app-popover\">\n                                <i class=\"lni lni-package mr-1\"></i>App\n                            </button>\n                                <?php dashboard\\primary\\popover(\"app-popover\", \"Application\", \"Find everything related to your application here\"); ?>\n                        </li>\n                        <?php } ?>\n                        <li class=\"mr-1\" role=\"presentation\">\n                            <button class=\"inline-block p-4 rounded-t-lg text-gray-400 hover:text-white hover:bg-gradient-to-r hover:from-purple-600/10 hover:to-pink-600/10 transition-all duration-300 w-full\" id=\"account-tab\"\n                                data-tabs-target=\"#account\" type=\"button\" role=\"tab\" data-tbt=\"account\"\n                                aria-controls=\"account\" aria-selected=\"false\"\n                                data-popover-target=\"account-popover\">\n                                <i class=\"lni lni-user mr-1\"></i>Account\n                            </button>\n                                <?php dashboard\\primary\\popover(\"account-popover\", \"Account\", \"Find everything related to your Account here.\"); ?>\n                        </li>\n                    </ul>\n                </div>\n                <div id=\"myTabContent\">\n                    <div class=\"hidden p-2 rounded-lg\" id=\"app\" role=\"tabpanel\" aria-labelledby=\"app-tab\">\n                        <ul class=\"space-y-1 font-medium\">\n                            <?php if (!($role == \"Manager\" && !($permissions & 1))){ ?>\n                            <li>\n                                <a href=\"?page=licenses\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white hover:bg-gradient-to-r hover:from-blue-600/20 hover:to-purple-600/20 border border-transparent hover:border-blue-500/30 group transition-all duration-300\">\n                                    <i class=\"lni lni-key text-blue-400\"></i>\n                                    <span class=\"ml-3\">Licenses</span>\n                                </a>\n                            </li>\n                            <?php } ?>\n\n                            <?php if (!($role == \"Manager\" && !($permissions & 2))){ ?>\n                            <li>\n                                <a href=\"?page=users\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white hover:bg-gradient-to-r hover:from-purple-600/20 hover:to-pink-600/20 border border-transparent hover:border-purple-500/30 group transition-all duration-300\">\n                                    <i class=\"lni lni-users text-purple-400\"></i>\n                                    <span class=\"ml-3\">Users</span>\n                                </a>\n                            </li>\n                            <?php } ?>\n\n                            <?php if (!($role == \"Manager\" && !($permissions & 2048))){ ?>\n                            <li>\n                                <a href=\"?page=tokens\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white hover:bg-gradient-to-r hover:from-pink-600/20 hover:to-red-600/20 border border-transparent hover:border-pink-500/30 group transition-all duration-300\">\n                                    <i class=\"lni lni-tag text-pink-400\"></i>\n                                    <span class=\"ml-3\">Tokens</span>\n                                </a>\n                            </li>\n                            <?php } ?>\n\n                            <?php if (!($role == \"Manager\" && !($permissions & 4))){ ?>\n                            <li>\n                                <a href=\"?page=subscriptions\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white hover:bg-gradient-to-r hover:from-yellow-600/20 hover:to-orange-600/20 border border-transparent hover:border-yellow-500/30 group transition-all duration-300\">\n                                    <i class=\"lni lni-crown text-yellow-400\"></i>\n                                    <span class=\"ml-3\">Subscriptions</span>\n                                </a>\n                            </li>\n                            <?php } ?>\n\n                            <?php if (!($role == \"Manager\" && !($permissions & 8))){ ?>\n                            <li>\n                                <a href=\"?page=chats\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white hover:bg-gradient-to-r hover:from-green-600/20 hover:to-emerald-600/20 border border-transparent hover:border-green-500/30 group transition-all duration-300\">\n                                    <i class=\"lni lni-popup text-green-400\"></i>\n                                    <span class=\"ml-3\">Chats</span>\n                                </a>\n                            </li>\n                            <?php } ?>\n\n                            <?php if (!($role == \"Manager\" && !($permissions & 16))){ ?>\n                            <li>\n                                <a href=\"?page=sessions\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white hover:bg-gradient-to-r hover:from-cyan-600/20 hover:to-blue-600/20 border border-transparent hover:border-cyan-500/30 group transition-all duration-300\">\n                                    <i class=\"lni lni-timer text-cyan-400\"></i>\n                                    <span class=\"ml-3\">Sessions</span>\n                                </a>\n                            </li>\n                            <?php } ?>\n\n                            <?php if (!($role == \"Manager\" && !($permissions & 32))){ ?>\n                            <li>\n                                <a href=\"?page=webhooks\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white hover:bg-gradient-to-r hover:from-indigo-600/20 hover:to-purple-600/20 border border-transparent hover:border-indigo-500/30 group transition-all duration-300\">\n                                    <i class=\"lni lni-webhook text-indigo-400\"></i>\n                                    <span class=\"ml-3\">Webhooks</span>\n                                </a>\n                            </li>\n                            <?php } ?>\n\n                            <?php if (!($role == \"Manager\" && !($permissions & 64))){ ?>\n                            <li>\n                                <a href=\"?page=files\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white hover:bg-gradient-to-r hover:from-teal-600/20 hover:to-green-600/20 border border-transparent hover:border-teal-500/30 group transition-all duration-300\">\n                                    <i class=\"lni lni-files text-teal-400\"></i>\n                                    <span class=\"ml-3\">Files</span>\n                                </a>\n                            </li>\n                            <?php } ?>\n\n                            <?php if (!($role == \"Manager\" && !($permissions & 128))){ ?>\n                            <li>\n                                <a href=\"?page=vars\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white hover:bg-gradient-to-r hover:from-violet-600/20 hover:to-purple-600/20 border border-transparent hover:border-violet-500/30 group transition-all duration-300\">\n                                    <i class=\"lni lni-code text-violet-400\"></i>\n                                    <span class=\"ml-3\">Variables</span>\n                                </a>\n                            </li>\n                            <?php } ?>\n\n                            <?php if (!($role == \"Manager\" && !($permissions & 256))){ ?>\n                            <li>\n                                <a href=\"?page=logs\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white hover:bg-gradient-to-r hover:from-orange-600/20 hover:to-yellow-600/20 border border-transparent hover:border-orange-500/30 group transition-all duration-300\">\n                                    <i class=\"lni lni-archive text-orange-400\"></i>\n                                    <span class=\"ml-3\">Logs</span>\n                                </a>\n                            </li>\n                            <?php } ?>\n\n                            <?php if (!($role == \"Manager\" && !($permissions & 512))){ ?>\n                            <li>\n                                <a href=\"?page=blacklists\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white hover:bg-gradient-to-r hover:from-red-600/20 hover:to-pink-600/20 border border-transparent hover:border-red-500/30 group transition-all duration-300\">\n                                    <i class=\"lni lni-ban text-red-400\"></i>\n                                    <span class=\"ml-3\">Blacklists</span>\n                                </a>\n                            </li>\n                            <?php } ?>\n\n                            <?php if (!($role == \"Manager\" && !($permissions & 1024))){ ?>\n                            <li>\n                                <a href=\"?page=app-settings\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white hover:bg-gradient-to-r hover:from-gray-600/20 hover:to-slate-600/20 border border-transparent hover:border-gray-500/30 group transition-all duration-300\">\n                                    <i class=\"lni lni-cog text-gray-400\"></i>\n                                    <span class=\"ml-3\">Settings</span>\n                                </a>\n                            </li>\n                            <?php } ?>\n\n                            <?php if ($role == \"seller\" || $role == \"developer\"){ ?>\n                            <li class=\"pt-3 border-t border-gray-800/50\">\n                                <a href=\"?page=seller-api\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white hover:bg-gradient-to-r hover:from-blue-600/20 hover:to-cyan-600/20 border border-transparent hover:border-blue-500/30 group transition-all duration-300\">\n                                    <i class=\"lni lni-key text-blue-400\"></i>\n                                    <span class=\"ml-3\">Seller API</span>\n                                    <span class=\"ml-auto bg-blue-500/20 text-blue-400 px-2 py-0.5 rounded-full text-xs font-semibold\">API</span>\n                                </a>\n                            </li>\n                            <li>\n                                <a href=\"?page=telegram-bot\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white hover:bg-gradient-to-r hover:from-blue-600/20 hover:to-purple-600/20 border border-transparent hover:border-blue-500/30 group transition-all duration-300\">\n                                    <i class=\"lni lni-telegram text-blue-400\"></i>\n                                    <span class=\"ml-3\">Telegram Bot</span>\n                                    <span class=\"ml-auto bg-green-500/20 text-green-400 px-2 py-0.5 rounded-full text-xs font-semibold\">Pro</span>\n                                </a>\n                            </li>\n                            <?php } ?>\n\n                            <?php if ($role != \"Manager\"){ ?>\n                            <li>\n                                <a href=\"?page=audit-logs\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white hover:bg-gradient-to-r hover:from-purple-600/20 hover:to-pink-600/20 border border-transparent hover:border-purple-500/30 group transition-all duration-300\">\n                                    <i class=\"lni lni-archive text-purple-400\"></i>\n                                    <span class=\"ml-3\">Audit Logs</span>\n                                </a>\n                            </li>\n                            <?php } ?>\n                        </ul>\n                    </div>\n                    <div class=\"hidden p-2 rounded-lg\" id=\"account\" role=\"tabpanel\" aria-labelledby=\"account-tab\">\n                        <ul class=\"space-y-1 font-medium\">\n                            <li>\n                                <a href=\"?page=manage-apps\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white hover:bg-gradient-to-r hover:from-blue-600/20 hover:to-purple-600/20 border border-transparent hover:border-blue-500/30 group transition-all duration-300\">\n                                    <i class=\"lni lni-package text-blue-400\"></i>\n                                    <span class=\"ml-3\">Manage Apps</span>\n                                </a>\n                            </li>\n                            <li>\n                                <a href=\"?page=account-settings\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white hover:bg-gradient-to-r hover:from-purple-600/20 hover:to-pink-600/20 border border-transparent hover:border-purple-500/30 group transition-all duration-300\">\n                                    <i class=\"lni lni-cog text-purple-400\"></i>\n                                    <span class=\"ml-3\">Settings</span>\n                                </a>\n                            </li>\n                            <li>\n                                <a href=\"?page=account-logs\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white hover:bg-gradient-to-r hover:from-pink-600/20 hover:to-red-600/20 border border-transparent hover:border-pink-500/30 group transition-all duration-300\">\n                                    <i class=\"lni lni-archive text-pink-400\"></i>\n                                    <span class=\"ml-3\">Account Logs</span>\n                                </a>\n                            </li>\n                            <?php if ($role != \"tester\") { ?>\n                            <li class=\"pt-3 border-t border-gray-800/50\">\n                                <a href=\"?page=upgrade\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white bg-gradient-to-r from-blue-600/10 to-purple-600/10 border border-blue-500/30 hover:from-blue-600/30 hover:to-purple-600/30 hover:border-blue-500/50 group transition-all duration-300\">\n                                    <i class=\"lni lni-rocket text-blue-400\"></i>\n                                    <span class=\"ml-3 font-semibold\">View Plans</span>\n                                    <span class=\"ml-auto bg-blue-500/20 text-blue-400 px-2 py-0.5 rounded-full text-xs font-semibold\">Upgrade</span>\n                                </a>\n                            </li>\n                            <?php } else { ?>\n                            <li class=\"pt-3 border-t border-gray-800/50\">\n                                <a href=\"?page=upgrade\"\n                                    class=\"flex items-center p-3 rounded-xl text-gray-300 hover:text-white bg-gradient-to-r from-green-600/10 to-emerald-600/10 border border-green-500/30 hover:from-green-600/30 hover:to-emerald-600/30 hover:border-green-500/50 group transition-all duration-300 animate-pulse\">\n                                    <i class=\"lni lni-rocket text-green-400\"></i>\n                                    <span class=\"ml-3 font-semibold\">Upgrade Now</span>\n                                    <span class=\"ml-auto bg-green-500/20 text-green-400 px-2 py-0.5 rounded-full text-xs font-semibold\">Free</span>\n                                </a>\n                            </li>\n                            <?php } ?>\n                        </ul>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</aside>\n","size_bytes":17839},"app/layout/breadcrumb.php":{"content":"<nav class=\"flex mb-5\" aria-label=\"Breadcrumb\">\n    <ol class=\"inline-flex items-center space-x-1 md:space-x-2\">\n        <li class=\"inline-flex items-center\">\n            <a href=\"?page=manage-apps\"\n                class=\"inline-flex items-center text-sm font-medium text-gray-400 hover:text-white\">\n                <svg class=\"w-3 h-3 mr-2.5\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\"\n                    viewBox=\"0 0 20 20\">\n                    <path\n                        d=\"m19.707 9.293-2-2-7-7a1 1 0 0 0-1.414 0l-7 7-2 2a1 1 0 0 0 1.414 1.414L2 10.414V18a2 2 0 0 0 2 2h3a1 1 0 0 0 1-1v-4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v4a1 1 0 0 0 1 1h3a2 2 0 0 0 2-2v-7.586l.293.293a1 1 0 0 0 1.414-1.414Z\" />\n                </svg>\n                Manage Apps\n            </a>\n        </li>\n        <li>\n            <div class=\"flex items-center\">\n                <i class=\"lni lni-angle-double-right mr-2\"></i>\n                <label class=\"inline-flex items-center text-sm font-medium text-gray-400\">Current App:\n                    <?= $_SESSION['selectedApp']; ?> </label>\n            </div>\n        </li>\n    </ol>\n</nav>\n","size_bytes":1151},"app/layout/footer.php":{"content":"<footer class=\"bg-[#0f0f17] rounded-lg shadow m-4\">\n    <div class=\"w-full mx-auto max-w-screen-xl p-4 md:flex md:items-center md:justify-between\">\n      <span class=\"text-sm text-white-500 sm:text-center\">Copyright © 2020 - <script>document.write(new Date().getFullYear())</script>  GenZ Auth LLC. All Rights Reserved.\n    </span>\n    <ul class=\"flex flex-wrap items-center mt-3 text-sm font-medium sm:mt-0\">\n        <li>\n            <a href=\"https://github.com/KeyAuth/KeyAuth-Source-Code\" target=\"_blank\" class=\"mr-4 hover:underline md:mr-6 \">Source Code</a>\n        </li>\n        <li>\n            <a href=\"https://betav3.keyauth.cc/terms\" target=\"_blank\" class=\"mr-4 hover:underline md:mr-6\">Terms and Conditions</a>\n        </li>\n        <li>\n            <a href=\"https://keyauth.tawk.help\" target=\"_blank\" class=\"hover:underline\">Help</a>\n        </li>\n    </ul>\n    </div>\n</footer>\n","size_bytes":891},"app/layout/master.php":{"content":"<?php\n$page = isset($_GET['page']) ? $_GET['page'] : \"manage-apps\";\n\nrequire '../app/layout/topbar.php';\n\n?>\n\n<div class=\"flex overflow-hidden pt-16 bg-[#09090d]\">\n    \n    <?php\n    if ($_SESSION[\"role\"] == 'Reseller'){\n        include '../app/layout/reselleraside.php';\n    } else{\n        include '../app/layout/aside.php';\n    }\n    \n    ?>\n\n    <div class=\"hidden fixed inset-0 z-10\" id=\"sidebarBackdrop\"></div>\n\n    <?php\n    if (str_contains($page, \".\")) {\n        require '../404_error.html';\n    }\n\n    ?>\n    <div id=\"main-content\" class=\"overflow-y-auto relative w-full h-full lg:ml-64\">\n        <main>\n        <?php\n            require __DIR__ . \"/../pages/{$page}.php\";\n            ?>\n\n        </main>\n\n        <?php \n    require '../app/layout/footer.php';\n    ?>\n    </div>\n</div>\n","size_bytes":796},"app/layout/profile.php":{"content":"<?php\n$query = misc\\mysql\\query(\"SELECT * FROM `accounts` WHERE `username` = ?\", [$_SESSION['username']]);\n\nif ($query->num_rows > 0) {\n    while ($row_ = mysqli_fetch_array($query->result)) {\n        $acclogs = $row_['acclogs'];\n        $expiry = $row_[\"expires\"];\n        $emailVerify = $row_[\"emailVerify\"];\n    }\n}\n\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n    if (isset($_POST['logout'])) {\n        session_destroy();\n        header('Location: /login');\n        exit;\n    }\n}\n\n?>\n\n<div class=\"w-full max-w-sm bg-gradient-to-br from-[#0f0f17] to-[#1a1a24] border border-gray-700/50 rounded-2xl shadow-xl backdrop-blur-sm hover:shadow-2xl transition-all duration-300\">\n    <div class=\"flex justify-end px-4 pt-2\">\n        <button id=\"dropdownButton\" data-dropdown-toggle=\"dropdown\" class=\"inline-block text-gray-400 hover:text-white hover:bg-gray-800/50 focus:ring-0 p-2 rounded-lg transition-all duration-300\" type=\"button\">\n            <span class=\"sr-only\">Open dropdown</span>\n            <svg class=\"w-5 h-5\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" viewBox=\"0 0 16 3\">\n                <path d=\"M2 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm6.041 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM14 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z\" />\n            </svg>\n        </button>\n        <!-- Dropdown menu -->\n        <form method=\"post\">\n            <div id=\"dropdown\" class=\"z-10 hidden text-base list-none bg-gradient-to-br from-[#0f0f17] to-[#1a1a24] border border-blue-500/30 rounded-xl shadow-2xl w-48 backdrop-blur-xl\">\n                <ul class=\"py-2\" aria-labelledby=\"dropdownButton\">\n                    <li>\n                        <a href=\"?page=account-settings\" class=\"flex items-center px-4 py-3 text-sm text-gray-300 hover:bg-gradient-to-r hover:from-blue-600/20 hover:to-purple-600/20 hover:text-white transition-all duration-300 rounded-t-xl\">\n                            <i class=\"lni lni-cog mr-2 text-blue-400\"></i> Account Settings\n                        </a>\n                    </li>\n                    <li>\n                        <a href=\"?page=account-logs\" class=\"flex items-center px-4 py-3 text-sm text-gray-300 hover:bg-gradient-to-r hover:from-purple-600/20 hover:to-pink-600/20 hover:text-white transition-all duration-300\">\n                            <i class=\"lni lni-archive mr-2 text-purple-400\"></i> Account Logs\n                        </a>\n                    </li>\n                    <li>\n                        <a href=\"?page=logout\" class=\"flex items-center px-4 py-3 text-sm text-gray-300 hover:bg-gradient-to-r hover:from-red-600/20 hover:to-pink-600/20 hover:text-white transition-all duration-300 rounded-b-xl\">\n                            <i class=\"lni lni-exit mr-2 text-red-400\"></i> Log Out\n                        </a>\n                    </li>\n                </ul>\n            </div>\n        </form>\n    </div>\n    <div class=\"flex flex-col items-center pb-6 px-4\">\n        <div class=\"relative mb-4 group\">\n            <div class=\"absolute inset-0 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full blur-lg opacity-50 group-hover:opacity-75 transition-opacity duration-300\"></div>\n            <img class=\"relative w-24 h-24 rounded-full border-4 border-gray-800 shadow-xl\" src=\"<?= $_SESSION[\"img\"]; ?>\" alt=\"profile image\" />\n        </div>\n        <?php if ($role == \"seller\") { ?>\n            <h5 class=\"mb-2 text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500 stars\"><?= $_SESSION[\"username\"]; ?></h5>\n        <?php } else { ?>\n            <h5 class=\"mb-2 text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-400\"><?= $_SESSION[\"username\"]; ?></h5>\n        <?php } ?>\n\n        <?php\n        $badgeClasses = \"inline-flex items-center px-3 py-1 text-xs font-bold rounded-full border mb-3 transition-all duration-300 hover:scale-105\";\n        $textClasses = \"\";\n        $borderColor = \"\";\n\n        if ($role == \"seller\") {\n            $textClasses = \"text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-400\";\n            $borderColor = \"border-blue-400/50 bg-blue-500/10\";\n        } elseif ($role == \"developer\") {\n            $textClasses = \"text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-400\";\n            $borderColor = \"border-purple-400/50 bg-purple-500/10\";\n        } elseif ($role == \"tester\") {\n            $textClasses = \"text-transparent bg-clip-text bg-gradient-to-r from-gray-400 to-gray-500\";\n            $borderColor = \"border-gray-400/50 bg-gray-500/10\";\n        } else {\n            $textClasses = \"text-gray-400\";\n            $borderColor = \"border-gray-500/50 bg-gray-600/10\";\n        }\n\n        echo \"<span class=\\\"$badgeClasses $borderColor\\\"><span class=\\\"$textClasses\\\">\" . strtoupper($role) . \" PLAN</span></span>\";\n        ?>\n\n        <?php\n        $display = match ($role) {\n            'tester' => '<div class=\"text-sm text-gray-400 flex items-center\"><i class=\"lni lni-infinite mr-2 text-green-400\"></i><b>Expires:</b>&nbsp;Free Forever</div>',\n            'developer' => '<div class=\"text-sm text-gray-400 flex items-center\"><i class=\"lni lni-calendar mr-2 text-purple-400\"></i><b>Expires:</b>&nbsp;<span id=\"expiryLabel\"></span></div>',\n            'seller' => '<div class=\"text-sm text-gray-400 flex items-center\" id=\"expirationLbl\"><i class=\"lni lni-calendar mr-2 text-blue-400\"></i><b>Expires:</b>&nbsp;<span id=\"expiryLabel\"></span></div>',\n            'Reseller' => '<div class=\"text-sm text-gray-400 flex items-center\"><i class=\"lni lni-users mr-2 text-cyan-400\"></i><b>Expires:</b>&nbsp;Owner Decides</div>',\n            'Manager' => '<div class=\"text-sm text-gray-400 flex items-center\"><i class=\"lni lni-user mr-2 text-yellow-400\"></i><b>Expires:</b>&nbsp;Owner Decides</div>',\n            'default' => '<div class=\"text-sm text-gray-400 flex items-center\"><i class=\"lni lni-infinite mr-2 text-gray-400\"></i><b>Expires:</b>&nbsp;Never</div>'\n        };\n        echo $display;\n\n        if ($role === 'developer' || $role === 'seller') {\n            echo '<script>';\n            echo 'document.getElementById(\"expiryLabel\").textContent = convertTimestamp(' . $expiry . ');';\n            echo '</script>';\n        }\n        ?>\n    </div>\n</div>\n<br>\n","size_bytes":6300},"app/layout/topbar.php":{"content":"<?php\nif (isset($_POST[\"shop\"])) {\n   dashboard\\primary\\error(\"Coming soon!\");\n}\n?>\n\n<nav class=\"fixed z-30 w-full bg-gradient-to-r from-[#0f0f17] via-[#1a1a24] to-[#0f0f17] border-b border-gray-800/50 backdrop-blur-xl\" style=\"height: 64px;\">\n    <div class=\"py-2 px-3 lg:px-5 lg:pl-3\" style=\"height: 100%;\">\n        <div class=\"flex justify-between items-center h-full\">\n            <div class=\"flex justify-start items-center h-full\">\n                <div\n                    class=\"hidden p-2 text-white rounded cursor-pointer lg:inline hover:opacity-60 transition duration-200 -ml-8\">\n                    <div class=\"w-6 h-6\">\n                    </div>\n                </div>\n\n                <button id=\"toggleSidebarMobile\" aria-expanded=\"true\" aria-controls=\"sidebar\"\n                    class=\"p-2 mr-2 text-white rounded-lg cursor-pointer lg:hidden hover:bg-gray-800/50 hover:opacity-60 focus:ring-0 transition-all duration-300\">\n                    <svg id=\"toggleSidebarMobileHamburger\" class=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\n                        xmlns=\"http://www.w3.org/2000/svg\">\n                        <path fill-rule=\"evenodd\"\n                            d=\"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h6a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z\"\n                            clip-rule=\"evenodd\"></path>\n                    </svg>\n                    <svg id=\"toggleSidebarMobileClose\" class=\"hidden w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 20 20\"\n                        xmlns=\"http://www.w3.org/2000/svg\">\n                        <path fill-rule=\"evenodd\"\n                            d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\"\n                            clip-rule=\"evenodd\"></path>\n                    </svg>\n                </button>\n\n                <a href=\"?page=manage-apps\" class=\"flex items-center group\">\n                    <div class=\"relative\" style=\"max-height: 40px;\">\n                        <img src=\"https://cdn.keyauth.cc/v3/imgs/KeyauthBanner.png\" alt=\"GenZ Auth\" class=\"h-8 w-auto transition-transform duration-300 group-hover:scale-105\">\n                        <div class=\"absolute inset-0 bg-gradient-to-r from-blue-600/0 via-purple-600/20 to-pink-600/0 opacity-0 group-hover:opacity-100 transition-opacity duration-300 blur-xl\"></div>\n                    </div>\n                </a>\n            </div>\n\n\n            <div class=\"hidden md:flex items-center gap-2 h-full\">\n                <a href=\"https://keyauth.readme.io\" target=\"_blank\"\n                    class=\"inline-flex items-center text-gray-300 bg-gray-800/50 hover:bg-gradient-to-r hover:from-blue-600/20 hover:to-purple-600/20 hover:text-white hover:border-blue-500/50 focus:ring-0 font-medium rounded-lg text-xs px-3 py-1.5 transition-all duration-300 border border-gray-700/50 backdrop-blur-sm\">\n                    <i class=\"lni lni-code mr-2\"></i>Docs\n                </a>\n\n                <a href=\"https://github.com/keyauth\" target=\"_blank\"\n                    class=\"inline-flex items-center text-gray-300 bg-gray-800/50 hover:bg-gradient-to-r hover:from-purple-600/20 hover:to-pink-600/20 hover:text-white hover:border-purple-500/50 focus:ring-0 font-medium rounded-lg text-xs px-3 py-1.5 transition-all duration-300 border border-gray-700/50 backdrop-blur-sm\">\n                    <i class=\"lni lni-github-original mr-2\"></i>GitHub\n                </a>\n\n                <a href=\"https://youtube.com/keyauth\" target=\"_blank\"\n                    class=\"inline-flex items-center text-gray-300 bg-gray-800/50 hover:bg-gradient-to-r hover:from-red-600/20 hover:to-pink-600/20 hover:text-white hover:border-red-500/50 focus:ring-0 font-medium rounded-lg text-xs px-3 py-1.5 transition-all duration-300 border border-gray-700/50 backdrop-blur-sm\">\n                    <i class=\"lni lni-youtube mr-2\"></i>YouTube\n                </a>\n\n                <a href=\"https://t.me/keyauth\" target=\"_blank\"\n                    class=\"inline-flex items-center text-gray-300 bg-gray-800/50 hover:bg-gradient-to-r hover:from-blue-600/20 hover:to-cyan-600/20 hover:text-white hover:border-blue-500/50 focus:ring-0 font-medium rounded-lg text-xs px-3 py-1.5 transition-all duration-300 border border-gray-700/50 backdrop-blur-sm\">\n                    <i class=\"lni lni-telegram-original mr-2\"></i>Telegram\n                </a>\n\n                <a href=\"https://vaultcord.com\" target=\"_blank\"\n                    class=\"inline-flex items-center text-gray-300 bg-gray-800/50 hover:bg-gradient-to-r hover:from-indigo-600/20 hover:to-blue-600/20 hover:text-white hover:border-indigo-500/50 focus:ring-0 font-medium rounded-lg text-xs px-3 py-1.5 transition-all duration-300 border border-gray-700/50 backdrop-blur-sm\">\n                    <i class=\"lni lni-discord-alt mr-2\"></i>VaultCord\n                </a>\n            </div>\n\n            <!-- Mobile Dropdown Menu -->\n            <div id=\"dropdownDotsHorizontal\"\n                class=\"z-10 hidden bg-gradient-to-br from-[#0f0f17] to-[#1a1a24] divide-y divide-gray-800/50 border border-blue-500/30 rounded-xl shadow-2xl w-48 backdrop-blur-xl\">\n                <ul class=\"py-2 text-white text-sm\" aria-labelledby=\"dropdownMenuIconHorizontalButton\">\n                    <li>\n                        <a href=\"https://keyauth.readme.io\" target=\"_blank\"\n                            class=\"flex items-center px-4 py-3 hover:bg-gradient-to-r hover:from-blue-600/20 hover:to-purple-600/20 transition-all duration-300\">\n                            <i class=\"lni lni-code mr-3 text-blue-400\"></i>Documentation\n                        </a>\n                    </li>\n                    <li>\n                        <a href=\"https://github.com/keyauth\" target=\"_blank\"\n                            class=\"flex items-center px-4 py-3 hover:bg-gradient-to-r hover:from-purple-600/20 hover:to-pink-600/20 transition-all duration-300\">\n                            <i class=\"lni lni-github-original mr-3 text-purple-400\"></i>Examples\n                        </a>\n                    </li>\n                    <li>\n                        <a href=\"https://youtube.com/keyauth\" target=\"_blank\"\n                            class=\"flex items-center px-4 py-3 hover:bg-gradient-to-r hover:from-red-600/20 hover:to-pink-600/20 transition-all duration-300\">\n                            <i class=\"lni lni-youtube mr-3 text-red-400\"></i>YouTube\n                        </a>\n                    </li>\n                    <li>\n                        <a href=\"https://t.me/keyauth\" target=\"_blank\"\n                            class=\"flex items-center px-4 py-3 hover:bg-gradient-to-r hover:from-blue-600/20 hover:to-cyan-600/20 transition-all duration-300\">\n                            <i class=\"lni lni-telegram-original mr-3 text-blue-400\"></i>Telegram\n                        </a>\n                    </li>\n                    <li>\n                        <a href=\"https://twitter.com/keyauth\" target=\"_blank\"\n                            class=\"flex items-center px-4 py-3 hover:bg-gradient-to-r hover:from-sky-600/20 hover:to-blue-600/20 transition-all duration-300\">\n                            <i class=\"lni lni-twitter-original mr-3 text-sky-400\"></i>Twitter\n                        </a>\n                    </li>\n                    <li>\n                        <a href=\"https://instagram.com/keyauthllc\" target=\"_blank\"\n                            class=\"flex items-center px-4 py-3 hover:bg-gradient-to-r hover:from-pink-600/20 hover:to-purple-600/20 transition-all duration-300\">\n                            <i class=\"lni lni-instagram-original mr-3 text-pink-400\"></i>Instagram\n                        </a>\n                    </li>\n                    <li>\n                        <a href=\"https://vaultcord.com\" target=\"_blank\"\n                            class=\"flex items-center px-4 py-3 hover:bg-gradient-to-r hover:from-indigo-600/20 hover:to-blue-600/20 transition-all duration-300 rounded-b-xl\">\n                            <i class=\"lni lni-discord-alt mr-3 text-indigo-400\"></i>VaultCord\n                        </a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </div>\n</nav>\n","size_bytes":8385},"app/pages/account-logs.php":{"content":"<?php\nif ($_SESSION['username'] == \"demodeveloper\" || $_SESSION['username'] == \"demoseller\") \n{\n   dashboard\\primary\\error(\"Due to privacy purposes, demo accounts do not have access to account logs!\");\n   die();\n}\n?>\n<div class=\"p-4 bg-[#09090d] block sm:flex items-center justify-between lg:mt-1.5\">\n    <div class=\"mb-1 w-full bg-[#0f0f17] rounded-xl\">\n        <div class=\"mb-4 p-4\">\n            <?php require '../app/layout/breadcrumb.php'; ?>\n            <h1 class=\"text-xl font-semibold text-white-900 sm:text-2xl\">Account Logs</h1>\n            <p class=\"text-xs text-gray-500\">View the event history of your account.</p>\n            <div class=\"p-4 flex flex-col\">\n                <div class=\"overflow-x-auto\">\n                    <!-- START TABLE -->\n                    <div class=\"relative overflow-x-auto shadow-md sm:rounded-lg pt-5\">\n                        <table id=\"kt_datatable_account_logs\"\n                            class=\"w-full text-sm text-left text-gray-500\">\n                            <thead>\n                                <tr class=\"fw-bolder fs-6 text-blue-700 px-7\">\n                                    <th class=\"px-6 py-3\">Date</th>\n                                    <th class=\"px-6 py-3\">IP</th>\n                                    <th class=\"px-6 py-3\">User-Agent</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                <?php\n                                    $query = misc\\mysql\\query(\"SELECT * FROM `acclogs` WHERE `username` = ?\", [$_SESSION['username']]);\n                                    $rows = array();\n                                    while ($r = mysqli_fetch_assoc($query->result)) \n                                    {\n                                        $rows[] = $r;\n                                    }\n\n                                    foreach ($rows as $row) \n                                    {\n                                    ?>\n                                        <tr>\n                                            <td>\n                                                <script>\n                                                    document.write(convertTimestamp(<?= $row[\"date\"]; ?>));\n                                                </script>\n                                            </td>\n\n                                            <td><a class=\"blur-sm hover:blur-none\"><?= $row[\"ip\"]; ?></a></td>\n                                            <td><a class=\"blur-sm hover:blur-none\"><?= $row[\"useragent\"]; ?></a></td>\n                                        </tr>\n                                    <?php\n                                    }\n                                ?>\n                            </tbody>\n                        </table>\n","size_bytes":2827},"app/pages/account-settings.php":{"content":"<?php\nif ($_SESSION['username'] == \"demodeveloper\" || $_SESSION['username'] == \"demoseller\") \n{\n   dashboard\\primary\\error(\"Demo accounts do not have access here... view manage apps for your owner ID!\");\n   die();\n}\n\n$twofactor = $row['twofactor'];\n\nrequire_once '../auth/GoogleAuthenticator.php';\n$gauth = new GoogleAuthenticator();\nif ($row[\"googleAuthCode\"] == NULL) \n{\n    $code_2factor = $gauth->createSecret();\n    misc\\mysql\\query(\"UPDATE `accounts` SET `googleAuthCode` = ? WHERE `username` = ?\", [$code_2factor, $_SESSION['username']]);\n} \nelse \n{\n    $code_2factor = $row[\"googleAuthCode\"];\n}\n\n$google_QR_Code = $gauth->getQRCodeGoogleUrl($_SESSION['username'], $code_2factor, 'KeyAuth');\n\n$query = misc\\mysql\\query(\"SELECT * FROM `accounts` WHERE `username` = ?\", [$_SESSION['username']]);\n\nif ($query->num_rows > 0) \n{\n    while ($row = mysqli_fetch_array($query->result)) \n    {\n        $acclogs = $row['acclogs'];\n        $expiry = $row[\"expires\"];\n        $emailVerify = $row[\"emailVerify\"];\n    }\n}\n\nif (isset($_POST['updatesettings'])) \n    {\n        $pfp = misc\\etc\\sanitize($_POST['pfp']);\n        $acclogs = misc\\etc\\sanitize($_POST['acclogs']);\n        $emailVerify = misc\\etc\\sanitize($_POST['emailVerify']);\n        misc\\mysql\\query(\"UPDATE `accounts` SET `acclogs` = ? WHERE `username` = ?\", [$acclogs, $_SESSION['username']]);\n\n        if ($acclogs == 0) \n        {\n            misc\\mysql\\query(\"DELETE FROM `acclogs` WHERE `username` = ?\", [$_SESSION['username']]); // delete all account logs\n        }\n\n        misc\\mysql\\query(\"UPDATE `accounts` SET `emailVerify` = ? WHERE `username` = ?\", [$emailVerify, $_SESSION['username']]);\n        if (isset($_POST['pfp']) && trim($_POST['pfp']) != '') \n        {\n            if (!filter_var($pfp, FILTER_VALIDATE_URL)) {\n                dashboard\\primary\\error(\"Invalid Url For Profile Image!\");\n                echo \"<meta http-equiv='Refresh' Content='2;'>\";\n                return;\n            }\n            if (strpos($pfp, \"file:///\") !== false) {\n                dashboard\\primary\\error(\"Url must start with https://\");\n                echo \"<meta http-equiv='Refresh' Content='2;'>\";\n                return;\n            }\n            $_SESSION['img'] = $pfp;\n            misc\\mysql\\query(\"UPDATE `accounts` SET `img` = ? WHERE `username` = ?\", [$pfp, $_SESSION['username']]);\n        }\n\n        dashboard\\primary\\success(\"Updated Account Settings!\");\n    }\n\n    if (isset($_POST['submit_code'])) \n    {\n        $code = misc\\etc\\sanitize($_POST['scan_code1'] . ($_POST['scan_code2']) . ($_POST['scan_code3']) . ($_POST['scan_code4']) . ($_POST['scan_code5']) . ($_POST['scan_code6']));\n\n        $query = misc\\mysql\\query(\"SELECT `googleAuthCode` from `accounts` WHERE `username` = ?\", [$_SESSION['username']]);\n\n        while ($row = mysqli_fetch_array($query->result)) \n        {\n            $secret_code = $row['googleAuthCode'];\n        }\n\n        $checkResult = $gauth->verifyCode($secret_code, $code, 2);\n\n        if ($checkResult) \n        {\n            $query = misc\\mysql\\query(\"UPDATE `accounts` SET `twofactor` = '1' WHERE `username` = ?\", [$_SESSION['username']]);\n            if ($query->affected_rows > 0) \n            {\n                echo \"<meta http-equiv='Refresh' Content='2;'>\";\n                dashboard\\primary\\success(\"Two-factor security has been successfully activated on your account!\");\n                dashboard\\primary\\wh_log($logwebhook, \"{$username} has enabled 2FA\", $webhookun);\n            } \n            else \n            {\n                echo \"<meta http-equiv='Refresh' Content='2;'>\";\n                dashboard\\primary\\wh_log($logwebhook, \"{$username} has disabled 2FA\", $webhookun);\n                dashboard\\primary\\success(\"Two-factor security has been successfully disabled on your account!\");\n            }\n        } \n        else \n        {\n            dashboard\\primary\\error(\"Invalid 2FA code! Make sure your device time settings are synced.\");\n        }\n    }\n\n    if (isset($_POST['submit_code_disable'])) \n    {\n        $code = misc\\etc\\sanitize($_POST['scan_code1'] . ($_POST['scan_code2']) . ($_POST['scan_code2']) . ($_POST['scan_code3']) . ($_POST['scan_code4']) . ($_POST['scan_code5']));\n\n        $query = misc\\mysql\\query(\"SELECT `googleAuthCode` from `accounts` WHERE `username` = ?\", [$_SESSION['username']]);\n\n        while ($row = mysqli_fetch_array($query->result)) \n        {\n            $secret_code = $row['googleAuthCode'];\n        }\n\n        $checkResult = $gauth->verifyCode($secret_code, $code, 2);\n\n        if ($checkResult) \n        {\n            $query = misc\\mysql\\query(\"UPDATE `accounts` SET `twofactor` = '0', `googleAuthCode` = NULL WHERE `username` = ?\", [$_SESSION['username']]);\n\n            if ($query->affected_rows > 0) \n            {\n                dashboard\\primary\\success(\"Successfully disabled 2FA!\");\n            } \n            else \n            {\n                dashboard\\primary\\error(\"Failed to disable 2FA!\");\n            }\n        } \n        else \n        {\n            dashboard\\primary\\error(\"Invalid 2FA code! Make sure your device time settings are synced.\");\n        }\n    }\n\n    if (isset($_POST['deleteWebauthn'])) \n    {\n        $name = misc\\etc\\sanitize($_POST['deleteWebauthn']);\n\n        $query = misc\\mysql\\query(\"DELETE FROM `securityKeys` WHERE `name` = ? AND `username` = ?\", [$name, $_SESSION['username']]);\n\n        if ($query->affected_rows > 0) \n        {\n            $query = misc\\mysql\\query(\"SELECT 1 FROM `securityKeys` WHERE `username` = ?\", [$_SESSION['username']]);\n            if ($query->num_rows == 0) \n            {\n                misc\\mysql\\query(\"UPDATE `accounts` SET `securityKey` = 0 WHERE `username` = ?\", [$_SESSION['username']]);\n            }\n            dashboard\\primary\\success(\"Successfully deleted security key\");\n        } \n        else \n        {\n            dashboard\\primary\\error(\"Failed to delete security key!\");\n        }\n    }\n\n?>\n\n<div class=\"p-4 bg-[#09090d] block sm:flex items-center justify-between lg:mt-1.5\">\n    <div class=\"mb-1 w-full bg-[#0f0f17] rounded-xl\">\n        <div class=\"mb-4 p-4\">\n            <?php require '../app/layout/breadcrumb.php'; ?>\n            <h1 class=\"text-xl font-semibold text-white-900 sm:text-2xl\">Account Settings</h1>\n            <p class=\"text-xs text-gray-500\">Manage your account.</p>\n            <br>\n            <div class=\"p-4 flex flex-col\">\n                <div class=\"overflow-x-auto\">\n                    <br>\n                    <form method=\"post\">\n                        <div id=\"lol\" class=\"grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-8 gap-2\">\n                            <div class=\"relative mb-4\">\n                                <select id=\"acclogs\" name=\"acclogs\"\n                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\">\n                                    <option value=\"1\" <?= $acclogs == 1 ? ' selected=\"selected\"' : ''; ?>>Enabled\n                                    </option>\n                                    <option value=\"0\" <?= $acclogs == 0 ? ' selected=\"selected\"' : ''; ?>>Disabled\n                                    </option>\n                                </select>\n                                <label for=\"acclogs\"\n                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Account\n                                    Logs</label>\n                            </div>\n\n                            <div class=\"relative mb-4\">\n                                <select id=\"emailVerify\" name=\"emailVerify\"\n                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\">\n                                    <option value=\"1\" <?= $emailVerify == 1 ? ' selected=\"selected\"' : ''; ?>>Enabled\n                                    </option>\n                                    <option value=\"0\" <?= $emailVerify == 0 ? ' selected=\"selected\"' : ''; ?>>Disabled\n                                    </option>\n                                </select>\n                                <label for=\"emailVerify\"\n                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">New\n                                    Location Alerts\n                                </label>\n                            </div>\n                        </div>\n\n                        <div class=\"relative mb-4 mt-4\">\n                            <input type=\"text\" name=\"username\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                placeholder=\" \" autocomplete=\"on\" value=\"<?= $_SESSION['username'];?>\" readonly>\n                            <label for=\"username\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Username</label>\n                        </div>\n\n                        <?php \n                            if ($_SESSION[\"role\"] != \"Reseller\"){ ?>\n                        <div class=\"relative mb-4 mt-4\">\n                            <input type=\"text\" name=\"ownerid\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                placeholder=\" \" autocomplete=\"on\"\n                                value=\"<?= $_SESSION['ownerid'] ?? \"Manager or Reseller accounts do not have OwnerIDs as they can't create applications.\";?>\"\n                                readonly>\n                            <label for=\"ownerid\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">OwnerID\n                            </label>\n                        </div>\n                        <?php } ?>\n\n                        <div class=\"relative mb-4 mt-4\">\n                            <input type=\"text\" name=\"expires\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                placeholder=\" \" value=\"<?php if ($_SESSION[\"role\"] == \"tester\")?> Free Forever \"\n                                autocomplete=\"on\" readonly>\n                            <?php if($_SESSION[\"role\"] == \"tester\"){ ?>\n                            <label for=\"expires\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Subscription\n                                Expires: </label>\n                            <?php } ?>\n                            <label for=\"expires\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Subscription\n                                Expires </label>\n                        </div>\n\n                        <script>\n                        var expiryInput = document.querySelector('input[name=\"expires\"]');\n                        var expiryValue = <?= $expiry ?>;\n                        expiryInput.value = convertTimestamp(expiryValue);\n                        </script>\n\n                        <div class=\"relative mb-4 mt-4\">\n                            <input type=\"url\" name=\"pfp\" id=\"pfp\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                placeholder=\" \" max=\"200\" value=\"<?= $_SESSION['img']; ?>\" autocomplete=\"on\">\n                            <label for=\"pfp\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Profile\n                                Picture URL</label>\n                        </div>\n\n                        <!-- Button Functions -->\n                        <button\n                            class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                            name=\"updatesettings\">\n                            <i class=\"lni lni-circle-plus mr-2 mt-1\"></i>Save\n                        </button>\n\n                        <?php if (!$twofactor){\n                            echo '<a class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200 cursor-pointer\"\n                            data-modal-target=\"enable-2fa-modal\" data-modal-toggle=\"enable-2fa-modal\"><i class=\"lni lni-shield mr-2 mt-1\"></i>Enable 2FA</a>';\n                        } else {\n                            echo '<a class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200 cursor-pointer\" \n                            data-modal-target=\"disable-2fa-modal\" data-modal-toggle=\"disable-2fa-modal\"><i class=\"lni lni-shield mr-2 mt-1\"></i>Disable 2FA</a>';\n                        }\n                        ?>\n\n                        <button type=\"button\"\n                            class=\"inline-flex text-white bg-purple-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                            data-modal-target=\"fido2-modal\" data-modal-toggle=\"fido2-modal\">\n                            <i class=\"lni lni-shield mr-2 mt-1\"></i>FIDO2 Webauthn (Security Key)\n                        </button>\n\n                        <a href=\"https://<?= $_SERVER['HTTP_HOST'] ?? $_SERVER['SERVER_NAME'] ?>/forgot/\"\n                            target=\"_blank\" type=\"button\"\n                            class=\"inline-flex text-white bg-orange-500 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">\n                            <i class=\"lni lni-reload mr-2 mt-1\"></i>Change Password\n                        </a>\n                        <a href=\"https://<?= $_SERVER['HTTP_HOST'] ?? $_SERVER['SERVER_NAME']?>/changeEmail/\"\n                            target=\"_blank\" type=\"button\"\n                            class=\"inline-flex text-white bg-orange-500 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">\n                            <i class=\"lni lni-reload mr-2 mt-1\"></i>Change Email\n                        </a>\n                        <a href=\"https://<?= $_SERVER['HTTP_HOST'] ?? $_SERVER['SERVER_NAME']?>/changeUsername/\"\n                            target=\"_blank\" type=\"button\"\n                            class=\"inline-flex text-white bg-orange-500 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">\n                            <i class=\"lni lni-reload mr-2 mt-1\"></i>Change Username\n                        </a>\n                        <a href=\"https://<?= $_SERVER['HTTP_HOST'] ?? $_SERVER['SERVER_NAME']?>/deleteAccount/\"\n                            target=\"_blank\" type=\"button\"\n                            class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">\n                            <i class=\"lni lni-trash-can mr-2 mt-1\"></i>Delete Account\n                        </a>\n                    </form>\n                    <!-- End Button Functions -->\n\n                    <?php \n                    if (!$twofactor) {?>\n                    <!-- Enable 2fa Modal -->\n                    <div id=\"enable-2fa-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <!-- Modal content -->\n                            <div class=\"relative bg-[#0f0f17] rounded-lg border-[#1d4ed8] shadow\">\n                                <div class=\"px-6 py-6 lg:px-8\">\n                                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Enable 2FA (Two Factor\n                                        Authentication)</h3>\n                                    <form class=\"space-y-6\" method=\"POST\">\n                                        <div>\n                                            <label class=\"mb-5\">Scan this QR code into your 2FA App.</label>\n                                            <img class=\"mb-5 mt-5\" src=\"<?= $google_QR_Code ?>\" />\n                                            <label class=\"mb-5\">Can't scan the QR code? Manually set it instead, code:\n                                                <code class=\"text-blue-700\"><?= $code_2factor ?></code></label>\n                                            <br><br>\n                                            <div id=\"otp\" class=\"tfa-container\">\n                                                <input type=\"text\" inputmode=\"numeric\" maxlength=\"1\" id=\"scan_code1\"\n                                                    name=\"scan_code1\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-lg text-white bg-transparent rounded-lg border-1 border-gray-600 appearance-none focus:ring-0 peer\"\n                                                    placeholder=\" \" autocomplete=\"on\" onpaste=\"handlePaste(event)\"\n                                                    required>\n\n                                                <input type=\"text\" inputmode=\"numeric\" maxlength=\"1\" id=\"scan_code2\"\n                                                    name=\"scan_code2\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-lg text-white bg-transparent rounded-lg border-1 border-gray-600 appearance-none focus:ring-0 peer\"\n                                                    placeholder=\" \" autocomplete=\"on\" required>\n\n                                                <input type=\"text\" inputmode=\"numeric\" maxlength=\"1\" id=\"scan_code3\"\n                                                    name=\"scan_code3\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-lg text-white bg-transparent rounded-lg border-1 border-gray-600 appearance-none focus:ring-0 peer\"\n                                                    placeholder=\" \" autocomplete=\"on\" required>\n\n                                                <input type=\"text\" inputmode=\"numeric\" maxlength=\"1\" id=\"scan_code4\"\n                                                    name=\"scan_code4\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-lg text-white bg-transparent rounded-lg border-1 border-gray-600 appearance-none focus:ring-0 peer\"\n                                                    placeholder=\" \" autocomplete=\"on\" required>\n\n                                                <input type=\"text\" inputmode=\"numeric\" maxlength=\"1\" id=\"scan_code5\"\n                                                    name=\"scan_code5\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-lg text-white bg-transparent rounded-lg border-1 border-gray-600 appearance-none focus:ring-0 peer\"\n                                                    placeholder=\" \" autocomplete=\"on\" required>\n\n                                                <input type=\"text\" inputmode=\"numeric\" maxlength=\"1\" id=\"scan_code6\"\n                                                    name=\"scan_code6\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-lg text-white bg-transparent rounded-lg border-1 border-gray-600 appearance-none focus:ring-0 peer\"\n                                                    placeholder=\" \" autocomplete=\"on\" required>\n                                            </div>\n\n                                            <script\n                                                src=\"https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js\">\n                                            </script>\n                                            <script>\n\n\n\n                                            </script>\n                                        </div>\n                                        <button name=\"submit_code\" id=\"submit_code\"\n                                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\"\n                                            disabled>Enable\n                                            2FA</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Enable 2fa Modal -->\n                    <?php } ?>\n\n                    <!-- Disable 2fa Modal -->\n                    <div id=\"disable-2fa-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <!-- Modal content -->\n                            <div class=\"relative bg-[#0f0f17] rounded-lg border-[#1d4ed8] shadow\">\n                                <button type=\"button\"\n                                    class=\"absolute top-3 right-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ml-auto inline-flex justify-center items-center\"\n                                    data-modal-hide=\"disable-2fa-modal\">\n                                    <svg class=\"w-3 h-3\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\"\n                                        fill=\"none\" viewBox=\"0 0 14 14\">\n                                        <path stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\"\n                                            stroke-width=\"2\" d=\"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6\" />\n                                    </svg>\n                                    <span class=\"sr-only\">Close modal</span>\n                                </button>\n                                <div class=\"px-6 py-6 lg:px-8\">\n                                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Disable 2FA (Two Factor\n                                        Authentication)</h3>\n                                    <form class=\"space-y-6\" method=\"POST\">\n                                        <div>\n                                            <div class=\"relative mb-4 mt-5\">\n                                                <input type=\"text\" id=\"scan_code\" name=\"scan_code\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-600 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\" required=\"\">\n                                                <label for=\"scan_code\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">6\n                                                    Digit Code from your 2FA app</label>\n                                            </div>\n                                        </div>\n                                        <button name=\"submit_code_disable\"\n                                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Disable\n                                            2FA</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Disable 2fa Modal -->\n\n                    <!-- FIDO2 Modal -->\n                    <form class=\"space-y-6\" method=\"POST\">\n                        <div id=\"fido2-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                            class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                            <div class=\"relative w-full max-w-md max-h-full\">\n                                <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                                    <div class=\"px-6 py-6 lg:px-8\">\n                                        <h3 class=\"mb-4 text-xl font-medium text-white-900\">FIDO2 WebAuthn (Security\n                                            Keys)</h3>\n                                        <hr class=\"h-px mb-4 mt-4 bg-gray-700 border-0\">\n                                        <div>\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" id=\"webauthn_name\" name=\"webauthn_name\"\n                                                    placeholder=\" \" maxlength=\"99\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                                    autocomplete=\"on\">\n                                                <label for=\"webauthn_name\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">\n                                                    New Security Key Name</label>\n                                            </div>\n                                        </div>\n                                        <button type=\"button\" onclick=\"newregistration()\"\n                                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center mb-5\">Register\n                                            New Security Key</button>\n\n                                        <h3 class=\"mb-4 text-xl font-medium text-white-900\">Existing Security Keys</h3>\n                                        <?php\n                                                $query = misc\\mysql\\query(\"SELECT * FROM `securityKeys` WHERE `username` = ?\", [$_SESSION['username']]);\n                                                    if ($query->num_rows > 0) {\n                                                        while ($row = mysqli_fetch_array($query->result)) {\n                                                            ?>\n                                        <button type=\"submit\" name=\"deleteWebauthn\" value=\"<?= $row[\"name\"]; ?>\"\n                                            onclick=\"return confirm('Are you sure you want to delete your security key? This cannot be undone.')\"\n                                            class=\"w-full text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Delete\n                                            Security Key: <?= $row[\"name\"]; ?></button>\n                                        <?php\n                                                            }\n                                                        }\n                                            ?>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </form>\n                    <!-- End FIDO2 Modal -->\n\n                    <!-- Include the jQuery library -->\n                    \n\n                    <script>\n                    function handlePaste(event) {\n                        event.preventDefault();\n                        var clipboardData = event.clipboardData || window.clipboardData;\n                        var pastedData = clipboardData.getData('text');\n                        var inputs = document.querySelectorAll(\".tfa-container input\");\n\n                        // Check if the pasted data is exactly 6 digits long\n                        if (/^\\d{6}$/.test(pastedData)) {\n                            for (var i = 0; i < 6; i++) {\n                                inputs[i].value = pastedData.charAt(i);\n                            }\n                        }\n                    }\n\n                    function updateButtonState(inputs) {\n                        var allNumeric = true;\n\n                        // Check if all input fields have numeric values\n                        for (var i = 0; i < inputs.length; i++) {\n                            if (!/^\\d$/.test(inputs[i].value)) {\n                                allNumeric = false;\n                                break;\n                            }\n                        }\n\n                        // Enable or disable the button based on the input values\n                        var button = document.getElementById('submit_code');\n                        button.disabled = !allNumeric;\n                    }\n\n                    // Add event listeners to each input field to monitor changes\n                    var inputs = document.querySelectorAll(\".tfa-container input\");\n                    for (var i = 0; i < inputs.length; i++) {\n                        inputs[i].addEventListener('input', function() {\n                            updateButtonState(inputs);\n                        });\n                    }\n                    </script>\n","size_bytes":32551},"app/pages/app-settings.php":{"content":"<?php\nif ($_SESSION['role'] == \"Reseller\") {\n    header(\"location: ./?page=reseller-licenses\");\n    die();\n}\nif ($role == \"Manager\" && !($permissions & 1024)) {\n    misc\\auditLog\\send(\"Attempted (and failed) to view app settings.\");\n    dashboard\\primary\\error(\"You weren't granted permission to view this page!\");\n    die();\n}\nif (!isset($_SESSION['app'])) {\n    dashboard\\primary\\error(\"Application not selected\");\n    die(\"Application not selected.\");\n}\nif (isset($_POST['addhash'])) {\n    $resp = misc\\app\\addHash($_POST['hash']);\n    match ($resp) {\n        'shorthash' => dashboard\\primary\\error(\"Hash is too short!\"),\n        'failure' => dashboard\\primary\\error(\"Failed to add hash!\"),\n        'success' => dashboard\\primary\\success(\"Added hash successfully!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n\nif (isset($_POST['resethash'])) {\n    $resp = misc\\app\\resetHash();\n    match ($resp) {\n        'failure' => dashboard\\primary\\error(\"Failed to reset hash!\"),\n        'success' => dashboard\\primary\\success(\"Successfully reset hash!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n\nif (isset($_POST['updatesettings'])) \n{\n    $status = misc\\etc\\sanitize($_POST['statusinput']);\n    $hwid = misc\\etc\\sanitize($_POST['hwidinput']);\n    $tokenvalidation = misc\\etc\\sanitize($_POST[\"tokeninput\"]);\n    $forceHwid = misc\\etc\\sanitize($_POST['forceHwid']);\n    $minHwid = misc\\etc\\sanitize($_POST['minHwid']);\n    $vpn = misc\\etc\\sanitize($_POST['vpninput']);\n    $hashstatus = misc\\etc\\sanitize($_POST['hashinput']);\n    $ver = misc\\etc\\sanitize($_POST['version']);\n    $dl = misc\\etc\\sanitize($_POST['download']);\n    $webdl = misc\\etc\\sanitize($_POST['webdownload']);\n    $webhook = misc\\etc\\sanitize($_POST['webhook']);\n    $resellerstorelink = misc\\etc\\sanitize($_POST['resellerstore']);\n    $panelstatus = misc\\etc\\sanitize($_POST['panelstatus']);\n    $customDomain = misc\\etc\\sanitize($_POST['customDomain']);\n    $cooldownexpiry = misc\\etc\\sanitize($_POST['cooldownexpiry']);\n    $cooldownduration = misc\\etc\\sanitize($_POST['cooldownduration']) * $cooldownexpiry;\n    $sessionexpiry = misc\\etc\\sanitize($_POST['sessionexpiry']);\n    $sessionduration = misc\\etc\\sanitize($_POST['sessionduration']) * $sessionexpiry;\n    $minUsernameLength = misc\\etc\\sanitize($_POST['minUsernameLength']);\n    $blockLeakedPasswords = misc\\etc\\sanitize($_POST['blockLeakedPasswords']);\n    $appdisabledpost = misc\\etc\\sanitize($_POST['appdisabled']);\n    $tokeninvalid = misc\\etc\\sanitize($_POST['tokeninvalid']);\n    $usernametakenpost = misc\\etc\\sanitize($_POST['usernametaken']);\n    $keynotfoundpost = misc\\etc\\sanitize($_POST['keynotfound']);\n    $keyusedpost = misc\\etc\\sanitize($_POST['keyused']);\n    $nosublevelpost = misc\\etc\\sanitize($_POST['nosublevel']);\n    $usernamenotfoundpost = misc\\etc\\sanitize($_POST['usernamenotfound']);\n    $passmismatchpost = misc\\etc\\sanitize($_POST['passmismatch']);\n    $hwidmismatchpost = misc\\etc\\sanitize($_POST['hwidmismatch']);\n    $noactivesubspost = misc\\etc\\sanitize($_POST['noactivesubs']);\n    $hwidblackedpost = misc\\etc\\sanitize($_POST['hwidblacked']);\n    $pausedsubpost = misc\\etc\\sanitize($_POST['pausedsub']);\n    $vpnblockedpost = misc\\etc\\sanitize($_POST['vpnblocked']);\n    $keybannedpost = misc\\etc\\sanitize($_POST['keybanned']);\n    $userbannedpost = misc\\etc\\sanitize($_POST['userbanned']);\n    $sessionunauthedpost = misc\\etc\\sanitize($_POST['sessionunauthed']);\n    $hashcheckfailpost = misc\\etc\\sanitize($_POST['hashcheckfail']);\n    $shoppywebhooksecret = misc\\etc\\sanitize($_POST['shoppywebhooksecret']);\n    $shoppyday = misc\\etc\\sanitize($_POST['shoppydayproduct']);\n    $shoppyweek = misc\\etc\\sanitize($_POST['shoppyweekproduct']);\n    $shoppymonth = misc\\etc\\sanitize($_POST['shoppymonthproduct']);\n    $shoppylife = misc\\etc\\sanitize($_POST['shoppylifetimeproduct']);\n    $sellixwebhooksecret = misc\\etc\\sanitize($_POST['sellixwebhooksecret']);\n    $sellixday = misc\\etc\\sanitize($_POST['sellixdayproduct']);\n    $sellixweek = misc\\etc\\sanitize($_POST['sellixweekproduct']);\n    $sellixmonth = misc\\etc\\sanitize($_POST['sellixmonthproduct']);\n    $sellixlife = misc\\etc\\sanitize($_POST['sellixlifetimeproduct']);\n    $sellappwebhooksecret = misc\\etc\\sanitize($_POST['sellappwebhooksecret']);\n    $sellappday = misc\\etc\\sanitize($_POST['sellappdayproduct']);\n    $sellappweek = misc\\etc\\sanitize($_POST['sellappweekproduct']);\n    $sellappmonth = misc\\etc\\sanitize($_POST['sellappmonthproduct']);\n    $sellapplife = misc\\etc\\sanitize($_POST['sellapplifetimeproduct']);\n    $customerPanelIcon = misc\\etc\\sanitize($_POST['customerPanelIcon']);\n    $loggedInMsg = misc\\etc\\sanitize($_POST['loggedInMsg']);\n    $pausedApp = misc\\etc\\sanitize($_POST['pausedApp']);\n    $unTooShort = misc\\etc\\sanitize($_POST['unTooShort']);\n    $pwLeaked = misc\\etc\\sanitize($_POST['pwLeaked']);\n    $chatHitDelay = misc\\etc\\sanitize($_POST['chatHitDelay']);\n\n    if (!is_null($customDomain) && ($_SESSION['role'] == \"seller\" || $_SESSION['role'] == \"Manager\")) \n    {\n        if (strpos($customDomain, \"http\") === 0) \n        {\n            dashboard\\primary\\error(\"Do not include protocol. Your custom domain should be entered as panel.example.com not https://panel.example.com or http://panel.example.com\");\n            echo \"<meta http-equiv='Refresh' Content='2;'>\";\n            return;\n        }\n        $query = misc\\mysql\\query(\"SELECT `name`, `owner` FROM `apps` WHERE `customDomain` = ? AND `secret` != ?\", [$customDomain, $_SESSION['app']]);\n        if ($query->num_rows > 0) \n        {\n            $row = mysqli_fetch_array($query->result);\n            $name = $row[\"name\"];\n            $owner = $row[\"owner\"];\n            dashboard\\primary\\error(\"The domain {$customDomain} is already being used on app named \\\"{$name}\\\" owned by {$owner}. Use a different domain or subdomain please.\");\n            echo \"<meta http-equiv='Refresh' Content='2;'>\";\n            return;\n        }\n    } \n    else if (!empty($customDomain)) \n    {\n        dashboard\\primary\\error(\"You must have seller plan to utilize customer panel\");\n        echo \"<meta http-equiv='Refresh' Content='2;'>\";\n        return;\n    }\n\n    if($_SESSION['role'] == \"tester\" && !is_null($webhook)) \n    {\n        dashboard\\primary\\error(\"You must upgrade to developer or seller to use Discord webhook!\");\n        echo \"<meta http-equiv='Refresh' Content='2;'>\";\n        return;\n    }\n\n    if((!is_null($webhook) && !str_contains($webhook, \"discord\")) || (!is_null($webhook) && str_contains($webhook, \"localhost\")) || (!is_null($webhook) && str_contains($webhook, \"127.0.0.1\"))) \n    {\n        dashboard\\primary\\error(\"Webhook URL is supposed to be a Discord webhook!\");\n        echo \"<meta http-equiv='Refresh' Content='2;'>\";\n        return;\n    }\n\n    if($_SESSION['role'] == \"tester\" && $vpn) \n    {\n        dashboard\\primary\\error(\"You must upgrade to developer or seller to use VPN block!\");\n        echo \"<meta http-equiv='Refresh' Content='2;'>\";\n        return;\n    }\n\n    if (!empty($shoppywebhooksecret) && !empty($sellixwebhooksecret)) \n    {\n        dashboard\\primary\\error(\"You cannot utilize Sellix and Shoppy simultaneously due to conflicting JavaScript code\");\n        echo \"<meta http-equiv='Refresh' Content='2;'>\";\n        return;\n    }\n\n    if ($sessionduration > 604800) \n    {\n        dashboard\\primary\\error(\"Session duration can be at most 7 days/1 week\");\n        echo \"<meta http-equiv='Refresh' Content='2;'>\";\n        return;\n    }\n\n    $query = misc\\mysql\\query(\n        \"UPDATE `apps` SET \n                `cooldown` = ?,\n                `customDomain` = NULLIF(?, ''),\n                `session` = ?,\n                `tokensystem` = ?,\n                `cooldownUnit` = ?,\n                `sessionUnit` = ?,\n                `appdisabled` = ?,\n                `tokeninvalid` = ?,\n                `hashcheckfail` = ?,\n                `sessionunauthed` = ?,\n                `userbanned` = ?,\n                `vpnblocked` = ?,\n                `keybanned` = ?,\n                `usernametaken` = ?,\n                `keynotfound` = ?,\n                `keyused` = ?,\n                `nosublevel` = ?,\n                `usernamenotfound` = ?,\n                `passmismatch` = ?,\n                `hwidmismatch` = ?,\n                `noactivesubs` = ?,\n                `hwidblacked` = ?,\n                `pausedsub` = ?,\n                `enabled` = ?,\n                `minUsernameLength` = ?,\n                `blockLeakedPasswords` = ?,\n                `hashcheck` = ?,\n                `hwidcheck` = ?,\n                `forceHwid` = ?,\n                `minHwid` = ?,\n                `vpnblock` = ?,\n                `ver` = ?,\n                `download` = NULLIF(?, ''),\n                `webdownload` = NULLIF(?, ''),\n                `webhook` = NULLIF(?, ''),\n                `resellerstore` = NULLIF(?, ''),\n                `sellixsecret` = NULLIF(?, ''),\n                `sellixdayproduct` = NULLIF(?, ''),\n                `sellixweekproduct` = NULLIF(?, ''),\n                `sellixmonthproduct` = NULLIF(?, ''),\n                `sellixlifetimeproduct` = NULLIF(?, ''),\n                `sellappsecret` = NULLIF(?, ''),\n                `sellappdayproduct` = NULLIF(?, ''),\n                `sellappweekproduct` = NULLIF(?, ''),\n                `sellappmonthproduct` = NULLIF(?, ''),\n                `sellapplifetimeproduct` = NULLIF(?, ''),\n                `shoppysecret` = NULLIF(?, ''),\n                `shoppydayproduct` = NULLIF(?, ''),\n                `shoppyweekproduct` = NULLIF(?, ''),\n                `shoppymonthproduct` = NULLIF(?, ''),\n                `shoppylifetimeproduct` = NULLIF(?, ''),\n                `customerPanelIcon` = ?,\n                `panelstatus` = ?,\n                `loggedInMsg` = ?,\n                `pausedApp` = ?,\n                `unTooShort` = ?,\n                `pwLeaked` = ?,\n                `chatHitDelay` = ?\n        WHERE `secret` = ?\",\n        [\n            $cooldownduration,\n            $customDomain,\n            $sessionduration,\n            $tokenvalidation,\n            $cooldownexpiry,\n            $sessionexpiry,\n            $appdisabledpost,\n            $tokeninvalid,\n            $hashcheckfailpost,\n            $sessionunauthedpost,\n            $userbannedpost,\n            $vpnblockedpost,\n            $keybannedpost,\n            $usernametakenpost,\n            $keynotfoundpost,\n            $keyusedpost,\n            $nosublevelpost,\n            $usernamenotfoundpost,\n            $passmismatchpost,\n            $hwidmismatchpost,\n            $noactivesubspost,\n            $hwidblackedpost,\n            $pausedsubpost,\n            $status,\n            $minUsernameLength,\n            $blockLeakedPasswords,\n            $hashstatus,\n            $hwid,\n            $forceHwid,\n            $minHwid,\n            $vpn,\n            $ver,\n            $dl,\n            $webdl,\n            $webhook,\n            $resellerstorelink,\n            $sellixwebhooksecret,\n            $sellixday,\n            $sellixweek,\n            $sellixmonth,\n            $sellixlife,\n            $sellappwebhooksecret,\n            $sellappday,\n            $sellappweek,\n            $sellappmonth,\n            $sellapplife,\n            $shoppywebhooksecret,\n            $shoppyday,\n            $shoppyweek,\n            $shoppymonth,\n            $shoppylife,\n            $customerPanelIcon,\n            $panelstatus,\n            $loggedInMsg,\n            $pausedApp,\n            $unTooShort,\n            $pwLeaked,\n            $chatHitDelay,\n            $_SESSION['app']\n        ]\n    );\n\n    if ($query->affected_rows > 0) \n    {\n        misc\\cache\\purge('KeyAuthApp:' . $_SESSION[\"name\"] . ':' . $_SESSION['ownerid']);\n        dashboard\\primary\\success(\"Successfully set settings!\");\n    } \n    else \n    {\n        dashboard\\primary\\error(\"Failed to set settings!\");\n    }\n}\n\nif ($_SESSION['app']) {\n    $query = misc\\mysql\\query(\"SELECT * FROM `apps` WHERE `secret` = ?\", [$_SESSION['app']]);\n    if ($query->num_rows > 0) {\n        while ($row = mysqli_fetch_array($query->result)) {\n            $enabled = $row['enabled'];\n            $hwidcheck = $row['hwidcheck'];\n            $forceHwid = $row['forceHwid'];\n            $minHwid = $row['minHwid'];\n            $vpnblock = $row['vpnblock'];\n            $panelstatus = $row['panelstatus'];\n            $customDomain = $row['customDomain'];\n            $hashcheck = $row['hashcheck'];\n            $tokenvalidation = $row[\"tokensystem\"];\n            $cooldown = $row['cooldown'];\n            $session = $row['session'];\n            $cooldownUnit = $row['cooldownUnit'];\n            $sessionUnit = $row['sessionUnit'];\n            $verr = $row['ver'];\n            $dll = $row['download'];\n            $webdll = $row['webdownload'];\n            $wh = $row['webhook'];\n            $rs = $row['resellerstore'];\n            $sellappwhsecret = $row['sellappsecret'];\n            $sellappdayproduct = $row['sellappdayproduct'];\n            $sellappweekproduct = $row['sellappweekproduct'];\n            $sellappmonthproduct = $row['sellappmonthproduct'];\n            $sellapplifetimeproduct = $row['sellapplifetimeproduct'];\n            $sellixwhsecret = $row['sellixsecret'];\n            $sellixdayproduct = $row['sellixdayproduct'];\n            $sellixweekproduct = $row['sellixweekproduct'];\n            $sellixmonthproduct = $row['sellixmonthproduct'];\n            $sellixlifetimeproduct = $row['sellixlifetimeproduct'];\n            $shoppywhsecret = $row['shoppysecret'];\n            $shoppydayproduct = $row['shoppydayproduct'];\n            $shoppyweekproduct = $row['shoppyweekproduct'];\n            $shoppymonthproduct = $row['shoppymonthproduct'];\n            $shoppylifetimeproduct = $row['shoppylifetimeproduct'];\n            $appdisabled = $row['appdisabled'];\n            $tokeninvalid = $row[\"tokeninvalid\"];\n            $usernametaken = $row['usernametaken'];\n            $keynotfound = $row['keynotfound'];\n            $keyused = $row['keyused'];\n            $nosublevel = $row['nosublevel'];\n            $usernamenotfound = $row['usernamenotfound'];\n            $passmismatch = $row['passmismatch'];\n            $hwidmismatch = $row['hwidmismatch'];\n            $noactivesubs = $row['noactivesubs'];\n            $hwidblacked = $row['hwidblacked'];\n            $pausedsub = $row['pausedsub'];\n            $vpnblocked = $row['vpnblocked'];\n            $keybanned = $row['keybanned'];\n            $userbanned = $row['userbanned'];\n            $sessionunauthed  = $row['sessionunauthed'];\n            $hashcheckfail  = $row['hashcheckfail'];\n            $minUsernameLength  = $row['minUsernameLength'];\n            $blockLeakedPasswords  = $row['blockLeakedPasswords'];\n            $customerPanelIcon  = $row['customerPanelIcon'];\n            $loggedInMsg  = $row['loggedInMsg'];\n            $pausedApp  = $row['pausedApp'];\n            $unTooShort  = $row['unTooShort'];\n            $pwLeaked  = $row['pwLeaked'];\n            $chatHitDelay  = $row['chatHitDelay'];\n        }\n    }\n}\n\n?>\n\n<div class=\"p-4 bg-[#09090d] block sm:flex items-center justify-between lg:mt-1.5\">\n    <div class=\"mb-1 w-full bg-[#0f0f17] rounded-xl\">\n        <div class=\"mb-4 p-4\">\n            <?php require '../app/layout/breadcrumb.php'; ?>\n            <h1 class=\"text-xl font-semibold text-white-900 sm:text-2xl\">Application Settings</h1>\n            <p class=\"text-xs text-gray-500\">Control your application here. <a\n                    href=\"https://keyauth.readme.io/reference/app-settings-1\" target=\"_blank\"\n                    class=\"text-blue-600   hover:underline\">Learn More</a>.</p>\n            <br>\n\n            <div class=\"mb-4 border-b border-gray-200  \">\n                <ul class=\"flex flex-wrap -mb-px text-sm font-medium text-center\" id=\"myTab\"\n                    data-tabs-toggle=\"#myTabContent\" role=\"tablist\">\n                    <li class=\"mr-2\" role=\"presentation\">\n                        <button class=\"inline-flex p-4 border-b-2 rounded-t-lg\" id=\"appsettings-tab\"\n                            data-tabs-target=\"#appsettings\" type=\"button\" role=\"tab\" aria-controls=\"appsettings\"\n                            aria-selected=\"false\" data-popover-target=\"appSettings-popover\">\n                            <svg class=\"w-5 h-5 mr-1\" fill=\"currentColor\" viewBox=\"0 0 24 24\"\n                                xmlns=\"http://www.w3.org/2000/svg\">\n                                <path\n                                    d=\"M11.55 21H3v-8.55h8.55V21ZM21 21h-8.55v-8.55H21V21Zm-9.45-9.45H3V3h8.55v8.55Zm9.45 0h-8.55V3H21v8.55Z\">\n                                </path>\n                            </svg>\n\n                            Application Functions\n                        </button>\n                        <?php dashboard\\primary\\popover(\"appSettings-popover\", \"App Settings\", \"Control the main functions of your app.\"); ?>\n                    </li>\n                    <li class=\"mr-2\" role=\"presentation\">\n                        <button\n                            class=\"inline-flex p-4 border-b-2 border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300  \"\n                            id=\"messages-tab\" data-tabs-target=\"#messages\" type=\"button\" role=\"tab\"\n                            aria-controls=\"messages\" aria-selected=\"false\" data-popover-target=\"alertMessages-popover\">\n                            <svg class=\"w-5 h-5 mr-1\" fill=\"currentColor\" viewBox=\"0 0 24 24\"\n                                xmlns=\"http://www.w3.org/2000/svg\">\n                                <path\n                                    d=\"M3 4v12c0 1.103.897 2 2 2h3.5l3.5 4 3.5-4H19c1.103 0 2-.897 2-2V4c0-1.103-.897-2-2-2H5c-1.103 0-2 .897-2 2Zm8 1h2v6h-2V5Zm0 8h2v2h-2v-2Z\">\n                                </path>\n                            </svg>\n\n                            Alert Messages\n                        </button>\n                        <?php dashboard\\primary\\popover(\"alertMessages-popover\", \"Alert Messages\", \"Customize the error messages that users will receive.\"); ?>\n                    </li>\n                    <li class=\"mr-2\" role=\"presentation\">\n                        <button\n                            class=\"inline-flex p-4 border-b-2 border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300 \"\n                            id=\"storesettings-tab\" data-tabs-target=\"#storesettings\" type=\"button\" role=\"tab\"\n                            aria-controls=\"storesettings\" aria-selected=\"false\"\n                            data-popover-target=\"storeSettings-popover\">\n                            <svg class=\"w-5 h-5 mr-1\" fill=\"currentColor\" viewBox=\"0 0 24 24\"\n                                xmlns=\"http://www.w3.org/2000/svg\">\n                                <path\n                                    d=\"M4 20h2V10a1 1 0 0 1 1-1h12V7a1 1 0 0 0-1-1h-3.051c-.252-2.244-2.139-4-4.449-4S6.303 3.756 6.051 6H3a1 1 0 0 0-1 1v11a2 2 0 0 0 2 2Zm6.5-16c1.207 0 2.218.86 2.45 2h-4.9c.232-1.14 1.243-2 2.45-2Z\">\n                                </path>\n                                <path\n                                    d=\"M21 11H9a1 1 0 0 0-1 1v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-8a1 1 0 0 0-1-1Zm-6 7c-2.757 0-5-2.243-5-5h2c0 1.654 1.346 3 3 3s3-1.346 3-3h2c0 2.757-2.243 5-5 5Z\">\n                                </path>\n                            </svg>\n\n                            Reseller\n                        </button>\n                        <?php dashboard\\primary\\popover(\"storeSettings-popover\", \"Reseller Settings\", \"Setup your reseller system here\"); ?>\n                    </li>\n                </ul>\n            </div>\n\n            <div class=\"p-4\">\n            </div>\n            <form method=\"post\">\n                <div id=\"myTabContent\">\n                    <div class=\"hidden p-4 rounded-lg grid gap-7\" id=\"appsettings\" role=\"tabpanel\"\n                        aria-labelledby=\"appsettings-tab\">\n\n                        <div class=\"-mt-12\">\n                            <!-- App Settings Functions -->\n                            <button type=\"button\"\n                                class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                                data-modal-toggle=\"add-new-hash-modal\" data-modal-target=\"add-new-hash-modal\">\n                                <i class=\"lni lni-circle-plus mr-2 mt-1\"></i>Add Additional Hash\n                            </button>\n                            <!-- End App Settings Functions -->\n\n                            <br>\n\n                            <!-- Reset App Settings Functions -->\n                            <button type=\"button\"\n                                class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                                data-modal-toggle=\"reset-program-hash-modal\"\n                                data-modal-target=\"reset-program-hash-modal\">\n                                <i class=\"lni lni-reload mr-2 mt-1\"></i>Reset Application Hash\n                            </button>\n                            <!-- End Reset App Settings Functions -->\n                        </div>\n\n                        <div id=\"lol\" class=\"grid grid-cols-1 lg:grid-cols-4 2xl:grid-cols-8\">\n                            <div class=\"relative mb-4 \" style=\"margin-right: 10px;\">\n                                <select id=\"statusinput\" name=\"statusinput\"\n                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\"\n                                    data-popover-target=\"status-popover\">\n                                    <option value=\"0\" <?= $enabled == 0 ? ' selected=\"selected\"' : ''; ?>>Disabled\n                                    </option>\n                                    <option value=\"1\" <?= $enabled == 1 ? ' selected=\"selected\"' : ''; ?>>Enabled\n                                    </option>\n                                </select>\n                                <label for=\"statusinput\"\n                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">App\n                                    Status</label>\n                                    <?php dashboard\\primary\\popover(\"status-popover\", \"App Status\", \"Allow users to open your app or not.\"); ?>\n                            </div>\n\n                            <div class=\"relative mb-4 \" style=\"margin-right: 10px;\">\n                                <select id=\"hwidinput\" name=\"hwidinput\"\n                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\"\n                                    data-popover-target=\"hwidlock-popover\">\n                                    <option value=\"0\" <?= $hwidcheck == 0 ? ' selected=\"selected\"' : ''; ?>>Disabled\n                                    </option>\n                                    <option value=\"1\" <?= $hwidcheck == 1 ? ' selected=\"selected\"' : ''; ?>>Enabled\n                                    </option>\n                                </select>\n                                <label for=\"hwidinput\"\n                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">HWID\n                                    Lock</label>\n                                    <?php dashboard\\primary\\popover(\"hwidlock-popover\", \"HWID Lock\", \"Lock users to a value from your user's computer which only changes\n                                    if they reinstall windows. Use this to prevent people from sharing your product.\"); ?>\n                            </div>\n\n                            <div class=\"relative mb-4 \" style=\"margin-right: 10px;\">\n                                <select id=\"forceHwid\" name=\"forceHwid\"\n                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\"\n                                    data-popover-target=\"forceHwid-popover\">\n                                    <option value=\"0\" <?= $forceHwid == 0 ? ' selected=\"selected\"' : ''; ?>>Disabled\n                                    </option>\n                                    <option value=\"1\" <?= $forceHwid == 1 ? ' selected=\"selected\"' : ''; ?>>Enabled\n                                    </option>\n                                </select>\n                                <label for=\"forceHwid\"\n                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Force\n                                    HWID</label>\n                                    <?php dashboard\\primary\\popover(\"forceHwid-popover\", \"Force HWID\", \"Prevent users from logging in with a blank HWID (disable this for PHP)\"); ?>\n                            </div>\n                            <div class=\"relative mb-4 \" style=\"margin-right: 10px;\">\n                                <select id=\"vpninput\" name=\"vpninput\"\n                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\"\n                                    data-popover-target=\"vpnblock-popover\">\n                                    <option value=\"0\" <?= $vpnblock == 0 ? ' selected=\"selected\"' : ''; ?>>Disabled\n                                    </option>\n                                    <option value=\"1\" <?= $vpnblock == 1 ? ' selected=\"selected\"' : ''; ?>>Enabled\n                                    </option>\n                                </select>\n                                <label for=\"vpninput\"\n                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">VPN\n                                    Block</label>\n                                    <?php dashboard\\primary\\popover(\"vpnblock-popover\", \"VPN\", \"Block IP addresses associated with VPNs\"); ?>\n                            </div>\n                            <div class=\"relative mb-4 \" style=\"margin-right: 10px;\">\n                                <select id=\"hashinput\" name=\"hashinput\"\n                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\"\n                                    data-popover-target=\"hashCheck-popover\">\n                                    <option value=\"0\" <?= $hashcheck == 0 ? ' selected=\"selected\"' : ''; ?>>Disabled\n                                    </option>\n                                    <option value=\"1\" <?= $hashcheck == 1 ? ' selected=\"selected\"' : ''; ?>>Enabled\n                                    </option>\n                                </select>\n                                <label for=\"hashinput\"\n                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Hash\n                                    Check</label>\n                                    <?php dashboard\\primary\\popover(\"hashCheck-popover\", \"Hash Check\", \"Checks whether the application has been modified since the last time you\n                                    pressed the reset hash button. Used to prevent people from altering/bypassing your app.\"); ?>\n                            </div>\n                            <div class=\"relative mb-4 \" style=\"margin-right: 10px;\">\n                                <select id=\"panelstatus\" name=\"panelstatus\"\n                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\"\n                                    data-popover-target=\"customerPanel-popover\">\n                                    <option value=\"0\" <?= $panelstatus == 0 ? ' selected=\"selected\"' : ''; ?>>Disabled\n                                    </option>\n                                    <option value=\"1\" <?= $panelstatus == 1 ? ' selected=\"selected\"' : ''; ?>>Enabled\n                                    </option>\n                                </select>\n                                <label for=\"panelstatus\"\n                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Customer\n                                    Panel</label>\n                                    <?php dashboard\\primary\\popover(\"customerPanel-popover\", \"Customer Panel\", \"Allows your users to access a dedicated page just for them to manage\n                                    their account and download updates/webloader.\"); ?>\n                            </div>\n                            <div class=\"relative mb-4 \" style=\"margin-right: 10px;\">\n                                <select id=\"blockLeakedPasswords\" name=\"blockLeakedPasswords\"\n                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\"\n                                    data-popover-target=\"blockLeakedPW-popover\">\n                                    <option value=\"0\" <?= $blockLeakedPasswords == 0 ? ' selected=\"selected\"' : ''; ?>>\n                                        Disabled\n                                    </option>\n                                    <option value=\"1\" <?= $blockLeakedPasswords == 1 ? ' selected=\"selected\"' : ''; ?>>\n                                        Enabled\n                                    </option>\n                                </select>\n                                <label for=\"blockLeakedPasswords\"\n                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Block\n                                    Leaked PW</label>\n                                    <?php dashboard\\primary\\popover(\"blockLeakedPW-popover\", \"Block Leaked Passwords\", \"Prevent users from using leaked passwords when registering an account.\"); ?>\n                            </div>\n                            <div class=\"relative mb-4 \" style=\"margin-right: 10px;\">\n                                <select id=\"tokeninput\" name=\"tokeninput\"\n                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\"\n                                    data-popover-target=\"tokeninput-popover\">\n                                    <option value=\"0\" <?= $tokenvalidation == 0 ? ' selected=\"selected\"' : ''; ?>>\n                                        Disabled\n                                    </option>\n                                    <option value=\"1\" <?= $tokenvalidation == 1 ? ' selected=\"selected\"' : ''; ?>>\n                                        Enabled\n                                    </option>\n                                </select>\n                                <label for=\"tokeninput\"\n                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Token Validation</label>\n                                    <?php dashboard\\primary\\popover(\"tokeninput-popover\", \"Token Validation\", \"Checks to see if a user has a valid token to use your application.\"); ?>\n                            </div>\n                        </div>\n\n                        <div class=\"relative\">\n                            <input type=\"text\" inputtype=\"numeric\" name=\"minHwid\" id=\"minHwid\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $minHwid; ?>\" data-popover-target=\"minHwid-popover\">\n                            <label for=\"minHwid\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Minimum\n                                HWID Length</label>\n                                <?php dashboard\\primary\\popover(\"minHwid-popover\", \"Minimum HWID Length\", \"Prevents users from logging in with a shorter HWID than the assigned value.\"); ?>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" inputtype=\"numeric\" maxlength=\"5\" name=\"version\" id=\"version\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $verr; ?>\" required data-popover-target=\"version-popover\">\n                            <label for=\"version\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Application\n                                Version</label>\n                                <?php dashboard\\primary\\popover(\"version-popover\", \"Version\", \"The version of your application. Make sure to change it in your application\n                                as well.\"); ?>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"url\" maxlength=\"120\" name=\"download\" id=\"download\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $dll; ?>\" placeholder=\" \" data-popover-target=\"download-popover\">\n                            <label for=\"download\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Auto-Update\n                                Download Link</label>\n                                <?php dashboard\\primary\\popover(\"download-popover\", \"Download Link\", \"This is the link that will open if the version is different than the one in your\n                                application. (AKA auto-update).\"); ?>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"url\" name=\"webdownload\" id=\"webdownload\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $webll; ?>\" placeholder=\" \" data-popover-target=\"webDownload-popover\">\n                            <label for=\"webdownload\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Webloader\n                                Download Link</label>\n                                <?php dashboard\\primary\\popover(\"webDownload-popover\", \"Web Downloader\", \"URL link for the web loader. (this will enable the web loader if it is not empty)\"); ?>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" name=\"webhook\" id=\"webhook\"\n                                class=\"blur-sm hover:blur-none transition duration-500 block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $wh; ?>\" placeholder=\" \" data-popover-target=\"webhook-popover\">\n                            <label for=\"webhook\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Discord\n                                Webhook Link</label>\n                                <?php dashboard\\primary\\popover(\"webhook-popover\", \"Webhook\", \"Receive secure Discord webhooks for logs/activity.\"); ?>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" id=\"customerPanelLink\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none    focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                placeholder=\" \"\n                                value=\"<?= 'https://' . ($_SERVER['HTTP_HOST'] ?? $_SERVER['SERVER_NAME']) . '/panel/' . urlencode($_SESSION['username']) . '/' . urlencode($_SESSION['name']); ?>\"\n                                readonly data-popover-target=\"customerPanelLink-popover\">\n                            <label for=\"customerPanelLink\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Customer\n                                Panel Link</label>\n                                <?php dashboard\\primary\\popover(\"customerPanelLink-popover\", \"Customer Panel Link\", \"This is the link you will provide to your users if you would like them to have\n                                the ability to HWID, and alter their accounts.\"); ?>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" id=\"customDomain\" name=\"customDomain\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $customDomain; ?>\" placeholder=\" \" data-popover-target=\"customDomain-popover\">\n                            <label for=\"customDomain\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Customer\n                                Panel Link Custom</label>\n                                <?php dashboard\\primary\\popover(\"customDomain-popover\", \"Customer Panel Custom Domain\", \"Custom domain for the customer panel. Please search on YouTube for the guide.\"); ?>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"url\" id=\"customerPanelIcon\" name=\"customerPanelIcon\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $customerPanelIcon; ?>\" placeholder=\" \" data-popover-target=\"customerPanelIcon-popover\">\n                            <label for=\"customerPanelIcon\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Customer\n                                Panel Icon</label>\n                                <?php dashboard\\primary\\popover(\"customerPanelIcon-popover\", \"Customer Panel Icon\", \"Image shown on SEO and next to the title in the browser tab.\"); ?>\n                        </div>\n                        <div class=\"relative\">\n                            <select id=\"cooldownexpiry\" name=\"cooldownexpiry\"\n                                class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\"\n                                data-popover-target=\"cooldownExpiry-popover\">\n                                <option value=\"1\" <?= $cooldownUnit == 1 ? ' selected=\"selected\"' : ''; ?>>Seconds\n                                </option>\n                                <option value=\"60\" <?= $cooldownUnit == 60 ? ' selected=\"selected\"' : ''; ?>>Minutes\n                                </option>\n                                <option value=\"3600\" <?= $cooldownUnit == 3600 ? ' selected=\"selected\"' : ''; ?>>Hours\n                                </option>\n                                <option value=\"86400\" <?= $cooldownUnit == 86400 ? ' selected=\"selected\"' : ''; ?>>Days\n                                </option>\n                                <option value=\"604800\" <?= $cooldownUnit == 604800 ? ' selected=\"selected\"' : ''; ?>>\n                                    Weeks</option>\n                                <option value=\"2629743\" <?= $cooldownUnit == 2629743 ? ' selected=\"selected\"' : ''; ?>>\n                                    Months</option>\n                                <option value=\"31556926\"\n                                    <?= $cooldownUnit == 31556926 ? ' selected=\"selected\"' : ''; ?>>Years</option>\n                                <option value=\"315569260\"\n                                    <?= $cooldownUnit == 315569260 ? ' selected=\"selected\"' : ''; ?>>Lifetime</option>\n                            </select>\n                            <label for=\"cooldownexpiry\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">HWID\n                                Reset Cooldown Unit</label>\n                                <?php dashboard\\primary\\popover(\"cooldownExpiry-popover\", \"HWID Reset Cooldown (unit)\", \"The unit before a user can HWID reset again.\"); ?>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" inputmode=\"numeric\" name=\"cooldownduration\" id=\"cooldownduration\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $cooldown / $cooldownUnit; ?>\"\n                                data-popover-target=\"cooldownDuration-popover\">\n                            <label for=\"cooldownduration\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">HWID\n                                Reset Cooldown Duration</label>\n                                <?php dashboard\\primary\\popover(\"cooldownDuration-popover\", \"HWID Reset Cooldown (duration)\", \"The duration before a user can HWID reset again. (Unit * Duration = cooldown)\"); ?>\n                        </div>\n                        <div class=\"relative\">\n                            <select id=\"sessionexpiry\" name=\"sessionexpiry\"\n                                class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\"\n                                data-popover-target=\"sessionExpiry-popover\">\n                                <option value=\"1\" <?= $sessionUnit == 1 ? ' selected=\"selected\"' : ''; ?>>Seconds\n                                </option>\n                                <option value=\"60\" <?= $sessionUnit == 60 ? ' selected=\"selected\"' : ''; ?>>Minutes\n                                </option>\n                                <option value=\"3600\" <?= $sessionUnit == 3600 ? ' selected=\"selected\"' : ''; ?>>Hours\n                                </option>\n                                <option value=\"86400\" <?= $sessionUnit == 86400 ? ' selected=\"selected\"' : ''; ?>>Days\n                                </option>\n                                <option value=\"604800\" <?= $sessionUnit == 604800 ? ' selected=\"selected\"' : ''; ?>>\n                                    Weeks\n                                </option>\n                            </select>\n                            <label for=\"sessionexpiry\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Session\n                                Expiry Unit</label>\n                                <?php dashboard\\primary\\popover(\"sessionExpiry-popover\", \"Session Expiry (unit)\", \"The unit before the users session expires (logs out)\"); ?>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" inputmode=\"numeric\" name=\"sessionduration\" id=\"sessionduration\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none  focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $session / $sessionUnit; ?>\" required\n                                data-popover-target=\"sessionDuration-popover\">\n                            <label for=\"sessionduration\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Session\n                                Expiry Duration</label>\n                                <?php dashboard\\primary\\popover(\"sessionDuration-popover\", \"Session Expiry (duration)\", \"The duration before the users session expires (logs out. Unit * Duration = expiry)\"); ?>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" inputmode=\"numeric\" name=\"minUsernameLength\" id=\"minUsernameLength\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $minUsernameLength; ?>\" required\n                                data-popover-target=\"minUsernameLength-popover\">\n                            <label for=\"minUsernameLength\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Minimum\n                                username length</label>\n                                <?php dashboard\\primary\\popover(\"minUsernameLength-popover\", \"Minimum Username Length\", \"Prevents users from creating an account with a username less than the \n                                given value.\"); ?>\n                        </div>\n                    </div>\n                    <div class=\"hidden p-4 rounded-lg grid gap-4 -mt-8\" id=\"messages\" role=\"tabpanel\"\n                        aria-labelledby=\"messages-tab\">\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"appdisabled\" id=\"appdisabled\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $appdisabled; ?>\" required>\n                            <label for=\"appdisabled\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Application\n                                Disabled Message</label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"tokeninvalid\" id=\"tokeninvalid\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $tokeninvalid; ?>\" required>\n                            <label for=\"tokeninvalid\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Token Validation Message</label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"hashcheckfail\" id=\"hashcheckfail\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $hashcheckfail; ?>\" required>\n                            <label for=\"hashcheckfail\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Mismatch Program Hash Message\n                            </label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"vpnblocked\" id=\"vpnblocked\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $vpnblocked; ?>\" required>\n                            <label for=\"vpnblocked\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">VPNs\n                                are blocked on this application\n                            </label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"usernametaken\" id=\"usernametaken\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $usernametaken; ?>\" required>\n                            <label for=\"usernametaken\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Username\n                                already taken, choose a different one\n                            </label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"keynotfound\" id=\"keynotfound\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $keynotfound; ?>\" required>\n                            <label for=\"keynotfound\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Invalid\n                                license key\n                            </label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"keyused\" id=\"keyused\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $keyused; ?>\" required>\n                            <label for=\"keyused\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">License\n                                key has already been used\n                            </label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"keybanned\" id=\"keybanned\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $keybanned; ?>\" required>\n                            <label for=\"keybanned\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Your\n                                license is banned\n                            </label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"nosublevel\" id=\"nosublevel\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $nosublevel; ?>\" required>\n                            <label for=\"nosublevel\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">There\n                                is no subscription created for your key level. Contact application developer.\n                            </label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"userbanned\" id=\"userbanned\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $userbanned; ?>\" required>\n                            <label for=\"userbanned\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">The\n                                user is banned\n                            </label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"usernamenotfound\" id=\"usernamenotfound\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $usernamenotfound; ?>\" required>\n                            <label for=\"usernamenotfound\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Username\n                                doesn't exist\n                            </label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"passmismatch\" id=\"passmismatch\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $passmismatch; ?>\" required>\n                            <label for=\"passmismatch\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Password\n                                does not match.\n                            </label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"hwidmismatch\" id=\"hwidmismatch\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $hwidmismatch; ?>\" required>\n                            <label for=\"hwidmismatch\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">HWID\n                                doesn't match. Ask for a HWID reset\n                            </label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"noactivesubs\" id=\"noactivesubs\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $noactivesubs; ?>\" required>\n                            <label for=\"noactivesubs\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">No\n                                active subscription(s) found\n                            </label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"hwidblacked\" id=\"hwidblacked\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $hwidblacked; ?>\" required>\n                            <label for=\"hwidblacked\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">You've\n                                been blacklisted from our application\n                            </label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"pausedsub\" id=\"pausedsub\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $pausedsub; ?>\" required>\n                            <label for=\"pausedsub\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Your\n                                subscription is paused and can't be used right now\n                            </label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"sessionunauthed\" id=\"sessionunauthed\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $sessionunauthed; ?>\" required>\n                            <label for=\"sessionunauthed\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Session\n                                is not validated\n                            </label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"loggedInMsg\" id=\"loggedInMsg\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $loggedInMsg; ?>\" required>\n                            <label for=\"loggedInMsg\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Logged\n                                in!\n                            </label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"pausedApp\" id=\"pausedApp\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $pausedApp; ?>\" required>\n                            <label for=\"pausedApp\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Application\n                                is currently paused, please wait for the developer to say otherwise.\n                            </label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"unTooShort\" id=\"unTooShort\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $unTooShort; ?>\" required>\n                            <label for=\"unTooShort\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Username\n                                too short, try longer one.\n                            </label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" maxlength=\"100\" name=\"pwLeaked\" id=\"pwLeaked\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $pwLeaked; ?>\" required>\n                            <label for=\"pwLeaked\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">This\n                                password has been leaked in a data breach (not from us), please use a different one.\n                            </label>\n                        </div>\n                        <div class=\"relative \">\n                            <input type=\"text\" maxlength=\"100\" name=\"chatHitDelay\" id=\"chatHitDelay\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                                autocomplete=\"on\" value=\"<?= $chatHitDelay; ?>\" required>\n                            <label for=\"chatHitDelay\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Chat\n                                slower, you've hit the delay limit\n                            </label>\n                        </div>\n                    </div>\n                    <div class=\"hidden p-4 rounded-lg  grid gap-4 -mt-8\" id=\"storesettings\" role=\"tabpanel\"\n                        aria-labelledby=\"storesettings-tab\">\n                        <div class=\"relative\">\n                            <input type=\"text\" id=\"resellerstore\" name=\"resellerstore\"\n                                class=\"transition duration-500 block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $rs; ?>\" placeholder=\" \" data-popover-target=\"resellerstore-popover\">\n                            <label for=\"resellerstore\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Reseller\n                                Store Link</label>\n\n                                <div data-popover id=\"resellerstore-popover\" role=\"tooltip\"\n                                class=\"absolute z-10 invisible inline-block w-64 text-sm text-gray-500 transition-opacity duration-300 bg-[#09090d] rounded-lg shadow-sm opacity-0\">\n                                <div class=\"px-3 py-2 bg-[#09090d]/70 rounded-t-lg\">\n                                    <h3 class=\"font-semibold text-white\">Reseller Store Link</h3>\n                                </div>\n                                <div class=\"px-3 py-2\">\n                                    <p>If you're not using built-in reseller system, set a link will show to your resellers for them to buy keys.</p>\n                                </div>\n                                <div data-popper-arrow></div>\n                            </div>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"url\" id=\"resellerstoreWebhookLink\" name=\"resellerstoreWebhookLink\"\n                                class=\"transition duration-500 block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none    focus:outline-none focus:ring-0 focus:border-blue-600 peer blur-sm hover:blur-none\"\n                                value=\"<?= 'https://' . (($_SERVER['HTTP_HOST'] == 'keyauth.cc') ? 'keyauth.win' : $_SERVER['HTTP_HOST']) . '/api/reseller/?app=' . $_SESSION['secret']; ?>\"\n                                placeholder=\" \" / data-popover-target=\"resellerstoreWebhookLink-popover\">\n                            <label for=\"resellerstoreWebhookLink\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Reseller\n                                Webhook Link</label>\n\n                                <div data-popover id=\"resellerstoreWebhookLink-popover\" role=\"tooltip\"\n                                class=\"absolute z-10 invisible inline-block w-64 text-sm text-gray-500 transition-opacity duration-300 bg-[#09090d] rounded-lg shadow-sm opacity-0\">\n                                <div class=\"px-3 py-2 bg-[#09090d]/70 rounded-t-lg\">\n                                    <h3 class=\"font-semibold text-white\">Reseller Webhook Link</h3>\n                                </div>\n                                <div class=\"px-3 py-2\">\n                                    <p>This is the same if you're using Sellix or Shoppy, create webhook with this link for the event order:paid</p>\n                                </div>\n                                <div data-popper-arrow></div>\n                            </div>\n                        </div>\n                        <h1 class=\"text-xl font-semibold text-white-900 sm:text-2xl\">Shoppy</h1>\n                        <div class=\"relative\">\n                            <input type=\"text\" id=\"shoppywebhooksecret\" name=\"shoppywebhooksecret\"\n                                class=\"transition duration-500 block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none    focus:outline-none focus:ring-0 focus:border-blue-600 peer blur-sm hover:blur-none\"\n                                value=\"<?= $shoppywhsecret; ?>\" maxlength=\"16\" placeholder=\" \"\n                                data-popover-target=\"shoppywebhooksecret-popover\">\n                            <label for=\"shoppywebhooksecret\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Shoppy\n                                Webhook Secret</label>\n\n                                <div data-popover id=\"shoppywebhooksecret-popover\" role=\"tooltip\"\n                                class=\"absolute z-10 invisible inline-block w-64 text-sm text-gray-500 transition-opacity duration-300 bg-[#09090d] rounded-lg shadow-sm opacity-0\">\n                                <div class=\"px-3 py-2 bg-[#09090d]/70 rounded-t-lg\">\n                                    <h3 class=\"font-semibold text-white\">Shoppy Webhook Secret</h3>\n                                </div>\n                                <div class=\"px-3 py-2\">\n                                    <p>Shoppy webhook secret for reseller system.</p>\n                                </div>\n                                <div data-popper-arrow></div>\n                            </div>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" id=\"shoppydayproduct\" name=\"shoppydayproduct\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none    focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $shoppydayproduct; ?>\" maxlength=\"7\" placeholder=\" \" />\n                            <label for=\"shoppydayproduct\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Shoppy\n                                Day Product ID</label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" id=\"shoppyweekproduct\" name=\"shoppyweekproduct\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none    focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $shoppyweekproduct; ?>\" maxlength=\"7\" placeholder=\" \" />\n                            <label for=\"shoppyweekproduct\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Shoppy\n                                Week Product ID</label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" id=\"shoppymonthproduct\" name=\"shoppymonthproduct\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none    focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $shoppymonthproduct; ?>\" maxlength=\"7\" placeholder=\" \" />\n                            <label for=\"shoppymonthproduct\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Shoppy\n                                Month Product ID</label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" id=\"shoppylifetimeproduct\" name=\"shoppylifetimeproduct\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none    focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $shoppylifetimeproduct; ?>\" maxlength=\"7\" placeholder=\" \" />\n                            <label for=\"shoppylifetimeproduct\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Shoppy\n                                Lifetime Product ID</label>\n                        </div>\n                        <h1 class=\"text-xl font-semibold text-white-900 sm:text-2xl\">Sellix</h1>\n                        <div class=\"relative\">\n                            <input type=\"text\" id=\"sellixwebhooksecret\" name=\"sellixwebhooksecret\"\n                                class=\"transition duration-500 block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none    focus:outline-none focus:ring-0 focus:border-blue-600 peer blur-sm hover:blur-none\"\n                                value=\"<?= $sellixwhsecret; ?>\" maxlength=\"32\" placeholder=\" \" \n                                data-popover-target=\"sellixwebhooksecret-popover\">\n                            <label for=\"sellixwebhooksecret\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Sellix\n                                Webhook Secret</label>\n\n                                <div data-popover id=\"sellixwebhooksecret-popover\" role=\"tooltip\"\n                                class=\"absolute z-10 invisible inline-block w-64 text-sm text-gray-500 transition-opacity duration-300 bg-[#09090d] rounded-lg shadow-sm opacity-0\">\n                                <div class=\"px-3 py-2 bg-[#09090d]/70 rounded-t-lg\">\n                                    <h3 class=\"font-semibold text-white\">Sellix Webhook Secret</h3>\n                                </div>\n                                <div class=\"px-3 py-2\">\n                                    <p>Sellix webhook secret for reseller system.</p>\n                                </div>\n                                <div data-popper-arrow></div>\n                            </div>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" id=\"sellixdayproduct\" name=\"sellixdayproduct\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none    focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $sellixdayproduct; ?>\" maxlength=\"13\" placeholder=\" \" />\n                            <label for=\"sellixdayproduct\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Sellix\n                                Day Product ID</label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" id=\"sellixweekproduct\" name=\"sellixweekproduct\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none    focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $sellixweekproduct; ?>\" maxlength=\"13\" placeholder=\" \" />\n                            <label for=\"sellixweekproduct\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Sellix\n                                Week Product ID</label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" id=\"sellixmonthproduct\" name=\"sellixmonthproduct\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none    focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $sellixmonthproduct; ?>\" maxlength=\"13\" placeholder=\" \" />\n                            <label for=\"sellixmonthproduct\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Sellix\n                                Month Product ID</label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" id=\"sellixlifetimeproduct\" name=\"sellixlifetimeproduct\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none    focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $sellixlifetimeproduct; ?>\" maxlength=\"13\" placeholder=\" \" />\n                            <label for=\"sellixlifetimeproduct\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Sellix\n                                Lifetime Product ID</label>\n                        </div>\n                        <h1 class=\"text-xl font-semibold text-white-900 sm:text-2xl\">Sellapp</h1>\n                        <div class=\"relative\">\n                            <input type=\"text\" id=\"sellappwebhooksecret\" name=\"sellappwebhooksecret\"\n                                class=\"transition duration-500 block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none    focus:outline-none focus:ring-0 focus:border-blue-600 peer blur-sm hover:blur-none\"\n                                value=\"<?= $sellappwhsecret; ?>\" maxlength=\"64\" placeholder=\" \" \n                                data-popover-target=\"sellappwebhooksecret-popover\">\n                            <label for=\"sellappwebhooksecret\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Sellapp\n                                Webhook Secret</label>\n\n                                <div data-popover id=\"sellappwebhooksecret-popover\" role=\"tooltip\"\n                                class=\"absolute z-10 invisible inline-block w-64 text-sm text-gray-500 transition-opacity duration-300 bg-[#09090d] rounded-lg shadow-sm opacity-0\">\n                                <div class=\"px-3 py-2 bg-[#09090d]/70 rounded-t-lg\">\n                                    <h3 class=\"font-semibold text-white\">Sell App Webhook Secret</h3>\n                                </div>\n                                <div class=\"px-3 py-2\">\n                                    <p>SellApp webhook secret for reseller system.</p>\n                                </div>\n                                <div data-popper-arrow></div>\n                            </div>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" id=\"sellappdayproduct\" name=\"sellappdayproduct\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none    focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $sellappdayproduct; ?>\" placeholder=\" \" />\n                            <label for=\"sellappdayproduct\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Sellapp\n                                Day Product ID</label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" id=\"sellappweekproduct\" name=\"sellappweekproduct\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none    focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $sellappweekproduct; ?>\" placeholder=\" \" />\n                            <label for=\"sellappweekproduct\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Sellapp\n                                Week Product ID</label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" id=\"sellappmonthproduct\" name=\"sellappmonthproduct\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none    focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $sellappmonthproduct; ?>\" placeholder=\" \" />\n                            <label for=\"sellappmonthproduct\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Sellapp\n                                Month Product ID</label>\n                        </div>\n                        <div class=\"relative\">\n                            <input type=\"text\" id=\"sellapplifetimeproduct\" name=\"sellapplifetimeproduct\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white-900 bg-transparent rounded-lg border-1 border-gray-700 appearance-none    focus:outline-none focus:ring-0 focus:border-blue-600 peer\"\n                                value=\"<?= $sellapplifetimeproduct; ?>\" placeholder=\" \" />\n                            <label for=\"sellapplifetimeproduct\"\n                                class=\"absolute text-sm text-gray-500 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Sellapp\n                                Lifetime Product ID</label>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"flex justify-end\">\n                    <button\n                        class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        name=\"updatesettings\" id=\"updatesettings\">\n                        <i class=\"lni lni-save mr-2 mt-1\"></i>Update App Settings\n                    </button>\n                </div>\n            </form>\n\n            <!-- Add New Hash Modal -->\n            <div id=\"add-new-hash-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                <div class=\"relative w-full max-w-md max-h-full\">\n                    <!-- Modal content -->\n                    <div class=\"relative bg-[#0f0f17] rounded-lg border border-blue-700 shadow\">\n                        <div class=\"px-6 py-6 lg:px-8\">\n                            <h3 class=\"mb-4 text-xl font-medium text-white-900\">Add Application Hash</h3>\n                            <hr class=\"h-px mb-4 mt-4 bg-gray-700 border-0\">\n                            <form class=\"space-y-6\" method=\"POST\">\n                                <div>\n                                    <div class=\"relative mb-4\">\n                                        <input type=\"text\" id=\"hash\" name=\"hash\"\n                                            class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                            placeholder=\" \" autocomplete=\"on\" required>\n                                        <label for=\"hash\"\n                                            class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">MD5\n                                            Program Hash To Add</label>\n                                    </div>\n                                </div>\n                                <button type=\"submit\" name=\"addhash\"\n                                    class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Add\n                                    Hash</button>\n                            </form>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <!-- End Add New Hash Modal -->\n\n            <!-- Reset Program Hash Modal -->\n            <div id=\"reset-program-hash-modal\" tabindex=\"-1\"\n                class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                <div class=\"relative w-full max-w-md max-h-full\">\n                    <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                        <div class=\"p-6 text-center\">\n                            <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                role=\"alert\">\n                                <span class=\"sr-only\">Info</span>\n                                <div>\n                                    <span class=\"font-medium\">Notice!</span> You're about to reset your programs hash.\n                                    This should only be done if you\n                                    plan on releasing a new version/update.\n                                    <b>This can\n                                        NOT be undone.</b>\n                                </div>\n                            </div>\n                            <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure\n                                you want\n                                to\n                                reset your programs hash?</h3>\n                            <form method=\"POST\">\n                                <button data-modal-hide=\"reset-program-hash-modal\" name=\"resethash\"\n                                    class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                    Yes, I'm sure\n                                </button>\n                                <button data-modal-hide=\"reset-program-hash-modal\" type=\"button\"\n                                    class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                    cancel</button>\n                            </form>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <!-- End Reset Program HashModal -->\n\n            <!-- Include the jQuery library -->\n            \n\n            <script>\n            $(document).keydown(function(event) {\n                if (event.ctrlKey && event.key === 's') {\n                    $(\"#updatesettings\").click();\n\n                    event.preventDefault();\n                }\n            });\n\n            $(\"#updatesettings\").on(\"click\", function() {\n\n            });\n            </script>\n","size_bytes":101838},"app/pages/audit-log.php":{"content":"<?php\nif ($_SESSION['role'] == \"Reseller\") {\n    header(\"location: ./?page=reseller-licenses\");\n    die();\n}\nif ($role == \"Manager\") {\n    misc\\auditLog\\send(\"Attempted (and failed) to view audit logs.\");\n    dashboard\\primary\\error(\"Managers aren't allowed to view audit logs.\");\n    die();\n}\nif (!isset($_SESSION['app'])) {\n    dashboard\\primary\\error(\"Application not selected\");\n    die(\"Application not selected.\");\n}\nif (isset($_POST['delauditLogs'])){\n   $resp = misc\\auditLog\\deleteAll();\n   match($resp){\n    'failure' => dashboard\\primary\\error(\"Failed to delete all audit logs\"),\n    'success' => dashboard\\primary\\success(\"Successfully deleted all audit logs!\"),\n    default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n   };\n}\nif (isset($_POST['exportAuditLogs'])) {\n        echo \"<meta http-equiv='Refresh' Content='0; url=download-types.php?type=auditLog'>\";\n        // get all rows, put in text file, download text file, delete text file.\n}\n?>\n\n<div class=\"p-4 bg-[#09090d] block sm:flex items-center justify-between lg:mt-1.5\">\n    <div class=\"mb-1 w-full bg-[#0f0f17] rounded-xl\">\n        <div class=\"mb-4 p-4\">\n            <?php require '../app/layout/breadcrumb.php'; ?>\n            <h1 class=\"text-xl font-semibold text-white-900 sm:text-2xl\">Audit Logs</h1>\n            <p class=\"text-xs text-gray-500\">Logs from Manager and Reseller actions. <a\n                    href=\"https://keyauth.readme.io/reference/audit-logs\" target=\"_blank\"\n                    class=\"text-blue-600 hover:underline\">Learn More</a>.</p>\n            <br>\n            <div class=\"p-4 flex flex-col\">\n                <div class=\"overflow-x-auto\">\n                    <form method=\"POST\">\n                        <!-- Audit Logs Functions -->\n                        <button name=\"exportAuditLogs\"\n                            class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">\n                            <i class=\"lni lni-download mr-2 mt-1\"></i>Export Audit Logs\n                        </button>\n                        <!-- End Audit Logs Functions -->\n                        <br>\n                        <!-- Delete Audit Logs Functions -->\n                        <button type=\"button\"\n                            class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                            data-modal-toggle=\"delete-all-audit-logs-modal\"\n                            data-modal-target=\"delete-all-audit-logs-modal\">\n                            <i class=\"lni lni-trash-can mr-2 mt-1\"></i>Delete All Audit Logs\n                        </button>\n                        <!-- End Delete Audit Logs Functions -->\n                    </form>\n\n                    <!-- Delete All Audit Logs Modal -->\n                    <div id=\"delete-all-audit-logs-modal\" tabindex=\"-1\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                        role=\"alert\">\n                                        <span class=\"sr-only\">Info</span>\n                                        <div>\n                                            <span class=\"font-medium\">Notice!</span> You're about to delete all of your\n                                            Audit logs. Are you sure you want to continue?\n                                            </b>\n                                        </div>\n                                    </div>\n                                    <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure you want to delete\n                                        all of your Audit Logs? This can not be undone.</h3>\n                                    <form method=\"POST\">\n                                        <button data-modal-hide=\"delete-all-audit-logs-modal\" name=\"delauditLogs\"\n                                            class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                            Yes, I'm sure\n                                        </button>\n                                        <button data-modal-hide=\"delete-all-audit-logs-modal\" type=\"button\"\n                                            class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                            cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Delete All Audit Logs Modal -->\n\n                    <!-- START TABLE -->\n                    <div class=\"relative overflow-x-auto shadow-md sm:rounded-lg pt-5\">\n                        <table id=\"kt_datatable_webhooks\" class=\"w-full text-sm text-left text-white\">\n                            <thead>\n                                <tr class=\"fw-bolder fs-6 text-blue-700 px-7\">\n                                    <th class=\"px-6 py-3\">User</th>\n                                    <th class=\"px-6 py-3\">Event</th>\n                                    <th class=\"px-6 py-3\">Time</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                <?php\n                                    if ($_SESSION['app']) {\n                                        $query = misc\\mysql\\query(\"SELECT * FROM `auditLog` WHERE `app` = ?\", [$_SESSION['app']]);\n                                        if ($query->num_rows > 0) {\n                                            while ($row = mysqli_fetch_array($query->result)) {\n\n                                                echo \"<tr>\";\n\n                                                echo \"  <td>\" . $row[\"user\"] . \"</td>\";\n\n                                                echo \"  <td>\" . $row[\"event\"] . \"</td>\";\n\n                                                echo \"  <td><script>document.write(convertTimestamp(\" . $row[\"time\"] . \"));</script></td>\";\n\n                                                echo \"</tr>\";\n                                            }\n                                        }\n                                    }\n                                ?>\n                            </tbody>\n                        </table>\n                    </div>\n                    \n","size_bytes":7146},"app/pages/blacklists.php":{"content":"<?php\nif ($_SESSION['role'] == \"Reseller\") {\n    header(\"location: ./?page=reseller-licenses\");\n    die();\n}\nif ($role == \"Manager\" && !($permissions & 512)) {\n    misc\\auditLog\\send(\"Attempted (and failed) to view blacklists.\");\n    dashboard\\primary\\error(\"You weren't granted permission to view this page!\");\n    die();\n}\nif (!isset($_SESSION['app'])) {\n    dashboard\\primary\\error(\"Application not selected\");\n    die(\"Application not selected.\");\n}\nif (isset($_POST['addblack'])) {\n    $resp = misc\\blacklist\\add($_POST['blackdata'], $_POST['blacktype']);\n    match($resp){\n        'invalid' => dashboard\\primary\\error(\"Invalid blacklist type!\"),\n        'failure' => dashboard\\primary\\error(\"Failed to add blacklists!\"),\n        'success' => dashboard\\primary\\success(\"Successfully added blacklists!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['delblacks'])) {\n    $resp = misc\\blacklist\\deleteAll();\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to delete all whitelists!\"),\n        'success' => dashboard\\primary\\success(\"Successfully deleted all whitelists!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n\nif (isset($_POST['deleteblack'])) {\n    $resp = misc\\blacklist\\deleteSingular($_POST['deleteblack'], $_POST['type']);\n    match($resp){\n        'invalid' => dashboard\\primary\\error(\"Invalid blacklist type!\"),\n        'failure' => dashboard\\primary\\error(\"Failed to delete blacklist!\"),\n        'success' => dashboard\\primary\\success(\"Successfully deleted blacklist!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['addwhite'])) {\n    $resp = misc\\blacklist\\addWhite($_POST['ip']);\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to add whitelist\"),\n        'success' => dashboard\\primary\\success(\"Successfully added whitelist\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n?>\n\n<div class=\"p-4 bg-[#09090d] block sm:flex items-center justify-between lg:mt-1.5\">\n    <div class=\"mb-1 w-full bg-[#0f0f17] rounded-xl\">\n        <div class=\"mb-4 p-4\">\n            <?php require '../app/layout/breadcrumb.php'; ?>\n            <h1 class=\"text-xl font-semibold text-white-900 sm:text-2xl\">Blacklists</h1>\n            <p class=\"text-xs text-gray-500\">Block or accept access from certain IPs/HWIDs <a\n                    href=\"https://keyauth.readme.io/reference/blacklists-1\" target=\"_blank\"\n                    class=\"text-blue-600 hover:underline\">Learn More</a>.</p>\n            <br>\n            <div class=\"p-4 flex flex-col\">\n                <div class=\"overflow-x-auto\">\n                    <!-- Blacklists Functions -->\n                    <button\n                        class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"add-blacklist-modal\" data-modal-target=\"add-blacklist-modal\">\n                        <i class=\"lni lni-circle-plus mr-2 mt-1\"></i>Create Blacklist\n                    </button>\n                    <button\n                        class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"add-whitelist-modal\" data-modal-target=\"add-whitelist-modal\">\n                        <i class=\"lni lni-circle-plus mr-2 mt-1\"></i>Create Whitelist\n                    </button>\n                    <!-- End Blacklists Functions -->\n\n                    <br>\n\n                    <!-- Delete Blacklists Functions -->\n                    <button\n                        class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"delete-all-blacklists-modal\" data-modal-target=\"delete-all-blacklists-modal\">\n                        <i class=\"lni lni-trash-can mr-2 mt-1\"></i>Delete All Blacklists\n                    </button>\n                    <button\n                        class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"delete-all-whitelists-modal\" data-modal-target=\"delete-all-whitelists-modal\">\n                        <i class=\"lni lni-trash-can mr-2 mt-1\"></i>Delete All Whitelists\n                    </button>\n                    <!-- End Delete Blacklists Functions -->\n\n                    <!-- Add To Blacklist Modal -->\n                    <div id=\"add-blacklist-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <!-- Modal content -->\n                            <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                                <div class=\"px-6 py-6 lg:px-8\">\n                                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Add Blacklist</h3>\n                                    <hr class=\"h-px mb-4 mt-4 bg-gray-700 border-0\">\n                                    <form class=\"space-y-6\" method=\"POST\">\n                                        <div>\n\n                                            <div class=\"relative mb-4  \">\n                                                <select id=\"blacktype\" name=\"blacktype\"\n                                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\">\n                                                    <option selected>IP Address</option>\n                                                    <option>Hardware ID</option>\n                                                </select>\n                                                <label for=\"blacktype\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Blacklist\n                                                    Type</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" id=\"blackdata\" name=\"blackdata\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\" required>\n                                                <label for=\"blackdata\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">IP\n                                                    / HWID</label>\n                                            </div>\n\n                                        </div>\n                                        <button type=\"submit\" name=\"addblack\"\n                                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Blacklist</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Add Blacklist Modal -->\n\n                    <!-- Add To Whitelist Modal -->\n                    <div id=\"add-whitelist-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <!-- Modal content -->\n                            <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                                <div class=\"px-6 py-6 lg:px-8\">\n                                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Add Whitelist</h3>\n                                    <hr class=\"h-px mb-4 mt-4 bg-gray-700 border-0\">\n                                    <form class=\"space-y-6\" method=\"POST\">\n                                        <div>\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" id=\"ip\" name=\"ip\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\"\" autocomplete=\"on\" required>\n                                                <label for=\"ip\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">IP\n                                                </label>\n                                            </div>\n                                        </div>\n                                        <button type=\"submit\" name=\"addwhite\"\n                                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Whitelist</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Add Whitelist Modal -->\n\n                    <!-- Delete All Blacklists Modal -->\n                    <div id=\"delete-all-blacklists-modal\" tabindex=\"-1\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                        role=\"alert\">\n                                        <span class=\"sr-only\">Info</span>\n                                        <div>\n                                            <span class=\"font-medium\">Notice!</span> You're about to delete all of your\n                                            Blacklists. Are you sure you want to continue?\n                                            </b>\n                                        </div>\n                                    </div>\n                                    <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure you want to delete\n                                        all of your Blacklists? This can not be undone.</h3>\n                                    <form method=\"POST\">\n                                        <button data-modal-hide=\"delete-all-blacklists-modal\" name=\"delblacks\"\n                                            class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                            Yes, I'm sure\n                                        </button>\n                                        <button data-modal-hide=\"delete-all-blacklists-modal\" type=\"button\"\n                                            class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                            cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Delete All Blacklists Modal -->\n\n                    <!-- Delete All Whitelists Modal -->\n                    <div id=\"delete-all-whitelists-modal\" tabindex=\"-1\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                        role=\"alert\">\n                                        <span class=\"sr-only\">Info</span>\n                                        <div>\n                                            <span class=\"font-medium\">Notice!</span> You're about to delete all of your\n                                            Whitelists. Are you sure you want to continue?\n                                            </b>\n                                        </div>\n                                    </div>\n                                    <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure you want to delete\n                                        all of your Whitelists? This can not be undone.</h3>\n                                    <form method=\"POST\">\n                                        <button data-modal-hide=\"delete-all-whitelists-modal\" name=\"delauditLogs\"\n                                            class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                            Yes, I'm sure\n                                        </button>\n                                        <button data-modal-hide=\"delete-all-whitelists-modal\" type=\"button\"\n                                            class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                            cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Delete All Whitelists Modal -->\n\n\n                    <!-- START TABLE -->\n                    <div class=\"relative overflow-x-auto shadow-md sm:rounded-lg pt-5\">\n                        <table id=\"kt_datatable_blacklists\"\n                            class=\"w-full text-sm text-left text-white\">\n                            <thead>\n                                <tr class=\"fw-bolder fs-6 text-blue-700 px-7\">\n                                    <th class=\"px-6 py-3\">Blacklist Data</th>\n                                    <th class=\"px-6 py-3\">Blacklist Type</th>\n                                    <th class=\"px-6 py-3\">Actions</th>\n                                </tr>\n                            </thead>\n                        </table>\n                    </div>\n                    <p class=\"text-xs text-red-600\">Dropdown actions in <b>RED</b> do not show a confirmation!<a class=\"text-blue-700\"> Dropdown actions in <b>BLUE</b> will show a confirmation!</a></p>\n                    \n","size_bytes":16929},"app/pages/chats.php":{"content":"<?php\nif ($_SESSION['role'] == \"Reseller\") {\n    header(\"location: ./?page=reseller-licenses\");\n    die();\n}\nif ($role == \"Manager\" && !($permissions & 8)) {\n    misc\\auditLog\\send(\"Attempted (and failed) to view chats.\");\n    dashboard\\primary\\error(\"You weren't granted permission to view this page!\");\n    die();\n}\nif (!isset($_SESSION['app'])) {\n    dashboard\\primary\\error(\"Application not selected\");\n    die(\"Application not selected.\");\n}\n\nif (isset($_POST['deletemsg'])) {\n    $resp = misc\\chat\\deleteMessage($_POST['deletemsg']);\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to delete message!\"),\n        'success' => dashboard\\primary\\success(\"Successfully deleted message!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['muteuser'])) {\n    $muted = misc\\etc\\sanitize($_POST['muted']);\n    $time = misc\\etc\\sanitize($_POST['time']);\n    $time = $time * $muted + time();\n\n    $resp = misc\\chat\\muteUser($_POST['user'], $time);\n    match($resp){\n        'missing' => dashboard\\primary\\error(\"User doesn't exist!\"),\n        'failure' => dashboard\\primary\\error(\"Failed to mute user!\"),\n        'success' => dashboard\\primary\\success(\"Successfully muted user!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['unmuteuser'])) {\n    $resp = misc\\chat\\unMuteUser($_POST['user']);\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to unmute user!\"),\n        'success' => dashboard\\primary\\success(\"Successfully unmuted user!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['clearchannel'])) {\n    $resp = misc\\chat\\clearChannel($_POST['channel']);\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to clear channel!\"),\n        'success' => dashboard\\primary\\success(\"Successfully cleared channel!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n\nif (isset($_POST['deleteallchatchannels'])){\n    $resp = misc\\chat\\deleteAllChannels();\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to delete all chat channels!\"),\n        'success' => dashboard\\primary\\success(\"Successfully deleted all chat channels!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n\nif (isset($_POST['editchan'])) {\n    $chan = misc\\etc\\sanitize($_POST['editchan']);\n    $query = misc\\mysql\\query(\"SELECT * FROM `chats` WHERE `name` = ? AND `app` = ?\", [$chan, $_SESSION['app']]);\n    if ($query->num_rows < 1) {\n        dashboard\\primary\\error(\"Channel not found!\");\n        echo \"<meta http-equiv='Refresh' Content='2'>\";\n        return;\n    }\n?>\n\n<!-- Edit Chat Channel Modal -->\n<div id=\"edit-chat-channel-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n    class=\"fixed grid place-items-center h-screen bg-black bg-opacity-60 z-50 p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n    <div class=\"relative w-full max-w-md max-h-full\">\n        <!-- Modal content -->\n        <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n            <div class=\"px-6 py-6 lg:px-8\">\n                <h3 class=\"mb-4 text-xl font-medium text-white-900\">Edit Chat Channel</h3>\n                <form class=\"space-y-6\" method=\"POST\">\n                    <div>\n                        <div class=\"relative mb-4\">\n                            <select id=\"unit\" name=\"unit\"\n                                class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\">\n                                <option value=\"1\">Seconds</option>\n                                <option value=\"60\">Minutes</option>\n                                <option value=\"3600\">Hours</option>\n                                <option value=\"86400\">Days</option>\n                                <option value=\"604800\">Weeks</option>\n                                <option value=\"2629743\">Months</option>\n                                <option value=\"31556926\">Years</option>\n                                <option value=\"315569260\">Lifetime</option>\n                            </select>\n                            <label for=\"unit\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Chat\n                                Cooldown Unit</label>\n                        </div>\n\n                        <div class=\"relative mb-4\">\n                            <input type=\"text\" inputmode=\"numeric\" id=\"delay\" name=\"delay\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                placeholder=\" \" autocomplete=\"on\">\n                            <label for=\"delay\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Cooldown\n                                Time * By Unit</label>\n                        </div>\n                    </div>\n\n                    <button name=\"savechan\" value=\"<?= $chan; ?>\"\n                        class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Save\n                        Changes</button>\n\n                    <button onClick=\"window.location.href=window.location.href\"\n                        class=\"w-full text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Cancel</button>\n                </form>\n            </div>\n        </div>\n    </div>\n</div>\n<!-- End Edit Chat Channel Modal -->\n\n<?php\n}\nif (isset($_POST['savechan'])) {\n    $chan = misc\\etc\\sanitize($_POST['savechan']);\n    $unit = misc\\etc\\sanitize($_POST['unit']);\n    $delay = misc\\etc\\sanitize($_POST['delay']);\n    $delay = $delay * $unit;\n    $query = misc\\mysql\\query(\"UPDATE `chats` SET `delay` = ? WHERE `app` = ? AND `name` = ?\", [$delay, $_SESSION['app'], $chan]);\n    if ($query->affected_rows > 0) // check query impacted something, else show error\n    {\n        dashboard\\primary\\success(\"Successfully updated channel!\");\n    } else {\n        dashboard\\primary\\error(\"Failed To update channel!\");\n    }\n}\nif (isset($_POST['deletechan'])) {\n    $resp = misc\\chat\\deleteChannel($_POST['deletechan']);\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to delete channel!\"),\n        'success' => dashboard\\primary\\success(\"Successfully deleted channel!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n\nif (isset($_POST['addchannel'])) {\n    if ($_SESSION['role'] != \"seller\") {\n        dashboard\\primary\\error(\"You must upgrade to seller to create chat channels\");\n    } else {\n        $unit = misc\\etc\\sanitize($_POST['unit']);\n        $delay = misc\\etc\\sanitize($_POST['delay']);\n        $delay = $delay * $unit;\n        $resp = misc\\chat\\createChannel($_POST['name'], $delay);\n        match($resp){\n            'failure' => dashboard\\primary\\error(\"Failed to create channel!\"),\n            'success' => dashboard\\primary\\success(\"Successfully created channel!\"),\n            default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n        };\n    }\n}\n?>\n\n\n<div class=\"p-4 bg-[#09090d] block sm:flex items-center justify-between lg:mt-1.5\">\n    <div class=\"mb-1 w-full bg-[#0f0f17] rounded-xl\">\n        <div class=\"mb-4 p-4\">\n            <?php require '../app/layout/breadcrumb.php'; ?>\n            <h1 class=\"text-xl font-semibold text-white-900 sm:text-2xl\">Chats</h1>\n            <p class=\"text-xs text-gray-500\">Allow your users to chat with each other. <a\n                    href=\"https://keyauth.readme.io/reference/chats-1\" target=\"_blank\"\n                    class=\"text-blue-600 hover:underline\">Learn More</a>.\n            </p>\n            <br>\n            <div class=\"p-4 flex flex-col\">\n                <div class=\"overflow-x-auto\">\n                    <!-- Chat Functions -->\n                    <button\n                        class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"create-chat-channel-modal\" data-modal-target=\"create-chat-channel-modal\">\n                        <i class=\"lni lni-circle-plus mr-2 mt-1\"></i>Create Chat Channel\n                    </button>\n                    <button\n                        class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"unmute-user-modal\" data-modal-target=\"unmute-user-modal\">\n                        <i class=\"lni lni-volume-mute mr-2 mt-1\"></i>Unmute User\n                    </button>\n                    <!-- End Chat Functions -->\n\n                    <br>\n\n                    <!-- Delete Chat Functions -->\n                    <button\n                        class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"clear-chat-channel-modal\" data-modal-target=\"clear-chat-channel-modal\">\n                        <i class=\"lni lni-trash-can mr-2 mt-1\"></i>Clear Chat Channel\n                    </button>\n                    <button\n                        class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"delete-all-chat-channels-modal\" data-modal-target=\"delete-all-chat-channels-modal\">\n                        <i class=\"lni lni-trash-can mr-2 mt-1\"></i>Delete All Chat Channels\n                    </button>\n\n                    <!-- Create Chat Channel Modal -->\n                    <div id=\"create-chat-channel-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <!-- Modal content -->\n                            <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                                <div class=\"px-6 py-6 lg:px-8\">\n                                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Create Chat Channel</h3>\n                                    <hr class=\"h-px mb-4 mt-4 bg-gray-700 border-0\">\n                                    <form class=\"space-y-6\" method=\"POST\">\n                                        <div>\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" id=\"name\" name=\"name\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\">\n                                                <label for=\"name\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Chat\n                                                    Channel Name</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <select id=\"unit\" name=\"unit\"\n                                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\">\n                                                    <option value=\"1\">Seconds</option>\n                                                    <option value=\"60\">Minutes</option>\n                                                    <option value=\"3600\">Hours</option>\n                                                    <option value=\"86400\">Days</option>\n                                                    <option value=\"604800\">Weeks</option>\n                                                    <option value=\"2629743\">Months</option>\n                                                    <option value=\"31556926\">Years</option>\n                                                    <option value=\"315569260\">Lifetime</option>\n                                                </select>\n                                                <label for=\"unit\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Chat\n                                                    Cooldown Unit</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" inputmode=\"numeric\" id=\"delay\" name=\"delay\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\">\n                                                <label for=\"delay\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Cooldown\n                                                    Time * By Unit</label>\n                                            </div>\n                                        </div>\n\n                                        <button name=\"addchannel\"\n                                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Create\n                                            Chat Cannel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Create Chat Channel Modal -->\n\n                    <!-- Clear Chat Channel Modal -->\n                    <div id=\"clear-chat-channel-modal\" tabindex=\"-1\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                        role=\"alert\">\n                                        <svg class=\"flex-shrink-0 inline w-4 h-4 mr-3\" aria-hidden=\"true\"\n                                            xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                            <path\n                                                d=\"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z\" />\n                                        </svg>\n                                        <span class=\"sr-only\">Info</span>\n                                        <div>\n                                            <span class=\"font-medium\">Notice!</span> You're about to clear a chat\n                                            channel. This will delete all messages in this channel. This can not be\n                                            undone!\n                                        </div>\n                                    </div>\n                                    <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure you want to clear\n                                        the chat channel? This can not be undone.</h3>\n                                    <div class=\"relative mb-4\">\n                                        <select type=\"text\" id=\"channel\" name=\"channel\"\n                                            class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\">\n                                            <?php\n                                                        $query = misc\\mysql\\query(\"SELECT * FROM `chats` WHERE `app` = ?\", [$_SESSION['app']]);\n                                                        $rows = array();\n                                                        while ($r = mysqli_fetch_assoc($query->result)) {\n                                                            $rows[] = $r;\n                                                        }\n                                                        foreach ($rows as $row) {\n                                                        ?>\n\n                                            <option><?= $row[\"name\"]; ?></option>\n\n                                            <?php\n                                                    } ?>\n                                        </select>\n                                        <label for=\"channel\"\n                                            class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Select\n                                            Channel</label>\n                                    </div>\n                                    <form method=\"POST\">\n                                        <button data-modal-hide=\"clear-chat-channel-modal\" name=\"clearchannel\"\n                                            class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                            Yes, I'm sure\n                                        </button>\n                                        <button data-modal-hide=\"clear-chat-channel-modal\" type=\"button\"\n                                            class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                            cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- Unmute User Modal -->\n\n                    <!-- Unmute User Channel Modal -->\n                    <div id=\"unmute-user-modal\" tabindex=\"-1\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <form method=\"POST\">\n                                        <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure you want to\n                                            unmute\n                                            this user?</h3>\n                                        <div class=\"relative mb-4\">\n                                            <select type=\"text\" id=\"user\" name=\"user\"\n                                                class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\">\n                                                <?php\n                                                        $query = misc\\mysql\\query(\"SELECT * FROM `chatmutes` WHERE `app` = ?\", [$_SESSION['app']]);\n                                                        $rows = array();\n                                                        while ($r = mysqli_fetch_assoc($query->result)) {\n                                                            $rows[] = $r;\n                                                        }\n                                                        foreach ($rows as $row) {\n                                                        ?>\n\n                                                <option><?= $row[\"user\"]; ?></option>\n\n                                                <?php\n                                                        } ?>\n                                            </select>\n                                            <label for=\"user\"\n                                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Select\n                                                User To Unmute</label>\n                                        </div>\n                                        <button data-modal-hide=\"unmute-user-modal\" name=\"unmuteuser\"\n                                            class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                            Yes, I'm sure\n                                        </button>\n                                        <button data-modal-hide=\"unmute-user-modal\" type=\"button\"\n                                            class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                            cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Unmute User Modal -->\n\n                    <!-- Delete All Chat Channels Modal -->\n                    <div id=\"delete-all-chat-channels-modal\" tabindex=\"-1\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                        role=\"alert\">\n                                        <svg class=\"flex-shrink-0 inline w-4 h-4 mr-3\" aria-hidden=\"true\"\n                                            xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                            <path\n                                                d=\"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z\" />\n                                        </svg>\n                                        <span class=\"sr-only\">Info</span>\n                                        <div>\n                                            <span class=\"font-medium\">Notice!</span> You're about to delete all of your\n                                            chat channels. This can not be undone!\n                                        </div>\n                                    </div>\n                                    <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure you want to delete\n                                        all of your chat channels?</h3>\n                                    <form method=\"POST\">\n                                        <button data-modal-hide=\"delete-all-chat-channels-modal\"\n                                            name=\"deleteallchatchannels\"\n                                            class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                            Yes, I'm sure\n                                        </button>\n                                        <button data-modal-hide=\"delete-all-chat-channels-modal\" type=\"button\"\n                                            class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                            cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Delete All Chat Channels Modal -->\n\n                    <!-- Mute User Modal -->\n                    <div id=\"mute-user-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                        class=\"fixed grid place-items-center hidden h-screen bg-black bg-opacity-60 z-50 p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <!-- Modal content -->\n                            <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                                <div class=\"px-6 py-6 lg:px-8\">\n                                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Mute User</h3>\n                                    <form class=\"space-y-6\" method=\"POST\">\n                                        <div>\n                                            <div class=\"relative mb-4\">\n                                                <select id=\"muted\" name=\"muted\"\n                                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\">\n                                                    <option value=\"1\">Seconds</option>\n                                                    <option value=\"60\">Minutes</option>\n                                                    <option value=\"3600\">Hours</option>\n                                                    <option value=\"86400\">Days</option>\n                                                    <option value=\"604800\">Weeks</option>\n                                                    <option value=\"2629743\">Months</option>\n                                                    <option value=\"31556926\">Years</option>\n                                                    <option value=\"315569260\">Lifetime</option>\n                                                </select>\n                                                <label for=\"muted\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Mute\n                                                    Unit</label>\n\n                                                <input type=\"hidden\" class=\"muteuser\" name=\"user\">\n\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" inputmode=\"numeric\" id=\"time\" name=\"time\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\">\n                                                <label for=\"time\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Mute\n                                                    Duration:</label>\n                                            </div>\n                                        </div>\n\n                                        <button name=\"muteuser\"\n                                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Mute\n                                            User</button>\n\n                                        <button type=\"button\" onclick=\"closeModal('mute-user-modal')\"\n                                            class=\"w-full text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Mute User Modal -->\n\n                    <!-- START TABLE -->\n                    <div class=\"relative overflow-x-auto shadow-md sm:rounded-lg pt-5\">\n                        <table id=\"kt_datatable_chats\" class=\"w-full text-sm text-left text-white\">\n                            <thead>\n                                <tr class=\"fw-bolder fs-6 text-blue-700 px-7\">\n                                    <th class=\"px-6 py-3\">Chat Name</th>\n                                    <th class=\"px-6 py-3\">Message Delay</th>\n                                    <th class=\"px-6 py-3\">Actions</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n\n\n\n                                <?php\n            if ($_SESSION['app']) {\n                $query = misc\\mysql\\query(\"SELECT * FROM `chats` WHERE `app` = ?\", [$_SESSION['app']]);\n                $rows = array();\n                while ($r = mysqli_fetch_assoc($query->result)) {\n                    $rows[] = $r;\n                }\n                foreach ($rows as $row) {\n                    $chan = $row['name'];\n            ?>\n\n\n\n                                <tr>\n\n\n\n                                    <td><?= $chan; ?></td>\n\n\n\n                                    <td><?= dashboard\\primary\\time2str(time() - $row[\"delay\"]); ?></td>\n\n                                    <form method=\"POST\">\n                                        <td>\n                                            <div x-data=\"{ open: false }\" class=\"z-0\">\n                                                <button x-on:click=\"open = true\"\n                                                    class=\"flex items-center border border-gray-700 rounded-lg focus:opacity-60 text-white focus:text-white font-semibold rounded focus:outline-none focus:shadow-inner py-2 px-4\"\n                                                    type=\"button\">\n                                                    <span class=\"mr-1\">Actions</span>\n                                                    <svg class=\"fill-current h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\"\n                                                        viewBox=\"0 0 20 20\" style=\"margin-top:3px\">\n                                                        <path\n                                                            d=\"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z\" />\n                                                    </svg>\n                                                </button>\n                                                <ul x-show=\"open\" x-on:click.away=\"open = false\"\n                                                    class=\"bg-[#09090d] text-white rounded shadow-lg absolute py-2 mt-1\"\n                                                    style=\"min-width:15rem\">\n                                                    <li>\n                                                        <button name=\"deletechan\"\n                                                            class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-red-700\"\n                                                            value=\"<?= $chan; ?>\">\n                                                            Delete Channel\n                                                        </button>\n                                                    </li>\n                                                    <li>\n                                                        <button name=\"editchan\"\n                                                            class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-blue-700\"\n                                                            value=\"<?= $chan; ?>\">\n                                                            Edit Channel\n                                                        </button>\n                                                    </li>\n                                                </ul>\n                                            </div>\n                                        </td>\n                                </tr>\n                                </form>\n\n                                <?php\n                }\n            }\n            ?>\n\n                            </tbody>\n                        </table>\n                    </div>\n                    <!-- END CHAT TABLE -->\n                    <p class=\"text-xs text-red-600\">Dropdown actions in <b>RED</b> do not show a confirmation!<a class=\"text-blue-700\"> Dropdown actions in <b>BLUE</b> will show a confirmation!</a></p>\n\n                    <br>\n\n                    <!-- START MESSAGES TABLE -->\n                    <div class=\"relative overflow-x-auto shadow-md sm:rounded-lg pt-5\">\n                        <table id=\"kt_datatable_messages\" class=\"w-full text-sm text-left text-white\">\n                            <thead>\n                                <tr class=\"fw-bolder fs-6 text-blue-700 px-7\">\n                                    <th class=\"px-6 py-3\">Author</th>\n                                    <th class=\"px-6 py-3\">Message</th>\n                                    <th class=\"px-6 py-3\">Time Sent</th>\n                                    <th class=\"px-6 py-3\">Channel</th>\n                                    <th class=\"px-6 py-3\">Actions</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n\n                                <?php\n                                if ($_SESSION['app']) {\n                                    $query = misc\\mysql\\query(\"SELECT * FROM `chatmsgs` WHERE `app` = ?\", [$_SESSION['app']]);\n                                    $rows = array();\n                                    while ($r = mysqli_fetch_assoc($query->result)) {\n                                        $rows[] = $r;\n                                    }\n                                    foreach ($rows as $row) {\n                                        $user = $row['author'];\n                                ?>\n\n                                <tr>\n                                    <td><?= $user; ?></td>\n                                    <td><?= $row[\"message\"]; ?></td>\n                                    <td>\n                                        <script>\n                                        document.write(convertTimestamp(<?= $row[\"timestamp\"]; ?>));\n                                        </script>\n                                    </td>\n                                    <td><?= $row[\"channel\"]; ?></td>\n\n                                    <form method=\"POST\">\n                                        <td>\n\n                                            <div x-data=\"{ open: false }\" class=\"z-0\">\n                                                <button x-on:click=\"open = true\"\n                                                    class=\"flex items-center border border-gray-700 rounded-lg focus:opacity-60 text-white focus:text-white font-semibold rounded focus:outline-none focus:shadow-inner py-2 px-4\"\n                                                    type=\"button\">\n                                                    <span class=\"mr-1\">Actions</span>\n                                                    <svg class=\"fill-current h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\"\n                                                        viewBox=\"0 0 20 20\" style=\"margin-top:3px\">\n                                                        <path\n                                                            d=\"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z\" />\n                                                    </svg>\n                                                </button>\n                                                <ul x-show=\"open\" x-on:click.away=\"open = false\"\n                                                    class=\"bg-[#09090d] text-white rounded shadow-lg absolute py-2 mt-1\"\n                                                    style=\"min-width:15rem\">\n                                                    <li>\n                                                        <button name=\"deletemsg\"\n                                                            class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-red-700\"\n                                                            value=\"<?= $row[\"id\"]; ?>\">\n                                                            Delete Message\n                                                        </button>\n                                                    </li>\n                                                    <li>\n                                                        <button type=\"button\"\n                                                            class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-blue-700\"\n                                                            onclick=\"muteuser('<?= $user; ?>')\">\n                                                            Mute User\n                                                        </button>\n                                                    </li>\n                                                </ul>\n                                            </div>\n                                        </td>\n                                </tr>\n                                </form>\n\n                                <?php\n    }\n}\n?>\n\n                            </tbody>\n                        </table>\n                    </div>\n                    <!-- END MESSAGES TABLE -->\n                    <p class=\"text-xs text-red-600\">Dropdown actions in <b>RED</b> do not show a confirmation!<a class=\"text-blue-700\"> Dropdown actions in <b>BLUE</b> will show a confirmation!</a></p>\n\n                    <script>\n                    function muteuser(key) {\n\n                        var muteuser = $('.muteuser');\n\n                        muteuser.attr('value', key);\n\n                        openModal('mute-user-modal');\n                    }\n                    </script>\n","size_bytes":42300},"app/pages/files.php":{"content":"<?php\nif ($_SESSION['role'] == \"Reseller\") {\n    header(\"location: ./?page=reseller-licenses\");\n    die();\n}\nif ($role == \"Manager\" && !($permissions & 64)) {\n    misc\\auditLog\\send(\"Attempted (and failed) to view files.\");\n    dashboard\\primary\\error(\"You weren't granted permission to view this page.\");\n    die();\n}\nif (!isset($_SESSION['app'])) {\n    dashboard\\primary\\error(\"Application not selected\");\n    die(\"Application not selected.\");\n}\n\nif (isset($_POST['addfile'])) {\n    $authed = misc\\etc\\sanitize($_POST['authed']) == NULL ? 0 : 1;\n    $resp = misc\\upload\\add($_POST['url'], $authed);\n    match($resp){\n        'invalid' => dashboard\\primary\\error(\"URL not valid!\"),\n        'no_local' => dashboard\\primary\\error(\"URL can't be a local path! Must be a remote URL accessible by the open internet!\"),\n        'failure' => dashboard\\primary\\error(\"Failed to add file!\"),\n        'success' => dashboard\\primary\\success(\"Successfully added file!\"),\n        'tester_file_exceed' => dashboard\\primary\\error(\"Tester plan may only upload files up to 10MB. Upgrade for larger file size!\"),\n        'dev_file_exceed' => dashboard\\primary\\error(\"File size limit is 50MB. Please upgrade for larger file size!\"),\n        'seller_file_exceed' => dashboard\\primary\\error(\"File size limit is 75MB. This is the MAX\"),\n        'name_too_large' => dashboard\\primary\\error(\"File name is too large. Rename it to something shorter\"),\n        'invalid_extension' => dashboard\\primary\\error(\"Invalid extension for given link!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n\nif (isset($_POST['delfiles'])) {\n    $resp = misc\\upload\\deleteAll();\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to delete all files!\"),\n        'success' => dashboard\\primary\\success(\"Successfully deleted all files!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n\nif (isset($_POST['deletefile'])) {\n    $resp = misc\\upload\\deleteSingular($_POST['deletefile']);\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to delete all files!\"),\n        'success' => dashboard\\primary\\success(\"Successfully deleted all files!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n\nif (isset($_POST['editfile'])) {\n    $file = misc\\etc\\sanitize($_POST['editfile']);\n\n    echo  '\n    <div id=\"edit-file-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n        class=\"fixed grid place-items-center h-screen bg-black bg-opacity-60 z-50 p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n        <div class=\"relative w-full max-w-md max-h-full\">\n            <!-- Modal content -->\n            <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                <div class=\"px-6 py-6 lg:px-8\">\n                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Edit File</h3>\n                    <form class=\"space-y-6\" method=\"POST\">\n                        <div>\n\n                        <div class=\"relative mb-4\">\n                        <input type=\"text\" id=\"url\" name=\"url\"\n                            class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                            placeholder=\" \" autocomplete=\"on\" required>\n                        <label for=\"url\"\n                            class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">File URL:</label>\n                    </div>\n\n                        </div>\n                        <div class=\"flex items-center mb-4\">\n                        <input id=\"authed\" name=\"authed\" type=\"checkbox\"\n                            class=\"w-4 h-4 text-blue-600 bg-[#0f0f17] border-gray-300 rounded focus:ring-blue-500 focus:ring-2\"\n                            checked>\n                        <label for=\"authed\"\n                            class=\"ml-2 text-sm font-medium text-white-900\">Authenticated</label>\n                    </div>\n\n                        <button name=\"savefile\"\n                            value=\"' . $file . '\"\n                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Save\n                            Changes</button>\n                        <button\n                            class=\"w-full text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\" onClick=\"window.location.href=window.location.href\">Cancel\n                            </button>\n                    </form>\n                </div>\n            </div>\n        </div>\n    </div>\n    <!-- End Edit Files Modal -->';\n}\n\nif (isset($_POST['savefile'])) {\n    $fileid = misc\\etc\\sanitize($_POST['savefile']);\n    $url = misc\\etc\\sanitize($_POST['url']);\n\n    if (!filter_var($url, FILTER_VALIDATE_URL)) {\n        dashboard\\primary\\error(\"Invalid Url!\");\n        echo \"<meta http-equiv='Refresh' Content='2;'>\";\n        return;\n    }\n\n    if (strpos($url, \"cdn.discordapp.com\") !== false) {\n        $urlParts = explode(\"?\", $url);\n        $url = $urlParts[0];\n    }\n\n    $requiredExtension = array(\n        \".zip\", \".pdf\", \".tiff\", \".png\", \".exe\", \".psd\", \".mp3\", \".mp4\",\n        \".jar\", \".xls\", \".csv\", \".bmp\", \".txt\", \".xml\", \".rar\", \".jpg\", \n        \".doc\", \".eps\", \".avi\", \".mov\", \".apk\", \".ios\", \".sys\", \".dll\", \".js\",\n        \".cpp\", \".c\", \".java\", \".py\", \".php\", \".html\", \".css\", \".xml\", \".json\",\n        \".sql\", \".rb\", \".swift\", \".go\", \".pl\", \".bat\", \".cs\", \".gif\", \".txt\", \".efi\"\n      );\n    \n    $linkExtension = strtolower(substr($url, strrpos($url, \".\")));\n    \n    if (!in_array($linkExtension, $requiredExtension)){\n        dashboard\\primary\\error(\"Invalid extension for given link!\");\n        return;\n    }\n\n    if(str_contains($url, \"localhost\") || str_contains($url, \"127.0.0.1\") || str_contains($url, \"file:/\")) {\n        dashboard\\primary\\error(\"URL can't be a local path! Must be a remote URL accessible by the open internet\");\n        echo \"<meta http-equiv='Refresh' Content='2;'>\";\n        return;\n    }\n\n    $file = file_get_contents($url);\n\n    $filesize = strlen($file);\n\n    if ($filesize > 10000000 && $role == \"tester\") {\n        dashboard\\primary\\error(\"Users with tester plan may only upload files up to 10MB. Paid plans may upload up to 75MB.\");\n        echo \"<meta http-equiv='Refresh' Content='2;'>\";\n        return;\n    } else if ($filesize > 50000000 && ($role == \"developer\" || $role == \"Manager\")) {\n        dashboard\\primary\\error(\"File size limit is 50 MB. Upgrade your account to gain a total of 75mb.\");\n        echo \"<meta http-equiv='Refresh' Content='2;'>\";\n        return;\n    } else if ($filesize > 75000000) {\n        dashboard\\primary\\error(\"File size limit is 75 MB.\");\n        echo \"<meta http-equiv='Refresh' Content='2;'>\";\n        return;\n    }\n\n    $fn = basename($url);\n    $fs = misc\\etc\\formatBytes($filesize);\n\n    if(strlen($fn) > 49) {\n        dashboard\\primary\\error(\"File name is too large! Rename it to have a shorter name.\");\n        echo \"<meta http-equiv='Refresh' Content='2;'>\";\n        return;\n    }\n\n    $authed = misc\\etc\\sanitize($_POST['authed']) == NULL ? 0 : 1;\n\n    $query = misc\\mysql\\query(\"UPDATE `files` SET `name` = ?,`size` = ?,`url` = ?, `uploaddate` = ?, `authed` = ? WHERE `app` = ? AND `id` = ?\", [$fn, $fs, $url, time(), $authed, $_SESSION['app'], $fileid]);\n\n    if ($query->affected_rows != 0) {\n        misc\\cache\\purge('KeyAuthFile:' . ($secret ?? $_SESSION['app']) . ':' . $fileid);\n        dashboard\\primary\\success(\"Successfully Updated File!\");\n    } else {\n        dashboard\\primary\\error(\"Failed to update file\");\n    }\n}\n?>\n\n<div class=\"p-4 bg-[#09090d] block sm:flex items-center justify-between lg:mt-1.5\">\n    <div class=\"mb-1 w-full bg-[#0f0f17] rounded-xl\">\n        <div class=\"mb-4 p-4\">\n            <?php require '../app/layout/breadcrumb.php'; ?>\n            <h1 class=\"text-xl font-semibold text-white-900 sm:text-2xl \">Files</h1>\n            <p class=\"text-xs text-gray-500\">Let your users download files you upload here. <a\n                    href=\"https://keyauth.readme.io/reference/files-1\" target=\"_blank\"\n                    class=\"text-blue-600  hover:underline\">Learn More</a>.</p>\n            <br>\n            <div class=\"p-4 flex flex-col\">\n                <div class=\"overflow-x-auto\">\n                    <!-- Alert Box -->\n                    <div id=\"alert\" class=\"flex items-center p-4 mb-4 text-yellow-800 rounded-lg bg-[#09090d]\"\n                        role=\"alert\">\n                        <svg class=\"flex-shrink-0 w-4 h-4\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\"\n                            fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                            <path\n                                d=\"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z\" />\n                        </svg>\n                        <span class=\"sr-only\">Info</span>\n                        <div class=\"ml-3 text-sm font-medium text-yellow-500\">\n                            Files not working? Make sure you're using a direct download link. View our <a\n                                href=\"https://keyauth.readme.io/reference/files-1\"\n                                class=\"font-semibold underline hover:no-underline\">Documentation</a> to learn how to\n                            learn more.\n                        </div>\n                    </div>\n                    <!-- End Alert Box -->\n\n                    <!-- Files Functions -->\n                    <button\n                        class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"create-file-modal\" data-modal-target=\"create-file-modal\">\n                        <i class=\"lni lni-upload mr-2 mt-1\"></i>Upload File\n                    </button>\n                    <!-- End Files Functions -->\n\n                    <br>\n\n                    <!-- Delete Files Functions -->\n                    <button\n                        class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"delete-all-files-modal\" data-modal-target=\"delete-all-files-modal\">\n                        <i class=\"lni lni-trash-can mr-2 mt-1\"></i>Delete All Files\n                    </button>\n                    <!-- End Delete Files Functions -->\n\n                    <!-- Create New File Modal -->\n                    <div id=\"create-file-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <!-- Modal content -->\n                            <div class=\"relative bg-[#0f0f17] rounded-lg border border-blue-700 shadow\">\n                                <div class=\"px-6 py-6 lg:px-8\">\n                                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Upload A New File</h3>\n                                    <hr class=\"h-px mb-4 mt-4 bg-gray-700 border-0\">\n                                    <form class=\"space-y-6\" method=\"POST\">\n                                        <div>\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" id=\"url\" name=\"url\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\" required>\n                                                <label for=\"url\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">File\n                                                    Direct Download Link</label>\n                                            </div>\n                                            <div class=\"flex items-center\">\n                                                <input checked id=\"authed\" type=\"checkbox\" name=\"authed\"\n                                                    class=\"w-4 h-4 text-blue-600 bg-[#0f0f17] border-gray-300 rounded focus:ring-blue-500  focus:ring-2  \">\n                                                <label for=\"authed\"\n                                                    class=\"ml-2 text-sm font-medium text-white-900 \">Authenticated</label>\n                                            </div>\n                                        </div>\n                                        <button type=\"submit\" name=\"addfile\"\n                                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Add\n                                            File</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Create A File Modal -->\n\n                    <!-- Delete All Files Modal -->\n                    <div id=\"delete-all-files-modal\" tabindex=\"-1\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                        role=\"alert\">\n                                        <span class=\"sr-only\">Info</span>\n                                        <div>\n                                            <span class=\"font-medium\">Notice!</span> You're about to delete all of your\n                                            file!. <b>This can\n                                                NOT be undone</b>\n                                        </div>\n                                    </div>\n                                    <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure\n                                        you want\n                                        to\n                                        delete all of your files?</h3>\n                                    <form method=\"POST\">\n                                        <button name=\"delfiles\"\n                                            class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                            Yes, I'm sure\n                                        </button>\n                                        <button data-modal-hide=\"delete-all-files-modal\" type=\"button\"\n                                            class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                            cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Delete All Files Modal -->\n\n                    <!-- START TABLE -->\n                    <div class=\"relative overflow-x-auto shadow-md sm:rounded-lg pt-5\">\n                        <table id=\"kt_datatable_files\" class=\"w-full text-sm text-left text-white\">\n                            <thead>\n                                <tr class=\"fw-bolder fs-6 text-blue-700 px-7\">\n                                    <th class=\"px-6 py-3\">Filename</th>\n                                    <th class=\"px-6 py-3\">ID</th>\n                                    <th class=\"px-6 py-3\">Size</th>\n                                    <th class=\"px-6 py-3\">Upload Date</th>\n                                    <th class=\"px-6 py-3\">Authenticated</th>\n                                    <th class=\"px-6 py-3\">Actions</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                <?php\n                                if ($_SESSION['app']){\n                                    $query = misc\\mysql\\query(\"SELECT * FROM `files` WHERE `app` = ?\", [$_SESSION['app']]);\n                                    if ($query->num_rows > 0) {\n                                        while ($row = mysqli_fetch_array($query->result)){\n                                            echo \"<tr>\";\n\n                                            echo \"  <td>\" . $row[\"name\"] . \"</td>\";\n                    \n                                            echo \"  <td>\" . $row[\"id\"] . \"</td>\";\n                    \n                                            echo \"  <td>\" . $row[\"size\"] . \"</td>\";\n                    \n                                            echo \"  <td><script>document.write(convertTimestamp(\" . $row[\"uploaddate\"] . \"));</script></td>\";\n                    \n                                            echo \"  <td>\" . (($row[\"authed\"] ? 1 : 0) ? 'True' : 'False') . \"</td>\";\n\n                                            echo '<form method=\"POST\">\n                                            <td>\n\n                                            <div x-data=\"{ open: false }\" class=\"z-0\">\n                                            <button x-on:click=\"open = true\" class=\"flex items-center border border-gray-700 rounded-lg focus:opacity-60 text-white focus:text-white font-semibold rounded focus:outline-none focus:shadow-inner py-2 px-4\" type=\"button\">\n                                                    <span class=\"mr-1\">Actions</span>\n                                                    <svg class=\"fill-current h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\"  style=\"margin-top:3px\">\n                                                    <path d=\"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z\"/>\n                                                    </svg>\n                                            </button>\n                                            <ul x-show=\"open\" x-on:click.away=\"open = false\" class=\"bg-[#09090d] text-white rounded shadow-lg absolute py-2 mt-1\" style=\"min-width:15rem\">\n                                                    <li>\n                                                            <button name=\"deletefile\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-red-700\"\n                                                            value=\"' . $row[\"id\"] . '\">\n                                                            Delete File\n                                                            </button>\n                                                    </li>\n                                                    <li>\n                                                            <a href=\"' . $row['url'] . '\" target=\"_blank\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-red-700\"\n                                                            value=\"' . urlencode($row[\"username\"]) . '\">\n                                                            Download File\n                                                            </a>\n                                                    </li>   \n                                                    <li>\n                                                            <button name=\"editfile\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-blue-700\"\n                                                            value=\"' . $row[\"id\"] . '\">\n                                                            Edit File\n                                                            </button>\n                                                    </li>\n                                                    </ul>\n                                                    </div>\n                                            </td>\n                                            </tr>\n                                            </form>\n                                            ';\n                                        }\n                                    }\n                                }\n                                ?>\n                            </tbody>\n                        </table>\n                    </div>\n                    <p class=\"text-xs text-red-600\">Dropdown actions in <b>RED</b> do not show a confirmation!<a\n                            class=\"text-blue-700\"> Dropdown actions in <b>BLUE</b> will show a confirmation!</a></p>\n\n                    <!-- Include the jQuery library -->\n                    \n","size_bytes":22290},"app/pages/licenses.php":{"content":"<?php\nif ($_SESSION['role'] == \"Reseller\") {\n    header(\"location: ./?page=reseller-licenses\");\n    die();\n}\n\nif ($role == \"Manager\" && !($permissions & 1)) {\n    misc\\auditLog\\send(\"Attempted (and failed) to view licenses.\");\n    dashboard\\primary\\error(\"You weren't granted permission to view this page!\");\n    die();\n}\nif (!isset($_SESSION['app'])) {\n    dashboard\\primary\\error(\"You must select an app first.\");\n    header(\"location: ./?page=manage-apps\");\n    die();\n}\n\nif (isset($_POST['unbankey'])) {\n    $resp = misc\\license\\unban($_POST['unbankey']);\n    match ($resp) {\n        'failure' => dashboard\\primary\\error(\"Failed to unban license!\"),\n        'success' => dashboard\\primary\\success(\"Successfully unbanned license!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n\nif (isset($_POST['genkeys'])) {\n    if (empty(trim($_POST['mask']))) {\n        dashboard\\primary\\error(\"You must specify a key mask.\");\n    } else {\n        $key = misc\\license\\createLicense($_POST['amount'], $_POST['mask'], $_POST['duration'], $_POST['level'], $_POST['note'], $_POST['expiry']);\n        switch ($key) {\n            case 'max_keys':\n                dashboard\\primary\\error(\"You can only generate 100 licenses at a time\");\n                break;\n            case 'tester_limit':\n                dashboard\\primary\\error(\"Tester plan only allows for 10 licenses, please upgrade!\");\n                break;\n            case 'dupe_custom_key':\n                dashboard\\primary\\error(\"Can't do custom key with amount greater than one\");\n                break;\n            default:\n                $mask = misc\\etc\\sanitize($_POST['mask']);\n                $amount = intval($_POST['amount']);\n                $level = misc\\etc\\sanitize($_POST['level']);\n                $note = misc\\etc\\sanitize($_POST['note']);\n                $duration = misc\\etc\\sanitize($_POST['duration']);\n                $expiry = misc\\etc\\sanitize($_POST['expiry']);\n\n                misc\\mysql\\query(\"UPDATE `apps` SET `format` = ?,`amount` = ?,`lvl` = ?,`note` = ?,`duration` = ?,`unit` = ? WHERE `secret` = ?\", [$mask, $amount, $level, $note, $duration, $expiry, $_SESSION['app']]);\n                if ($_POST['amount'] > 1) {\n                    $_SESSION['keys_array'] = $key;\n                } else {\n                    echo \"<script>navigator.clipboard.writeText('\" . array_values($key)[0] . \"');</script>\";\n                    dashboard\\primary\\success(\"License Created And Copied To Clipboard!\");\n                }\n                break;\n        }\n    }\n}\n\nif (isset($_POST['editkey'])) {\n    $key = misc\\etc\\sanitize($_POST['editkey']);\n    $query = misc\\mysql\\query(\"SELECT * FROM `keys` WHERE `key` = ? AND `app` = ?\",[$key, $_SESSION['app']]);\n    if ($query->num_rows < 1) {\n        dashboard\\primary\\error(\"Key not Found!\");\n        echo \"<meta http-equiv='Refresh' Content='2'>\";\n        return;\n    }\n    $row = mysqli_fetch_array($query->result);\n?>\n<!-- Edit User Modal -->\n<div id=\"edit-key-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n    class=\"fixed grid place-items-center h-screen bg-black bg-opacity-60 z-50 p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n    <div class=\"relative w-full max-w-md max-h-full\">\n        <!-- Modal content -->\n        <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n            <div class=\"px-6 py-6 lg:px-8\">\n                <h3 class=\"mb-4 text-xl font-medium text-white-900\">Edit License</h3>\n                <form class=\"space-y-6\" method=\"POST\">\n                    <div>\n\n                        <div class=\"relative mb-4\">\n                            <input type=\"text\" id=\"level\" name=\"level\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                placeholder=\" \" value=\"<?= $row['level']; ?>\" autocomplete=\"on\">\n                            <label for=\"level\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Level:</label>\n                        </div>\n\n                        <div class=\"relative mb-4\">\n                            <select id=\"expiry\" name=\"expiry\"\n                                class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\">\n                                <option value=\"1\">Seconds</option>\n                                <option value=\"60\">Minutes</option>\n                                <option value=\"3600\">Hours</option>\n                                <option value=\"86400\">Days</option>\n                                <option value=\"604800\">Weeks</option>\n                                <option value=\"2629743\">Months</option>\n                                <option value=\"31556926\">Years</option>\n                                <option value=\"315569260\">Lifetime</option>\n                            </select>\n                        </div>\n\n                        <div class=\"relative mb-4\">\n                            <input type=\"text\" id=\"duration\" name=\"duration\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                placeholder=\" \">\n                            <label for=\"duration\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Duration:</label>\n                        </div>\n\n                        <div class=\"relative mb-4\">\n                            <input type=\"text\" id=\"editNote\" name=\"editNote\"\n                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                placeholder=\" \">\n                            <label for=\"editNote\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">New\n                                Note:</label>\n                        </div>\n                    </div>\n                    <div style=\"display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;\">\n\n                        <button name=\"savekey\"\n                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\"\n                            value=\"<?= $key; ?>\">Save Changes</button>\n\n                        <button\n                            class=\"w-full text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\"\n                            onClick=\"window.location.href=window.location.href\">Cancel</button>\n                    </div>\n                </form>\n            </div>\n        </div>\n    </div>\n</div>\n<!-- End Edit User Modal -->\n<?php\n}\n?>\n\n<div class=\"p-4 bg-[#09090d] block sm:flex items-center justify-between lg:mt-1.5\">\n    <div class=\"mb-1 w-full bg-[#0f0f17] rounded-xl\">\n        <div class=\"mb-4 p-4\">\n            <?php require '../app/layout/breadcrumb.php'; ?>\n            <h1 lang class=\"text-xl font-semibold text-white-900 sm:text-2xl\">Licenses</h1>\n            <p class=\"text-xs text-gray-500\">Licenses allow your users to register on your application.</p>\n            <br>\n            <div class=\"p-4 flex flex-col\">\n                <div class=\"overflow-x-auto\">\n                    <form method=\"POST\">\n                        <!-- Key Functions -->\n                        <button type=\"button\"\n                            class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                            data-modal-toggle=\"create-key-modal\" data-modal-target=\"create-key-modal\">\n                            <i class=\"lni lni-circle-plus mr-2 mt-1\"></i> Create Keys\n                        </button>\n\n                        <button type=\"button\"\n                            class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                            data-modal-toggle=\"add-time-modal\" data-modal-target=\"add-time-modal\">\n                            <i class=\"lni lni-timer mr-2 mt-1\"></i>Add Time To Unused Keys\n                        </button>\n\n                        <button type=\"button\"\n                            class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                            data-modal-toggle=\"import-key-modal\" data-modal-target=\"import-key-modal\">\n                            <i class=\"lni lni-upload mr-2 mt-1\"></i>Import Keys\n                        </button>\n\n                        <button name=\"dlkeys\"\n                            class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">\n                            <i class=\"lni lni-download mr-2 mt-1\"></i>Export Keys\n                        </button>\n                    </form>\n                    <!-- End Key Functions -->\n\n                    <!-- Delete Key Functions -->\n                    <button\n                        class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"delete-all-keys-modal\" data-modal-target=\"delete-all-keys-modal\">\n                        <i class=\"lni lni-trash-can mr-2 mt-1\"></i>Delete All Keys\n                    </button>\n                    <button\n                        class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"delete-all-used-keys-modal\" data-modal-target=\"delete-all-used-keys-modal\">\n                        <i class=\"lni lni-trash-can mr-2 mt-1\"></i>Delete All Used Keys\n                    </button>\n                    <button\n                        class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"delete-all-unused-keys-modal\"\n                        data-modal-target=\"delete-all-unused-keys-modal\">\n                        <i class=\"lni lni-trash-can mr-2 mt-1\"></i></i>Delete All Unused Keys\n                    </button>\n                    <!-- End Delete Key Functions -->\n\n                    <?php\n    if (isset($_SESSION['keys_array'])) {\n        $list = $_SESSION['keys_array'];\n        $keys = NULL;\n        for ($i = 0; $i < count($list); $i++) {\n            $keys .= \"\" . $list[$i] . \"<br>\";\n        }\n        echo \"<div class=\\\"card\\\"> <div class=\\\"card-body\\\" id=\\\"multi-keys\\\"> $keys </div> </div> <br>\";\n        echo \"<button onclick=\\\"copyToClipboard()\\\" class=\\\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\\\">Copy new licenses</button>\";\n        unset($_SESSION['keys_array']);\n    }\n    ?>\n\n                    <!-- Create Key Modal -->\n                    <div id=\"create-key-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <?php\n                            $query = misc\\mysql\\query(\"SELECT `format`, `amount`, `lvl`, `note`, `duration`, `unit` FROM `apps` WHERE `secret` = ?\", [$_SESSION['app']]);\n                            $row = mysqli_fetch_array($query->result);\n\n                            $format = $row['format'];\n                            $amt = $row['amount'];\n                            $lvl = $row['lvl'];\n                            $note = $row['note'];\n                            $dur = $row['duration'];\n                            $unit = $row['unit'];\n                            ?>\n                            <!-- Modal content -->\n                            <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                                <div class=\"px-6 py-6 lg:px-8\">\n                                    <h3 class=\"text-xl font-medium text-white-900\">Create A New Key</h3>\n                                    <hr class=\"h-px mb-4 mt-4 bg-gray-700 border-0\">\n                                    <form class=\"space-y-6\" method=\"POST\">\n                                        <div>\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" inputmode=\"numeric\" min=\"1\" max=\"100\" id=\"amount\"\n                                                    name=\"amount\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\"\n                                                    value=\"<?php if (!is_null($amt)) {                                                                                                                                                                                                                                                                                echo $amt;                                                                                                                                                                                                                                                                         } ?>\"\n                                                    required data-popover-target=\"amount-popover\">\n                                                <label for=\"amount\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">License\n                                                    Amount</label>\n\n                                                <?php dashboard\\primary\\popover(\"amount-popover\", \"License Amount\", \"The amount of licenses you would like to create.\"); ?>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" maxlength=\"49\" id=\"mask\" name=\"mask\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\"*****-*****-*****-*****\" autocomplete=\"on\"\n                                                    value=\"<?php if (!is_null($format)) { echo $format; } else { echo \"*****-*****-*****-*****-*****\"; } ?>\"\n                                                    required data-popover-target=\"mask-popover\">\n                                                <label for=\"mask\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">License\n                                                    Mask</label>\n\n                                                <?php dashboard\\primary\\popover(\"mask-popover\", \"License Mask\", \"The format of the license. You can use * to generate random characters.\"); ?>\n                                            </div>\n\n                                            <div class=\"flex items-center mb-4\">\n                                                <input id=\"lowercaseLetters\" name=\"lowercaseLetters\" type=\"checkbox\"\n                                                    class=\"w-4 h-4 text-blue-600 bg-[#0f0f17] border-gray-300 rounded focus:ring-blue-500 focus:ring-2\"\n                                                    checked data-popover-target=\"lowercase-popover\">\n                                                <label for=\"lowercaseLetters\"\n                                                    class=\"ml-2 text-sm font-medium text-white-900\">Include\n                                                    Lowercase Letters</label>\n\n                                                <?php dashboard\\primary\\popover(\"lowercase-popover\", \"Lowercase Letters\", \"Include lowercase letters in your license.\"); ?>\n                                            </div>\n                                            <div class=\"flex items-center\">\n                                                <input checked id=\"capitalLetters\" name=\"capitalLetters\" type=\"checkbox\"\n                                                    class=\"w-4 h-4 text-blue-600 bg-[#0f0f17] border-gray-300 rounded focus:ring-blue-500 focus:ring-2\"\n                                                    checked data-popover-target=\"capital-popover\">\n                                                <label for=\"capitalLetters\"\n                                                    class=\"ml-2 text-sm font-medium text-white-900\">Include\n                                                    Uppercase Letters</label>\n\n                                                <?php dashboard\\primary\\popover(\"capital-popover\", \"Capital Letters\", \"Include capital letters in your license.\"); ?>\n                                            </div>\n\n                                            <div class=\"relative mb-4 pt-3\">\n                                                <select id=\"level\" name=\"level\"\n                                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\"\n                                                    data-popover-target=\"level-popover\">\n                                                    <?php\n                                                    $query = misc\\mysql\\query(\"SELECT DISTINCT `level` FROM `subscriptions` WHERE `app` = ? ORDER BY `level` ASC\", [$_SESSION['app']]);\n                                                    if ($query->num_rows > 0) {\n                                                        while ($row = mysqli_fetch_array($query->result)) {\n                                                            $queryName = misc\\mysql\\query(\"SELECT `name` FROM `subscriptions` WHERE `level` = ? AND `app` = ?\", [$row[\"level\"], $_SESSION['app']]);\n                                                            $name = \" (\";\n                                                            $count = 0;\n                                                            while ($rowSubs = mysqli_fetch_array($queryName->result)) {\n                                                                $count++;\n                                                                if ($count > 1) {\n                                                                    $name .= \", \" . $rowSubs[\"name\"];\n                                                                } else {\n                                                                    $name .= $rowSubs[\"name\"];\n                                                                }\n                                                            }\n                                                            $name .= \")\";\n                                                    ?>\n\n                                                    <option <?= $lvl == $row[\"level\"] ? 'selected=\"selected\"' : ''; ?>\n                                                        value=\"<?= $row[\"level\"]; ?>\">\n                                                        <?= $row[\"level\"] . $name; ?></option>\n                                                    <?php\n                                                        }\n                                                    }\n                                                    ?>\n                                                </select>\n\n                                                <?php dashboard\\primary\\popover(\"level-popover\", \"License Level\", \"The level/subscription you would like to assign to your license(s).\"); ?>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" maxlength=\"69\" id=\"note\" name=\"note\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\"\n                                                    value=\"<?php if (!is_null($note)) {                                                                                                                                                                                                                                               } ?>\"\n                                                    data-popover-target=\"note-popover\">\n                                                <label for=\"note\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">License\n                                                    Note</label>\n\n                                                <?php dashboard\\primary\\popover(\"note-popover\", \"License Note\", \"A unique message for a license.\"); ?>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <select id=\"expiry\" name=\"expiry\"\n                                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\"\n                                                    data-popover-target=\"expiry-popover\">\n                                                    <option value=\"1\" <?= $unit == 1 ? 'selected=\"selected\"' : ''; ?>>\n                                                        Seconds\n                                                    </option>\n                                                    <option value=\"60\" <?= $unit == 60 ? 'selected=\"selected\"' : ''; ?>>\n                                                        Minutes\n                                                    </option>\n                                                    <option value=\"3600\"\n                                                        <?= $unit == 3600 ? 'selected=\"selected\"' : ''; ?>>\n                                                        Hours\n                                                    </option>\n                                                    <option value=\"86400\"\n                                                        <?= $unit == 86400 ? 'selected=\"selected\"' : ''; ?>>\n                                                        Days\n                                                    </option>\n                                                    <option value=\"604800\"\n                                                        <?= $unit == 604800 ? 'selected=\"selected\"' : ''; ?>>\n                                                        Weeks\n                                                    </option>\n                                                    <option value=\"2629743\"\n                                                        <?= $unit == 2629743 ? 'selected=\"selected\"' : ''; ?>>\n                                                        Months\n                                                    </option>\n                                                    <option value=\"31556926\"\n                                                        <?= $unit == 31556926 ? 'selected=\"selected\"' : ''; ?>>\n                                                        Years\n                                                    </option>\n                                                    <option value=\"315569260\"\n                                                        <?= $unit == 315569260 ? 'selected=\"selected\"' : ''; ?>>\n                                                        Lifetime\n                                                    </option>\n                                                </select>\n                                                <label for=\"expiry\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">License\n                                                    Expiry Unit</label>\n\n                                                <?php dashboard\\primary\\popover(\"expiry-popover\", \"License Expiry (unit)\", \"The unit the license will expire in.\"); ?>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" inputmode=\"numeric\" maxlength=\"4\" id=\"duration\"\n                                                    name=\"duration\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\" pattern=\"\\d*\"\n                                                    value=\"<?php if (!is_null($dur)) {                                                                                                                                                                                                                                                                                 } ?>\"\n                                                    required data-popover-target=\"duration-popover\">\n                                                <label for=\"duration\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">License\n                                                    Duration</label>\n\n                                                <?php dashboard\\primary\\popover(\"duration-popover\", \"License Expiry (duration)\", \"The duration the license will expire in. (Unit * Duration = Expiry)\"); ?>\n                                            </div>\n                                        </div>\n                                        <button type=\"submit\" name=\"genkeys\"\n                                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Generate\n                                            Keys</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Create Key Modal -->\n\n                    <!-- Add Time To Key Modal -->\n                    <div id=\"add-time-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <!-- Modal content -->\n                            <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                                <div class=\"px-6 py-6 lg:px-8\">\n                                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Add Time To Unused Licenses</h3>\n                                    <hr class=\"h-px mb-4 mt-4 bg-gray-700 border-0\">\n                                    <form class=\"space-y-6\" method=\"POST\">\n                                        <div>\n\n                                            <div class=\"relative mb-4  \">\n                                                <select id=\"expiry\" name=\"expiry\"\n                                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\">\n                                                    <option value=\"1\" selected>Seconds</option>\n                                                    <option value=\"60\">Minutes</option>\n                                                    <option value=\"3600\">Hours</option>\n                                                    <option value=\"86400\">Days</option>\n                                                    <option value=\"604800\">Weeks</option>\n                                                    <option value=\"2629743\">Months</option>\n                                                    <option value=\"31556926\">Years</option>\n                                                    <option value=\"315569260\">Lifetime</option>\n                                                </select>\n                                                <label for=\"expiry\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Unit\n                                                    of Time To Add</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" inputmode=\"numeric\" min=\"1\" id=\"time\" name=\"time\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    autocomplete=\"on\" placeholder=\"\" required>\n                                                <label for=\"time\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Time\n                                                    To Add</label>\n                                            </div>\n\n                                        </div>\n                                        <button name=\"addtime\"\n                                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Add\n                                            Time</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Add Time To Key Modal -->\n\n                    <!-- Import Keys Modal -->\n                    <div id=\"import-key-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <!-- Modal content -->\n                            <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                                <div class=\"px-6 py-6 lg:px-8\">\n                                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Import Licenses .json</h3>\n                                    <hr class=\"h-px mb-4 mt-4 bg-gray-700 border-0\">\n                                    <form class=\"space-y-6\" method=\"POST\" enctype=\"multipart/form-data\">\n                                        <div class=\"relative\">\n                                            <input\n                                                class=\"block w-full text-sm text-gray-400 border border-gray-700 rounded-lg cursor-pointer focus:outline-none\"\n                                                id=\"file_input\" name=\"file_input\" type=\"file\">\n                                        </div>\n                                        <button type=\"submit\" name=\"importkeysFile\"\n                                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Import\n                                            Licenses</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Import Keys Modal -->\n\n                    <!-- Delete All Keys Modal -->\n                    <div id=\"delete-all-keys-modal\" tabindex=\"-1\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                        role=\"alert\">\n                                        <span class=\"sr-only\">Info</span>\n                                        <div>\n                                            <span class=\"font-medium\">Notice!</span> This will not delete users (prevent\n                                            them from logging in). Go to https://keyauth.cc/app/?page=users for that.\n                                            </b>\n                                        </div>\n                                    </div>\n                                    <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure you want to delete\n                                        all of your keys? This can not be undone.</h3>\n                                    <form method=\"POST\">\n                                        <button data-modal-hide=\"delete-all-keys-modal\" name=\"delkeys\"\n                                            class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                            Yes, I'm sure\n                                        </button>\n                                        <button data-modal-hide=\"delete-all-keys-modal\" type=\"button\"\n                                            class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                            cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Delete All Keys Modal -->\n\n                    <!-- Delete All Used Keys Modal -->\n                    <div id=\"delete-all-used-keys-modal\" tabindex=\"-1\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                        role=\"alert\">\n                                        <span class=\"sr-only\">Info</span>\n                                        <div>\n                                            <span class=\"font-medium\">Notice!</span> This will not delete users (prevent\n                                            them from logging in). Go to https://keyauth.cc/app/?page=users for that.\n                                            </b>\n                                        </div>\n                                    </div>\n                                    <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure you want to delete\n                                        all of your used keys? This can not be undone.</h3>\n                                    <form method=\"POST\">\n                                        <button data-modal-hide=\"delete-all-used-keys-modal\" name=\"deleteallused\"\n                                            class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                            Yes, I'm sure\n                                        </button>\n                                        <button data-modal-hide=\"delete-all-used-keys-modal\" type=\"button\"\n                                            class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                            cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Delete All Used Keys Modal -->\n\n                    <!-- Delete All Unused Keys Modal -->\n                    <div id=\"delete-all-unused-keys-modal\" tabindex=\"-1\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                        role=\"alert\">\n                                        <span class=\"sr-only\">Info</span>\n                                        <div>\n                                            <span class=\"font-medium\">Notice!</span> This will not delete users (prevent\n                                            them from logging in). Go to https://keyauth.cc/app/?page=users for that.\n                                            </b>\n                                        </div>\n                                    </div>\n                                    <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure you want to delete\n                                        all of your unused keys? This can not be undone.</h3>\n                                    <form method=\"POST\">\n                                        <button data-modal-hide=\"delete-all-unused-keys-modal\" name=\"deleteallunused\"\n                                            class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                            Yes, I'm sure\n                                        </button>\n                                        <button data-modal-hide=\"delete-all-unused-keys-modal\" type=\"button\"\n                                            class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                            cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Delete All Unused Keys Modal -->\n\n                    <!-- Delete Key Modal -->\n                    <div id=\"del-key\" tabindex=\"-1\"\n                        class=\"modal fixed inset-0 flex items-center justify-center z-50 hidden\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                        role=\"alert\">\n                                        <span class=\"sr-only\">Info</span>\n                                        <div>\n                                            <span class=\"font-medium\">Notice!</span> This will not delete the user\n                                            (prevent them from logging in) unless you check Delete User Too\n                                            </b>\n                                        </div>\n                                    </div>\n                                    <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure you want to delete\n                                        this key? This can not be undone.</h3>\n                                    <form method=\"POST\">\n                                        <div class=\"flex items-center mb-4\">\n                                            <input id=\"delUserToo\" name=\"delUserToo\" type=\"checkbox\"\n                                                class=\"w-4 h-4 text-blue-600 bg-[#0f0f17] border-gray-300 rounded focus:ring-blue-500 focus:ring-2\"\n                                                checked>\n                                            <label for=\"delUserToo\"\n                                                class=\"ml-2 text-sm font-medium text-white-900\">Delete user too</label>\n                                        </div>\n\n                                        <button name=\"deletekey\"\n                                            class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2 delkey\">\n                                            Yes, I'm sure\n                                        </button>\n                                        <button type=\"button\" onclick=\"closeModal('del-key')\"\n                                            class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                            cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Delete Key Modal -->\n\n                    <!-- Ban License Modal Actions-->\n                    <div id=\"ban-key-modal\" tabindex=\"-1\"\n                        class=\"modal fixed inset-0 flex items-center justify-center z-50 hidden\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <div class=\"flex items-center p-4 mb-4 text-sm text-red-800 border border-red-700 rounded-lg bg-[#0f0f17]\"\n                                        role=\"alert\">\n                                        <span class=\"sr-only\">Info</span>\n                                        <div>\n                                            <span class=\"font-medium text-red-400\">Notice! This will not ban the user\n                                                (prevent them from logging in) unless you check Ban User Too</b></span>\n                                        </div>\n                                    </div>\n                                    <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure you want to ban this\n                                        license?\n                                        <form method=\"POST\">\n                                            <div>\n                                                <div class=\"relative mb-4 pt-4\">\n                                                    <input type=\"text\" id=\"reason\" name=\"reason\"\n                                                        class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer focus:border-red-700\"\n                                                        placeholder=\" \" autocomplete=\"on\" required>\n                                                    <label for=\"reason\"\n                                                        class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-red-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Ban\n                                                        Reason</label>\n                                                </div>\n                                            </div>\n                                            <div class=\"flex items-center mb-4 pt-4\">\n                                                <input id=\"banUserToo\" name=\"banUserToo\" type=\"checkbox\"\n                                                    class=\"w-4 h-4 text-blue-600 bg-[#0f0f17] border-gray-300 rounded focus:ring-blue-500 focus:ring-2\"\n                                                    checked>\n                                                <label for=\"banUserToo\"\n                                                    class=\"ml-2 text-sm font-medium text-white-900\">Ban User\n                                                    Too?</label>\n                                            </div>\n                                            <button name=\"bankey\"\n                                                class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2 bankey\">\n                                                Yes, I'm sure\n                                            </button>\n                                            <button type=\"button\" onclick=\"closeModal('ban-key-modal')\"\n                                                class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                                cancel</button>\n                                        </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Ban License Modal Actions-->\n\n                    <!-- START TABLE -->\n                    <div class=\"relative overflow-x-auto shadow-md sm:rounded-lg pt-5\">\n                        <table id=\"kt_datatable_licenses\" class=\"w-full text-sm text-left text-white\">\n                            <thead>\n                                <tr class=\"border-2 border-gray-200 text-blue-700 px-7\">\n                                    <th scope=\"col\" class=\"px-6 py-3\">Key</th>\n                                    <th scope=\"col\" class=\"px-6 py-3\">Creation Date</th>\n                                    <th scope=\"col\" class=\"px-6 py-3\">Generated By</th>\n                                    <th scope=\"col\" class=\"px-6 py-3\">Duration</th>\n                                    <th scope=\"col\" class=\"px-6 py-3\">Note</th>\n                                    <th scope=\"col\" class=\"px-6 py-3\">Used On</th>\n                                    <th scope=\"col\" class=\"px-6 py-3\">Used By</th>\n                                    <th scope=\"col\" class=\"px-6 py-3\">Status</th>\n                                    <th scope=\"col\" class=\"px-6 py-3\">Actions</th>\n                                </tr>\n                            </thead>\n                        </table>\n                    </div>\n                    <p class=\"text-xs text-red-600\">Dropdown actions in <b>RED</b> do not show a confirmation!<a\n                            class=\"text-blue-700\"> Dropdown actions in <b>BLUE</b> will show a confirmation!</a></p>\n\n                    <!-- Include the jQuery library -->\n\n\n                    <script>\n                    $(document).keydown(function(event) {\n                        if (event.key === 'Escape') {\n                            $('[data-modal]').each(function() {\n                                if (!$(this).hasClass('hidden')) {\n                                    const modalName = $(this).data('modal');\n                                    closeModal(modalName);\n                                }\n                            });\n                        }\n                    });\n\n                    function bankey(key) {\n                        var bankey = $('.bankey');\n                        bankey.attr('value', key);\n\n                        openModal('ban-key-modal');\n                    }\n\n                    function delkey(key) {\n                        var delkey = $('.delkey');\n                        delkey.attr('value', key);\n\n                        openModal('del-key');\n                    }\n\n                    function copyToClipboard() {\n                        const cardBodyContent = document.getElementById('multi-keys').innerText;\n\n                        const formattedContent = cardBodyContent.replace(/<br>/g, '\\n');\n\n                        const textarea = document.createElement('textarea');\n                        textarea.value = formattedContent;\n\n                        textarea.style.position = 'fixed';\n                        textarea.style.opacity = 0;\n\n                        document.body.appendChild(textarea);\n\n                        textarea.select();\n                        document.execCommand('copy');\n\n                        document.body.removeChild(textarea);\n\n                        alert('Copied new licenses!');\n                    }\n                    </script>\n                    <!-- END TABLE -->\n\n                </div>\n\n                <?php\n                if (isset($_POST['delkeys'])) {\n                    if ($_SESSION['role'] == \"tester\") {\n                        dashboard\\primary\\error(\"Free tester accounts can't delete keys, upgrade your account to delete keys!\");\n                        echo \"<meta http-equiv='Refresh' Content='2'>\";\n                        return;\n                    }\n                    $resp = misc\\license\\deleteAll();\n                    match ($resp) {\n                        'failure' => dashboard\\primary\\error(\"Didn't find any keys!\"),\n                        'success' => dashboard\\primary\\success(\"Deleted All Keys!\"),\n                        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n                    };\n                }\n\n                if (isset($_POST['addtime'])) {\n                    $resp = misc\\license\\addTime($_POST['time'], $_POST['expiry']);\n                    match ($resp) {\n                        'failure' => dashboard\\primary\\error(\"Failed to add time!\"),\n                        'success' => dashboard\\primary\\success(\"Added time to unused licenses!\"),\n                        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n                    };\n                }\n\n                if (isset($_POST['deleteallunused'])) {\n                    if ($_SESSION['role'] == \"tester\") {\n                        dashboard\\primary\\error(\"Free tester accounts can't delete keys, upgrade your account to delete keys!\");\n                        echo \"<meta http-equiv='Refresh' Content='2'>\";\n                        return;\n                    }\n                    $resp = misc\\license\\deleteAllUnused();\n                    match ($resp) {\n                        'failure' => dashboard\\primary\\error(\"Didn't find any unused keys!\"),\n                        'success' => dashboard\\primary\\success(\"Deleted all unused keys!\"),\n                        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n                    };\n                }\n\n                if (isset($_POST['deleteallused'])) {\n                    if ($_SESSION['role'] == \"tester\") {\n                        dashboard\\primary\\error(\"Free tester accounts can't delete keys, upgrade your account to delete keys!\");\n                        echo \"<meta http-equiv='Refresh' Content='2'>\";\n                        return;\n                    }\n                    $resp = misc\\license\\deleteAllUsed();\n                    match ($resp) {\n                        'failure' => dashboard\\primary\\error(\"Didn't find any used keys!\"),\n                        'success' => dashboard\\primary\\success(\"Deleted all used keys!\"),\n                        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n                    };\n                }\n\n                if (isset($_POST['savekey'])) {\n                    $key = misc\\etc\\sanitize($_POST['savekey']);\n                    $level = misc\\etc\\sanitize($_POST['level']);\n                    $duration = misc\\etc\\sanitize($_POST['duration']);\n                    $note = misc\\etc\\sanitize($_POST['editNote']);\n                    if (!empty($duration)) {\n                        $expiry = misc\\etc\\sanitize($_POST['expiry']);\n                        $duration = $duration * $expiry;\n                        misc\\mysql\\query(\"UPDATE `keys` SET `expires` = ? WHERE `key` = ? AND `app` = ?\",[$duration, $key, $_SESSION['app']]);\n                    }\n                    misc\\mysql\\query(\"UPDATE `keys` SET `note` = ?, `level` = ? WHERE `key` = ? AND `app` = ?\",[$note, $level, $key, $_SESSION['app']]);\n                    misc\\cache\\purge('KeyAuthKey:' . $_SESSION['app'] . ':' . $key);\n                    misc\\cache\\purge('KeyAuthKeys:' . $_SESSION['app']);\n                    dashboard\\primary\\success(\"Successfully Updated Settings!\");\n                }\n\n                if (isset($_POST['importkeysFile'])) {\n                    if ($_FILES['file_input']['error'] == UPLOAD_ERR_OK) {\n                        $fileContent = file_get_contents($_FILES['file_input']['tmp_name']);\n                        $jsonArray = json_decode($fileContent, true);\n                \n                        if ($jsonArray === null) {\n                            dashboard\\primary\\error(\"Invalid JSON format!\");\n                            echo \"<meta http-equiv='Refresh' Content='2;'>\";\n                            return;\n                        }\n                \n                        foreach ($jsonArray as $keyData) {\n                            $key_format = $keyData['key'];\n                            $level_format = $keyData['level'];\n                            $expiry_format = $keyData['expiry'];\n                \n                            if (!isset($key_format) || $key_format == '' || !isset($level_format) || $level_format == '' || !isset($expiry_format) || $expiry_format == '') {\n                                dashboard\\primary\\error(\"Invalid Format!\");\n                                echo \"<meta http-equiv='Refresh' Content='2;'>\";\n                                return;\n                            }\n                \n                            $expiry = $expiry_format * 86400;\n                            misc\\mysql\\query(\"INSERT INTO `keys` (`key`, `expires`, `status`, `level`, `genby`, `gendate`, `app`) VALUES (?, ?,'Not Used', ?, ?, ?, ?)\", [$key_format, $expiry, $level_format, $_SESSION['username'], time(), $_SESSION['app']]);\n                        }\n                \n                        dashboard\\primary\\success(\"Successfully imported licenses!\");\n                    } else {\n                        dashboard\\primary\\error(\"File upload failed!\");\n                        echo \"<meta http-equiv='Refresh' Content='2;'>\";\n                        return;\n                    }\n                }\n\n                if (isset($_POST['deletekey'])) {\n                    if ($_SESSION['role'] == \"tester\") {\n                        dashboard\\primary\\error(\"Free tester accounts can't delete keys, upgrade your account to delete keys!\");\n                        echo \"<meta http-equiv='Refresh' Content='2'>\";\n                        return;\n                    }\n                    $userToo = ($_POST['delUserToo'] == \"on\") ? 1 : 0;\n                    $resp = misc\\license\\deleteSingular($_POST['deletekey'], $userToo);\n                    match ($resp) {\n                        'failure' => dashboard\\primary\\error(\"Failed to delete license!\"),\n                        'success' => dashboard\\primary\\success(\"Successfully deleted license!\"),\n                        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n                    };\n                }\n\n                if (isset($_POST['dlkeys'])) {\n                    echo \"<meta http-equiv='Refresh' Content='0; url=download-types.php?type=licenses'>\";\n                    // get all rows, put in text file, download text file, delete text file.\n                }\n\n                if (isset($_POST['bankey'])) {\n                    $userToo = ($_POST['banUserToo'] == \"on\") ? 1 : 0;\n                    $resp = misc\\license\\ban($_POST['bankey'], $_POST['reason'], $userToo);\n                    match ($resp) {\n                        'failure' => dashboard\\primary\\error(\"Failed to ban license!\"),\n                        'success' => dashboard\\primary\\success(\"Successfully banned license!\"),\n                        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n                    };\n                }\n","size_bytes":61834},"app/pages/logout.php":{"content":"<?php\nsession_start();\necho \"<meta http-equiv='Refresh' Content='0; url=../../../login/'>\"; \nsession_destroy();\nexit();\n","size_bytes":120},"app/pages/logs.php":{"content":"<?php\nif ($_SESSION['role'] == \"Reseller\") {\n    header(\"location: ./?page=reseller-licenses\");\n    die();\n}\nif($role == \"Manager\" && !($permissions & 256)) {\n    misc\\auditLog\\send(\"Attempted (and failed) to view logs.\");\n    dashboard\\primary\\error(\"You weren't granted permission to view this page.\");\n    die();\n}\nif(!isset($_SESSION['app'])) {\n    dashboard\\primary\\error(\"Application not selected\");\n    die(\"Application not selected.\");\n}\nif (isset($_POST['dellogs'])) {\n    $resp = misc\\logging\\deleteAll();\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to delete all logs!\"),\n        'success' => dashboard\\primary\\success(\"Successfully deleted all logs!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['dllogs'])){\n    echo \"<meta http-equiv='Refresh' Content='0; url=download-types.php?type=logs'>\";\n}\n\nif($_SESSION['role'] == \"tester\") {\n    $query = misc\\mysql\\query(\"SELECT count(*) AS 'numLogs' FROM `logs` WHERE `logapp` = ?\",[$_SESSION['app']]);\n    $row = mysqli_fetch_array($query->result);\n    $numLogs = $row[\"numLogs\"];\n    if($numLogs >= 20) {\n        ?><div class=\"alert alert-danger\" role=\"alert\">You have hit 20 logs! Upgrade to developer or seller to store\n    more logs.</div><?php\n    }\n}\n?>\n\n<div class=\"p-4 bg-[#09090d] block sm:flex items-center justify-between lg:mt-1.5\">\n    <div class=\"mb-1 w-full bg-[#0f0f17] rounded-xl\">\n        <div class=\"mb-4 p-4\">\n            <?php require '../app/layout/breadcrumb.php'; ?>\n            <h1 class=\"text-xl font-semibold text-white-900 sm:text-2xl \">Logs</h1>\n            <p class=\"text-xs text-gray-500\">Keep track of user actions. <a\n                    href=\"https://keyauth.readme.io/reference/logs-1\" target=\"_blank\"\n                    class=\"text-blue-600  hover:underline\">Learn More</a>.</p>\n            <br>\n            <div id=\"alert\" class=\"flex items-center p-4 mb-4 text-yellow-500 rounded-lg bg-[#09090d]\" role=\"alert\">\n                <span class=\"sr-only\">Info</span>\n                <div class=\"ml-3 text-sm font-medium text-yellow-500\">\n                    The maximum log message length is 275 characters. Logs are automatically deleted after 1 month. If\n                    you set Discord webhook at <a\n                        href=\"https://keyauth.cc/app/?page=app-settings\">https://keyauth.cc/app/?page=app-settings</a>,\n                    logs will go to Discord and not display on our site.\n                </div>\n            </div>\n            <div class=\"p-4 flex flex-col\">\n                <div class=\"overflow-x-auto\">\n                    <form method=\"POST\">\n                        <!-- Logs Functions -->\n                        <button name=\"dllogs\"\n                            class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">\n                            <i class=\"lni lni-download mr-2 mt-1\"></i>Export Logs\n                        </button>\n                        <!-- End Logs Functions -->\n\n                        <br>\n\n                        <!-- Delete Logs Functions -->\n                        <button type=\"button\"\n                            class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                            data-modal-toggle=\"delete-all-logs-modal\" data-modal-target=\"delete-all-logs-modal\">\n                            <i class=\"lni lni-trash-can mr-2 mt-1\"></i>Delete All Logs\n                        </button>\n                        <!-- End Delete Logs Functions -->\n                    </form>\n                    <!-- Delete All Logs Modal -->\n                    <div id=\"delete-all-logs-modal\" tabindex=\"-1\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                        role=\"alert\">\n                                        <span class=\"sr-only\">Info</span>\n                                        <div>\n                                            <span class=\"font-medium\">Notice!</span> You're about to delete all of\n                                            your logs. <b>This can\n                                                NOT be undone</b>\n                                        </div>\n                                    </div>\n                                    <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure\n                                        you want\n                                        to\n                                        delete your logs?</h3>\n                                    <form method=\"POST\">\n                                        <button data-modal-hide=\"delete-all-logs-modal\" name=\"dellogs\"\n                                            class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                            Yes, I'm sure\n                                        </button>\n                                        <button data-modal-hide=\"delete-all-logs-modal\" type=\"button\"\n                                            class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                            cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Delete All Logs Modal -->\n\n                    <!-- START TABLE -->\n                    <div class=\"relative overflow-x-auto shadow-md sm:rounded-lg pt-5\">\n                        <table id=\"kt_datatable_logs\" class=\"w-full text-sm text-left text-white\">\n                            <thead>\n                                <tr class=\"fw-bolder fs-6 text-blue-700 px-7\">\n                                    <th class=\"px-6 py-3\">Log Date</th>\n                                    <th class=\"px-6 py-3\">Log Data</th>\n                                    <th class=\"px-6 py-3\">Credential</th>\n                                    <th class=\"px-6 py-3\">Device Name</th>\n                                </tr>\n                            </thead>\n                        </table>\n                    </div>\n","size_bytes":6999},"app/pages/manage-apps.php":{"content":"<?php\nif ($_SESSION['role'] == \"Reseller\") {\n    header(\"location: ./?page=reseller-licenses\");\n    die();\n}\n\nif (isset($_POST['selectApp'])) {\n    $appName = misc\\etc\\sanitize($_POST['selectApp']);\n    $query = misc\\mysql\\query(\"SELECT `secret`, `name`, `banned`, `sellerkey` FROM `apps` WHERE `owner` = ? AND `name` = ?\", [$_SESSION['username'], $appName]);\n\n    if ($query->num_rows < 1) {\n        dashboard\\primary\\error(\"Application not found!\");\n    } else {\n        $row = mysqli_fetch_array($query->result);\n        $banned = $row[\"banned\"];\n\n        if ($banned) {\n            dashboard\\primary\\error(\"Application is banned!\");\n        } else {\n            $_SESSION[\"app\"] = $row[\"secret\"];\n            $_SESSION[\"name\"] = $appName;\n            $_SESSION[\"selectedApp\"] = $row[\"name\"];\n            $_SESSION['sellerkey'] = $row[\"sellerkey\"];\n\n            echo '<meta http-equiv=\"refresh\" content=\"0\">'; \n            dashboard\\primary\\success(\"Successfully Selected the App!\");\n        }\n    }\n}\n\nif (isset($_POST['create_app'])) {\n\n    $appname = misc\\etc\\sanitize($_POST['appname']);\n    if ($appname == \"\") {\n        dashboard\\primary\\error(\"Input a valid name\");\n        echo '<meta http-equiv=\"refresh\" content=\"2\">';\n        return;\n    }\n\n    $query = misc\\mysql\\query(\"SELECT 1 FROM `apps` WHERE name = ? AND owner = ?\", [$appname, $_SESSION['username']]);\n    if ($query->num_rows > 0) {\n        dashboard\\primary\\error(\"You already own application with this name!\");\n        echo '<meta http-equiv=\"refresh\" content=\"2\">';\n        return;\n    }\n\n    $owner = $_SESSION['username'];\n\n    if ($role == \"tester\") {\n        $num_rows = misc\\mysql\\query(\"SELECT * FROM `apps` WHERE `owner` = ? AND `ownerid` = ?\", [$_SESSION['username'], $_SESSION['ownerid']])->num_rows;\n\n        if ($num_rows > 0) {\n            dashboard\\primary\\error(\"Tester plan only supports one application!\");\n            echo '<meta http-equiv=\"refresh\" content=\"2\">';\n            return;\n        }\n    }\n\n    if ($role == \"Manager\") {\n        dashboard\\primary\\error(\"Manager Accounts Are Not Allowed To Create Applications\");\n        echo '<meta http-equiv=\"refresh\" content=\"2\">';\n        return;\n    }\n\n    $clientsecret = hash('sha256', misc\\etc\\generateRandomString());\n    $algos = array(\n        'ripemd128',\n        'md5',\n        'md4',\n        'tiger128,4',\n        'haval128,3',\n        'haval128,4',\n        'haval128,5'\n    );\n    $sellerkey = hash($algos[array_rand($algos)], misc\\etc\\generateRandomString());\n    misc\\mysql\\query(\"INSERT INTO `subscriptions` (`name`, `level`, `app`) VALUES ('default', '1', ?)\", [$clientsecret]);\n    if (!isset($_SESSION['ownerid'])) {\n        $ownerQuery = misc\\mysql\\query(\"SELECT ownerid FROM accounts WHERE username = ?\", [$_SESSION['username']]);\n        if ($ownerQuery->num_rows > 0) {\n            $ownerRow = mysqli_fetch_array($ownerQuery->result);\n            $_SESSION['ownerid'] = $ownerRow['ownerid'];\n        }\n    }\n    \n    $query = misc\\mysql\\query(\"INSERT INTO `apps` (`owner`, `name`, `secret`, `ownerid`, `enabled`, `hwidcheck`, `sellerkey`) VALUES (?, ?, ?, ?, '1', '1', ?)\", [$_SESSION['username'], $appname, $clientsecret, $_SESSION['ownerid'], $sellerkey]);\n\n    if ($query->affected_rows != 0) {\n        $_SESSION['secret'] = $clientsecret;\n        dashboard\\primary\\success(\"Successfully Created App!\");\n        $_SESSION['app'] = $clientsecret;\n        $_SESSION[\"selectedapp\"] = $appname;\n        $_SESSION['name'] = $appname;\n        $_SESSION['sellerkey'] = $sellerkey;\n        echo '<meta http-equiv=\"refresh\" content=\"2\">';\n    } else {\n        dashboard\\primary\\error(\"Failed to create application!\");\n    }\n}\n\nif (isset($_POST['rename_app'])) {\n    $appname = misc\\etc\\sanitize($_POST['appname']);\n    if ($appname == \"\") {\n        dashboard\\primary\\error(\"Input a valid name\");\n        echo '<meta http-equiv=\"refresh\" content=\"2\">';\n        return;\n    }\n    if ($role == \"Manager\") {\n        dashboard\\primary\\error(\"Manager Accounts Aren't Allowed To Rename Applications\");\n        echo '<meta http-equiv=\"refresh\" content=\"2\">';\n        return;\n    }\n    $query = misc\\mysql\\query(\"SELECT 1 FROM `apps` WHERE `owner` = ? AND `name` = ?\", [$_SESSION['username'], $appname]);\n    if ($query->num_rows > 0) {\n        dashboard\\primary\\error(\"You already have an application with this name!\");\n        echo '<meta http-equiv=\"refresh\" content=\"2\">';\n        return;\n    }\n    misc\\mysql\\query(\"UPDATE `accounts` SET `app` = ? WHERE `app` = ? AND `owner` = ?\", [$appname, $_SESSION['name'], $_SESSION['username']]);\n    $query = misc\\mysql\\query(\"UPDATE `apps` SET `name` = ? WHERE `secret` = ? AND `owner` = ?\", [$appname, $_SESSION['app'], $_SESSION['username']]);\n\n    if ($query->affected_rows != 0) {\n        $oldName = $_SESSION['name'];\n        $_SESSION['name'] = $appname;\n        dashboard\\primary\\success(\"Successfully Renamed App!\");\n        misc\\cache\\purge('KeyAuthApp:' . $oldName . ':' . $_SESSION['ownerid']);\n        if ($_SESSION['role'] == \"seller\") {\n            $query = misc\\mysql\\query(\"SELECT `customDomain`, `sellerkey`, `customDomainAPI` FROM `apps` WHERE `owner` = ? AND `name` = ?\", [$_SESSION['username'], $appname]);\n            $row = mysqli_fetch_array($query->result);\n            misc\\cache\\purge('KeyAuthAppPanel:' . $row['customDomain']);\n            misc\\cache\\purge('KeyAuthAppSeller:' . $row['sellerkey']);\n        }\n        $_SESSION[\"selectedapp\"] = $appname;\n        echo '<meta http-equiv=\"refresh\" content=\"2\">';\n    } else {\n        dashboard\\primary\\error(\"Application Renamed Failed!\");\n    }\n}\n\nif (isset($_POST['pauseapp'])) {\n    if ($role == \"Manager\") {\n        dashboard\\primary\\error(\"Manager accounts aren't allowed to pause applications\");\n        echo '<meta http-equiv=\"refresh\" content=\"2\">';\n        return;\n    }\n    misc\\cache\\purgePattern('KeyAuthSubs:' . $_SESSION[\"app\"]);\n    misc\\app\\pause();\n    dashboard\\primary\\success(\"Paused application and any active subscriptions!\");\n    echo '<meta http-equiv=\"refresh\" content=\"2\">';\n}\nif (isset($_POST['unpauseapp'])) {\n    if ($role == \"Manager\") {\n        dashboard\\primary\\error(\"Manager accounts aren't allowed to unpause applications\");\n        echo '<meta http-equiv=\"refresh\" content=\"2\">';\n        return;\n    }\n    misc\\cache\\purgePattern('KeyAuthSubs:' . $_SESSION[\"app\"]);\n    misc\\app\\unpause();\n    dashboard\\primary\\success(\"Unpaused application and any paused subscriptions!\");\n    echo '<meta http-equiv=\"refresh\" content=\"2\">';\n}\n\nif (isset($_POST['refreshapp'])) {\n    if ($role == \"Manager\") {\n        dashboard\\primary\\error(\"Manager Accounts Aren't Allowed To Refresh Applications\");\n        echo '<meta http-equiv=\"refresh\" content=\"2\">';\n        return;\n    }\n    $gen = misc\\etc\\generateRandomString();\n    $new_secret = hash('sha256', $gen);\n    $query = misc\\mysql\\query(\"UPDATE `apps` SET `secret` = ? WHERE `secret` = ? AND `owner` = ?\", [$new_secret, $_SESSION['app'], $_SESSION['username']]);\n    $_SESSION['secret'] = $new_secret;\n    if ($query->affected_rows != 0) {\n        misc\\mysql\\query(\"UPDATE `bans` SET `app` = ? WHERE `app` = ?\", [$new_secret, $_SESSION['app']]);\n        misc\\mysql\\query(\"UPDATE `buttons` SET `app` = ? WHERE `app` = ?\", [$new_secret, $_SESSION['app']]);\n        misc\\mysql\\query(\"UPDATE `chatmsgs` SET `app` = ? WHERE `app` = ?\", [$new_secret, $_SESSION['app']]);\n        misc\\mysql\\query(\"UPDATE `chatmutes` SET `app` = ? WHERE `app` = ?\", [$new_secret, $_SESSION['app']]);\n        misc\\mysql\\query(\"UPDATE `chats` SET `app` = ? WHERE `app` = ?\", [$new_secret, $_SESSION['app']]);\n        misc\\mysql\\query(\"UPDATE `files` SET `app` = ? WHERE `app` = ?\", [$new_secret, $_SESSION['app']]);\n        misc\\mysql\\query(\"UPDATE `keys` SET `app` = ? WHERE `app` = ?\", [$new_secret, $_SESSION['app']]);\n        misc\\mysql\\query(\"UPDATE `logs` SET `logapp` = ? WHERE `logapp` = ?\", [$new_secret, $_SESSION['app']]);\n        misc\\mysql\\query(\"UPDATE `subs` SET `app` = ? WHERE `app` = ?\", [$new_secret, $_SESSION['app']]);\n        misc\\mysql\\query(\"UPDATE `subscriptions` SET `app` = ? WHERE `app` = ?\", [$new_secret, $_SESSION['app']]);\n        misc\\mysql\\query(\"UPDATE `users` SET `app` = ? WHERE `app` = ?\", [$new_secret, $_SESSION['app']]);\n        misc\\mysql\\query(\"UPDATE `uservars` SET `app` = ? WHERE `app` = ?\", [$new_secret, $_SESSION['app']]);\n        misc\\mysql\\query(\"UPDATE `vars` SET `app` = ? WHERE `app` = ?\", [$new_secret, $_SESSION['app']]);\n        misc\\mysql\\query(\"UPDATE `webhooks` SET `app` = ? WHERE `app` = ?\", [$new_secret, $_SESSION['app']]);\n        $_SESSION['app'] = $new_secret;\n        misc\\cache\\purge('KeyAuthApp:' . $_SESSION['name'] . ':' . $_SESSION['ownerid']);\n        if ($_SESSION['role'] == \"seller\" || $_SESSION['role'] == \"developer\") {\n            $query = misc\\mysql\\query(\"SELECT `sellerkey`,`customDomainAPI` FROM `apps` WHERE `owner` = ? AND `name` = ?\", [$_SESSION['username'], $_SESSION['name']]);\n            $row = mysqli_fetch_array($query->result);\n            misc\\cache\\purge('KeyAuthAppSeller:' . $row['sellerkey']);\n            misc\\cache\\purge('KeyAuthApp:' . $row['customDomainAPI']);\n        }\n        dashboard\\primary\\success(\"Successfully Refreshed App!\");\n        echo '<meta http-equiv=\"refresh\" content=\"2\">';\n    } else {\n        dashboard\\primary\\error(\"Application Refresh Failed!\");\n    }\n}\n\nif (isset($_POST['deleteapp'])) {\n    if ($role == \"Manager\") {\n        dashboard\\primary\\error(\"Manager Accounts Aren't Allowed To Delete Applications\");\n        echo '<meta http-equiv=\"refresh\" content=\"2\">';\n        return;\n    }\n\n    $confirmName = misc\\etc\\sanitize($_POST['confirmappname']);\n    if ($confirmName != $_SESSION['name']) {\n        dashboard\\primary\\error(\"Application name doesn't match!\");\n        echo '<meta http-equiv=\"refresh\" content=\"2\">';\n        return;\n    }\n\n    $app = $_SESSION['app'];\n    $query = misc\\mysql\\query(\"DELETE FROM `apps` WHERE `secret` = ?\", [$app]);\n    if ($query->affected_rows != 0) {\n        misc\\mysql\\query(\"DELETE FROM `bans` WHERE `app` = ?\", [$app]);\n        misc\\mysql\\query(\"DELETE FROM `buttons` WHERE `app` = ?\", [$app]);\n        misc\\mysql\\query(\"DELETE FROM `chatmsgs` WHERE `app` = ?\", [$app]);\n        misc\\mysql\\query(\"DELETE FROM `chatmutes` WHERE `app` = ?\", [$app]);\n        misc\\mysql\\query(\"DELETE FROM `chats` WHERE `app` = ?\", [$app]);\n        misc\\mysql\\query(\"DELETE FROM `files` WHERE `app` = ?\", [$app]);\n        misc\\mysql\\query(\"DELETE FROM `keys` WHERE `app` = ?\", [$app]);\n        misc\\mysql\\query(\"DELETE FROM `logs` WHERE `logapp` = ?\", [$app]);\n        misc\\mysql\\query(\"DELETE FROM `subs` WHERE `app` = ?\", [$app]);\n        misc\\mysql\\query(\"DELETE FROM `subscriptions` WHERE `app` = ?\", [$app]);\n        misc\\mysql\\query(\"DELETE FROM `users` WHERE `app` = ?\", [$app]);\n        misc\\mysql\\query(\"DELETE FROM `uservars` WHERE `app` = ?\", [$app]);\n        misc\\mysql\\query(\"DELETE FROM `vars` WHERE `app` = ?\", [$app]);\n        misc\\mysql\\query(\"DELETE FROM `webhooks` WHERE `app` = ?\", [$app]);\n        misc\\mysql\\query(\"DELETE FROM `auditLog` WHERE `app` = ?\", [$app]);\n        misc\\mysql\\query(\"DELETE FROM `sellerLogs` WHERE `app` = ?\", [$app]);\n        misc\\mysql\\query(\"DELETE FROM `whitelist` WHERE `app` = ?\", [$app]);\n        misc\\mysql\\query(\"DELETE FROM `accounts` WHERE `app` = ? AND `owner` = ?\", [$_SESSION['name'], $_SESSION['username']]);\n\n        misc\\cache\\purge('KeyAuthApp:' . $_SESSION['name'] . ':' . $_SESSION['ownerid']);\n        if ($_SESSION['role'] == \"seller\" || $_SESSION['role'] == \"developer\") {\n            $query = misc\\mysql\\query(\"SELECT `sellerkey`,`customDomainAPI` FROM `apps` WHERE `owner` = ? AND `name` = ?\", [$_SESSION['username'], $_SESSION['name']]);\n            $row = mysqli_fetch_array($query->result);\n            misc\\cache\\purge('KeyAuthAppSeller:' . $row['sellerkey']);\n            misc\\cache\\purge('KeyAuthApp:' . $row['customDomainAPI']);\n        }\n\n        $_SESSION['app'] = NULL;\n        dashboard\\primary\\success(\"Successfully deleted App!\");\n        $query = misc\\mysql\\query(\"SELECT * FROM `apps` WHERE `owner` = ? AND `ownerid` = ?\", [$_SESSION['username'], $_SESSION['ownerid']]);\n        if ($query->num_rows == 1) {\n            $row = mysqli_fetch_array($query->result);\n            $_SESSION['name'] = $row[\"name\"];\n            $_SESSION[\"selectedApp\"] = $row[\"name\"];\n            $_SESSION['app'] = $row[\"secret\"];\n        } else {\n            $_SESSION['name'] = NULL;\n            $_SESSION[\"selectedApp\"] = NULL;\n        }\n        echo '<meta http-equiv=\"refresh\" content=\"2\">';\n    } else {\n        dashboard\\primary\\error(\"Application Deletion Failed!\");\n    }\n}\n\nif (isset($_SESSION[\"app\"])) {\n    $appsecret = $_SESSION[\"app\"];\n    $query = misc\\mysql\\query(\"SELECT * FROM `apps` WHERE `secret` = ?\", [$appsecret]);\n\n    $row = mysqli_fetch_array($query->result);\n    $appname = $row[\"name\"];\n    $secret = $row[\"secret\"];\n    $version = $row[\"ver\"];\n    $ownerid = $row[\"ownerid\"];\n    $paused = $row[\"paused\"];\n\n    $_SESSION[\"secret\"] = $secret;\n}\n\n?>\n\n<div class=\"p-4 bg-[#09090d] min-h-screen\">\n    <div class=\"mb-1 w-full modern-card mt-4 md:mt-12\">\n        <div class=\"modern-card-header\">\n            <?php require '../app/layout/breadcrumb.php'; ?>\n            \n            <div class=\"flex items-center justify-between mb-6\">\n                <div>\n                    <h1 class=\"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400\">\n                        <?php echo isset($appname) ? \"Manage Applications - \" . htmlspecialchars($appname) : \"Manage Applications\"; ?>\n                    </h1>\n                    <p class=\"text-gray-400 mt-2\">\n                        This is where it all begins. \n                        <a href=\"https://keyauth.readme.io/reference/manage-application\" target=\"_blank\" class=\"text-blue-400 hover:text-blue-300 hover:underline transition-colors\">\n                            Learn More\n                        </a>\n                    </p>\n                </div>\n                <?php if ($_SESSION['role'] != \"Manager\") { ?>\n                <button data-modal-target=\"create-app-modal\" data-modal-toggle=\"create-app-modal\" class=\"inline-flex items-center text-white bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 focus:ring-4 focus:ring-blue-500/50 font-semibold rounded-xl text-sm px-6 py-3 transition-all duration-300 transform hover:scale-105 shadow-lg shadow-blue-500/30\">\n                    <i class=\"lni lni-circle-plus mr-2 text-lg\"></i>\n                    Create Application\n                </button>\n                <?php } ?>\n            </div>\n\n            <?php if (isset($_SESSION[\"app\"])) { ?>\n            <div class=\"mb-8 p-6 bg-gradient-to-br from-[#0f0f17] to-[#1a1a24] rounded-2xl border border-gray-700/50 shadow-2xl\">\n                <div class=\"flex items-center mb-4\">\n                    <i class=\"lni lni-code-alt text-blue-400 text-2xl mr-3\"></i>\n                    <h2 class=\"text-xl font-bold text-white\">Application Credentials</h2>\n                </div>\n                <p class=\"text-sm text-gray-400 mb-4\">Use these credentials in your application</p>\n                \n                <div class=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\n                    <div class=\"p-4 bg-gray-800/30 rounded-lg border border-gray-700/50\">\n                        <p class=\"text-xs text-gray-500 mb-1\">Application Name</p>\n                        <p class=\"text-white font-mono text-sm\"><?= htmlspecialchars($appname); ?></p>\n                    </div>\n                    <div class=\"p-4 bg-gray-800/30 rounded-lg border border-gray-700/50\">\n                        <p class=\"text-xs text-gray-500 mb-1\">Owner ID</p>\n                        <p class=\"text-white font-mono text-sm\"><?= htmlspecialchars($ownerid); ?></p>\n                    </div>\n                    <div class=\"p-4 bg-gray-800/30 rounded-lg border border-gray-700/50\">\n                        <p class=\"text-xs text-gray-500 mb-1\">Version</p>\n                        <p class=\"text-white font-mono text-sm\"><?= htmlspecialchars($version); ?></p>\n                    </div>\n                </div>\n\n                <div class=\"p-4 bg-gray-900/50 rounded-lg border border-gray-700/50\">\n                    <p class=\"text-xs text-gray-500 mb-2\">Application Secret</p>\n                    <div class=\"flex items-center justify-between\">\n                        <code class=\"text-white font-mono text-sm blur-sm hover:blur-none transition-all cursor-pointer\"><?= htmlspecialchars($secret); ?></code>\n                        <button onclick=\"copyToClipboard('<?= htmlspecialchars($secret); ?>')\" class=\"ml-4 inline-flex items-center text-white bg-blue-600 hover:bg-blue-700 focus:ring-4 focus:ring-blue-500/50 font-medium rounded-lg text-xs px-3 py-2 transition-all\">\n                            <i class=\"lni lni-clipboard mr-1\"></i>\n                            Copy\n                        </button>\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"flex flex-wrap gap-3 mb-8\">\n                <?php if (isset($_SESSION['app']) && $_SESSION['role'] != \"Manager\") { ?>\n                <button data-modal-target=\"rename-app-modal\" data-modal-toggle=\"rename-app-modal\" class=\"inline-flex items-center text-white bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 focus:ring-4 focus:ring-purple-500/50 font-semibold rounded-xl text-sm px-5 py-2.5 transition-all duration-300 transform hover:scale-105 shadow-lg shadow-purple-500/30\">\n                    <i class=\"lni lni-pencil-alt mr-2\"></i>\n                    Rename Application\n                </button>\n\n                <?php if (!$paused) { ?>\n                <button data-modal-target=\"pause-app-modal\" data-modal-toggle=\"pause-app-modal\" class=\"inline-flex items-center text-white bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-700 hover:to-orange-800 focus:ring-4 focus:ring-orange-500/50 font-semibold rounded-xl text-sm px-5 py-2.5 transition-all duration-300 transform hover:scale-105 shadow-lg shadow-orange-500/30\">\n                    <i class=\"lni lni-pause mr-2\"></i>\n                    Pause Application\n                </button>\n                <?php } else { ?>\n                <button data-modal-target=\"unpause-app-modal\" data-modal-toggle=\"unpause-app-modal\" class=\"inline-flex items-center text-white bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 focus:ring-4 focus:ring-green-500/50 font-semibold rounded-xl text-sm px-5 py-2.5 transition-all duration-300 transform hover:scale-105 shadow-lg shadow-green-500/30\">\n                    <i class=\"lni lni-play mr-2\"></i>\n                    Unpause Application\n                </button>\n                <?php } ?>\n\n                <button data-modal-target=\"refresh-app-modal\" data-modal-toggle=\"refresh-app-modal\" class=\"inline-flex items-center text-white bg-gradient-to-r from-cyan-600 to-cyan-700 hover:from-cyan-700 hover:to-cyan-800 focus:ring-4 focus:ring-cyan-500/50 font-semibold rounded-xl text-sm px-5 py-2.5 transition-all duration-300 transform hover:scale-105 shadow-lg shadow-cyan-500/30\">\n                    <i class=\"lni lni-reload mr-2\"></i>\n                    Refresh Secret\n                </button>\n\n                <button data-modal-target=\"delete-app-modal\" data-modal-toggle=\"delete-app-modal\" class=\"inline-flex items-center text-white bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 focus:ring-4 focus:ring-red-500/50 font-semibold rounded-xl text-sm px-5 py-2.5 transition-all duration-300 transform hover:scale-105 shadow-lg shadow-red-500/30\">\n                    <i class=\"lni lni-trash-can mr-2\"></i>\n                    Delete Application\n                </button>\n                <?php } ?>\n            </div>\n            <?php } ?>\n\n            <?php if ($_SESSION['role'] != \"Manager\") { ?>\n            <div class=\"bg-gradient-to-br from-[#0f0f17] to-[#1a1a24] rounded-2xl border border-gray-700/50 shadow-2xl overflow-hidden\">\n                <div class=\"p-6\">\n                    <div class=\"flex items-center mb-6\">\n                        <i class=\"lni lni-package text-blue-400 text-2xl mr-3\"></i>\n                        <h3 class=\"text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500\">\n                            Your Applications\n                        </h3>\n                    </div>\n                    \n                    <div class=\"relative overflow-x-auto\">\n                        <table class=\"w-full text-sm text-left text-white\">\n                            <thead>\n                                <tr class=\"border-b border-gray-700/50\">\n                                    <th class=\"px-6 py-4 text-blue-400 font-semibold\">\n                                        <div class=\"flex items-center\">\n                                            <i class=\"lni lni-code-alt mr-2\"></i>\n                                            Application Name\n                                        </div>\n                                    </th>\n                                    <th class=\"px-6 py-4 text-purple-400 font-semibold\">\n                                        <div class=\"flex items-center\">\n                                            <i class=\"lni lni-signal mr-2\"></i>\n                                            Status\n                                        </div>\n                                    </th>\n                                    <th class=\"px-6 py-4 text-cyan-400 font-semibold text-right\">\n                                        <div class=\"flex items-center justify-end\">\n                                            <i class=\"lni lni-pointer mr-2\"></i>\n                                            Action\n                                        </div>\n                                    </th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                <?php\n                $rows = array();\n                $query = misc\\mysql\\query(\"SELECT * FROM `apps` WHERE `owner` = ? AND `ownerid` = ? ORDER BY `name` ASC\", [$_SESSION['username'], $_SESSION['ownerid']]);\n                while ($r = mysqli_fetch_assoc($query->result)) {\n                    $rows[] = $r;\n                }\n\n                if (count($rows) == 0) {\n                    echo '<tr><td colspan=\"3\" class=\"px-6 py-16 text-center\">\n                        <div class=\"flex flex-col items-center\">\n                            <i class=\"lni lni-inbox text-7xl mb-4 text-gray-600\"></i>\n                            <p class=\"text-lg font-semibold mb-2 text-gray-300\">No applications yet</p>\n                            <p class=\"text-sm text-gray-500\">Click \"Create Application\" to get started</p>\n                        </div>\n                    </td></tr>';\n                }\n\n                foreach ($rows as $row) {\n                    $appName = $row['name'];\n                    $paused = $row['paused'];\n\n                    if (isset($_SESSION[\"selectedApp\"])) {\n                        $appSelected = ($_SESSION[\"selectedApp\"] == $appName);\n                    } else {\n                        $appSelected = 0;\n                    }\n                ?>\n                                <tr class=\"border-b border-gray-800/30 hover:bg-gradient-to-r hover:from-blue-600/10 hover:to-purple-600/10 transition-all duration-300 <?= $appSelected ? 'bg-gradient-to-r from-blue-600/20 to-purple-600/20' : ''; ?>\">\n                                    <td class=\"px-6 py-4\">\n                                        <div class=\"flex items-center\">\n                                            <div class=\"w-10 h-10 rounded-lg bg-gradient-to-r from-blue-600 to-purple-600 flex items-center justify-center mr-3 shadow-lg shadow-blue-500/30\">\n                                                <i class=\"lni lni-code text-white text-lg\"></i>\n                                            </div>\n                                            <span class=\"font-semibold text-white\"><?= htmlspecialchars($appName) ?></span>\n                                        </div>\n                                    </td>\n                                    <td class=\"px-6 py-4\">\n                                        <?php if ($paused == 1) { ?>\n                                        <span class=\"inline-flex items-center bg-orange-500/20 text-orange-400 text-xs font-semibold px-3 py-1.5 rounded-full border border-orange-500/30\">\n                                            <span class=\"h-2 w-2 rounded-full bg-orange-400 mr-2 animate-pulse\"></span>\n                                            Paused\n                                        </span>\n                                        <?php } else { ?>\n                                        <span class=\"inline-flex items-center bg-green-500/20 text-green-400 text-xs font-semibold px-3 py-1.5 rounded-full border border-green-500/30\">\n                                            <span class=\"h-2 w-2 rounded-full bg-green-400 mr-2 animate-pulse\"></span>\n                                            Active\n                                        </span>\n                                        <?php } ?>\n                                    </td>\n                                    <td class=\"px-6 py-4 text-right\">\n                                        <form method=\"POST\">\n                                            <?php if ($appSelected) { ?>\n                                            <button type=\"submit\" value=\"<?= htmlspecialchars($appName) ?>\" name=\"selectApp\" class=\"inline-flex items-center bg-gradient-to-r from-blue-600 to-purple-600 text-white text-xs font-semibold px-4 py-2 rounded-lg shadow-lg shadow-blue-500/30 hover:shadow-blue-500/50 transition-all duration-300 hover:scale-105\">\n                                                <span class=\"h-2 w-2 rounded-full bg-white mr-2 animate-pulse\"></span>\n                                                Selected\n                                            </button>\n                                            <?php } else { ?>\n                                            <button type=\"submit\" value=\"<?= htmlspecialchars($appName) ?>\" name=\"selectApp\" class=\"inline-flex items-center bg-gray-700 hover:bg-gradient-to-r hover:from-blue-600 hover:to-purple-600 text-gray-300 hover:text-white text-xs font-semibold px-4 py-2 rounded-lg transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-blue-500/30\">\n                                                <span class=\"h-2 w-2 rounded-full bg-gray-500 mr-2\"></span>\n                                                Select\n                                            </button>\n                                            <?php } ?>\n                                        </form>\n                                    </td>\n                                </tr>\n                                <?php } ?>\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            </div>\n            <?php } ?>\n        </div>\n    </div>\n</div>\n\n<!-- Create New App Modal -->\n<div id=\"create-app-modal\" tabindex=\"-1\" aria-hidden=\"true\" class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n    <div class=\"relative w-full max-w-md max-h-full\">\n        <div class=\"relative bg-gradient-to-br from-[#0f0f17] to-[#1a1a24] rounded-2xl border border-blue-500/30 shadow-2xl\">\n            <div class=\"px-6 py-6 lg:px-8\">\n                <div class=\"flex items-center justify-between mb-4\">\n                    <h3 class=\"text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500\">\n                        Create New Application\n                    </h3>\n                    <button type=\"button\" class=\"text-gray-400 hover:text-white\" data-modal-hide=\"create-app-modal\">\n                        <svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                            <path fill-rule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clip-rule=\"evenodd\"></path>\n                        </svg>\n                    </button>\n                </div>\n                <form class=\"space-y-6\" method=\"POST\">\n                    <div class=\"relative\">\n                        <input type=\"text\" id=\"appname\" name=\"appname\" class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border border-gray-600 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/50 appearance-none peer transition-all\" placeholder=\" \" required>\n                        <label for=\"appname\" class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-400 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">\n                            Application Name\n                        </label>\n                    </div>\n                    <button type=\"submit\" name=\"create_app\" class=\"w-full text-white bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 focus:ring-4 focus:ring-blue-500/50 font-bold rounded-lg text-sm px-5 py-3 text-center transition-all duration-300 transform hover:scale-105\">\n                        <i class=\"lni lni-circle-plus mr-2\"></i>\n                        Create Application\n                    </button>\n                </form>\n            </div>\n        </div>\n    </div>\n</div>\n\n<!-- Rename App Modal -->\n<div id=\"rename-app-modal\" tabindex=\"-1\" aria-hidden=\"true\" class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n    <div class=\"relative w-full max-w-md max-h-full\">\n        <div class=\"relative bg-gradient-to-br from-[#0f0f17] to-[#1a1a24] rounded-2xl border border-purple-500/30 shadow-2xl\">\n            <div class=\"px-6 py-6 lg:px-8\">\n                <div class=\"flex items-center justify-between mb-4\">\n                    <h3 class=\"text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-500\">\n                        Rename Application\n                    </h3>\n                    <button type=\"button\" class=\"text-gray-400 hover:text-white\" data-modal-hide=\"rename-app-modal\">\n                        <svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                            <path fill-rule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clip-rule=\"evenodd\"></path>\n                        </svg>\n                    </button>\n                </div>\n                <form class=\"space-y-6\" method=\"POST\">\n                    <div class=\"relative\">\n                        <input type=\"text\" id=\"appname\" name=\"appname\" class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border border-gray-600 focus:border-purple-500 focus:ring-2 focus:ring-purple-500/50 appearance-none peer transition-all\" placeholder=\" \" required>\n                        <label for=\"appname\" class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-purple-400 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">\n                            New Application Name\n                        </label>\n                    </div>\n                    <button type=\"submit\" name=\"rename_app\" class=\"w-full text-white bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 focus:ring-4 focus:ring-purple-500/50 font-bold rounded-lg text-sm px-5 py-3 text-center transition-all duration-300 transform hover:scale-105\">\n                        <i class=\"lni lni-pencil-alt mr-2\"></i>\n                        Rename Application\n                    </button>\n                </form>\n            </div>\n        </div>\n    </div>\n</div>\n\n<!-- Pause App Modal -->\n<div id=\"pause-app-modal\" tabindex=\"-1\" class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n    <div class=\"relative w-full max-w-md max-h-full\">\n        <div class=\"relative bg-gradient-to-br from-[#0f0f17] to-[#1a1a24] rounded-2xl border border-orange-500/30 shadow-2xl\">\n            <div class=\"p-6 text-center\">\n                <div class=\"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-orange-500/20 mb-4\">\n                    <i class=\"lni lni-warning text-orange-400 text-3xl\"></i>\n                </div>\n                <h3 class=\"mb-4 text-xl font-bold text-white\">Pause Application?</h3>\n                <p class=\"mb-6 text-sm text-gray-400\">\n                    Pausing your app will make it unusable until you unpause it. All users will be temporarily blocked.\n                </p>\n                <form method=\"POST\" class=\"flex gap-3 justify-center\">\n                    <button type=\"submit\" name=\"pauseapp\" class=\"text-white bg-orange-600 hover:bg-orange-700 focus:ring-4 focus:ring-orange-500/50 font-semibold rounded-lg text-sm px-6 py-2.5 transition-all\">\n                        Yes, Pause It\n                    </button>\n                    <button type=\"button\" data-modal-hide=\"pause-app-modal\" class=\"text-white bg-gray-700 hover:bg-gray-600 focus:ring-4 focus:ring-gray-500/50 font-semibold rounded-lg text-sm px-6 py-2.5 transition-all\">\n                        Cancel\n                    </button>\n                </form>\n            </div>\n        </div>\n    </div>\n</div>\n\n<!-- Unpause App Modal -->\n<div id=\"unpause-app-modal\" tabindex=\"-1\" class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n    <div class=\"relative w-full max-w-md max-h-full\">\n        <div class=\"relative bg-gradient-to-br from-[#0f0f17] to-[#1a1a24] rounded-2xl border border-green-500/30 shadow-2xl\">\n            <div class=\"p-6 text-center\">\n                <div class=\"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-500/20 mb-4\">\n                    <i class=\"lni lni-play text-green-400 text-3xl\"></i>\n                </div>\n                <h3 class=\"mb-4 text-xl font-bold text-white\">Unpause Application?</h3>\n                <p class=\"mb-6 text-sm text-gray-400\">\n                    Unpausing your app will make it accessible to all users again.\n                </p>\n                <form method=\"POST\" class=\"flex gap-3 justify-center\">\n                    <button type=\"submit\" name=\"unpauseapp\" class=\"text-white bg-green-600 hover:bg-green-700 focus:ring-4 focus:ring-green-500/50 font-semibold rounded-lg text-sm px-6 py-2.5 transition-all\">\n                        Yes, Unpause It\n                    </button>\n                    <button type=\"button\" data-modal-hide=\"unpause-app-modal\" class=\"text-white bg-gray-700 hover:bg-gray-600 focus:ring-4 focus:ring-gray-500/50 font-semibold rounded-lg text-sm px-6 py-2.5 transition-all\">\n                        Cancel\n                    </button>\n                </form>\n            </div>\n        </div>\n    </div>\n</div>\n\n<!-- Refresh App Secret Modal -->\n<div id=\"refresh-app-modal\" tabindex=\"-1\" class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n    <div class=\"relative w-full max-w-md max-h-full\">\n        <div class=\"relative bg-gradient-to-br from-[#0f0f17] to-[#1a1a24] rounded-2xl border border-cyan-500/30 shadow-2xl\">\n            <div class=\"p-6 text-center\">\n                <div class=\"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-cyan-500/20 mb-4\">\n                    <i class=\"lni lni-reload text-cyan-400 text-3xl\"></i>\n                </div>\n                <h3 class=\"mb-4 text-xl font-bold text-white\">Refresh Application Secret?</h3>\n                <p class=\"mb-6 text-sm text-gray-400\">\n                    Make sure you update your application secret in your program after refreshing.\n                </p>\n                <form method=\"POST\" class=\"flex gap-3 justify-center\">\n                    <button type=\"submit\" name=\"refreshapp\" class=\"text-white bg-cyan-600 hover:bg-cyan-700 focus:ring-4 focus:ring-cyan-500/50 font-semibold rounded-lg text-sm px-6 py-2.5 transition-all\">\n                        Yes, Refresh It\n                    </button>\n                    <button type=\"button\" data-modal-hide=\"refresh-app-modal\" class=\"text-white bg-gray-700 hover:bg-gray-600 focus:ring-4 focus:ring-gray-500/50 font-semibold rounded-lg text-sm px-6 py-2.5 transition-all\">\n                        Cancel\n                    </button>\n                </form>\n            </div>\n        </div>\n    </div>\n</div>\n\n<!-- Delete App Modal -->\n<div id=\"delete-app-modal\" tabindex=\"-1\" class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n    <div class=\"relative w-full max-w-md max-h-full\">\n        <div class=\"relative bg-gradient-to-br from-[#0f0f17] to-[#1a1a24] rounded-2xl border border-red-500/30 shadow-2xl\">\n            <div class=\"p-6 text-center\">\n                <div class=\"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-500/20 mb-4\">\n                    <i class=\"lni lni-trash-can text-red-400 text-3xl\"></i>\n                </div>\n                <h3 class=\"mb-4 text-xl font-bold text-white\">Delete Application?</h3>\n                <p class=\"mb-4 text-sm text-red-400 font-semibold\">\n                    This action cannot be undone!\n                </p>\n                <p class=\"mb-6 text-sm text-gray-400\">\n                    Please enter your application name to confirm: <br>\n                    <span class=\"font-mono text-white\"><?= isset($appname) ? htmlspecialchars($appname) : '' ?></span>\n                </p>\n                <form method=\"POST\" class=\"space-y-4\">\n                    <div class=\"relative\">\n                        <input type=\"text\" id=\"confirmappname\" name=\"confirmappname\" class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border border-gray-600 focus:border-red-500 focus:ring-2 focus:ring-red-500/50 appearance-none peer transition-all\" placeholder=\" \" required>\n                        <label for=\"confirmappname\" class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-red-400 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">\n                            Application Name\n                        </label>\n                    </div>\n                    <div class=\"flex gap-3 justify-center\">\n                        <button type=\"submit\" name=\"deleteapp\" class=\"text-white bg-red-600 hover:bg-red-700 focus:ring-4 focus:ring-red-500/50 font-semibold rounded-lg text-sm px-6 py-2.5 transition-all\">\n                            Yes, Delete It\n                        </button>\n                        <button type=\"button\" data-modal-hide=\"delete-app-modal\" class=\"text-white bg-gray-700 hover:bg-gray-600 focus:ring-4 focus:ring-gray-500/50 font-semibold rounded-lg text-sm px-6 py-2.5 transition-all\">\n                            Cancel\n                        </button>\n                    </div>\n                </form>\n            </div>\n        </div>\n    </div>\n</div>\n\n<script>\nfunction copyToClipboard(text) {\n    navigator.clipboard.writeText(text).then(function() {\n        Swal.fire({\n            icon: 'success',\n            title: 'Copied!',\n            text: 'Secret copied to clipboard',\n            showConfirmButton: false,\n            timer: 1500,\n            iconColor: '#3b82f6',\n            customClass: {\n                popup: 'bg-[#0f0f17] border border-blue-500/30 rounded-2xl',\n                title: 'text-white',\n                content: 'text-gray-400'\n            }\n        });\n    }).catch(function(err) {\n        console.error('Failed to copy: ', err);\n    });\n}\n</script>\n","size_bytes":41054},"app/pages/sessions.php":{"content":"<?php\nif ($_SESSION['role'] == \"Reseller\") {\n    header(\"location: ./?page=reseller-licenses\");\n    die();\n}\nif($role == \"Manager\" && !($permissions & 16)) {\n    misc\\auditLog\\send(\"Attempted (and failed) to view sessions.\");\n    dashboard\\primary\\error(\"You weren't granted permission to view this page!\");\n    die();\n}\nif(!isset($_SESSION['app'])) {\n    dashboard\\primary\\error(\"Application not selected\");\n    die(\"Application not selected.\");\n}\nif (isset($_POST['killall'])) {\n    $resp = misc\\session\\killAll();\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to kill all sessions!\"),\n        'success' => dashboard\\primary\\success(\"Successfully killed all sessions!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['kill'])) {\n    $resp = misc\\session\\killSingular($_POST['kill']);\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to kill session!\"),\n        'success' => dashboard\\primary\\success(\"Successfully killed session!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n?>\n\n<div class=\"p-4 bg-[#09090d] block sm:flex items-center justify-between lg:mt-1.5\">\n    <div class=\"mb-1 w-full bg-[#0f0f17] rounded-xl\">\n        <div class=\"mb-4 p-4\">\n            <?php require '../app/layout/breadcrumb.php'; ?>\n            <h1 class=\"text-xl font-semibold text-white-900 sm:text-2xl \">Sessions</h1>\n            <p class=\"text-xs text-gray-500\">All of your active sessions. (Active Users) <a\n                    href=\"https://keyauth.readme.io/reference/sessions-1\" target=\"_blank\"\n                    class=\"text-blue-600  hover:underline\">Learn More</a>.</p>\n            <br>\n            <div class=\"p-4 flex flex-col\">\n                <div class=\"overflow-x-auto\">\n                    <!-- Session Functions -->\n                    <button\n                        class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"kill-all-sessions-modal\" data-modal-target=\"kill-all-sessions-modal\">\n                        <i class=\"lni lni-trash-can mr-2 mt-1\"></i>Kill All Sessions\n                    </button>\n                    <!-- End Sessions Functions -->\n\n                    <!--Kill All Sessions Modal -->\n                    <div id=\"kill-all-sessions-modal\" tabindex=\"-1\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                        role=\"alert\">\n                                        <span class=\"sr-only\">Info</span>\n                                        <div>\n                                            <span class=\"font-medium\">Notice!</span> You're about to kill all of\n                                            your active sessions. Requiring everyone to log into your app again.\n                                        </div>\n                                    </div>\n                                    <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure\n                                        you want\n                                        to\n                                        kill your active sessions?</h3>\n                                    <form method=\"POST\">\n                                        <button data-modal-hide=\"kill-all-sessions-modal\" name=\"killall\"\n                                            class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                            Yes, I'm sure\n                                        </button>\n                                        <button data-modal-hide=\"kill-all-sessions-modal\" type=\"button\"\n                                            class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                            cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Kill All Sessions Modal -->\n\n                    <!-- START TABLE -->\n                    <div class=\"relative overflow-x-auto shadow-md sm:rounded-lg pt-5\">\n                        <table id=\"kt_datatable_sessions\" class=\"w-full text-sm text-left text-white\">\n                            <thead>\n                                <tr class=\"fw-bolder fs-6 text-blue-700 px-7\">\n                                    <th class=\"px-6 py-3\">ID</th>\n                                    <th class=\"px-6 py-3\">Credentials</th>\n                                    <th class=\"px-6 py-3\">Expires</th>\n                                    <th class=\"px-6 py-3\">Authenticated</th>\n                                    <th class=\"px-6 py-3\">IP Adress</th>\n                                    <th class=\"px-6 py-3\">Action</th>\n                                </tr>\n                            </thead>\n                        </table>\n                    </div>\n                    <p class=\"text-xs text-red-600\">Dropdown actions in <b>RED</b> do not show a confirmation!<a\n                            class=\"text-blue-700\"> Dropdown actions in <b>BLUE</b> will show a confirmation!</a></p>\n                    \n","size_bytes":6031},"app/pages/subscriptions.php":{"content":"<?php\nif ($_SESSION['role'] == \"Reseller\") {\n    header(\"location: ./?page=reseller-licenses\");\n    die();\n}\nif ($role == \"Manager\" && !($permissions & 4)) {\n    misc\\auditLog\\send(\"Attempted (and failed) to view subscriptions.\");\n    dashboard\\primary\\error(\"You weren't granted permission to view this page.\");\n    die();\n}\nif (!isset($_SESSION['app'])) {\n    dashboard\\primary\\error(\"Application not selected\");\n    die(\"Application not selected.\");\n}\nif (isset($_POST['addsub'])) {\n    if (!is_numeric($_POST['level'])) {\n        dashboard\\primary\\error(\"Level must be a number!\");\n    } else {\n        $resp = misc\\sub\\add($_POST['subname'], $_POST['level']);\n        match($resp){\n            'failure' => dashboard\\primary\\error(\"Failed to create subscription!\"),\n            'success' => dashboard\\primary\\success(\"Successfully created subscription!\"),\n            default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n        };\n    }\n}\n\nif (isset($_POST['deletesub'])) {\n    $resp = misc\\sub\\deleteSingular($_POST['deletesub']);\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to delete subscription\"),\n        'success' => dashboard\\primary\\success(\"Successfully deleted subscription\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n\nif (isset($_POST['delallsubs'])){\n    $resp = misc\\sub\\deleteall();\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to delete subscriptions!\"),\n        'success' => dashboard\\primary\\success(\"Successfully deleted all subscriptions!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n\nif (isset($_POST['editsub'])) {\n    $subscription = misc\\etc\\sanitize($_POST['editsub']);\n    $query = misc\\mysql\\query(\"SELECT * FROM `subscriptions` WHERE `name` = ? AND `app` = ?\", [$subscription, $_SESSION['app']]);\n    if ($query->num_rows < 1) {\n        dashboard\\primary\\error(\"Subscription not Found!\");\n        echo \"<meta http-equiv='Refresh' Content='2'>\";\n        return;\n    }\n    $row = mysqli_fetch_array($query->result);\n    $level = $row[\"level\"];\n    echo  '\n    <div id=\"edit-file-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n        class=\"fixed grid place-items-center h-screen bg-black bg-opacity-60 z-50 p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n        <div class=\"relative w-full max-w-md max-h-full\">\n            <!-- Modal content -->\n            <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                <div class=\"px-6 py-6 lg:px-8\">\n                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Edit Subscription</h3>\n                    <form class=\"space-y-6\" method=\"POST\">\n                        <div>\n\n                        <div class=\"relative mb-4\">\n                        <input type=\"text\" inputmode=\"numeric\" id=\"level\" name=\"level\"\n                            class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                            placeholder=\" \" autocomplete=\"on\" value=\"' . $level . '\" maxlength=\"12\" required>\n                            <input type=\"hidden\" name=\"subscription\" value=\"' . $subscription . '\">\n                        <label for=\"level\"\n                            class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Subscription Level:</label>\n                    </div>\n\n                    \n                    </div>\n\n                        <button name=\"savesub\"\n                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Save\n                            Changes</button>\n                        <button\n                            class=\"w-full text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\" onClick=\"window.location.href=window.location.href\">Cancel\n                            </button>\n                    </form>\n                </div>\n            </div>\n        </div>\n    </div>\n    <!-- End Edit Account Modal -->';\n}\nif (isset($_POST['savesub'])) {\n    $subscription = misc\\etc\\sanitize($_POST['subscription']);\n    $level = misc\\etc\\sanitize($_POST['level']);\n\n    if (!is_numeric($_POST['level'])) {\n        dashboard\\primary\\error(\"Level must be a number!\");\n    } else {\n        misc\\mysql\\query(\"UPDATE `subscriptions` SET `level` = ? WHERE `name` = ? AND `app` = ?\", [$level, $subscription, $_SESSION['app']]);\n        if ($_SESSION['role'] == \"seller\") {\n            misc\\cache\\purge('KeyAuthSubscriptions:' . $_SESSION['app']);\n        }\n        dashboard\\primary\\success(\"Successfully Updated Subscription!\");\n        echo \"<meta http-equiv='Refresh' Content='2'>\";\n    }\n}\n?>\n\n<div class=\"p-4 bg-[#09090d] block sm:flex items-center justify-between lg:mt-1.5\">\n    <div class=\"mb-1 w-full bg-[#0f0f17] rounded-xl\">\n        <div class=\"mb-4 p-4\">\n            <?php require '../app/layout/breadcrumb.php'; ?>\n            <h1 class=\"text-xl font-semibold text-white-900 sm:text-2xl \">Subscriptions</h1>\n            <p class=\"text-xs text-gray-500\">Subscriptions act as levels/tiers. <a\n                    href=\"https://keyauth.readme.io/reference/subscriptions-1\" target=\"_blank\"\n                    class=\"text-blue-600  hover:underline\">Learn More</a>.</p>\n            <br>\n            <div class=\"p-4 flex flex-col\">\n                <div class=\"overflow-x-auto\">\n                    <!-- Subscripion Functions -->\n                    <button\n                        class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"create-subscription-modal\" data-modal-target=\"create-subscription-modal\">\n                        <i class=\"lni lni-circle-plus mr-2 mt-1\"></i>Create Subscription\n                    </button>\n                    <!-- End Subscription Functions -->\n\n                    <br>\n\n                    <!-- Delete Subscription Functions -->\n                    <button\n                        class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"delete-all-subs-modal\" data-modal-target=\"delete-all-subs-modal\">\n                        <i class=\"lni lni-trash-can mr-2 mt-1\"></i>Delete All Subscriptions\n                    </button>\n                    <!-- End Delete Subscription Functions -->\n\n                    <!-- Create Subscription Modal -->\n                    <div id=\"create-subscription-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <!-- Modal content -->\n                            <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                                <div class=\"px-6 py-6 lg:px-8\">\n                                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Create A Subscription</h3>\n                                    <hr class=\"h-px mb-4 mt-4 bg-gray-700 border-0\">\n                                    <form class=\"space-y-6\" method=\"POST\">\n                                        <div>\n\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" id=\"subname\" name=\"subname\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\" required>\n                                                <label for=\"subname\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Subscription\n                                                    Name</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" inputmode=\"numeric\" id=\"level\" name=\"level\"\n                                                    maxlength=\"12\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\" required>\n                                                <label for=\"level\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Subscription\n                                                    Level</label>\n                                            </div>\n\n\n                                        </div>\n                                        <button type=\"submit\" name=\"addsub\"\n                                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Create\n                                            Subscription</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Create Subscription Modal -->\n\n                    <!-- Delete All Subscriptions Modal -->\n                    <div id=\"delete-all-subs-modal\" tabindex=\"-1\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                        role=\"alert\">\n                                        <span class=\"sr-only\">Info</span>\n                                        <div>\n                                            <span class=\"font-medium\">Notice!</span> You're about to delete all of your\n                                            subscriptions. This can not be undone.\n                                        </div>\n                                    </div>\n                                    <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure you want to delete\n                                        all of your subscriptions?</h3>\n                                    <form method=\"POST\">\n                                        <button data-modal-hide=\"delete-all-subs-modal\" name=\"delallsubs\"\n                                            class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                            Yes, I'm sure\n                                        </button>\n                                        <button data-modal-hide=\"delete-all-subs-modal\" type=\"button\"\n                                            class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                            cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Delete All Keys Modal -->\n\n                    <!-- START TABLE -->\n                    <div class=\"relative overflow-x-auto shadow-md sm:rounded-lg pt-5\">\n                        <table id=\"kt_datatable_subs\" class=\"w-full text-sm text-left text-white\">\n                            <thead>\n                                <tr class=\"fw-bolder fs-6 text-blue-700 px-7\">\n                                    <th class=\"px-6 py-3\">Subscription Name</th>\n                                    <th class=\"px-6 py-3\">License Level</th>\n                                    <th class=\"px-6 py-3\">Actions</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                <?php\n                                if ($_SESSION['app']) {\n                                    $query = misc\\mysql\\query(\"SELECT * FROM `subscriptions` WHERE `app` = ?\", [$_SESSION['app']]);\n                                    if ($query->num_rows > 0){\n                                        while ($row = mysqli_fetch_array($query->result)){\n                                            echo \"<tr>\";\n                                            echo \"<td>\" . $row[\"name\"] . \"</td>\";\n                                            echo \"<td>\" . $row[\"level\"] . \"</td>\";\n\n                                            echo '<form method=\"POST\">\n                                            <td>\n                                            <div x-data=\"{ open: false }\" class=\"z-0\">\n                                            <button x-on:click=\"open = true\" class=\"flex items-center border border-gray-700 rounded-lg focus:opacity-60 text-white focus:text-white font-semibold rounded focus:outline-none focus:shadow-inner py-2 px-4\" type=\"button\">\n                                                    <span class=\"mr-1\">Actions</span>\n                                                    <svg class=\"fill-current h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\"  style=\"margin-top:3px\">\n                                                    <path d=\"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z\"/>\n                                                    </svg>\n                                            </button>\n                                            <ul x-show=\"open\" x-on:click.away=\"open = false\" class=\"bg-[#09090d] text-white rounded shadow-lg absolute py-2 mt-1\" style=\"min-width:15rem\">\n                                                    <li>\n                                                            <button name=\"deletesub\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-red-700\"\n                                                            value=\"' . $row[\"name\"] . '\">\n                                                            Delete Subscription\n                                                            </button>\n                                                    </li>\n                                                    <li>\n                                                            <button name=\"editsub\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-blue-700\"\n                                                            value=\"' . $row[\"name\"] . '\">\n                                                            Edit Subscription\n                                                            </button>\n                                                    </li>\n                                            </ul>\n                                            </div>\n                                            </td>\n                                            </tr>\n                                        </form>';\n                                        }\n                                    }\n                                }\n                            ?>\n\n                            </tbody>\n                        </table>\n                    </div>\n                    <p class=\"text-xs text-red-600\">Dropdown actions in <b>RED</b> do not show a confirmation!<a class=\"text-blue-700\"> Dropdown actions in <b>BLUE</b> will show a confirmation!</a></p>\n                    \n","size_bytes":17438},"app/pages/tokens.php":{"content":"<?php\nif ($_SESSION['role'] == \"Reseller\") {\n    header(\"location: ./?page=reseller-licenses\");\n\tdie();\n}\nif($role == \"Manager\" && !($permissions & 1)) {\n    misc\\auditLog\\send(\"Attempted (and failed) to view tokens.\");\n    dashboard\\primary\\error(\"You weren't granted permission to view this page!\");\n\tdie();\n}\nif(!isset($_SESSION['app'])) {\n    dashboard\\primary\\error(\"Application not selected\");\n\tdie(\"Application not selected.\");\n}\n?>\n\n<div class=\"p-4 bg-[#09090d] block sm:flex items-center justify-between lg:mt-1.5\">\n    <div class=\"mb-1 w-full bg-[#0f0f17] rounded-xl\">\n        <div class=\"mb-4 p-4\">\n            <?php require '../app/layout/breadcrumb.php'; ?>\n            <h1 lang class=\"text-xl font-semibold text-white-900 sm:text-2xl\">Tokens</h1>\n            <p class=\"text-xs text-gray-500\">Given to users to manage blacklists.</p>\n            <br>\n            <div class=\"p-4 flex flex-col\">\n                <div class=\"overflow-x-auto\">\n\n                    <!-- START TABLE -->\n                    <div class=\"relative overflow-x-auto shadow-md sm:rounded-lg pt-5\">\n                        <table id=\"kt_datatable_tokens\" class=\"w-full text-sm text-left text-white\">\n                            <thead>\n                                <tr class=\"fw-bolder fs-6 text-blue-700 px-7\">\n                                    <th class=\"px-6 py-3\">App</th>\n                                    <th class=\"px-6 py-3\">Token</th>\n                                    <th class=\"px-6 py-3\">Assigned</th>\n                                    <th class=\"px-6 py-3\">Banned</th>\n                                    <th class=\"px-6 py-3\">Reason</th>\n                                    <th class=\"px-6 py-3\">Hash</th>\n                                    <th class=\"px-6 py-3\">Type</th>\n                                    <th class=\"px-6 py-3\">Status</th>\n                                </tr>\n                            </thead>\n                        </table>\n                    </div>\n","size_bytes":1989},"app/pages/users.php":{"content":"<?php\nif ($_SESSION['role'] == \"Reseller\") {\n    header(\"location: ./?page=reseller-licenses\");\n    die();\n}\nif ($role == \"Manager\" && !($permissions & 2)) {\n    misc\\auditLog\\send(\"Attempted (and failed) to view users.\");\n    dashboard\\primary\\error(\"You weren't granted permission to view this page.\");\n    die();\n}\nif (!isset($_SESSION['app'])) {\n    dashboard\\primary\\error(\"Application not selected\");\n    die(\"Application not selected.\");\n}\n\nif (isset($_POST['saveuser'])) {\n    $un = misc\\etc\\sanitize(urldecode($_POST['saveuser']));\n    $username = misc\\etc\\sanitize($_POST['username']);\n    $hwid = misc\\etc\\sanitize($_POST['hwid']);\n    $pass = misc\\etc\\sanitize($_POST['pass']);\n    $email = misc\\etc\\sanitize($_POST['email']);\n    $client2fa = misc\\etc\\sanitize($_POST['client2fa']);\n    if (isset($hwid) && trim($hwid) != '') {\n        $query = misc\\mysql\\query(\"SELECT `hwid` FROM `users` WHERE `username` = ? AND `app` = ?\", [$un, $_SESSION['app']]);\n        $row = mysqli_fetch_array($query->result);\n        $oldHwid = $row[\"hwid\"];\n        $oldHwid = $oldHwid .= $hwid;\n        $query = misc\\mysql\\query(\"UPDATE `users` SET `hwid` = ? WHERE `username` = ? AND `app` = ?\", [$oldHwid, $un, $_SESSION['app']]);\n        if ($query->affected_rows) {\n            dashboard\\primary\\success(\"Successfully updated user!\");\n            misc\\cache\\purge('KeyAuthUser:' . $_SESSION['app'] . ':' . $un);\n        } else {\n            dashboard\\primary\\error(\"Failed to update user!\");\n        }\n    }\n    if (isset($username) && trim($username) != '') {\n        $resp = misc\\user\\changeUsername($un, $username, $_SESSION['app']);\n        match($resp){\n            'already_used' => dashboard\\primary\\error(\"Username already used!\"),\n            'failure' => dashboard\\primary\\error(\"Failed to change username!\"),\n            'success' => dashboard\\primary\\success(\"Successfully changed username!\"),\n            default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n        };\n    }\n    if (isset($pass) && trim($pass) != '') {\n        $resp = misc\\user\\changePassword($un, $pass, $_SESSION['app']);\n        match($resp){\n            'failure' => dashboard\\primary\\error(\"Failed to change password!\"),\n            'success' => dashboard\\primary\\success(\"Successfully changed password!\"),\n            default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n        };\n    }\n    if (isset($email) && trim($email) != '') {\n        $resp = misc\\user\\changeEmail($un, $email, $_SESSION['app']);\n        match($resp){\n            'failure' => dashboard\\primary\\error(\"Failed to change email!\"),\n            'success' => dashboard\\primary\\success(\"Successfully changed email!\"),\n            default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n        };\n    }\n    if (isset($client2fa)){\n        $resp = misc\\user\\disable2fa($un, $_SESSION['app']);\n        match($resp){\n            'failure' => dashboard\\primary\\error(\"Failed to disabled 2fa\"),\n            'success' => dashboard\\primary\\success(\"Successfully disabled 2fa\"),\n            default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n        };\n    }\n}\n\nif (isset($_POST['deletevar'])) {\n    $resp = misc\\user\\deleteVar(urldecode($_POST['deletevar']), $_POST['var']);\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to delete variable\"),\n        'success' => dashboard\\primary\\success(\"Successfully deleted variable\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['deletesub'])) {\n    $sub = misc\\etc\\sanitize($_POST['sub']);\n\n    $resp = misc\\user\\deleteSub(urldecode($_POST['deletesub']), $sub);\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to delete subscription\"),\n        'success' => dashboard\\primary\\success(\"Successfully deleted subscription\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['dlusers'])) {\n    echo \"<meta http-equiv='Refresh' Content='0; url=download-types.php?type=users'>\";\n}\nif (isset($_POST['importusersFile'])) {\n    if ($_FILES['file_input']['error'] === UPLOAD_ERR_OK){\n        $fileContent = file_get_contents($_FILES['file_input']['tmp_name']);\n        $json = json_decode($fileContent);\n\n        if ($json === null){\n            dashboard\\primary\\error(\"Invalid JSON file. Double check the format you're selecting.\");\n            return;\n        }\n\n        if (isset($json->users) && isset($json->subscription)){\n            foreach ($json->users as $user){\n                $username = $user->username;\n                $email = $user->email;\n                $password = $user->password;\n                $hwid = $user->hwid;\n                $banned = $user->banned;\n                $ip = $user->ip;\n                $expiry = $user->expiry;\n    \n                $users = misc\\mysql\\query(\"SELECT * FROM `users` WHERE `app` = ?\", [$_SESSION[\"app\"]]);\n    \n                $userrows = mysqli_fetch_all($users->result, MYSQLI_ASSOC);\n    \n                foreach ($userrows as $user) {\n                    if ($user[\"username\"] === $username) {\n                        dashboard\\primary\\error(\"User $username Already Exists\");\n                        return;\n                    } \n                }\n                misc\\mysql\\query(\"INSERT INTO `users` (`username`, `email`, `password`, `hwid`, `app`,`owner`, `createdate`, `banned`, `ip`) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\", [$username, $email, $password, $hwid, $_SESSION['app'], $_SESSION['username'], time(), $banned, $ip]);\n            }\n\n            foreach ($json->subscription as $sub){\n                $username = $sub->user;\n                $expiry = $sub->expiry;\n    \n                misc\\mysql\\query(\"INSERT INTO `subs` (`user`, `subscription`, `expiry`, `app`) VALUES (?, 'default', ?, ?)\", [$username, $expiry, $_SESSION['app']]);\n            }\n\n            dashboard\\primary\\success(\"Successfully imported user!\");\n        } else {\n            dashboard\\primary\\error(\"Invalid JSON file. Double check the format you're selecting.\");\n        }\n    } else {\n        dashboard\\primary\\error(\"Unhandled Error! Contact support if you need help!\");\n    }\n}\nif (isset($_POST['extenduser'])) {\n    $activeOnly = ($_POST['activeOnly'] == \"on\") ? 1 : 0;\n    $expiry = time() + $_POST['time'] * $_POST['expiry'];\n    $resp = misc\\user\\extend(urldecode($_POST['user']), $_POST['sub'], $expiry, $activeOnly);\n    match($resp){\n        'missing' => dashboard\\primary\\error(\"User(s) not found!\"),\n        'sub_missing' => dashboard\\primary\\error(\"Subscription not found!\"),\n        'date_past' => dashboard\\primary\\error(\"Subscription expiry must be set in the future!\"),\n        'failure' => dashboard\\primary\\error(\"Failed to extend user(s)\"),\n        'success' => dashboard\\primary\\success(\"Successfully exteneded user(s)!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['subtractuser'])) {\n    $expiry = $_POST['time'] * $_POST['expiry'];\n    $resp = misc\\user\\subtract(urldecode($_POST['user']), $_POST['sub'], $expiry, $secret);\n    match($resp){\n        'invalid_seconds' => dashboard\\primary\\error(\"Seconds specified must be greater than zero\"),\n        'failure' => dashboard\\primary\\error(\"Failed to subtract time from subscription\"),\n        'success' => dashboard\\primary\\success(\"Successfully subtracted time from subscription\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['adduser'])) {\n    $resp = misc\\user\\add(urldecode($_POST['username']), $_POST['sub'], strtotime($_POST['expiry']), NULL, $_POST['password']);\n    match($resp){\n        'already_exist' => dashboard\\primary\\error(\"Username already exists!\"),\n        'sub_missing' => dashboard\\primary\\error(\"Subscription not found!\"),\n        'date_past' => dashboard\\primary\\error(\"Subscription expiry must be set in the future!\"),\n        'username_not_allowed' => dashboard\\primary\\error(\"This username is not allowed\"),\n        'failure' => dashboard\\primary\\error(\"Failed to create user!\"),\n        'success' => dashboard\\primary\\success(\"Successfully created user!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['delexpusers'])) {\n    $resp = misc\\user\\deleteExpiredUsers();\n    match($resp){\n        'missing' => dashboard\\primary\\error(\"You do not have users!\"),\n        'failure' => dashboard\\primary\\error(\"No users are expired!\"),\n        'success' => dashboard\\primary\\success(\"Successfully deleted expired users!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['delusers'])) {\n    $resp = misc\\user\\deleteAll();\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to delete all users!\"),\n        'success' => dashboard\\primary\\success(\"Successfully deleted all users!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['resetall'])) {\n    $resp = misc\\user\\resetAll();\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to reset all users!\"),\n        'success' => dashboard\\primary\\success(\"Successfully reset all users!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['unbanall'])) {\n    $resp = misc\\user\\unbanAll();\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to unban all users!\"),\n        'success' => dashboard\\primary\\success(\"Successfully unbanned all users!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['deleteuser'])) {\n    $resp = misc\\user\\deleteSingular(urldecode($_POST['deleteuser']));\n    match ($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to delete user!\"),\n        'success' => dashboard\\primary\\success(\"Successfully deleted user!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['resetuser'])) {\n    $resp = misc\\user\\resetSingular(urldecode($_POST['resetuser']));\n    match ($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to reset user!\"),\n        'success' => dashboard\\primary\\success(\"Successfully reset user!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['setvar'])) {\n    if(strlen($_POST['data']) > 500) {\n        dashboard\\primary\\error(\"Variable data must be 500 characters or less!\");\n    }\n    else {\n        $readOnly = misc\\etc\\sanitize($_POST['readOnly']) == NULL ? 0 : 1;\n        $resp = misc\\user\\setVariable(urldecode($_POST['user']), $_POST['var'], $_POST['data'], null, $readOnly);\n        match($resp){\n            'missing' => dashboard\\primary\\error(\"No users found!\"),\n            'failure' => dashboard\\primary\\error(\"Failed to set variable!\"),\n            'success' => dashboard\\primary\\success(\"Successfully set variable!\"),\n            default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n        };\n    }\n}\nif (isset($_POST['banuser'])) {\n    $resp = misc\\user\\ban(urldecode($_POST['un']), $_POST['reason']);\n    match($resp){\n        'missing' => dashboard\\primary\\error(\"User not found!\"),\n        'failure' => dashboard\\primary\\error(\"Failed to ban user!\"),\n        'success' => dashboard\\primary\\success(\"Successfully banned user!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['unbanuser'])) {\n    $resp = misc\\user\\unban(urldecode($_POST['unbanuser']));\n    match($resp){\n        'missing' => dashboard\\primary\\error(\"User not found!\"),\n        'failure' => dashboard\\primary\\error(\"Failed to unban user!\"),\n        'success' => dashboard\\primary\\success(\"Successfully unbanned user!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\nif (isset($_POST['pauseuser'])) {\n    $resp = misc\\user\\pauseUser(urldecode($_POST['pauseuser']));\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to pause user!\"),\n        'success' => dashboard\\primary\\success(\"Successfully paused user!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact support if you need help\")\n    };\n}\nif (isset($_POST['unpauseuser'])) {\n    $resp = misc\\user\\unpauseUser(urldecode($_POST['unpauseuser']));\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to unpause user!\"),\n        'success' => dashboard\\primary\\success(\"Successfully unpaused user!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact support if you need help\")\n    };\n}\n\nif (isset($_POST['edituser'])) {\n    $un = misc\\etc\\sanitize(urldecode($_POST['edituser']));\n    $query = misc\\mysql\\query(\"SELECT * FROM `users` WHERE `username` = ? AND `app` = ?\", [$un, $_SESSION['app']]);\n    if ($query->num_rows == 0) {\n        dashboard\\primary\\error(\"User not Found!\");\n        echo \"<meta http-equiv='Refresh' Content='2'>\";\n        return;\n    }\n    $row = mysqli_fetch_array($query->result);\n?>\n\n                    <!-- Edit User Modal -->\n                    <div id=\"edit-user-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                        class=\"fixed grid place-items-center h-screen bg-black bg-opacity-60 z-50 p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <!-- Modal content -->\n                            <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                                <div class=\"px-6 py-6 lg:px-8\">\n                                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Edit User</h3>\n                                    <form class=\"space-y-6\" method=\"POST\">\n                                        <div>\n\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" id=\"username\" name=\"username\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\">\n                                                <label for=\"username\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Username:</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"password\" id=\"pass\" name=\"pass\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\">\n                                                <label for=\"pass\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Password:</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"email\" id=\"email\" name=\"email\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \">\n                                                <label for=\"email\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Email:</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4 pt-3\">\n                                                <select id=\"sub\" name=\"sub\"\n                                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\">\n                                                    <?php\n                                                $query = misc\\mysql\\query(\"SELECT * FROM `subs` WHERE `user` = ? AND `app` = ? AND `expiry` > ?\", [$un, $_SESSION['app'], time()], \"ssi\");\n                                                $rows = array();\n                                                while ($r = mysqli_fetch_assoc($query->result)) {\n                                                    $rows[] = $r;\n                                                }\n                                                foreach ($rows as $subrow) {\n                                                    $sub = $subrow['subscription'];\n                                                    $value = \"[\" . $subrow['subscription'] . \"] - Expires: <script>document.write(convertTimestamp(\" . $subrow[\"expiry\"] . \"));</script>\";\n                                                ?>\n                                                    <option value=\"<?= $sub; ?>\">\n                                                    <?= $value; ?></option>\n                                                    <?php\n                                                }\n                                                ?>\n                                                </select>\n                                                <label for=\"sub\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">User\n                                                    Subscription</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4 pt-3\">\n                                                <select id=\"var\" name=\"var\"\n                                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\">\n                                                    <?php\n                                                        $query = misc\\mysql\\query(\"SELECT `name`,`data` FROM `uservars` WHERE `user` = ? AND `app` = ?\", [$un, $_SESSION['app']]);\n                                                        $rows = array();\n                                                        while ($r = mysqli_fetch_assoc($query->result)) {\n                                                            $rows[] = $r;\n                                                        }\n                                                        foreach ($rows as $varrow) {\n                                                            $value = $varrow['name'] . \" : \" . $varrow[\"data\"];\n                                                        ?>\n\n                                                    <option value=\"<?= $varrow['name']; ?>\">\n                                                        <?= $value; ?></option>\n\n                                                    <?php\n                                                    }\n                                                    ?>\n                                                </select>\n                                                <label for=\"var\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">User\n                                                    Variable</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4 pt-3\">\n                                                <select id=\"client2fa\" name=\"client2fa\"\n                                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\">\n                                                    <?php\n                                                        $query = misc\\mysql\\query(\"SELECT `2fa` FROM `users` WHERE `username` = ? AND `app` = ?\", [$un, $_SESSION['app']]);\n                                                        if ($query->num_rows > 0){\n                                                            $client2fa = $row[\"2fa\"];\n                                                        }\n                                                    ?>\n\n                                                    <option value=\"0\"\n                                                        <?= $client2fa == 0 ? ' selected=\"selected\"' : ''; ?>>\n                                                        Disabled</option>\n                                                    <option value=\"1\"\n                                                        <?= $client2fa == 1 ? ' selected=\"selected\"' : ''; ?>>\n                                                        Enabled</option>\n\n                                                </select>\n                                                <label for=\"client2fa\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">2FA</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" id=\"hwid\" name=\"hwid\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \">\n                                                <label for=\"hwid\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Additional\n                                                    HWID:</label>\n                                            </div>\n\n                                            <p class=\"text-xs text-white-500\">HWID: <?= $row['hwid'] ?? \"N/A\"; ?>\n                                            </p>\n                                            <p class=\"text-xs text-white-500\">IP: <?= $row['ip']?? \"N/A\";?></p>\n\n                                        </div>\n                                        <div\n                                            style=\"display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;\">\n\n                                            <button name=\"deletesub\"\n                                                class=\"w-full text-white bg-orange-700 hover:bg-orange-800 focus:ring-4 focus:outline-none focus:ring-orange-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\"\n                                                value=\"<?= urlencode($un); ?>\">Delete Subscription</button>\n\n                                            <button name=\"saveuser\"\n                                                class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\"\n                                                value=\"<?= urlencode($un); ?>\">Save Changes</button>\n\n\n                                            <button name=\"deletevar\"\n                                                class=\"w-full text-white bg-yellow-700 hover:bg-yellow-800 focus:ring-4 focus:outline-none focus:ring-yellow-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\"\n                                                value=\"<?= urlencode($un); ?>\">Delete User Variable</button>\n\n                                            <button\n                                                class=\"w-full text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\"\n                                                onClick=\"window.location.href=window.location.href\">Cancel</button>\n                                        </div>\n\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Edit User Modal -->\n                    <?php\n}\n?>\n\n<div class=\"p-4 bg-[#09090d] block sm:flex items-center justify-between lg:mt-1.5\">\n    <div class=\"mb-1 w-full bg-[#0f0f17] rounded-xl\">\n        <div class=\"mb-4 p-4\">\n            <?php require '../app/layout/breadcrumb.php'; ?>\n            <h1 class=\"text-xl font-semibold text-white-900 sm:text-2xl \">Users</h1>\n            <p class=\"text-xs text-gray-500\">After someone registers for your app with a license, they will appear here.\n                <a href=\"https://keyauth.readme.io/reference/users-1\" target=\"_blank\"\n                    class=\"text-blue-600  hover:underline\">Learn More</a>.\n            </p>\n            <br>\n            <div class=\"p-4 flex flex-col\">\n                <div class=\"overflow-x-auto\">\n                    <form method=\"POST\">\n                        <!-- User Functions -->\n                        <button type=\"button\"\n                            class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                            data-modal-toggle=\"create-user-modal\" data-modal-target=\"create-user-modal\">\n                            <i class=\"lni lni-circle-plus mr-2 mt-1\"></i>Create User\n                        </button>\n                        <button type=\"button\"\n                            class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                            data-modal-toggle=\"set-user-var-modal\" data-modal-target=\"set-user-var-modal\">\n                            <i class=\"lni lni-circle-plus mr-2 mt-1\"></i>Set User Variable\n                        </button>\n                        <button type=\"button\"\n                            class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                            data-modal-toggle=\"extend-user-modal\" data-modal-target=\"extend-user-modal\">\n                            <i class=\"lni lni-timer mr-2 mt-1\"></i>Extend User(s)\n                        </button>\n                        <button type=\"button\"\n                            class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                            data-modal-toggle=\"subtract-user-modal\" data-modal-target=\"subtract-user-modal\">\n                            <i class=\"lni lni-timer mr-2 mt-1\"></i>Subtract User(s)\n                        </button>\n                        <button type=\"button\"\n                            class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                            data-modal-toggle=\"import-users-modal\" data-modal-target=\"import-users-modal\">\n                            <i class=\"lni lni-upload mr-2 mt-1\"></i>Import Users\n                        </button>\n                        <button\n                            class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                            name=\"dlusers\">\n                            <i class=\"lni lni-download mr-2 mt-1\"></i>Export Users\n                        </button>\n                        <!-- End User Functions -->\n                    </form>\n\n\n                    <!-- Delete User Functions -->\n                    <button\n                        class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"del-all-users-modal\" data-modal-target=\"del-all-users-modal\">\n                        <i class=\"lni lni-trash-can mr-2 mt-1\"></i>Delete All Users\n                    </button>\n                    <button\n                        class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"del-expired-users-modal\" data-modal-target=\"del-expired-users-modal\">\n                        <i class=\"lni lni-trash-can mr-2 mt-1\"></i>Delete Expired Users\n                    </button>\n                    <button\n                        class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"reset-all-users-hwid-modal\" data-modal-target=\"reset-all-users-hwid-modal\">\n                        <i class=\"lni lni-reload mr-2 mt-1\"></i>Reset All Users HWID\n                    </button>\n                    <button\n                        class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"unban-all-users-modal\" data-modal-target=\"unban-all-users-modal\">\n                        <i class=\"lni lni-trash-can mr-2 mt-1\"></i>Unban All Users\n                    </button>\n                    <!-- End Delete User Functions -->\n\n                    <!-- Create User Modal -->\n                    <div id=\"create-user-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <!-- Modal content -->\n                            <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                                <div class=\"px-6 py-6 lg:px-8\">\n                                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Create User</h3>\n                                    <hr class=\"h-px mb-4 mt-4 bg-gray-700 border-0\">\n                                    <form class=\"space-y-6\" method=\"POST\">\n                                        <div>\n\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" id=\"username\" name=\"username\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\">\n                                                <label for=\"username\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Username</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"password\" id=\"password\" name=\"password\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\">\n                                                <label for=\"password\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Password</label>\n                                            </div>\n\n                                            <!-- drawer init and toggle -->\n                                            <div class=\"text-center\">\n                                                <button\n                                                    class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\"\n                                                    type=\"button\" data-drawer-target=\"drawer-right-example\"\n                                                    data-drawer-show=\"drawer-right-example\"\n                                                    data-drawer-placement=\"right\" aria-controls=\"drawer-right-example\">\n                                                    Use KeyAuth Password Generator\n                                                </button>\n                                            </div>\n\n                                            <div class=\"relative mb-4 pt-3\">\n                                                <select id=\"sub\" name=\"sub\"\n                                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\">\n                                                    <?php\n                                                    $query = misc\\mysql\\query(\"SELECT * FROM `subscriptions` WHERE `app` = ? ORDER BY `level` ASC\", [$_SESSION['app']]);\n                                                    if ($query->num_rows > 0) {\n                                                        while ($row = mysqli_fetch_array($query->result)) {\n                                                            echo \"  <option value=\\\"\" . $row[\"name\"] . \"\\\">\" . $row[\"name\"] . \"</option>\";\n                                                        }\n                                                    }\n                                                ?>\n                                                </select>\n                                            </div>\n\n                                            <div class=\"relative max-w-sm\">\n                                                <div\n                                                    class=\"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none\">\n                                                    <svg class=\"w-4 h-4 text-gray-500 \" aria-hidden=\"true\"\n                                                        xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\"\n                                                        viewBox=\"0 0 20 20\">\n                                                        <path\n                                                            d=\"M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z\" />\n                                                    </svg>\n                                                </div>\n                                                <?php\n                                                echo '\n                                                <input datepicker datepicker-autohide type=\"datetime-local\"\n                                                    name=\"expiry\"\n                                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 \"\n                                                    placeholder=\"Subscription Expiry\"\n                                                    value=\"' . date(\"Y-m-d\\TH:i\", time() + 3600) .'\" required>';?>\n                                            </div>\n\n                                            <!-- Password Generator -->\n                                            <div id=\"drawer-right-example\"\n                                                class=\"fixed top-0 right-0 z-40 h-screen p-4 overflow-y-auto transition-transform translate-x-full bg-[#0f0f17] border border-blue-700 w-80\"\n                                                tabindex=\"-1\" aria-labelledby=\"drawer-right-label\">\n                                                <h5 id=\"drawer-right-label\"\n                                                    class=\"inline-flex items-center mb-4 text-base font-semibold text-white-500\">\n                                                    KeyAuth Password Generator</h5>\n                                                <button type=\"button\" data-drawer-hide=\"drawer-right-example\"\n                                                    aria-controls=\"drawer-right-example\"\n                                                    class=\"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 absolute top-2.5 right-2.5 inline-flex items-center justify-center\">\n                                                    <svg class=\"w-3 h-3\" aria-hidden=\"true\"\n                                                        xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\"\n                                                        viewBox=\"0 0 14 14\">\n                                                        <path stroke=\"currentColor\" stroke-linecap=\"round\"\n                                                            stroke-linejoin=\"round\" stroke-width=\"2\"\n                                                            d=\"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6\" />\n                                                    </svg>\n                                                    <span class=\"sr-only\">Close menu</span>\n                                                </button>\n                                                <p class=\"mb-6 text-sm text-gray-500 \">Need help generating a secure,\n                                                    strong, and original password? Use our password generator!</p>\n\n                                                <div class=\"w-full mb-4 border border-gray-200 rounded-lg bg-[#0f0f17]\">\n                                                    <div class=\"px-4 py-2 bg-[#0f0f17] rounded-t-lg\">\n                                                        <label for=\"genpw\" class=\"sr-only\">Generated Password</label>\n                                                        <textarea id=\"genpw\"\n                                                            class=\"copy-target w-full px-0 text-sm text-white-900 bg-[#0f0f17] border-0 focus:ring-0\"\n                                                            placeholder=\"\" readonly></textarea>\n                                                    </div>\n\n                                                    <div class=\"flex items-center justify-between px-3 py-2 border-t\">\n                                                        <button type=\"button\" data-copy-target=\"genpw\"\n                                                            class=\"copy-button inline-flex items-center py-2.5 px-4 text-xs font-medium text-center text-white bg-blue-700 rounded-lg focus:ring-4 focus:ring-blue-200 hover:bg-blue-800\">\n                                                            Copy\n                                                        </button>\n\n\n                                                    </div>\n\n                                                </div>\n                                                <label for=\"default-range\"\n                                                    class=\"block mb-2 text-sm font-medium text-white-900\">Password\n                                                    Range [13-121]</label>\n                                                <input id=\"default-range\" type=\"range\" min=\"13\" max=\"32\" value=\"50\"\n                                                    class=\"w-full h-2 bg-[#0f0f17] rounded-lg appearance-none cursor-pointer\"\n                                                    onchange=\"updateGeneratedPassword(this.value)\"></input>\n                                                <div class=\"px-4 py-2 bg-[#0f0f17] rounded-t-lg\">\n                                                    <input id=\"length\"\n                                                        class=\"w-full px-0 text-sm text-white-900 bg-[#0f0f17] border-0 focus:ring-0\"\n                                                        readonly></input>\n                                                </div>\n                                            </div>\n\n                                        </div>\n                                        <button name=\"adduser\"\n                                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Add\n                                            User</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Create User Modal -->\n\n                    <!-- Set User Var Modal -->\n                    <div id=\"set-user-var-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <!-- Modal content -->\n                            <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                                <div class=\"px-6 py-6 lg:px-8\">\n                                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Set User Variable</h3>\n                                    <hr class=\"h-px mb-4 mt-4 bg-gray-700 border-0\">\n                                    <form class=\"space-y-6\" method=\"POST\">\n                                        <div>\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" id=\"user\" name=\"user\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\">\n                                                <label for=\"user\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">User</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" id=\"var\" name=\"var\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\"\" autocomplete=\"on\" list=\"vars\" required>\n                                                <datalist id=\"vars\">\n                                                    <?php\n                                                        $query = misc\\mysql\\query(\"SELECT DISTINCT `name` FROM `uservars` WHERE `app` = ?\", [$_SESSION['app']]);\n                                                        if ($query->num_rows > 0) {\n                                                            while ($row = mysqli_fetch_array($query->result)) {\n                                                                echo \"  <option value=\\\"\" . $row[\"name\"] . \"\\\">\" . $row[\"name\"] . \"</option>\";\n                                                            }\n                                                        }\n                                                    ?>\n                                                </datalist>\n                                                <label for=\"var\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Variable</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <label for=\"data\" name=\"data\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">User\n                                                    Variable Data</label>\n                                                <textarea id=\"data\" name=\"data\" rows=\"4\"\n                                                    class=\"block p-2.5 w-full text-sm text-white-900 bg-[#0f0f17] rounded-lg border border-gray-700 focus:ring-blue-500 focus:border-blue-500\"\n                                                    placeholder=\"\" maxlength=\"500\" required></textarea>\n                                            </div>\n                                        </div>\n\n                                        <div class=\"flex items-center mb-4\">\n                                            <input id=\"readOnly\" name=\"readOnly\" type=\"checkbox\" value=\"\"\n                                                class=\"w-4 h-4 text-blue-600 bg-[#0f0f17] border-gray-300 rounded focus:ring-blue-500 focus:ring-2\"\n                                                checked>\n                                            <label for=\"readOnly\"\n                                                class=\"ml-2 text-sm font-medium text-white-900\">Readonly</label>\n                                        </div>\n                                        <button name=\"setvar\"\n                                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Set\n                                            User Var</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Set User Var Modal -->\n\n                    <!-- Extend User Modal -->\n                    <div id=\"extend-user-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <!-- Modal content -->\n                            <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                                <div class=\"px-6 py-6 lg:px-8\">\n                                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Extend User(s)</h3>\n                                    <hr class=\"h-px mb-4 mt-4 bg-gray-700 border-0\">\n                                    <form class=\"space-y-6\" method=\"POST\">\n                                        <div>\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" id=\"user\" name=\"user\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\">\n                                                <label for=\"user\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">User</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <select id=\"sub\" name=\"sub\"\n                                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\">\n                                                    <?php\n                                                        $query = misc\\mysql\\query(\"SELECT * FROM `subscriptions` WHERE `app` = ? ORDER BY `level` ASC\", [$_SESSION['app']]);\n                                                        if ($query->num_rows > 0) {\n                                                            while ($row = mysqli_fetch_array($query->result)) {\n                                                                echo \"  <option value=\\\"\" . $row[\"name\"] . \"\\\">\" . $row[\"name\"] . \"</option>\";\n                                                            }\n                                                        }\n                                                    ?>\n                                                </select>\n                                                <label for=\"sub\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Subscription</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <select id=\"expiry\" name=\"expiry\"\n                                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\">\n                                                    <option value=\"1\">Seconds</option>\n                                                    <option value=\"60\">Minutes</option>\n                                                    <option value=\"3600\">Hours</option>\n                                                    <option value=\"86400\">Days</option>\n                                                    <option value=\"604800\">Weeks</option>\n                                                    <option value=\"2629743\">Months</option>\n                                                    <option value=\"31556926\">Years</option>\n                                                    <option value=\"315569260\">Lifetime</option>\n                                                </select>\n                                                <label for=\"expiry\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">License\n                                                    Expiry Unit</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" inputmode=\"numeric\" id=\"time\" name=\"time\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\">\n                                                <label for=\"time\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Time\n                                                    To Add</label>\n                                            </div>\n                                        </div>\n\n                                        <div class=\"flex items-center mb-4\">\n                                            <input id=\"activeOnly\" name=\"activeOnly\" type=\"checkbox\" value=\"\"\n                                                class=\"w-4 h-4 text-blue-600 bg-[#0f0f17] border-gray-300 rounded focus:ring-blue-500 focus:ring-2\"\n                                                checked>\n                                            <label for=\"activeOnly\"\n                                                class=\"ml-2 text-sm font-medium text-white-900\">Active users\n                                                only</label>\n                                        </div>\n                                        <button name=\"extenduser\"\n                                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Extend\n                                            User(s)</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Extend User Modal -->\n\n                    <!-- Extend Subtract User Modal -->\n                    <div id=\"subtract-user-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <!-- Modal content -->\n                            <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                                <div class=\"px-6 py-6 lg:px-8\">\n                                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Subtract Time From User(s)</h3>\n                                    <hr class=\"h-px mb-4 mt-4 bg-gray-700 border-0\">\n                                    <form class=\"space-y-6\" method=\"POST\">\n                                        <div>\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" id=\"user\" name=\"user\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\">\n                                                <label for=\"user\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">User</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <select id=\"sub\" name=\"sub\"\n                                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\">\n                                                    <?php\n                                                         $query = misc\\mysql\\query(\"SELECT * FROM `subscriptions` WHERE `app` = ? ORDER BY `level` ASC\", [$_SESSION['app']]);\n                                                         if ($query->num_rows > 0) {\n                                                             while ($row = mysqli_fetch_array($query->result)) {\n                                                                 echo \"  <option value=\\\"\" . $row[\"name\"] . \"\\\">\" . $row[\"name\"] . \"</option>\";\n                                                             }\n                                                         }\n                                                    ?>\n                                                </select>\n                                                <label for=\"sub\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Subscription</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <select id=\"expiry\" name=\"expiry\"\n                                                    class=\"bg-[#0f0f17] border border-gray-700 text-white-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5\">\n                                                    <option value=\"1\">Seconds</option>\n                                                    <option value=\"60\">Minutes</option>\n                                                    <option value=\"3600\">Hours</option>\n                                                    <option value=\"86400\">Days</option>\n                                                    <option value=\"604800\">Weeks</option>\n                                                    <option value=\"2629743\">Months</option>\n                                                    <option value=\"31556926\">Years</option>\n                                                    <option value=\"315569260\">Lifetime</option>\n                                                </select>\n                                                <label for=\"expiry\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">License\n                                                    Expiry Unit</label>\n                                            </div>\n\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" inputmode=\"numeric\" id=\"time\" name=\"time\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\">\n                                                <label for=\"time\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Time\n                                                    To Subtract</label>\n                                            </div>\n                                        </div>\n                                        <button name=\"subtractuser\"\n                                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Subtract\n                                            Time From User(s)</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Subtact User Modal -->\n\n                    <!-- Import Users Modal -->\n                    <div id=\"import-users-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <!-- Modal content -->\n                            <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                                <div class=\"px-6 py-6 lg:px-8\">\n                                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Import Users .json</h3>\n                                    <hr class=\"h-px mb-4 mt-4 bg-gray-700 border-0\">\n                                    <form class=\"space-y-6\" method=\"POST\" enctype=\"multipart/form-data\">\n                                        <div class=\"relative\">\n                                            <input\n                                                class=\"block w-full text-sm text-gray-400 border border-gray-700 rounded-lg cursor-pointer focus:outline-none\"\n                                                id=\"file_input\" name=\"file_input\" type=\"file\">\n                                        </div>\n                                        <button name=\"importusersFile\"\n                                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Import\n                                            Users</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Import Users Modal -->\n\n\n                    <!-- Delete All Users Modal -->\n                    <div id=\"del-all-users-modal\" tabindex=\"-1\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                        role=\"alert\">\n                                        <span class=\"sr-only\">Info</span>\n                                        <div>\n                                            <span class=\"font-medium\">Notice!</span> You're about to delete all your\n                                            users. This can not be undone.\n                                        </div>\n                                    </div>\n                                    <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure you want to delete\n                                        all of your users?</h3>\n                                    <form method=\"POST\">\n                                        <button data-modal-hide=\"del-all-users-modal\" name=\"delusers\"\n                                            class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                            Yes, I'm sure\n                                        </button>\n                                        <button data-modal-hide=\"del-all-users-modal\" type=\"button\"\n                                            class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                            cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Delete All Users Modal -->\n\n                    <!-- Delete Expired Users Modal -->\n                    <div id=\"del-expired-users-modal\" tabindex=\"-1\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                        role=\"alert\">\n                                        <span class=\"sr-only\">Info</span>\n                                        <div>\n                                            <span class=\"font-medium\">Notice!</span> You're about to delete all your\n                                            expired users. This can not be undone.\n                                        </div>\n                                    </div>\n                                    <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure you want to delete\n                                        all of your expired users?</h3>\n                                    <form method=\"POST\">\n                                        <button data-modal-hide=\"del-expired-users-modal\" name=\"delexpusers\"\n                                            class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                            Yes, I'm sure\n                                        </button>\n                                        <button data-modal-hide=\"del-expired-users-modal\" type=\"button\"\n                                            class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                            cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Expired All Users Modal -->\n\n                    <!-- Reset All Users HWID Modal -->\n                    <div id=\"reset-all-users-hwid-modal\" tabindex=\"-1\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                        role=\"alert\">\n                                        <span class=\"sr-only\">Info</span>\n                                        <div>\n                                            <span class=\"font-medium\">Notice!</span> You're about to reset all users\n                                            HWIDs.\n                                        </div>\n                                    </div>\n                                    <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure you want to reset\n                                        the HWID of all users?</h3>\n                                    <form method=\"POST\">\n                                        <button data-modal-hide=\"reset-all-users-hwid-modal\" name=\"resetall\"\n                                            class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                            Yes, I'm sure\n                                        </button>\n                                        <button data-modal-hide=\"reset-all-users-hwid-modal\" type=\"button\"\n                                            class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                            cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Reset All Users HWID Modal -->\n\n                    <!-- Unban All Users Modal -->\n                    <div id=\"unban-all-users-modal\" tabindex=\"-1\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                        role=\"alert\">\n                                        <span class=\"sr-only\">Info</span>\n                                        <div>\n                                            <span class=\"font-medium\">Notice!</span> You're about to unban all banned\n                                            users.\n                                        </div>\n                                    </div>\n                                    <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure you want to unban\n                                        all banned users?</h3>\n                                    <form method=\"POST\">\n                                        <button data-modal-hide=\"unban-all-users-modal\" name=\"unbanall\"\n                                            class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                            Yes, I'm sure\n                                        </button>\n                                        <button data-modal-hide=\"unban-all-users-modal\" type=\"button\"\n                                            class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                            cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Unban All Users Modal -->\n\n                    <!-- Ban User Modal -->\n                    <div id=\"ban-user\" tabindex=\"-1\" aria-hidden=\"true\"\n                        class=\"fixed grid place-items-center hidden h-screen bg-black bg-opacity-60 z-50 p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <!-- Modal content -->\n                            <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                                <div class=\"px-6 py-6 lg:px-8\">\n                                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Ban User</h3>\n                                    <form class=\"space-y-6\" method=\"POST\">\n                                        <div>\n\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" id=\"reason\" name=\"reason\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\"\" autocomplete=\"on\" maxlength=\"99\" required>\n                                                <input type=\"hidden\" class=\"banuser\" name=\"un\">\n                                                <label for=\"users\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Ban\n                                                    Reason:</label>\n                                            </div>\n                                        </div>\n                                        <div style=\"display: flex;\">\n                                            <button onclick=\"closeModal('ban-user')\"\n                                                class=\"w-full text-white bg-gray-700 hover:bg-gray-800 focus:ring-4 focus:outline-none focus:ring-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\"\n                                                style=\"margin-right: 10px;\">Cancel</button>\n\n                                            <button name=\"banuser\"\n                                                class=\"w-full text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\"\n                                                style=\"margin-right: 10px;\">Ban User</button>\n                                        </div>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Ban User Modal -->\n\n                    <!-- START TABLE -->\n                    <div class=\"relative overflow-x-auto shadow-md sm:rounded-lg pt-5\">\n                        <table id=\"kt_datatable_users\" class=\"w-full text-sm text-left text-white\">\n                            <thead>\n                                <tr class=\"fw-bolder fs-6 text-blue-700 px-7\">\n                                    <th class=\"px-6 py-3\">Username</th>\n                                    <th class=\"px-6 py-3\">HWID</th>\n                                    <th class=\"px-6 py-3\">IP</th>\n                                    <th class=\"px-6 py-3\">Creation Date</th>\n                                    <th class=\"px-6 py-3\">Last Login Date</th>\n                                    <th class=\"px-6 py-3\">Status</th>\n                                    <th class=\"px-6 py-3\">Actions</th>\n                                </tr>\n                            </thead>\n                        </table>\n                    </div>\n                    <p class=\"text-xs text-red-600\">Dropdown actions in <b>RED</b> do not show a confirmation!<a\n                            class=\"text-blue-700\"> Dropdown actions in <b>BLUE</b> will show a confirmation!</a></p>\n\n                    <!-- Include the jQuery library -->\n                    \n\n                    <script>\n                    function banuser(username) {\n                        var banuser = $('.banuser');\n\n                        // Set the value of the element with the class 'banuser'\n                        banuser.attr('value', username);\n\n                        // Open the ban-user modal\n                        openModal('ban-user');\n                    }\n\n                    // JavaScript function to open the modal\n                    </script>\n\n                    <!-- Generate Random Password -->\n                    <script>\n                    function updateGeneratedPassword(value) {\n                        const password = generateRandomPassword(value);\n\n                        document.getElementById('genpw').value = password;\n                        document.getElementById('password').value = password;\n                        document.getElementById('length').value = \"Current Password Length \" + password.length;\n                    }\n\n                    function generateRandomPassword(length) {\n                        const charset = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+\";\n                        let password = \"\";\n                        for (let i = 0; i < length; i++) {\n                            const randomIndex = Math.floor(Math.random() * charset.length);\n                            password += charset.charAt(randomIndex);\n                        }\n                        return password;\n                    }\n\n                    updateGeneratedPassword(document.getElementById('default-range').value);\n                    </script>\n\n                    <!-- Copy Generated Password To Clipboard -->\n                    <script>\n                    function copyContent(targetId) {\n                        const codeBlock = document.getElementById(targetId);\n                        const codeContent = codeBlock.value; // Use .value to get the content of a textarea\n\n                        const tempTextarea = document.createElement(\"textarea\");\n                        tempTextarea.value = codeContent;\n                        document.body.appendChild(tempTextarea);\n\n                        tempTextarea.select();\n                        document.execCommand(\"copy\");\n\n                        document.body.removeChild(tempTextarea);\n\n                        alert(\"Copied Password To Clipboard!\");\n                    }\n\n                    // Attach click event listeners to all copy buttons\n                    const copyButtons = document.querySelectorAll(\".copy-button\");\n                    copyButtons.forEach(button => {\n                        button.addEventListener(\"click\", () => {\n                            const targetId = button.getAttribute(\"data-copy-target\");\n                            copyContent(targetId);\n                        });\n                    });\n                    </script>\n","size_bytes":83399},"app/pages/vars.php":{"content":"<?php\nif ($_SESSION['role'] == \"Reseller\") {\n    header(\"location: ./?page=reseller-licenses\");\n    die();\n}\nif($role == \"Manager\" && !($permissions & 128)) {\n    misc\\auditLog\\send(\"Attempted (and failed) to view vars.\");\n    dashboard\\primary\\error(\"You weren't granted permission to view this page!\");\n    die();\n}\nif(!isset($_SESSION['app'])) {\n    dashboard\\primary\\error(\"Application not selected\");\n    die(\"Application not selected.\");\n}\n\nif (isset($_POST['genvar'])) {\n    if ($_SESSION['role'] == \"tester\") {\n        if(strlen($_POST['vardata']) > 100) {\n            dashboard\\primary\\error(\"Must upgrade to developer or seller to create variables longer than 100 characters!\");\n            echo \"<meta http-equiv='Refresh' Content='2'>\";\n            return;\n        }\n\n        $query = misc\\mysql\\query(\"SELECT count(*) AS 'numVars' FROM `vars` WHERE `app` = ?\",[$_SESSION['app']]);\n        $row = mysqli_fetch_array($query->result);\n        $numVars = $row[\"numVars\"];\n        if($numVars >= 5) {\n            dashboard\\primary\\error(\"Must upgrade to developer or seller to create more than 5 variables!\");\n            echo \"<meta http-equiv='Refresh' Content='2'>\";\n            return;\n        }\n    }\n    $authed = misc\\etc\\sanitize($_POST['authed']) == NULL ? 0 : 1;\n    $resp = misc\\variable\\add($_POST['varname'], $_POST['vardata'], $authed);\n    match($resp){\n        'exists' => dashboard\\primary\\error(\"Variable name already exists!\"),\n        'too_long' => dashboard\\primary\\error(\"Variable too long! Must be 1000 characters or less\"),\n        'failure' => dashboard\\primary\\error(\"Failed to create variable\"),\n        'success' => dashboard\\primary\\success(\"Successfully created variable\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n\nif (isset($_POST['delvars'])) {\n    $resp = misc\\variable\\deleteAll();\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to delete all variables\"),\n        'success' => dashboard\\primary\\success(\"Successfully deleted all variables\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n\nif (isset($_POST['deletevar'])) {\n    $resp = misc\\variable\\deleteSingular($_POST['deletevar']);\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to delete variable\"),\n        'success' => dashboard\\primary\\success(\"Successfully deleted variable\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n\n// edit modal\nif (isset($_POST['editvar'])) {\n    $variable = misc\\etc\\sanitize($_POST['editvar']);\n\n    $query = misc\\mysql\\query(\"SELECT * FROM `vars` WHERE `varid` = ? AND `app` = ?\",[$variable, $_SESSION['app']]);\n    if ($query->num_rows < 1) {\n        dashboard\\primary\\error(\"Variable not Found!\");\n        echo \"<meta http-equiv='Refresh' Content='2'>\";\n        return;\n    }\n\n    $row = mysqli_fetch_array($query->result);\n\n    $data = $row[\"msg\"];\n\n    echo  '\n    <div id=\"edit-variable-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n        class=\"fixed grid place-items-center h-screen bg-black bg-opacity-60 z-50 p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n        <div class=\"relative w-full max-w-md max-h-full\">\n            <!-- Modal content -->\n            <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                <div class=\"px-6 py-6 lg:px-8\">\n                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Edit Variable</h3>\n                    <form class=\"space-y-6\" method=\"POST\">\n                        <div>\n\n                        <div class=\"relative mb-4\">\n                            <label for=\"msg\" name=\"msg\"\n                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">\n                                Variable Data</label>\n                            <textarea id=\"msg\" name=\"msg\" rows=\"4\"\n                                class=\"block p-2.5 w-full text-sm text-white-900 bg-[#0f0f17] rounded-lg border border-gray-700 focus:ring-blue-500 focus:border-blue-500\"\n                                placeholder=\"\" maxlength=\"1000\" required>' . $data . '</textarea>\n                                <input type=\"hidden\" name=\"variable\" value=\"' . $variable . '\">\n                        </div>\n\n                        </div>\n                        <div class=\"flex items-center mb-4\">\n                        <input id=\"authed\" name=\"authed\" type=\"checkbox\"\n                            class=\"w-4 h-4 text-blue-600 bg-[#0f0f17] border-gray-300 rounded focus:ring-blue-500 focus:ring-2\"\n                            checked>\n                        <label for=\"authed\"\n                            class=\"ml-2 text-sm font-medium text-white-900\">Authenticated</label>\n                    </div>\n\n                        <button name=\"savevar\"\n                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Save\n                            Changes</button>\n                        <button\n                            class=\"w-full text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\" onClick=\"window.location.href=window.location.href\">Cancel\n                            </button>\n                    </form>\n                </div>\n            </div>\n        </div>\n    </div>\n    <!-- End Edit Var Modal -->';\n}\n\nif (isset($_POST['savevar'])) {\n    $authed = misc\\etc\\sanitize($_POST['authed']) == NULL ? 0 : 1;\n    $resp = misc\\variable\\edit($_POST['variable'], $_POST['msg'], $authed);\n    switch ($resp) {\n        case 'success':\n            misc\\cache\\purge('KeyAuthVar:' . $_SESSION['app'] . ':' . $_POST['variable']);\n            dashboard\\primary\\success(\"Successfully edited variable!\");\n            break;\n    }\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to edit variable!\"),\n        'too_long' => dashboard\\primary\\error(\"Variable too long! Must be 1000 characters or less\"),\n        'success' => dashboard\\primary\\success(\"Successfully edited variable!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n?>\n\n<div class=\"p-4 bg-[#09090d] block sm:flex items-center justify-between lg:mt-1.5\">\n    <div class=\"mb-1 w-full bg-[#0f0f17] rounded-xl\">\n        <div class=\"mb-4 p-4\">\n            <?php require '../app/layout/breadcrumb.php'; ?>\n            <h1 class=\"text-xl font-semibold text-white-900 sm:text-2xl \">Global Variables</h1>\n            <p class=\"text-xs text-gray-500\">Pass, assign, obtain data globally. <a\n                    href=\"https://keyauth.readme.io/reference/variables-1\" target=\"_blank\"\n                    class=\"text-blue-600  hover:underline\">Learn More</a>.</p>\n            <br>\n            <div class=\"overflow-x-auto\">\n\n                <!-- Alert Box -->\n                <div id=\"alert-4\" class=\"flex items-center p-4 mb-4 text-yellow-800 rounded-lg bg-[#09090d]\"\n                    role=\"alert\">\n                    <svg class=\"flex-shrink-0 w-4 h-4\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\"\n                        fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path\n                            d=\"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z\" />\n                    </svg>\n                    <span class=\"sr-only\">Info</span>\n                    <div class=\"ml-3 text-sm font-medium text-yellow-500\">\n                        These are global variables. You must use 'var()', not get/setvar()(aka user variables). Please\n                        view our <a href=\"https://keyauth.readme.io/reference/variables-1\"\n                            class=\"font-semibold underline hover:no-underline\">Documentation</a> to learn how to use\n                        global variables.\n                    </div>\n                </div>\n                <!-- End Alert Box -->\n\n                <!-- Global Variable Functions -->\n                <button\n                    class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                    data-modal-toggle=\"set-global-var-modal\" data-modal-target=\"set-global-var-modal\">\n                    <i class=\"lni lni-circle-plus mr-2 mt-1\"></i>Create Global Variable\n                </button>\n                <!-- End Global Variable Functions -->\n\n                <br>\n\n                <!-- Delete Global Variable Functions -->\n                <button\n                    class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                    data-modal-toggle=\"delete-all-vars-modal\" data-modal-target=\"delete-all-vars-modal\">\n                    <i class=\"lni lni-trash-can mr-2 mt-1\"></i>Delete All Variables\n                </button>\n                <!-- End Delete Global Variable Functions -->\n\n                <!-- Set Global Var Modal -->\n                <div id=\"set-global-var-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                    class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                    <div class=\"relative w-full max-w-md max-h-full\">\n                        <!-- Modal content -->\n                        <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                            <div class=\"px-6 py-6 lg:px-8\">\n                                <h3 class=\"mb-4 text-xl font-medium text-white-900\">Set Global Variable</h3>\n                                <hr class=\"h-px mb-4 mt-4 bg-gray-700 border-0\">\n                                <form class=\"space-y-6\" method=\"POST\">\n                                    <div>\n                                        <div class=\"relative mb-4\">\n                                            <input type=\"text\" id=\"varname\" name=\"varname\"\n                                                class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                placeholder=\" \" autocomplete=\"on\" required>\n                                            <label for=\"varname\"\n                                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Variable\n                                                Name</label>\n                                        </div>\n\n                                        <div class=\"relative mb-4\">\n                                            <label for=\"vardata\" name=\"vardata\"\n                                                class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">\n                                                Variable Data</label>\n                                            <textarea id=\"vardata\" name=\"vardata\" rows=\"4\"\n                                                class=\"block p-2.5 w-full text-sm text-white-900 bg-[#0f0f17] rounded-lg border border-gray-700 focus:ring-blue-500 focus:border-blue-500\"\n                                                placeholder=\"\" maxlength=\"1000\" required></textarea>\n                                        </div>\n                                    </div>\n\n                                    <div class=\"flex items-center mb-4\">\n                                        <input id=\"authed\" name=\"authed\" type=\"checkbox\" \n                                            class=\"w-4 h-4 text-blue-600 bg-[#0f0f17] border-gray-300 rounded focus:ring-blue-500 focus:ring-2\"\n                                            checked>\n                                        <label for=\"authed\"\n                                            class=\"ml-2 text-sm font-medium text-white-900\">Authenticated</label>\n                                    </div>\n                                    <button name=\"genvar\"\n                                        class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Set\n                                        Global Var</button>\n                                </form>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <!-- End Create Global Var Modal -->\n\n                <!-- Delete All Vars Modal -->\n                <div id=\"delete-all-vars-modal\" tabindex=\"-1\"\n                    class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                    <div class=\"relative w-full max-w-md max-h-full\">\n                        <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                            <div class=\"p-6 text-center\">\n                                <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                    role=\"alert\">\n                                    <span class=\"sr-only\">Info</span>\n                                    <div>\n                                        <span class=\"font-medium\">Notice!</span> You're about to delete all of your\n                                        global variables. This can not be undone.\n                                    </div>\n                                </div>\n                                <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure you want to delete\n                                    all of your global variables?</h3>\n                                <form method=\"POST\">\n                                    <button data-modal-hide=\"delete-all-vars-modal\" name=\"delvars\"\n                                        class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                        Yes, I'm sure\n                                    </button>\n                                    <button data-modal-hide=\"delete-all-vars-modal\" type=\"button\"\n                                        class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                        cancel</button>\n                                </form>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <!-- End Delete All Vars Modal -->\n\n                <!-- START TABLE -->\n                <div class=\"relative overflow-x-auto shadow-md sm:rounded-lg pt-5\">\n                    <table id=\"kt_datatable_vars\" class=\"w-full text-sm text-left text-white\">\n                        <thead>\n                            <tr class=\"fw-bolder fs-6 text-blue-700 px-7\">\n                                <th class=\"px-6 py-3\">Variable Name</th>\n                                <th class=\"px-6 py-3\">Variable Data</th>\n                                <th class=\"px-6 py-3\">Autheticated</th>\n                                <th class=\"px-6 py-3\">Actions</th>\n                            </tr>\n                        </thead>\n                    </table>\n                </div>\n                <p class=\"text-xs text-red-600\">Dropdown actions in <b>RED</b> do not show a confirmation!<a\n                            class=\"text-blue-700\"> Dropdown actions in <b>BLUE</b> will show a confirmation!</a></p>\n","size_bytes":16885},"app/pages/webhooks.php":{"content":"<?php\nif ($_SESSION['role'] == \"Reseller\") {\n    header(\"location: ./?page=reseller-licenses\");\n    die();\n}\nif($role == \"Manager\" && !($permissions & 32)) {\n    misc\\auditLog\\send(\"Attempted (and failed) to view webhooks.\");\n    dashboard\\primary\\error(\"You weren't granted permission to view this page.\");\n    die();\n}\nif(!isset($_SESSION['app'])) {\n    dashboard\\primary\\error(\"Application not selected\");\n    die(\"Application not selected.\");\n}\n\nif (isset($_POST['genwebhook'])) {\n\n    if ($_SESSION['role'] == \"tester\") {\n        dashboard\\primary\\error(\"You must upgrade to developer or seller to use webhooks!\");\n    } else {\n        $authed = misc\\etc\\sanitize($_POST['authed']) == NULL ? 0 : 1;\n        $resp = misc\\webhook\\add($_POST['webhookname'], $_POST['baselink'], $_POST['useragent'], $authed);\n        match($resp){\n            'invalid_url' => dashboard\\primary\\error(\"URL isn't a valid URL\"),\n            'no_local' => dashboard\\primary\\error(\"URL can't be a local path! Must be a remote URL accessible by the open internet!\"),\n            'failure' => dashboard\\primary\\error(\"Failed to add webhook!\"),\n            'success' => dashboard\\primary\\success(\"Successfully added webhook!\"),\n            'empty_webhookname' => dashboard\\primary\\error(\"Wehbook name can not be empty!\"),\n            default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n        };\n    }\n}\n\nif (isset($_POST['deletewebhook'])) {\n    $resp = misc\\webhook\\deleteSingular($_POST['deletewebhook']);\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to delete webhook!\"),\n        'success' => dashboard\\primary\\success(\"Successfully deleted webhook!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n\nif (isset($_POST['delallwebhooks'])){\n    $resp = misc\\webhook\\deleteAll();\n    match($resp){\n        'failure' => dashboard\\primary\\error(\"Failed to delete all webhooks!\"),\n        'success' => dashboard\\primary\\success(\"Successfully deleted all webhooks!\"),\n        default => dashboard\\primary\\error(\"Unhandled Error! Contact us if you need help\")\n    };\n}\n\nif (isset($_POST['editwebhook'])) {\n    $webhook = misc\\etc\\sanitize($_POST['editwebhook']);\n\n    $query = misc\\mysql\\query(\"SELECT * FROM `webhooks` WHERE `webid` = ? AND `app` = ?\",[$webhook, $_SESSION['app']]);\n    if ($query->num_rows < 1) {\n        dashboard\\primary\\error(\"Webhook not Found!\");\n        echo \"<meta http-equiv='Refresh' Content='2'>\";\n        return;\n    }\n\n    $row = mysqli_fetch_array($query->result);\n\n    $baselink = $row[\"baselink\"];\n    $useragent = $row[\"useragent\"];\n\n    echo  '\n    <div id=\"edit-webhook-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n        class=\"fixed grid place-items-center h-screen bg-black bg-opacity-60 z-50 p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n        <div class=\"relative w-full max-w-md max-h-full\">\n            <!-- Modal content -->\n            <div class=\"relative bg-[#0f0f17] rounded-lg border border-[#1d4ed8] shadow\">\n                <div class=\"px-6 py-6 lg:px-8\">\n                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Edit Webhook</h3>\n                    <form class=\"space-y-6\" method=\"POST\">\n                        <div>\n\n                        <div class=\"relative mb-4\">\n                        <input type=\"text\" id=\"baselink\" name=\"baselink\"\n                            class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                            placeholder=\" \" autocomplete=\"on\" value=\"' . $baselink . '\" required>\n                        <label for=\"baselink\"\n                            class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Base URL:</label>\n                            <input type=\"hidden\" name=\"webhook\" value=\"' . $webhook . '\">\n                    </div>\n\n                    <div class=\"relative mb-4\">\n                    <input type=\"text\" id=\"useragent\" name=\"useragent\"\n                        class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0 peer\"\n                        placeholder=\" \" autocomplete=\"on\" value=\"' . $useragent . '\" required>\n                    <label for=\"useragent\"\n                        class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">User-Agent:</label>\n                </div>\n                       \n                        </div>\n                        <button name=\"savewebhook\"\n                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\" value=\"' . $file . '\">Save\n                            Changes</button>\n                        <button\n                            class=\"w-full text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\" onClick=\"window.location.href=window.location.href\">Cancel\n                            </button>\n                    </form>\n                </div>\n            </div>\n        </div>\n    </div>\n    <!-- End Edit Account Modal -->';\n}\n\nif (isset($_POST['savewebhook'])) {\n    $webhook = misc\\etc\\sanitize($_POST['webhook']);\n\n    $baselink = misc\\etc\\sanitize($_POST['baselink']);\n    $useragent = misc\\etc\\sanitize($_POST['useragent']);\n\n    if (!filter_var($baselink, FILTER_VALIDATE_URL)) {\n        dashboard\\primary\\error(\"URL isn't a valid URL\");\n        echo \"<meta http-equiv='Refresh' Content='2'>\";\n        return;\n    }\n\n    if(str_contains($baselink, \"localhost\") || str_contains($baselink, \"127.0.0.1\")) {\n        dashboard\\primary\\error(\"URL can't be a local path! Must be a remote URL accessible by the open internet\");\n        echo \"<meta http-equiv='Refresh' Content='2'>\";\n        return;\n    }\n\n    misc\\mysql\\query(\"UPDATE `webhooks` SET `baselink` = ?,`useragent` = ? WHERE `webid` = ? AND `app` = ?\",[$baselink, $useragent, $webhook, $_SESSION['app']]);\n\n    dashboard\\primary\\success(\"Successfully Updated Settings!\");\n    misc\\cache\\purge('KeyAuthWebhook:' . $_SESSION['app'] . ':' . $webhook);\n}\n?>\n\n<div class=\"p-4 bg-[#09090d] block sm:flex items-center justify-between lg:mt-1.5\">\n    <div class=\"mb-1 w-full bg-[#0f0f17] rounded-xl\">\n        <div class=\"mb-4 p-4\">\n            <?php require '../app/layout/breadcrumb.php'; ?>\n            <h1 class=\"text-xl font-semibold text-white-900 sm:text-2xl \">Webhooks</h1>\n            <p class=\"text-xs text-gray-500\">Send and receive secure requests. <a\n                    href=\"https://keyauth.readme.io/reference/webhooks-1\" target=\"_blank\"\n                    class=\"text-blue-600  hover:underline\">Learn More</a>.</p>\n            <br>\n            <div class=\"p-4 flex flex-col\">\n                <div class=\"overflow-x-auto\">\n\n                    <!-- Alert Box -->\n                    <div id=\"alert-4\" class=\"flex items-center p-4 mb-4 text-yellow-800 rounded-lg bg-[#09090d]\"\n                        role=\"alert\">\n                        <svg class=\"flex-shrink-0 w-4 h-4\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\"\n                            fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                            <path\n                                d=\"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z\" />\n                        </svg>\n                        <span class=\"sr-only\">Info</span>\n                        <div class=\"ml-3 text-sm font-medium text-yellow-500\">\n                            People often this mistake this for Discord webhooks. Please view our <a\n                                href=\"https://keyauth.readme.io/reference/webhooks-1\"\n                                class=\"font-semibold underline hover:no-underline\">Documentation</a> to learn how to\n                            send Discord webhooks.\n                        </div>\n                    </div>\n                    <!-- End Alert Box -->\n\n                    <!-- Webhooks Functions -->\n                    <button\n                        class=\"inline-flex text-white bg-blue-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"create-webhook-modal\" data-modal-target=\"create-webhook-modal\">\n                        <i class=\"lni lni-circle-plus mr-2 mt-1\"></i>Create Webhook\n                    </button>\n                    <!-- End Webhooks Functions -->\n\n                    <br>\n\n                    <!-- Delete Webhooks Functions -->\n                    <button\n                        class=\"inline-flex text-white bg-red-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\"\n                        data-modal-toggle=\"delete-all-webhooks-modal\" data-modal-target=\"delete-all-webhooks-modal\">\n                        <i class=\"lni lni-trash-can mr-2 mt-1\"></i>Delete All Webhooks\n                    </button>\n                    <!-- End Delete Webhooks Functions -->\n\n                    <!-- Create Create A Webhook Modal -->\n                    <div id=\"create-webhook-modal\" tabindex=\"-1\" aria-hidden=\"true\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <!-- Modal content -->\n                            <div class=\"relative bg-[#0f0f17] rounded-lg border border-blue-700 shadow\">\n                                <div class=\"px-6 py-6 lg:px-8\">\n                                    <h3 class=\"mb-4 text-xl font-medium text-white-900\">Generate A Webhook</h3>\n                                    <hr class=\"h-px mb-4 mt-4 bg-gray-700 border-0\">\n                                    <form class=\"space-y-6\" method=\"POST\">\n                                        <div>\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" id=\"webhookname\" name=\"webhookname\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\">\n                                                <label for=\"webhookname\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Webhook\n                                                    Name (optional)</label>\n                                            </div>\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" id=\"baselink\" name=\"baselink\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\" required>\n                                                <label for=\"baselink\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">Webhook\n                                                    Endpoint</label>\n                                            </div>\n                                            <div class=\"relative mb-4\">\n                                                <input type=\"text\" id=\"useragent\" name=\"useragent\"\n                                                    class=\"block px-2.5 pb-2.5 pt-4 w-full text-sm text-white bg-transparent rounded-lg border-1 border-gray-700 appearance-none focus:ring-0  peer\"\n                                                    placeholder=\" \" autocomplete=\"on\">\n                                                <label for=\"useragent\"\n                                                    class=\"absolute text-sm text-gray-400 duration-300 transform -translate-y-4 scale-75 top-2 z-10 origin-[0] bg-[#0f0f17] px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 left-1\">User\n                                                    Agent (Default is KeyAuth)</label>\n                                            </div>\n                                            <div class=\"flex items-center\">\n                                                <input checked id=\"authed\" type=\"checkbox\" name=\"authed\"\n                                                    class=\"w-4 h-4 text-blue-600 bg-[#0f0f17] border-gray-300 rounded focus:ring-blue-500   focus:ring-2  \">\n                                                <label for=\"authed\"\n                                                    class=\"ml-2 text-sm font-medium text-white-900 \">Authenticated</label>\n                                            </div>\n                                        </div>\n                                        <button type=\"submit\" name=\"genwebhook\"\n                                            class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center\">Generate\n                                            Webhook</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Create A Webhook Modal -->\n\n                    <!-- Delete All Webhooks Modal -->\n                    <div id=\"delete-all-webhooks-modal\" tabindex=\"-1\"\n                        class=\"fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full\">\n                        <div class=\"relative w-full max-w-md max-h-full\">\n                            <div class=\"relative bg-[#0f0f17] border border-red-700 rounded-lg shadow\">\n                                <div class=\"p-6 text-center\">\n                                    <div class=\"flex items-center p-4 mb-4 text-sm text-white border border-yellow-500 rounded-lg bg-[#0f0f17]\"\n                                        role=\"alert\">\n                                        <span class=\"sr-only\">Info</span>\n                                        <div>\n                                            <span class=\"font-medium\">Notice!</span> You're about to delete all of your\n                                            webhooks. This can not be undone.\n                                        </div>\n                                    </div>\n                                    <h3 class=\"mb-5 text-lg font-normal text-gray-200\">Are you sure you want to delete\n                                        all of your webhooks?</h3>\n                                    <form method=\"POST\">\n                                        <button data-modal-hide=\"delete-all-webhooks-modal\" name=\"delallwebhooks\"\n                                            class=\"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2\">\n                                            Yes, I'm sure\n                                        </button>\n                                        <button data-modal-hide=\"delete-all-webhooks-modal\" type=\"button\"\n                                            class=\"inline-flex text-white bg-gray-700 hover:opacity-60 focus:ring-0 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 transition duration-200\">No,\n                                            cancel</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- End Delete All Webhooks Modal -->\n\n                    <!-- START TABLE -->\n                    <div class=\"relative overflow-x-auto shadow-md sm:rounded-lg pt-5\">\n                        <table id=\"kt_datatable_webhooks\" class=\"w-full text-sm text-left text-white\">\n                            <thead>\n                                <tr class=\"fw-bolder fs-6 text-blue-700 px-7\">\n                                    <th class=\"px-6 py-3\">ID</th>\n                                    <th class=\"px-6 py-3\">Endpoint</th>\n                                    <th class=\"px-6 py-3\">User-Agent</th>\n                                    <th class=\"px-6 py-3\">Authenticated</th>\n                                    <th class=\"px-6 py-3\">Actions</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                <?php\n            if ($_SESSION['app']) {\n                $query = misc\\mysql\\query(\"SELECT * FROM `webhooks` WHERE `app` = ?\",[$_SESSION['app']]);\n                if ($query->num_rows > 0) {\n                    while ($row = mysqli_fetch_array($query->result)) {\n\n                        echo \"<tr>\";\n\n                        echo \"  <td>\" . $row[\"webid\"] . \"</td>\";\n\n                        echo \"  <td><span class=\\\"blur-sm hover:blur-none\\\">\" . $row[\"baselink\"] . \"</span></td>\";\n\n                        echo \"  <td>\" . $row[\"useragent\"] . \"</td>\";\n\n                        echo \"  <td>\" . (($row[\"authed\"] ? 1 : 0) ? 'True' : 'False') . \"</td>\";\n\n                        echo '<form method=\"POST\">\n                                <td>\n\n                                <div x-data=\"{ open: false }\" class=\"z-0\">\n                                <button x-on:click=\"open = true\" class=\"flex items-center border border-gray-700 rounded-lg focus:opacity-60 text-white focus:text-white font-semibold rounded focus:outline-none focus:shadow-inner py-2 px-4\" type=\"button\">\n                                        <span class=\"mr-1\">Actions</span>\n                                        <svg class=\"fill-current h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\"  style=\"margin-top:3px\">\n                                        <path d=\"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z\"/>\n                                        </svg>\n                                </button>\n                                <ul x-show=\"open\" x-on:click.away=\"open = false\" class=\"bg-[#09090d] text-white rounded shadow-lg absolute py-2 mt-1\" style=\"min-width:15rem\">\n                                        <li>\n                                                <button name=\"deletewebhook\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-red-700\"\n                                                value=\"' . $row[\"webid\"] . '\">\n                                                Delete Webhook\n                                                </button>\n                                        </li>\n                                        <li>\n                                                <button name=\"editwebhook\" class=\"block hover:opacity-60 whitespace-no-wrap py-2 px-4 hover:text-blue-700\"\n                                                value=\"' . $row[\"webid\"] . '\">\n                                                Edit Webhook\n                                                </button>\n                                        </li>\n                                        </ul>\n                                        </div>\n                                    </tr>\n                                </td>\n                              </form>';\n                    }\n                }\n            }\n\n            ?>\n                            </tbody>\n                        </table>\n                    </div>\n                    <p class=\"text-xs text-red-600\">Dropdown actions in <b>RED</b> do not show a confirmation!<a\n                            class=\"text-blue-700\"> Dropdown actions in <b>BLUE</b> will show a confirmation!</a></p>\n","size_bytes":21665},"includes/dashboard/primary.php":{"content":"<?php\n\nnamespace dashboard\\primary;\n\nuse misc\\mysql;\n\nfunction time2str($date)\n{\n    $now = time();\n    $diff = $now - $date;\n    if ($diff < 60) {\n        return sprintf($diff > 1 ? '%s seconds' : 'second', $diff);\n    }\n    $diff = floor($diff / 60);\n    if ($diff < 60) {\n        return sprintf($diff > 1 ? '%s minutes' : 'minute', $diff);\n    }\n    $diff = floor($diff / 60);\n    if ($diff < 24) {\n        return sprintf($diff > 1 ? '%s hours' : 'hour', $diff);\n    }\n    $diff = floor($diff / 24);\n    if ($diff < 7) {\n        return sprintf($diff > 1 ? '%s days' : 'day', $diff);\n    }\n    if ($diff < 30) {\n        $diff = floor($diff / 7);\n        return sprintf($diff > 1 ? '%s weeks' : 'week', $diff);\n    }\n    $diff = floor($diff / 30);\n    if ($diff < 12) {\n        return sprintf($diff > 1 ? '%s months' : 'month', $diff);\n    }\n    $diff = date('Y', $now) - date('Y', $date);\n    return sprintf($diff > 1 ? '%s years' : 'year', $diff);\n}\nfunction expireCheck($username, $expires)\n{\n    // Check if subscription is expired\n    $isExpired = ($expires < time());\n    \n    if ($isExpired) {\n        // Store expired status and original role\n        $_SESSION['subscription_expired'] = true;\n        \n        // Store original role only if not already stored\n        if (!isset($_SESSION['original_role'])) {\n            $_SESSION['original_role'] = $_SESSION['role'];\n        }\n        \n        // Downgrade session role to tester for access control\n        $_SESSION['role'] = \"tester\";\n        $_SESSION['effective_role'] = \"tester\";\n        \n        // Log the expiry event for admin tracking\n        error_log(\"User {$username} subscription expired at \" . date('Y-m-d H:i:s', $expires) . \", temporarily downgraded to tester\");\n    } else {\n        // Clear expired status if subscription is active\n        $_SESSION['subscription_expired'] = false;\n        \n        // Restore original role if it was downgraded\n        if (isset($_SESSION['original_role'])) {\n            $_SESSION['role'] = $_SESSION['original_role'];\n            $_SESSION['effective_role'] = $_SESSION['original_role'];\n        }\n    }\n    \n    if ($expires - time() < 2629743) // check if account expires in month or less\n    {\n        return true;\n    } else {\n        return false;\n    }\n}\n\n// Helper function to get effective role for permission checks\nfunction getEffectiveRole()\n{\n    if (isset($_SESSION['subscription_expired']) && $_SESSION['subscription_expired']) {\n        return $_SESSION['effective_role'] ?? 'tester';\n    }\n    return $_SESSION['role'];\n}\n\n// Helper function to check if user has subscription access\nfunction hasActiveSubscription()\n{\n    return !(isset($_SESSION['subscription_expired']) && $_SESSION['subscription_expired']);\n}\n\n// Function to restore role when subscription is renewed\nfunction restoreOriginalRole($username)\n{\n    if (isset($_SESSION['original_role'])) {\n        $_SESSION['role'] = $_SESSION['original_role'];\n        $_SESSION['effective_role'] = $_SESSION['original_role'];\n        $_SESSION['subscription_expired'] = false;\n        unset($_SESSION['subscription_warning']);\n        \n        // Update database if role was changed incorrectly before\n        mysql\\query(\"UPDATE `accounts` SET `role` = ? WHERE `username` = ?\", [$_SESSION['original_role'], $username]);\n        \n        error_log(\"Restored role for user {$username} to {$_SESSION['original_role']}\");\n        return true;\n    }\n    return false;\n}\n\nfunction wh_log($webhook_url, $msg, $un)\n{\n    $json_data = json_encode([\n        // Message\n        \"content\" => $msg,\n        // Username\n        \"username\" => \"$un\",\n    ], JSON_UNESCAPED_SLASHES | JSON_UNESCAPED_UNICODE);\n    $ch = curl_init($webhook_url);\n    curl_setopt($ch, CURLOPT_HTTPHEADER, array(\n        'Content-type: application/json'\n    ));\n    curl_setopt($ch, CURLOPT_POST, 1);\n    curl_setopt($ch, CURLOPT_POSTFIELDS, $json_data);\n    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);\n    curl_setopt($ch, CURLOPT_HEADER, 0);\n    curl_exec($ch);\n    curl_close($ch);\n}\nfunction error($msg)\n{\n    echo '<script src=\"https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js\"></script><link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css\"><script type=\\'text/javascript\\'>\n\n                \n\n                            const notyf = new Notyf();\n\n                            notyf\n\n                              .error({\n\n                                message: \\'' . addslashes($msg) . '\\',\n\n                                duration: 3500,\n\n                                dismissible: true\n\n                              });               \n\n                \n\n                </script>';\n}\nfunction success($msg)\n{\n    echo '<script src=\"https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js\"></script><link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css\"><script type=\\'text/javascript\\'>\n\n                \n\n                            const notyf = new Notyf();\n\n                            notyf\n\n                              .success({\n\n                                message: \\'' . addslashes($msg) . '\\',\n\n                                duration: 3500,\n\n                                dismissible: true\n\n                              });               \n\n                \n\n                </script>';\n}\n\nfunction popover($id, $title, $msg){\n    echo '<div data-popover id=\"' . $id . '\" role=\"tooltip\"\n            class=\"absolute z-10 invisible inline-block w-64 text-sm text-gray-500 transition-opacity duration-300 bg-[#09090d] rounded-lg shadow-sm opacity-0\">\n            <div class=\"px-3 py-2 bg-[#09090d]/70 rounded-t-lg\">\n                <h3 class=\"font-semibold text-white\">' . $title . '</h3>\n            </div>\n            <div class=\"px-3 py-2\">\n                <p>' . $msg . '</p>\n            </div>\n            <div data-popper-arrow></div>\n        </div>';\n}\n?>\n","size_bytes":5896},"includes/misc/account.php":{"content":"<?php\n\nnamespace misc\\account;\n\nuse misc\\etc;\nuse misc\\mysql;\n\nfunction addAccount($username, $role, $email, $password, $keyLevels, $owner, $name, $permissions)\n{\n        $username = etc\\sanitize($username);\n        $role = etc\\sanitize($role);\n        $email = etc\\sanitize($email);\n        $password = etc\\sanitize($password);\n        $keyLevels = etc\\sanitize($keyLevels) ?? \"N/A\";\n        $owner = etc\\sanitize($owner);\n        $name = etc\\sanitize($name);\n        $permissions = etc\\sanitize($permissions);\n\n        if (!in_array($role, array(\"Manager\", \"Reseller\"))) {\n                return 'invalid_role';\n        }\n\n        if (is_null($email)) {\n                return 'invalid_email';\n        }\n\n        $pass_encrypted = password_hash($password, PASSWORD_BCRYPT);\n\n        $user_check = mysql\\query(\"SELECT `username` FROM `accounts` WHERE `username` = ?\", [$username]);\n\n        if ($user_check->num_rows > 0) {\n                return 'username_taken';\n        }\n        $email_check = mysql\\query(\"SELECT `username` FROM `accounts` WHERE `email` = SHA1(?)\", [$email]);\n\n        if ($email_check->num_rows > 0) {\n                return 'email_taken';\n        }\n\n        if ($permissions <= 0 || !is_numeric($permissions)) { // Manager users must have access to at least one page\n                return 'invalid_perms';\n        }\n        $permissions = decbin($permissions);\n\n        $query = mysql\\query(\"INSERT INTO `accounts` (`username`, `email`, `password`, `role`, `app`, `owner`, `balance`, `keylevels`, `permissions`) VALUES (?, SHA1(?), ?, ?, ?, ?, '0|0|0|0|0|0', ?, b'$permissions')\", [$username, $email, $pass_encrypted, $role, $name, $owner, $keyLevels]);\n        if ($query->affected_rows > 0) {\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\n","size_bytes":1818},"includes/misc/app.php":{"content":"<?php\n\nnamespace misc\\app;\n\nuse misc\\etc;\nuse misc\\cache;\nuse misc\\mysql;\n\nfunction pause($secret = null)\n{\n        \n        mysql\\query(\"UPDATE `subs` SET `paused` = 1, `expiry` = `expiry`-? WHERE `app` = ? AND `expiry` > ?\",[time(), $secret ?? $_SESSION['app'], time()], \"isi\");\n        mysql\\query(\"UPDATE `apps` SET `paused` = 1 WHERE `secret` = ?\",[$secret ?? $_SESSION['app']]);\n        $query = mysql\\query(\"SELECT `ownerid`,`name`,`customDomainAPI` FROM `apps` WHERE `secret` = ?\", [$secret ?? $_SESSION['app']]);\n        $row = mysqli_fetch_array($query->result);\n        cache\\purge('KeyAuthApp:' . $row['customDomainAPI']);\n        cache\\purge('KeyAuthApp:' . $row['name'] . ':' . $row['ownerid']);\n}\nfunction unpause($secret = null)\n{\n        mysql\\query(\"UPDATE `subs` SET `paused` = 0, `expiry` = `expiry`+? WHERE `app` = ? AND `paused` = 1\", [time(), $secret ?? $_SESSION['app']], \"is\");\n        mysql\\query(\"UPDATE `apps` SET `paused` = 0 WHERE `secret` = ?\",[$secret ?? $_SESSION['app']]);\n        $query = mysql\\query(\"SELECT `ownerid`,`name`,`customDomainAPI` FROM `apps` WHERE `secret` = ?\",[$secret ?? $_SESSION['app']]);\n        $row = mysqli_fetch_array($query->result);\n        cache\\purge('KeyAuthApp:' . $row['customDomainAPI']);\n        cache\\purge('KeyAuthApp:' . $row['name'] . ':' . $row['ownerid']);\n}\nfunction addHash($hash, $secret = null)\n{\n        $hash = etc\\sanitize($hash);\n        $query = mysql\\query(\"SELECT `hash`, `name`, `ownerid` FROM `apps` WHERE `secret` = ?\",[$secret ?? $_SESSION['app']]);\n        $row = mysqli_fetch_array($query->result);\n        $oldHash = $row[\"hash\"];\n        $name = $row[\"hash\"];\n        $ownerid = $row[\"ownerid\"];\n\n        $newHash = $oldHash .= $hash;\n\n        $query = mysql\\query(\"UPDATE `apps` SET `hash` = ? WHERE `secret` = ?\",[$newHash, $secret ?? $_SESSION['app']]);\n\n        if ($query->affected_rows > 0) {\n                cache\\purge(\"KeyAuthApp:{$name}:{$ownerid}\");\n                return 'success';\n        }\n        return 'failure';\n}\nfunction resetHash($secret = null, $name = null, $ownerid = null)\n{\n        \n        $name = $name ?? $_SESSION['name'];\n        $ownerid = $ownerid ?? $_SESSION['ownerid'];\n        \n        $query = mysql\\query(\"UPDATE `apps` SET `hash` = NULL WHERE `secret` = ?\",[$secret ?? $_SESSION['app']]);\n\n        if ($query->affected_rows > 0) {\n                cache\\purge(\"KeyAuthApp:{$name}:{$ownerid}\");\n                return 'success';\n        }\n        return 'failure';\n}\n","size_bytes":2499},"includes/misc/auditLog.php":{"content":"<?php\n\nnamespace misc\\auditLog;\nuse misc\\mysql;\nuse dashboard\\primary;\n\nfunction send($event)\n{\n\n        $query = mysql\\query(\"SELECT `auditLogWebhook` FROM `apps` WHERE `secret` = ?\",[$_SESSION['app']]);\n\n        $row = mysqli_fetch_array($query->result);\n        if(!is_null($row['auditLogWebhook'])) {\n                primary\\wh_log($row['auditLogWebhook'], \"**User:** \" . $_SESSION['username'] . \"**Event:** $event\", \"\");\n        }\n        else {\n                $query = mysql\\query(\"INSERT INTO `auditLog` (`user`, `event`, `time`, `app`) VALUES (?, ?, ?, ?)\",[$_SESSION['username'], $event, time(), $_SESSION['app']]);\n        }\n}\n","size_bytes":638},"includes/misc/blacklist.php":{"content":"<?php\n\nnamespace misc\\blacklist;\n\nuse misc\\etc;\nuse misc\\cache;\nuse misc\\mysql;\n\nfunction add($data, $type, $secret = null)\n{\n        $data = etc\\sanitize($data);\n        $type = etc\\sanitize($type);\n\n        switch ($type) {\n                case 'IP Address':\n                        $query = mysql\\query(\"INSERT INTO `bans`(`ip`, `type`, `app`) VALUES (?, 'ip', ?)\",[$data, $secret ?? $_SESSION['app'] ]);\n                        cache\\purgePattern('KeyAuthBlacklist:' . ($secret ?? $_SESSION['app']) . ':' . $data);\n                        break;\n                case 'Hardware ID':\n                        $query = mysql\\query(\"INSERT INTO `bans`(`hwid`, `type`, `app`) VALUES (?, 'hwid', ?)\",[$data, $secret ?? $_SESSION['app']]);\n\n                        cache\\purgePattern('KeyAuthBlacklist:' . ($secret ?? $_SESSION['app']) . ':*:' . $data);\n                        break;\n                default:\n                        return 'invalid';\n        }\n        if ($query->affected_rows > 0) {\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthBlacks:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction deleteAll($secret = null)\n{\n        $query = mysql\\query(\"DELETE FROM `bans` WHERE `app` = ?\",[$secret ?? $_SESSION['app']]);\n\n        if ($query->affected_rows > 0) {\n                cache\\purgePattern('KeyAuthBlacklist:' . ($secret ?? $_SESSION['app']));\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthBlacks:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction deleteSingular($blacklist, $type, $secret = null)\n{\n        $blacklist = etc\\sanitize($blacklist);\n        $type = etc\\sanitize($type);\n\n        switch ($type) {\n                case 'ip':\n                        $query = mysql\\query(\"DELETE FROM `bans` WHERE `app` = ? AND `ip` = ?\",[$secret ?? $_SESSION['app'], $blacklist]);\n                        cache\\purgePattern('KeyAuthBlacklist:' . ($secret ?? $_SESSION['app']) . ':' . $blacklist);\n                        break;\n                case 'hwid':\n                        $query = mysql\\query(\"DELETE FROM `bans` WHERE `app` = ? AND `hwid` = ?\",[$secret ?? $_SESSION['app'], $blacklist]);\n                        cache\\purgePattern('KeyAuthBlacklist:' . ($secret ?? $_SESSION['app']) . ':*:' . $blacklist);\n                        break;\n                default:\n                        return 'invalid';\n        }\n        if ($query->affected_rows > 0) {\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthBlacks:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction addWhite($ip, $secret = null)\n{\n        $ip = etc\\sanitize($ip);\n\n        $query = mysql\\query(\"INSERT INTO `whitelist`(`ip`, `app`) VALUES (?, ?)\",[$ip, $secret ?? $_SESSION['app']]);\n\n        cache\\purge('KeyAuthWhitelist:' . ($secret ?? $_SESSION['app']) . ':' . $ip);\n                        \n        if ($query->affected_rows > 0) {\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction deleteWhite($ip, $secret = null)\n{\n        $ip = etc\\sanitize($ip);\n\n        $query = mysql\\query(\"DELETE FROM `whitelist` WHERE `app` = ? AND `ip` = ?\",[$secret ?? $_SESSION['app'], $ip]);\n        cache\\purge('KeyAuthWhitelist:' . ($secret ?? $_SESSION['app']) . ':' . $ip);\n                        \n        if ($query->affected_rows > 0) {\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\n","size_bytes":3906},"includes/misc/button.php":{"content":"<?php\n\nnamespace misc\\button;\n\nuse misc\\etc;\nuse misc\\cache;\nuse misc\\mysql;\n\nfunction addButton($text, $value, $secret = null)\n{\n    \n    $text = etc\\sanitize($text);\n    $value = etc\\sanitize($value);\n    $query = mysql\\query(\"INSERT INTO `buttons` (`text`, `value`, `app`) VALUES (?, ?, ?)\",[$text, $value, $secret ?? $_SESSION['app']]);\n\n    if ($query->affected_rows > 0) {\n        if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n            cache\\purge('KeyAuthButtons:' . ($secret ?? $_SESSION['app']));\n        }\n        return 'success';\n    } else {\n        return 'failure';\n    }\n}\n\nfunction deleteButton($value, $secret = null)\n{\n    \n    $value = etc\\sanitize($value);\n    $query = mysql\\query(\"DELETE FROM `buttons` WHERE `value` = ? AND `app` = ?\",[$value, $secret ?? $_SESSION['app']]);\n\n    if ($query->affected_rows > 0) {\n        if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n            cache\\purge('KeyAuthButtons:' . ($secret ?? $_SESSION['app']));\n        }\n        return 'success';\n    } else {\n        return 'failure';\n    }\n}\n\n?>\n","size_bytes":1081},"includes/misc/cache.php":{"content":"<?php\n\nnamespace misc\\cache;\n\nuse misc\\mysql;\nuse api\\shared;\n\nfunction fetch($redisKey, $sqlQuery, $args = [], $multiRowed, $expiry = null, $types = null)\n{\n        global $redis;\n        include_once (($_SERVER['DOCUMENT_ROOT'] == \"/usr/share/nginx/html/panel\" || $_SERVER['DOCUMENT_ROOT'] == \"/usr/share/nginx/html/api\") ? \"/usr/share/nginx/html\" : $_SERVER['DOCUMENT_ROOT']) . '/includes/redis.php'; // create connection with redis\n        $redisKey = strtolower($redisKey); // redis is case-insensitive\n        $data = $redis->get($redisKey);\n        if (!$data) {\n                $query = mysql\\query($sqlQuery,$args, $types);\n                if ($query->num_rows < 1) // check if MySQL found any rows\n                {\n                        $redis->set($redisKey, 'not_found'); // save redis key indicating record not found\n                        $redis->expire($redisKey, 300); // if the data doesn't exist, only keep Redis key for 5 minutes to mitigate against spam\n                        return 'not_found';\n                }\n                if ($multiRowed) { // return multi-rowed response for applications such as chat channels where multiple rows containing messages\n                        while ($r = mysqli_fetch_assoc($query->result)) {\n                                $data[] = $r;\n                        }\n                } else {\n                        $data = mysqli_fetch_array($query->result);\n                }\n\n                $redis->set($redisKey, serialize($data)); // save data to redis key so next time it's retrieved much quicker from cache\n\n                if(str_contains($redisKey, \"keyauthsubs\")) { // ensure no users can login for longer than they're supposed to\n                        $expiries = array();\n                        foreach ($data as $row) {\n                                $expiries[] = $row['expiry'];\n                        }\n                        $ttl = intval(min($expiries) - time());\n                        $redis->expire($redisKey, $ttl);\n                }\n\n                if(str_contains($redisKey, \"keyauthsellercheck\")) { // ensure no customers can use SellerAPI for longer than the period they have seller plan\n                        $ttl = intval($data[\"expires\"] - time());\n                        $redis->expire($redisKey, $ttl);\n                }\n\n                if(str_contains($redisKey, \"keyauthstate\")) { // ensure no users stay logged in for longer than they're supposed to\n                        $ttl = intval($data[\"expiry\"] - time());\n                        $redis->expire($redisKey, $ttl);\n                }\n\n                if (!is_null($expiry)) {\n                        $redis->expire($redisKey, intval($expiry)); // set TTL if specified\n                }\n        } else {\n                if ($data == \"not_found\") {\n                        return 'not_found';\n                }\n                $data = unserialize($data);\n        }\n        return $data; // return data from either MySQL or Redis\n}\nfunction purge($redisKey) // delete key from Redis cache (typically called when MySQL row(s) updated or deleted)\n{\n        $redisKey = strtolower($redisKey); // redis is case-insensitive, and key must be encoded for HTTP request used in production\n        global $redisServers;\n        if(!empty($redisServers)) {\n                $redisKey = urlencode($redisKey);\n                // for production setup, to purge redis keys from all servers\n                foreach ($redisServers as $server) {\n                        $url = $server . \"&type=purge&key={$redisKey}\";\n\n                        $curl = curl_init($url);\n                        curl_setopt($curl, CURLOPT_URL, $url);\n                        curl_setopt($curl, CURLOPT_HTTPHEADER, array('host: keyauth.win'));\n                        curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);\n                        \n                        curl_exec($curl);\n                        curl_close($curl);\n                }\n                return;\n        }\n\n        global $redis;\n        include_once (($_SERVER['DOCUMENT_ROOT'] == \"/usr/share/nginx/html/panel\" || $_SERVER['DOCUMENT_ROOT'] == \"/usr/share/nginx/html/api\") ? \"/usr/share/nginx/html\" : $_SERVER['DOCUMENT_ROOT']) . '/includes/redis.php'; // create connection with Redis\n        $redis->del($redisKey);\n}\n\nfunction purgePattern($redisKey) // purge all data starting with, ending with, or both and unknown text in between\n{\n        if($redisKey == \"*\" || empty($redisKey)) {\n                die(\"Invalid redis key purge value. Must specify some text.\");\n        }\n        $redisKey = strtolower($redisKey); // redis is case-insensitive, and key must be encoded for HTTP request used in production\n        global $redisServers;\n        if(!empty($redisServers)) {\n                $redisKey = urlencode($redisKey);\n                // for production setup, to purge redis keys from all servers\n                foreach ($redisServers as $server) {\n                        $url = $server . \"&type=purgePattern&key={$redisKey}\";\n\n                        $curl = curl_init($url);\n                        curl_setopt($curl, CURLOPT_URL, $url);\n                        curl_setopt($curl, CURLOPT_HTTPHEADER, array('host: keyauth.win'));\n                        curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);\n\n                        curl_exec($curl);\n                        curl_close($curl);\n                }\n                return;\n        }\n        \n        global $redis;\n        include_once (($_SERVER['DOCUMENT_ROOT'] == \"/usr/share/nginx/html/panel\" || $_SERVER['DOCUMENT_ROOT'] == \"/usr/share/nginx/html/api\") ? \"/usr/share/nginx/html\" : $_SERVER['DOCUMENT_ROOT']) . '/includes/redis.php'; // create connection with Redis\n        $redis->delete($redis->keys($redisKey . '*'));\n}\n\nfunction rateLimit($redisKey, $amount, $expiry, $limit) // rate limiting with Redis, prevent spam/DDoS attack(s)\n{\n        global $redis;\n        include_once (($_SERVER['DOCUMENT_ROOT'] == \"/usr/share/nginx/html/panel\" || $_SERVER['DOCUMENT_ROOT'] == \"/usr/share/nginx/html/api\") ? \"/usr/share/nginx/html\" : $_SERVER['DOCUMENT_ROOT']) . '/includes/redis.php'; // create connection with Redis\n        $redisKey = strtolower($redisKey); // redis is case-insensitive\n        $data = $redis->get($redisKey);\n        if (!$data) {\n                $redis->set($redisKey, $amount, $expiry);\n                return false;\n        } else {\n                if (intval($data) >= $limit) {\n                        $ttl = $redis->ttl($redisKey);\n                        if($ttl > $expiry || $ttl < 0) {\n                                purge($redisKey);\n                                return false;\n                        }\n                        return true;\n                }\n                $redis->incr($redisKey, $amount);\n                return false;\n        }\n}\n\nfunction select($redisKey) {\n        global $redis;\n        include_once (($_SERVER['DOCUMENT_ROOT'] == \"/usr/share/nginx/html/panel\" || $_SERVER['DOCUMENT_ROOT'] == \"/usr/share/nginx/html/api\") ? \"/usr/share/nginx/html\" : $_SERVER['DOCUMENT_ROOT']) . '/includes/redis.php'; // create connection with Redis\n        $redisKey = strtolower($redisKey); // redis is case-insensitive\n        return $redis->get($redisKey);\n}\n\nfunction insert($redisKey, $value, $expiry) {\n        $redisKey = strtolower($redisKey); // redis is case-insensitive\n\n        global $redisServers;\n        if(!empty($redisServers)) {\n                // for production setup, to purge redis keys from all servers\n\n                $data = base64_encode($value);\n                foreach ($redisServers as $server) {\n                        $url = $server . \"&type=insert&key={$redisKey}&data={$data}&expiry={$expiry}\";\n\n                        $curl = curl_init($url);\n                        curl_setopt($curl, CURLOPT_URL, $url);\n                        curl_setopt($curl, CURLOPT_HTTPHEADER, array('host: keyauth.win'));\n                        curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);\n\n                        curl_exec($curl);\n                        curl_close($curl);\n                }\n                return;\n        }\n\n        global $redis;\n        include_once (($_SERVER['DOCUMENT_ROOT'] == \"/usr/share/nginx/html/panel\" || $_SERVER['DOCUMENT_ROOT'] == \"/usr/share/nginx/html/api\") ? \"/usr/share/nginx/html\" : $_SERVER['DOCUMENT_ROOT']) . '/includes/redis.php'; // create connection with Redis\n        $redis->set($redisKey, $value, $expiry);\n}\n\nfunction update($redisKey, ...$replacements) {\n        global $redis;\n        include_once (($_SERVER['DOCUMENT_ROOT'] == \"/usr/share/nginx/html/panel\" || $_SERVER['DOCUMENT_ROOT'] == \"/usr/share/nginx/html/api\") ? \"/usr/share/nginx/html\" : $_SERVER['DOCUMENT_ROOT']) . '/includes/redis.php'; // create connection with Redis\n        $redisKey = strtolower($redisKey); // redis is case-insensitive\n        \n        $data = unserialize($redis->get($redisKey));\n\n        if(!$data) {\n                return false;\n        }\n\n        global $redisServers;\n        if(!empty($redisServers)) {\n                // for production setup, to update redis keys on all servers\n                foreach ($redisServers as $server) {\n                        $url = $server . \"&type=update&key={$redisKey}\";\n\n                        $json_data = json_encode([\n                                \"data\" => $replacements[0]\n                        ]);\n\n                        $curl = curl_init($url);\n                        curl_setopt($curl, CURLOPT_URL, $url);\n                        curl_setopt($curl, CURLOPT_HTTPHEADER, array(\n                                'Content-type: application/json',\n                                'host: keyauth.win'\n                        ));\n                        curl_setopt($curl, CURLOPT_POST, 1);\n                            curl_setopt($curl, CURLOPT_POSTFIELDS, $json_data);\n                        curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);\n\n                        curl_exec($curl);\n                        curl_close($curl);\n                }\n                return true;\n        }\n\n        $new = serialize(array_replace($data, ...$replacements));\n\n        $redis->set($redisKey, $new, ['KEEPTTL']);\n\n        return true;\n}\n","size_bytes":10253},"includes/misc/chat.php":{"content":"<?php\n\nnamespace misc\\chat;\n\nuse misc\\etc;\nuse misc\\cache;\nuse misc\\mysql;\n\nfunction deleteMessage($id, $secret = null)\n{\n        $id = etc\\sanitize($id);\n\n        $query = mysql\\query(\"SELECT `channel` FROM `chatmsgs` WHERE `app` = ? AND `id` = ?\",[$secret ?? $_SESSION['app'], $id]);\n        $row = mysqli_fetch_array($query->result);\n        cache\\purge('KeyAuthChatMsgs:' . ($secret ?? $_SESSION['app']) . ':' . $row['channel']);\n\n        $query = mysql\\query(\"DELETE FROM `chatmsgs` WHERE `app` = ? AND `id` = ?\",[$secret ?? $_SESSION['app'], $id]);\n        if ($query->affected_rows > 0) {\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction muteUser($user, $time, $secret = null)\n{\n        $user = etc\\sanitize($user);\n        $time = etc\\sanitize($time);\n\n        $query = mysql\\query(\"SELECT 1 FROM `users` WHERE `app` = ? AND `username` = ?\",[$secret ?? $_SESSION['app'], $user]);\n        if ($query->num_rows == 0) {\n                return 'missing';\n        }\n        $query = mysql\\query(\"INSERT INTO `chatmutes` (`user`, `time`, `app`) VALUES (?, ?, ?)\",[$user, $time, $secret ?? $_SESSION['app']]);\n        if ($query->affected_rows > 0) {\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthMutes:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction unMuteUser($user, $secret = null)\n{\n        $user = etc\\sanitize($user);\n\n        $query = mysql\\query(\"DELETE FROM `chatmutes` WHERE `app` = ? AND `user` = ?\",[$secret ?? $_SESSION['app'], $user]);\n\n        if ($query->affected_rows > 0) {\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthMutes:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction clearChannel($channel, $secret = null)\n{\n        $channel = etc\\sanitize($channel);\n\n        $query = mysql\\query(\"DELETE FROM `chatmsgs` WHERE `app` = ? AND `channel` = ?\",[$secret ?? $_SESSION['app'], $channel]);\n\n        if ($query->affected_rows > 0) {\n                cache\\purge('KeyAuthChatMsgs:' . ($secret ?? $_SESSION['app']) . ':' . $channel);\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction createChannel($name, $delay, $secret = null)\n{\n        $name = etc\\sanitize($name);\n        $delay = etc\\sanitize($delay);\n\n        $query = mysql\\query(\"INSERT INTO `chats` (`name`, `delay`, `app`) VALUES (?, ?, ?)\",[$name, $delay, $secret ?? $_SESSION['app']]);\n\n        if ($query->affected_rows > 0) {\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthChats:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction deleteChannel($name, $secret = null)\n{\n        $name = etc\\sanitize($name);\n\n        $query = mysql\\query(\"DELETE FROM `chats` WHERE `app` = ? AND `name` = ?\",[$secret ?? $_SESSION['app'], $name]);\n\n        if ($query->affected_rows > 0) {\n                $query = mysql\\query(\"DELETE FROM `chatmsgs` WHERE `app` = ? AND `channel` = ?\",[$secret ?? $_SESSION['app'], $name]);\n                cache\\purge('KeyAuthChatMsgs:' . ($secret ?? $_SESSION['app']) . ':' . $name);\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthChats:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\n","size_bytes":3814},"includes/misc/email.php":{"content":"<?php\n\nnamespace misc\\email;\n\nfunction send($username, $email, $content, $subject) {\n        global $awsAccessKey;\n        global $awsSecretKey;\n        \n        if(empty($awsAccessKey)) {\n                return;\n        }\n        \n        require_once (($_SERVER['DOCUMENT_ROOT'] == \"/usr/share/nginx/html/panel\" || $_SERVER['DOCUMENT_ROOT'] == \"/usr/share/nginx/html/api\") ? \"/usr/share/nginx/html\" : $_SERVER['DOCUMENT_ROOT']) . '/vendor/autoload.php';\n        \n        $content = '<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n        <html xmlns=\"http://www.w3.org/1999/xhtml\">\n          <head>\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n            <meta name=\"x-apple-disable-message-reformatting\" />\n            <meta name=\"color-scheme\" content=\"light dark\" />\n            <meta name=\"supported-color-schemes\" content=\"light dark\" />\n            <style type=\"text/css\" rel=\"stylesheet\" media=\"all\">\n    \n            @import url(\"https://fonts.googleapis.com/css?family=Nunito+Sans:400,700&display=swap\");\n            body {\n              width: 100% !important;\n              height: 100%;\n              margin: 0;\n              -webkit-text-size-adjust: none;\n            }\n            \n            a img {\n              border: none;\n            }\n            \n            td {\n              word-break: break-word;\n            }\n            \n            .preheader {\n              display: none !important;\n              visibility: hidden;\n              mso-hide: all;\n              font-size: 1px;\n              line-height: 1px;\n              max-height: 0;\n              max-width: 0;\n              opacity: 0;\n              overflow: hidden;\n            }\n            \n            body,\n            td,\n            th {\n              font-family: \"Nunito Sans\", Helvetica, Arial, sans-serif;\n            }\n            \n            h1 {\n              margin-top: 0;\n              color: #333333;\n              font-size: 22px;\n              font-weight: bold;\n              text-align: left;\n            }\n            \n            h2 {\n              margin-top: 0;\n              color: #333333;\n              font-size: 16px;\n              font-weight: bold;\n              text-align: left;\n            }\n            \n            h3 {\n              margin-top: 0;\n              color: #333333;\n              font-size: 14px;\n              font-weight: bold;\n              text-align: left;\n            }\n            \n            td,\n            th {\n              font-size: 16px;\n            }\n            \n            p,\n            ul,\n            ol,\n            blockquote {\n              margin: .4em 0 1.1875em;\n              font-size: 16px;\n              line-height: 1.625;\n            }\n            \n            p.sub {\n              font-size: 13px;\n            }\n            \n            .align-right {\n              text-align: right;\n            }\n            \n            .align-left {\n              text-align: left;\n            }\n            \n            .align-center {\n              text-align: center;\n            }\n            \n            .u-margin-bottom-none {\n              margin-bottom: 0;\n            }\n            \n            .button {\n              background-color: #3869D4;\n              border-top: 10px solid #3869D4;\n              border-right: 18px solid #3869D4;\n              border-bottom: 10px solid #3869D4;\n              border-left: 18px solid #3869D4;\n              display: inline-block;\n              color: #FFF;\n              text-decoration: none;\n              border-radius: 3px;\n              -webkit-text-size-adjust: none;\n              box-sizing: border-box;\n            }\n            \n            .button--green {\n              background-color: #22BC66;\n              border-top: 10px solid #22BC66;\n              border-right: 18px solid #22BC66;\n              border-bottom: 10px solid #22BC66;\n              border-left: 18px solid #22BC66;\n            }\n            \n            .button--red {\n              background-color: #FF6136;\n              border-top: 10px solid #FF6136;\n              border-right: 18px solid #FF6136;\n              border-bottom: 10px solid #FF6136;\n              border-left: 18px solid #FF6136;\n            }\n            \n            @media only screen and (max-width: 500px) {\n              .button {\n                width: 100% !important;\n                text-align: center !important;\n              }\n            }\n            \n            .attributes {\n              margin: 0 0 21px;\n            }\n            \n            .attributes_content {\n              background-color: #F4F4F7;\n              padding: 16px;\n            }\n            \n            .attributes_item {\n              padding: 0;\n            }\n            \n            .related {\n              width: 100%;\n              margin: 0;\n              padding: 25px 0 0 0;\n              -premailer-width: 100%;\n              -premailer-cellpadding: 0;\n              -premailer-cellspacing: 0;\n            }\n            \n            .related_item {\n              padding: 10px 0;\n              color: #CBCCCF;\n              font-size: 15px;\n              line-height: 18px;\n            }\n            \n            .related_item-title {\n              display: block;\n              margin: .5em 0 0;\n            }\n            \n            .related_item-thumb {\n              display: block;\n              padding-bottom: 10px;\n            }\n            \n            .related_heading {\n              border-top: 1px solid #CBCCCF;\n              text-align: center;\n              padding: 25px 0 10px;\n            }\n            \n            .discount {\n              width: 100%;\n              margin: 0;\n              padding: 24px;\n              -premailer-width: 100%;\n              -premailer-cellpadding: 0;\n              -premailer-cellspacing: 0;\n              background-color: #F4F4F7;\n              border: 2px dashed #CBCCCF;\n            }\n            \n            .discount_heading {\n              text-align: center;\n            }\n            \n            .discount_body {\n              text-align: center;\n              font-size: 15px;\n            }\n            \n            .social {\n              width: auto;\n            }\n            \n            .social td {\n              padding: 0;\n              width: auto;\n            }\n            \n            .social_icon {\n              height: 20px;\n              margin: 0 8px 10px 8px;\n              padding: 0;\n            }\n            \n            .purchase {\n              width: 100%;\n              margin: 0;\n              padding: 35px 0;\n              -premailer-width: 100%;\n              -premailer-cellpadding: 0;\n              -premailer-cellspacing: 0;\n            }\n            \n            .purchase_content {\n              width: 100%;\n              margin: 0;\n              padding: 25px 0 0 0;\n              -premailer-width: 100%;\n              -premailer-cellpadding: 0;\n              -premailer-cellspacing: 0;\n            }\n            \n            .purchase_item {\n              padding: 10px 0;\n              color: #51545E;\n              font-size: 15px;\n              line-height: 18px;\n            }\n            \n            .purchase_heading {\n              padding-bottom: 8px;\n              border-bottom: 1px solid #EAEAEC;\n            }\n            \n            .purchase_heading p {\n              margin: 0;\n              color: #85878E;\n              font-size: 12px;\n            }\n            \n            .purchase_footer {\n              padding-top: 15px;\n              border-top: 1px solid #EAEAEC;\n            }\n            \n            .purchase_total {\n              margin: 0;\n              text-align: right;\n              font-weight: bold;\n              color: #333333;\n            }\n            \n            .purchase_total--label {\n              padding: 0 15px 0 0;\n            }\n            \n            body {\n              background-color: #F2F4F6;\n              color: #51545E;\n            }\n            \n            p {\n              color: #51545E;\n            }\n            \n            .email-wrapper {\n              width: 100%;\n              margin: 0;\n              padding: 0;\n              -premailer-width: 100%;\n              -premailer-cellpadding: 0;\n              -premailer-cellspacing: 0;\n              background-color: #F2F4F6;\n            }\n            \n            .email-content {\n              width: 100%;\n              margin: 0;\n              padding: 0;\n              -premailer-width: 100%;\n              -premailer-cellpadding: 0;\n              -premailer-cellspacing: 0;\n            }\n            \n            .email-masthead {\n              text-align: center;\n            }\n            \n            .email-masthead_logo {\n              width: 94px;\n            }\n            \n            .email-masthead_name {\n              font-size: 16px;\n              font-weight: bold;\n              color: #A8AAAF;\n              text-decoration: none;\n              text-shadow: 0 1px 0 white;\n            }\n            \n            .email-body {\n              width: 100%;\n              margin: 0;\n              padding: 0;\n              -premailer-width: 100%;\n              -premailer-cellpadding: 0;\n              -premailer-cellspacing: 0;\n            }\n            \n            .email-body_inner {\n              width: 570px;\n              margin: 0 auto;\n              padding: 0;\n              -premailer-width: 570px;\n              -premailer-cellpadding: 0;\n              -premailer-cellspacing: 0;\n              background-color: #FFFFFF;\n            }\n            \n            .email-footer {\n              width: 570px;\n              margin: 0 auto;\n              padding: 0;\n              -premailer-width: 570px;\n              -premailer-cellpadding: 0;\n              -premailer-cellspacing: 0;\n              text-align: center;\n            }\n            \n            .email-footer p {\n              color: #A8AAAF;\n            }\n            \n            .body-action {\n              width: 100%;\n              margin: 30px auto;\n              padding: 0;\n              -premailer-width: 100%;\n              -premailer-cellpadding: 0;\n              -premailer-cellspacing: 0;\n              text-align: center;\n            }\n            \n            .body-sub {\n              margin-top: 25px;\n              padding-top: 25px;\n              border-top: 1px solid #EAEAEC;\n            }\n            \n            .content-cell {\n              padding: 45px;\n            }\n            \n            @media only screen and (max-width: 600px) {\n              .email-body_inner,\n              .email-footer {\n                width: 100% !important;\n              }\n            }\n            \n            @media (prefers-color-scheme: dark) {\n              body,\n              .email-body,\n              .email-body_inner,\n              .email-content,\n              .email-wrapper,\n              .email-masthead,\n              .email-footer {\n                background-color: #333333 !important;\n                color: #FFF !important;\n              }\n              p,\n              ul,\n              ol,\n              blockquote,\n              h1,\n              h2,\n              h3,\n              span,\n              .purchase_item {\n                color: #FFF !important;\n              }\n              .attributes_content,\n              .discount {\n                background-color: #222 !important;\n              }\n              .email-masthead_name {\n                text-shadow: none !important;\n              }\n            }\n            \n            :root {\n              color-scheme: light dark;\n              supported-color-schemes: light dark;\n            }\n            </style>\n          </head>\n          <body>\n            <table class=\"email-wrapper\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\">\n              <tr>\n                <td align=\"center\">\n                  <table class=\"email-content\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\">\n                    <tr>\n                      <td class=\"email-masthead\" style=\"text-align: center\";>\n                        <a href=\"https://keyauth.cc\" class=\"f-fallback email-masthead_name\">\n                        <img src=\"https://cdn.keyauth.cc/v2/assets/media/logos/logo-1-white.png\" width=\"180\" height=\"100\">\n                      </a>\n                      </td>\n                    </tr>\n                    <!-- Email Body -->\n                    <tr>\n                      <td class=\"email-body\" width=\"570\" cellpadding=\"0\" cellspacing=\"0\">\n                        <table class=\"email-body_inner\" align=\"center\" width=\"570\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\">\n                          <!-- Body content -->\n                          <tr>\n                            <td class=\"content-cell\">'.$content.'</td>\n                          </tr>\n                        </table>\n                      </td>\n                    </tr>\n                    <tr>\n                      <td>\n                        <table class=\"email-footer\" align=\"center\" width=\"570\" cellpadding=\"0\" cellspacing=\"0\" role=\"presentation\">\n                          <tr>\n                                           <td align=\"center\">\n                            <p class=\"f-fallback sub align-center\">\n                              <br>Nelson Cybersecurity LLC\n                              <br>1317 Edgewater Dr\n                              <br>Suite 6111\n                              <br>Orlando, FL 32804\n                                                  <br>Transactional email, unsubscribe <a href=\"https://keyauth.cc/deleteAccount/\">https://keyauth.cc/deleteAccount/</a>\n                            </p>\n                        </td>\n                          </tr>\n                        </table>\n                      </td>\n                    </tr>\n                  </table>\n                </td>\n              </tr>\n            </table>\n          </body>\n        </html>';\n\n        $m = new \\SimpleEmailServiceMessage();\n        $m->addTo(\"{$username} <{$email}>\");\n        $m->setFrom('KeyAuth <noreply@keyauth.cc>');\n        $m->setSubject(\"{$subject}\");\n        $m->setMessageFromString($content, $content);\n        \n        $region_endpoint = \\SimpleEmailService::AWS_US_EAST_2;\n        $ses = new \\SimpleEmailService($awsAccessKey, $awsSecretKey, $region_endpoint);\n        $ses->sendEmail($m);\n}\n","size_bytes":14562},"includes/misc/etc.php":{"content":"<?php\r\n\r\nnamespace misc\\etc;\r\n\r\nfunction sanitize($input)\r\n{\r\n    $input = strip_tags(trim($input));\r\n    if (empty($input) & !is_numeric($input)) \r\n    { // in the event the input can't be sanitized\r\n        return NULL;\r\n    }\r\n    return $input;\r\n}\r\n\r\nfunction random_string_lower($length = 10, $keyspace = \"0123456789abcdefghijklmnopqrstuvwxyz\"): string \r\n{\r\n    $out = '';\r\n    for ($i = 0; $i < $length; $i++)\r\n    {\r\n        $rand_index = random_int(0, strlen($keyspace) -1);\r\n        $out .= $keyspace[$rand_index];\r\n    }\r\n    return $out;\r\n}\r\n\r\nfunction random_string_upper($length = 10, $keyspace = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"): string \r\n{\r\n    $out = '';\r\n    for ($i = 0; $i < $length; $i++)\r\n    {\r\n        $rand_index = random_int(0, strlen($keyspace) -1);\r\n        $out .= $keyspace[$rand_index];\r\n    }\r\n    return $out;\r\n}\r\n\r\nfunction random_string_gen($length = 10, $keyspace = '0123456789aAbBcCdDeEfFgGhHiIjJkKlLmMnNoOpPqQrRsStTuUvVwWxXyYzZ'): string // generates both lower and capital letters based on checkbox results\r\n{ // https://github.com/FinGu/c_auth/blob/cfbd7036e69561e538e26dc47f7690dbc0d8ba53/functions/general/functions.php#L55\r\n    $out = '';\r\n    for ($i = 0; $i < $length; $i++) \r\n    {\r\n        $rand_index = random_int(0, strlen($keyspace) - 1);\r\n        $out .= $keyspace[$rand_index];\r\n    }\r\n    return $out;\r\n}\r\nfunction formatBytes($bytes, $precision = 2) // convert number of file bytes to human-recognizable unit\r\n{ // https://stackoverflow.com/a/2510459\r\n    $units = array(\r\n        'B',\r\n        'KB',\r\n        'MB',\r\n        'GB',\r\n        'TB'\r\n    );\r\n    $bytes = max($bytes, 0);\r\n    $pow = floor(($bytes ? log($bytes) : 0) / log(1024));\r\n    $pow = min($pow, count($units) - 1);\r\n\r\n    $bytes /= (1 << (10 * $pow));\r\n    return round($bytes, $precision) . ' ' . $units[$pow];\r\n}\r\nfunction generateRandomString($length = 10)\r\n{ // https://stackoverflow.com/a/4356295\r\n    $characters = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\r\n    $charactersLength = strlen($characters);\r\n    $randomString = '';\r\n    for ($i = 0; $i < $length; $i++) \r\n    {\r\n        $randomString .= $characters[rand(0, $charactersLength - 1)];\r\n    }\r\n    return $randomString;\r\n}\r\nfunction generateRandomNum($length = 6)\r\n{ // adapted from https://stackoverflow.com/a/4356295\r\n    $characters = '0123456789';\r\n    $charactersLength = strlen($characters);\r\n    $randomString = '';\r\n    for ($i = 0; $i < $length; $i++) \r\n    {\r\n        $randomString .= $characters[rand(0, $charactersLength - 1)];\r\n    }\r\n    return $randomString;\r\n}\r\nfunction isBreached($pw) // query HaveIBeenPwned's API (huge dataset, FBI and many other agencies worldwide contrubute) to see if pass has been leaked. This only supplies their API with SHA1 hash prefix\r\n{ // from https://github.com/Mikjaer/haveibeenpwned/blob/main/p0wned.php\r\n    $hash = strtoupper(sha1($pw));\r\n    foreach (explode(\"\\n\", file_get_contents(\"https://api.pwnedpasswords.com/range/\" . substr($hash, 0, 5))) as $pmatch)\r\n        if (substr($hash, 0, 5) . substr($pmatch, 0, strpos($pmatch, \":\")) == $hash)\r\n            return true;\r\n}\r\nfunction isPhonyEmail($email) // check if valid email format, if known temporary email, if email server online, and if mailbox found on email server\r\n{\r\n    if(!filter_var($email, FILTER_VALIDATE_EMAIL)) \r\n    {\r\n        return true;\r\n    }\r\n    \r\n    $resp = file_get_contents(\"https://api.mailcheck.ai/email/\" . $email);\r\n    $json = json_decode($resp);\r\n    \r\n    if($json->disposable) \r\n    {\r\n        return true;\r\n    }\r\n    \r\n    if (strpos($email, \".ru\") !== false) \r\n    {\r\n        return false; \r\n        // russian email services either have a lot of downtime or heavy rate limits, because every other time I make SMTP connection with an .ru email it fails\r\n    }\r\n    \r\n    if (strpos($email, \"proton\") !== false) \r\n    {\r\n        return false; \r\n        // protonmail is also giving us issues\r\n    }\r\n    \r\n    ini_set(\"default_socket_timeout\", 1);\r\n    $connection = @fsockopen(\"gmail-smtp-in.l.google.com\", 25);\r\n    \r\n    // check if port 25 is open (many hosts have it closed inherently)\r\n    if (is_resource($connection)) \r\n    {\r\n        global $mail;\r\n        require_once (($_SERVER['DOCUMENT_ROOT'] == \"/usr/share/nginx/html/panel\" || $_SERVER['DOCUMENT_ROOT'] == \"/usr/share/nginx/html/api\") ? \"/usr/share/nginx/html\" : $_SERVER['DOCUMENT_ROOT']) . '/includes/VerifyEmail.class.php'; \r\n        \r\n        return (!$mail->check($email));\r\n    }\r\n    else \r\n    {\r\n        return false;\r\n    }\r\n}\r\n\r\nfunction timeconversion($expires) {\r\n    $value = \"\";\r\n    $unit = \"\";\r\n\r\n    if ($expires >= 31536000) {\r\n        $value = floor($expires / 31536000);\r\n        $unit = 'Year(s)';\r\n    }\r\n    elseif ($expires >= 2419200) {\r\n        $value = floor($expires / 2592000);\r\n        $unit = 'Month(s)';\r\n    }\r\n    elseif ($expires >= 604800) {\r\n        $value = floor($expires / 604800);\r\n        $unit = 'Weeks(s)';\r\n    }\r\n    elseif ($expires >= 86400) {\r\n        $value = floor($expires / 86400);\r\n        $unit = 'Day(s)';\r\n    } elseif ($expires >= 3600) {\r\n        $value = floor($expires / 3600);\r\n        $unit = 'Hour(s)';\r\n    } elseif ($expires >= 60) {\r\n        $value = floor($expires / 60);\r\n        $unit = 'Minute(s)';\r\n    } else {\r\n        $value = $expires;\r\n        $unit = 'Second(s)';\r\n    }\r\n\r\n    return \"$value $unit\";\r\n}","size_bytes":5409},"includes/misc/license.php":{"content":"<?php\r\n\r\nnamespace misc\\license;\r\n\r\nuse misc\\etc;\r\nuse misc\\cache;\r\nuse misc\\user;\r\nuse misc\\mysql;\r\nuse misc\\token;\r\n\r\nfunction license_masking($mask, $int = null) // substitute random characters for upper-case and lower-case random character variables, X or x\r\n{\r\n        $mask_arr = str_split($mask);\r\n        $size_of_mask = count($mask_arr);\r\n        for ($i = 0; $i < $size_of_mask; $i++) \r\n        {\r\n                if ($mask_arr[$i] === '*') {\r\n                        if (isset($_POST['lowercaseLetters']) && $_POST['lowercaseLetters'] == 'on' && isset($_POST['capitalLetters']) && $_POST['capitalLetters'] == 'on')\r\n                        {\r\n                                $mask_arr[$i] = etc\\random_string_gen(1);\r\n                        }\r\n                        elseif (isset($_POST['lowercaseLetters']) && $_POST['lowercaseLetters'] == 'on') \r\n                        {\r\n                                $mask_arr[$i] = etc\\random_string_lower(1);\r\n                        }\r\n                        elseif (isset($_POST['capitalLetters']) && $_POST['capitalLetters'] == 'on') \r\n                        {\r\n                                $mask_arr[$i] = etc\\random_string_upper(1);\r\n                        }\r\n\r\n                else\r\n                {\r\n                        if (isset($int)) {\r\n                                if ($int === \"1\") \r\n                                {\r\n                                        $mask_arr[$i] = etc\\random_string_gen(1);\r\n                                }\r\n                                if ($int === \"2\") \r\n                                {\r\n                                        $mask_arr[$i] = etc\\random_string_upper(1);\r\n                                }\r\n                                if ($int === \"3\") \r\n                                {\r\n                                        $mask_arr[$i] = etc\\random_string_lower(1);\r\n                                }\r\n                        }\r\n                        else {\r\n                                $mask_arr[$i] = etc\\random_string_gen(1);\r\n                        }\r\n               }\r\n        }\r\n        }\r\n        return implode('', $mask_arr);\r\n}\r\nfunction createLicense($amount, $mask, $duration, $level, $note, $expiry = null, $secret = null, $owner = null, $character = null)\r\n{\r\n        $amount = etc\\sanitize($amount);\r\n        $mask = etc\\sanitize($mask);\r\n        $duration = etc\\sanitize($duration);\r\n        $level = etc\\sanitize($level);\r\n        $note = etc\\sanitize($note);\r\n        $expiry = etc\\sanitize($expiry);\r\n        $secret = etc\\sanitize($secret);\r\n        $letters = etc\\sanitize($character);\r\n\r\n        if ($amount > 100) \r\n        {\r\n                return 'max_keys';\r\n        }\r\n        if (!isset($amount)) \r\n        {\r\n                $amount = 1;\r\n        }\r\n        if (!is_numeric($level)) \r\n        {\r\n                $level = 1;\r\n        }\r\n        if (is_null($expiry)) \r\n        {\r\n                $expiry = 86400; // set unit to day(s) if license expiry unit isn't specified (as it isn't with SellerAPI)\r\n        }\r\n        $duration = $duration * $expiry;\r\n        if ($amount > 1 && strpos($mask, '*') === false) \r\n        {\r\n                return 'dupe_custom_key';\r\n        }\r\n\r\n        switch ($_SESSION['role']) \r\n        {\r\n                case 'tester':\r\n                        $query = mysql\\query(\"SELECT 1 FROM `keys` WHERE `genby` = ? AND `app` = ?\",[$_SESSION['username'], $_SESSION['app']]);\r\n                        $currkeys = $query->num_rows;\r\n                        if ($currkeys + $amount > 10) \r\n                        {\r\n                                return 'tester_limit';\r\n                        }\r\n\r\n                        $mask = \"KEYAUTH-\" . $mask;\r\n                        break;\r\n                case 'Reseller':\r\n                        if ($amount < 0) \r\n                        {\r\n                                return 'no_negative';\r\n                        }\r\n                        $query = mysql\\query(\"SELECT `keylevels`, `balance` FROM `accounts` WHERE `username` = ?\",[$_SESSION['username']]);\r\n                        $row = mysqli_fetch_array($query->result);\r\n                        $keylevels = explode(\"|\", $row['keylevels']);\r\n                        $balance = explode(\"|\", $row['balance']);\r\n                        if ($row['keylevels'] != \"N/A\" && !in_array($level, $keylevels)) \r\n                        {\r\n                                return 'unauthed_level';\r\n                        }\r\n                        $day = $balance[0];\r\n                        $week = $balance[1];\r\n                        $month = $balance[2];\r\n                        $threemonth = $balance[3];\r\n                        $sixmonth = $balance[4];\r\n                        $lifetime = $balance[5];\r\n\t\t\t$year = $balance[6];\r\n                        switch ($expiry) \r\n                        {\r\n                                case '1 Day':\r\n                                        $duration = 86400;\r\n                                        $day = $day - $amount;\r\n                                        break;\r\n                                case '1 Week':\r\n                                        $duration = 604800;\r\n                                        $week = $week - $amount;\r\n                                        break;\r\n                                case '1 Month':\r\n                                        $duration = 2.592e+6;\r\n                                        $month = $month - $amount;\r\n                                        break;\r\n                                case '3 Month':\r\n                                        $duration = 7.862e+6;\r\n                                        $threemonth = $threemonth - $amount;\r\n                                        break;\r\n                                case '6 Month':\r\n                                        $duration = 1.572e+7;\r\n                                        $sixmonth = $sixmonth - $amount;\r\n                                        break;\r\n                                case '1 Lifetime':\r\n                                        $duration = 8.6391e+8;\r\n                                        $lifetime = $lifetime - $amount;\r\n                                        break;\r\n\t\t\t\tcase '1 Year':\r\n                                        $duration = 3.1536e+7;\r\n                                        $year = $year - $amount;\r\n                                        break;\r\n                                default:\r\n                                        return 'invalid_exp';\r\n                                        break;\r\n                        }\r\n                        if ($day < 0 || $month < 0 || $week < 0 || $threemonth < 0 || $sixmonth < 0 || $lifetime < 0 || $year < 0) \r\n                        {\r\n                                return 'insufficient_balance';\r\n                        }\r\n                        $balance = $day . '|' . $week . '|' . $month . '|' . $threemonth . '|' . $sixmonth . '|' . $lifetime . '|' . $year;\r\n                        $query = mysql\\query(\"UPDATE `accounts` SET `balance` = ? WHERE `username` = ?\",[$balance, $_SESSION['username']]);\r\n                        break;\r\n                case 'seller':\r\n                        cache\\purge('KeyAuthKeys:' . ($secret ?? $_SESSION['app']));\r\n                        break;\r\n        }\r\n        \r\n        if(!is_null($secret)) {\r\n                cache\\purge('KeyAuthKeys:' . ($secret ?? $_SESSION['app']));\r\n        }\r\n\r\n        $licenses = array();\r\n\r\n        for ($i = 0; $i < $amount; $i++) {\r\n                $license = license_masking($mask, $letters);\r\n                \r\n                if (token\\ModifyUserToken($license, \"License\", null, null, $secret ?? $_SESSION[\"app\"]) === \"failed\") {\r\n                        return \"failure\";\r\n        }\r\n        $query = mysql\\query(\"INSERT INTO `keys` (`key`, `note`, `expires`, `status`, `level`, `genby`, `gendate`, `app`) VALUES (?, NULLIF(?, ''), ?, 'Not Used', ?, ?, ?, ?)\", [$license, $note, $duration, $level, $owner ?? $_SESSION['username'], time(), $secret ?? $_SESSION['app']]);\r\n        $licenses[] = $license;\r\n        }\r\n        return $licenses;\r\n}\r\n\r\nfunction addTime($time, $expiry, $secret = null)\r\n{\r\n        $time = etc\\sanitize($time);\r\n        $expiry = etc\\sanitize($expiry);\r\n\r\n        $time = $time * $expiry;\r\n        $query = mysql\\query(\"UPDATE `keys` SET `expires` = `expires`+? WHERE `app` = ? AND `status` = 'Not Used'\",[$time, $secret ?? $_SESSION['app']]);\r\n        if ($query->affected_rows > 0) \r\n        {\r\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) \r\n                {\r\n                        cache\\purge('KeyAuthKeys:' . ($secret ?? $_SESSION['app']));\r\n                }\r\n                return 'success';\r\n        } \r\n        else \r\n        {\r\n                return 'failure';\r\n        }\r\n}\r\nfunction deleteAll($secret = null)\r\n{\r\n        $query = mysql\\query(\"DELETE FROM `keys` WHERE `app` = ?\",[$secret ?? $_SESSION['app']]);\r\n        if ($query->affected_rows > 0) \r\n        {\r\n\t\t$query = mysql\\query(\"DELETE FROM `tokens` WHERE `app` = ? AND `type` = ?\",[$secret ?? $_SESSION['app'], \"license\"]);\r\n\r\n\t\tif ($query->affected_rows > 0) { cache\\purgePattern('KeyAuthUserTokens:' . ($secret ?? $_SESSION['app'])); }\r\n\t\t\r\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\r\n                        cache\\purge('KeyAuthKeys:' . ($secret ?? $_SESSION['app']));\r\n                }\r\n                return 'success';\r\n        } \r\n        else \r\n        {\r\n                return 'failure';\r\n        }\r\n}\r\nfunction deleteAllUnused($secret = null)\r\n{\r\n        $query = mysql\\query(\"DELETE FROM `keys` WHERE `app` = ? AND `status` = 'Not Used'\",[$secret ?? $_SESSION['app']]);\r\n        if ($query->affected_rows > 0) \r\n        {\r\n\t\t$query = mysql\\query(\"DELETE FROM `tokens` WHERE `app` = ? AND `status` = ? AND `type` = ?\",[$secret ?? $_SESSION['app'], \"Not Used\", \"license\"]);\r\n\r\n\t\tif ($query->affected_rows > 0) { cache\\purgePattern('KeyAuthUserTokens:' . ($secret ?? $_SESSION['app'])); }\r\n\t\t\r\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) \r\n                {\r\n                        cache\\purge('KeyAuthKeys:' . ($secret ?? $_SESSION['app']));\r\n                }\r\n                return 'success';\r\n        } \r\n        else \r\n        {\r\n                return 'failure';\r\n        }\r\n}\r\nfunction deleteAllUsed($secret = null)\r\n{\r\n        $query = mysql\\query(\"DELETE FROM `keys` WHERE `app` = ? AND `status` = 'Used'\",[$secret ?? $_SESSION['app']]);\r\n        if ($query->affected_rows > 0) \r\n        {\r\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) \r\n                {\r\n                        cache\\purge('KeyAuthKeys:' . ($secret ?? $_SESSION['app']));\r\n                }\r\n                return 'success';\r\n        } \r\n        else \r\n        {\r\n                return 'failure';\r\n        }\r\n}\r\nfunction deleteSingular($key, $userToo, $secret = null)\r\n{\r\n    $key = etc\\sanitize($key);\r\n    $userToo = etc\\sanitize($userToo);\r\n\r\n    if ($_SESSION['role'] == \"Reseller\") \r\n        {\r\n        $query = mysql\\query(\"SELECT 1 FROM `keys` WHERE `app` = ? AND `key` = ? AND `genby` = ?\",[$secret ?? $_SESSION['app'], $key, $_SESSION['username']]);\r\n        if ($query->num_rows < 1) \r\n                {\r\n            return 'nope';\r\n        }\r\n    }\r\n\r\n    if ($userToo) {\r\n        $query = mysql\\query(\"SELECT `usedby` FROM `keys` WHERE `app` = ? AND `key` = ?\",[$secret ?? $_SESSION['app'], $key]);\r\n        $row = mysqli_fetch_array($query->result);\r\n        $usedby = $row['usedby'];\r\n\r\n        user\\deleteSingular($usedby, $secret);\r\n    }\r\n\r\n    $query = mysql\\query(\"DELETE FROM `subs` WHERE `app` = ? AND `key` = ?\",[$secret ?? $_SESSION['app'], $key]);// delete any subscriptions created with key\r\n    $query = mysql\\query(\"DELETE FROM `tokens` WHERE `app` = ? AND `assigned` = ?\", [$secret ?? $_SESSION['app'], $key]);\r\n    $query = mysql\\query(\"DELETE FROM `keys` WHERE `app` = ? AND `key` = ?\",[$secret ?? $_SESSION['app'], $key]);\r\n     if ($query->affected_rows > 0) {\r\n        cache\\purgePattern('KeyAuthUserTokens:' . ($secret ?? $_SESSION['app'])); \r\n        if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\r\n            cache\\purge('KeyAuthKeys:' . ($secret ?? $_SESSION['app']));\r\n            cache\\purge('KeyAuthKey:' . ($secret ?? $_SESSION['app']) . ':' . $key);\r\n        }\r\n        return 'success';\r\n    } else {\r\n        return 'failure';\r\n    }\r\n}\r\n\r\nfunction deleteMultiple($keys, $userToo, $secret = null) {\r\n    $keys = explode(', ', $keys);\r\n    $userToo = etc\\sanitize($userToo);\r\n\r\n    foreach ($keys as $key) {\r\n        $key = etc\\sanitize(trim($key));\r\n\r\n        if ($_SESSION['role'] == \"Reseller\") \r\n                {\r\n            $query = mysql\\query(\"SELECT 1 FROM `keys` WHERE `app` = ? AND `key` = ? AND `genby` = ?\",[$secret ?? $_SESSION['app'], $key, $_SESSION['username']]);\r\n            if ($query->num_rows < 1) \r\n                        {\r\n                return 'nope';\r\n            }\r\n        }\r\n\r\n        if ($userToo) \r\n                {\r\n            $query = mysql\\query(\"SELECT `usedby` FROM `keys` WHERE `app` = ? AND `key` = ?\",[$secret ?? $_SESSION['app'], $key]);\r\n            $row = mysqli_fetch_array($query->result);\r\n            $usedby = $row['usedby'];\r\n\r\n            user\\deleteSingular($usedby, $secret);\r\n        }\r\n\r\n        $query = mysql\\query(\"DELETE FROM `subs` WHERE `app` = ? AND `key` = ?\",[$secret ?? $_SESSION['app'], $key]);// delete any subscriptions created with key\r\n        $query = mysql\\query(\"DELETE FROM `tokens` WHERE `app` = ? AND `assigned` = ?\", [$secret ?? $_SESSION['app'], $key]);\r\n\t$query = mysql\\query(\"DELETE FROM `keys` WHERE `app` = ? AND `key` = ?\",[$secret ?? $_SESSION['app'], $key]);\r\n       if ($query->affected_rows > 0) {\r\n                cache\\purgePattern('KeyAuthUserTokens:' . ($secret ?? $_SESSION['app'])); \r\n            if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\r\n                cache\\purge('KeyAuthKeys:' . ($secret ?? $_SESSION['app']));\r\n                cache\\purge('KeyAuthKey:' . ($secret ?? $_SESSION['app']) . ':' . $key);\r\n            }\r\n        } else {\r\n            return 'failure';\r\n        }\r\n    }\r\n    return 'success';\r\n}\r\n\r\nfunction ban($key, $reason, $userToo, $secret = null)\r\n{\r\n        $key = etc\\sanitize($key);\r\n        $reason = etc\\sanitize($reason);\r\n        $userToo = etc\\sanitize($userToo);\r\n\r\n        if ($_SESSION['role'] == \"Reseller\") \r\n        {\r\n                $query = mysql\\query(\"SELECT 1 FROM `keys` WHERE `app` = ? AND `key` = ? AND `genby` = ?\", [$secret ?? $_SESSION['app'], $key, $_SESSION['username']]);\r\n                if ($query->num_rows === 0) \r\n                {\r\n                        return 'nope';\r\n                }\r\n        }\r\n\r\n        if ($userToo) {\r\n                $query = mysql\\query(\"SELECT `usedby` FROM `keys` WHERE `app` = ? AND `key` = ?\", [$secret ?? $_SESSION['app'], $key]);\r\n                $row = mysqli_fetch_array($query->result);\r\n                $usedby = $row['usedby'];\r\n                \r\n                user\\ban($usedby, $reason, $secret);\r\n        }\r\n\r\n        $query = mysql\\query(\"UPDATE `keys` SET `banned` = ?, `status` = 'Banned' WHERE `app` = ? AND `key` = ?\",[$reason, $secret ?? $_SESSION['app'], $key]);\r\n        if ($query->affected_rows > 0) \r\n        {\r\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\r\n                        cache\\purge('KeyAuthKeys:' . ($secret ?? $_SESSION['app']));\r\n                }\r\n\r\n                $query = mysql\\query(\"UPDATE `tokens` SET `banned` = ?, `reason` = NULL WHERE `app` = ? AND `assigned` = ? AND `type` = ?\", [1, $secret ?? $_SESSION['app'], $key, \"license\"]);\r\n\t\tif ($query->affected_rows > 0) { \r\n                        cache\\purgePattern('KeyAuthUserTokens:' . ($secret ?? $_SESSION['app'])); \r\n                } else { \r\n                        return 'failure'; \r\n                }                         \r\n                return 'success';\r\n        } \r\n        else \r\n        {\r\n                return 'failure';\r\n        }\r\n}\r\nfunction unban($key, $secret = null)\r\n{\r\n        $key = etc\\sanitize($key);\r\n\r\n        if ($_SESSION['role'] == \"Reseller\") \r\n        {\r\n                $query = mysql\\query(\"SELECT 1 FROM `keys` WHERE `app` = ? AND `key` = ? AND `genby` = ?\",[$secret ?? $_SESSION['app'], $key, $_SESSION['username']]);\r\n                if ($query->num_rows === 0) \r\n                {\r\n                        return 'nope';\r\n                }\r\n        }\r\n\r\n        $status = \"Not Used\";\r\n        $query = mysql\\query(\"SELECT `usedby` FROM `keys` WHERE `app` = ? AND `key` = ?\",[$secret ?? $_SESSION['app'], $key]);\r\n        $row = mysqli_fetch_array($query->result);\r\n        if (!is_null($row['usedby'])) \r\n        {\r\n                $status = \"Used\";       \r\n                user\\unban($row['usedby'], $secret);\r\n        }\r\n\r\n        $query = mysql\\query(\"UPDATE `keys` SET `banned` = NULL, `status` = ? WHERE `app` = ? AND `key` = ?\",[$status, $secret ?? $_SESSION['app'], $key]);// update key from banned to its old status\r\n        if ($query->affected_rows > 0) \r\n        {\r\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) \r\n                {\r\n                        cache\\purge('KeyAuthKeys:' . ($secret ?? $_SESSION['app']));\r\n                }\r\n                \r\n                $query = mysql\\query(\"UPDATE `tokens` SET `banned` = 0, `reason` = NULL WHERE `app` = ? AND `assigned` = ? AND `type` = ?\", [$secret ?? $_SESSION['app'], $key, \"license\"]);\r\n\r\n\t\tif ($query->affected_rows > 0) { \r\n                        cache\\purgePattern('KeyAuthUserTokens:' . ($secret ?? $_SESSION['app']));    \r\n                } else { \r\n                        return 'failure'; \r\n                }\r\n                return 'success';\r\n        } \r\n        else \r\n        {\r\n                return 'failure';\r\n        }\r\n}\r\n","size_bytes":18047},"includes/misc/log.php":{"content":"<?php\n\nnamespace misc\\logging;\n\nuse misc\\etc;\nuse misc\\mysql;\n\nfunction deleteAll($secret = null)\n{\n  $query = mysql\\query(\"DELETE FROM `logs` WHERE `logapp` = ?\",[$secret ?? $_SESSION['app']]);\n  if ($query->affected_rows > 0) {\n    return 'success';\n  } else {\n    return 'failure';\n  }\n}\n","size_bytes":291},"includes/misc/mysql.php":{"content":"<?php\n\nnamespace misc\\mysql;\n\nfunction query($query, $args = [], $types = null)\n{\n        static $connection = null;\n        static $readOnlyConnection = null;\n\n        global $mysqlRequireSSL;\n        global $databaseHost;\n        global $databaseUsername;\n        global $databasePassword;\n        global $databaseName;\n        global $databasePort;\n        global $readOnlyRegions;\n\n        // use read-only database replica, for lower latency in regions far away from the primary database region\n        if(strtolower(substr($query, 0, 6)) == \"select\" && isset($readOnlyRegions[$_SERVER['SERVER_ADDR']])) {\n                if (!$readOnlyConnection) {\n                        $readOnlyConnection = new \\mysqli();\n                        \n                        // Performance optimizations for read-only\n                        $readOnlyConnection->options(MYSQLI_OPT_CONNECT_TIMEOUT, 5);\n                        $readOnlyConnection->options(MYSQLI_OPT_READ_TIMEOUT, 10);\n                        $readOnlyConnection->options(MYSQLI_OPT_INT_AND_FLOAT_NATIVE, 1);\n\n                        if ($mysqlRequireSSL) {\n                                $readOnlyConnection->ssl_set(NULL, NULL, \"/etc/ssl/certs/ca-bundle.crt\", NULL, NULL);\n                        }\n\n                        $readOnlyConnection->real_connect($readOnlyRegions[$_SERVER['SERVER_ADDR']][\"host\"], $readOnlyRegions[$_SERVER['SERVER_ADDR']][\"username\"], $readOnlyRegions[$_SERVER['SERVER_ADDR']][\"password\"], $databaseName, isset($readOnlyRegions[$_SERVER['SERVER_ADDR']][\"port\"]) ? $readOnlyRegions[$_SERVER['SERVER_ADDR']][\"port\"] : 3306, NULL, MYSQLI_CLIENT_COMPRESS);\n\n                        if (!$readOnlyConnection)\n                                die($readOnlyConnection->connect_error);\n\n                        $readOnlyConnection->set_charset('utf8mb4');\n                        \n                        // Optimize read-only connection for speed\n                        $readOnlyConnection->query(\"SET SESSION query_cache_type = ON\");\n                        $readOnlyConnection->query(\"SET SESSION sql_mode = 'NO_ENGINE_SUBSTITUTION'\");\n                        $readOnlyConnection->query(\"SET SESSION tx_isolation = 'READ-UNCOMMITTED'\");\n                }\n                $connectionToUse = $readOnlyConnection;\n        }\n        else {\n                if (!$connection) {\n                        $connection = new \\mysqli();\n                        \n                        // Performance optimizations\n                        $connection->options(MYSQLI_OPT_CONNECT_TIMEOUT, 5);\n                        $connection->options(MYSQLI_OPT_READ_TIMEOUT, 10);\n                        $connection->options(MYSQLI_OPT_INT_AND_FLOAT_NATIVE, 1);\n                        \n                        if ($mysqlRequireSSL) {\n                                $connection->ssl_set(NULL, NULL, \"/etc/ssl/certs/ca-bundle.crt\", NULL, NULL);\n                        }\n\n                        $connection->real_connect($databaseHost, $databaseUsername, $databasePassword, $databaseName, $databasePort, NULL, MYSQLI_CLIENT_COMPRESS);\n\n                        if (!$connection)\n                                die($connection->connect_error);\n\n                        $connection->set_charset('utf8mb4');\n                        \n                        // Optimize connection for speed\n                        $connection->query(\"SET SESSION query_cache_type = ON\");\n                        $connection->query(\"SET SESSION sql_mode = 'NO_ENGINE_SUBSTITUTION'\");\n                }\n                $connectionToUse = $connection;\n        }\n\n        if ($types === null && $args !== [])\n                $types = str_repeat('s', count($args)); // unless otherwise specified, set type to string\n\n        $stmt = $connectionToUse->prepare($query);\n\n        if (!$stmt)\n                die($connectionToUse->error);\n\n        if (strpos($query, '?') !== false)\n                $stmt->bind_param($types, ...$args);\n\n        $stmt->execute();\n\n        $query = new \\stdClass();\n        $query->result = $stmt->get_result();\n        $query->num_rows = $query->result->num_rows;\n        $query->affected_rows = $stmt->affected_rows;\n\n        $stmt->close();\n\n        return $query;\n}\n","size_bytes":4233},"includes/misc/session.php":{"content":"<?php\n\nnamespace misc\\session;\n\nuse misc\\etc;\nuse misc\\cache;\nuse misc\\mysql;\n\nfunction killAll($secret = null)\n{\n        $query = mysql\\query(\"DELETE FROM `sessions` WHERE `app` = ?\",[$secret ?? $_SESSION['app']]);\n        if ($query->affected_rows > 0) {\n                cache\\purgePattern('KeyAuthState:' . ($secret ?? $_SESSION['app']));\n                cache\\purge('KeyAuthSessions:' . ($secret ?? $_SESSION['app']));\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction killSingular($id, $secret = null)\n{\n        $id = etc\\sanitize($id);\n\n        $query = mysql\\query(\"SELECT `ip` FROM `sessions` WHERE `app` = ? AND `id` = ?\",[$secret ?? $_SESSION['app'], $id]);\n        $row = mysqli_fetch_array($query->result);\n\n        $query = mysql\\query(\"DELETE FROM `sessions` WHERE `app` = ? AND `id` = ?\",[$secret ?? $_SESSION['app'], $id]);\n        if ($query->affected_rows > 0) {\n                cache\\purge('KeyAuthState:' . ($secret ?? $_SESSION['app']) . ':' . $id);\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\n","size_bytes":1124},"includes/misc/sub.php":{"content":"<?php\n\nnamespace misc\\sub;\n\nuse misc\\etc;\nuse misc\\cache;\nuse misc\\mysql;\n\nfunction deleteSingular($subscription, $secret = null)\n{\n        $subscription = etc\\sanitize($subscription);\n\n        $query = mysql\\query(\"DELETE FROM `subscriptions` WHERE `app` = ? AND `name` = ?\",[$secret ?? $_SESSION['app'], $subscription]);\n        if ($query->affected_rows > 0) {\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthSubscriptions:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction add($name, $level, $secret = null)\n{\n        $name = etc\\sanitize($name);\n        $level = etc\\sanitize($level);\n\n        $query = mysql\\query(\"INSERT INTO `subscriptions` (`name`, `level`, `app`) VALUES (?, ?, ?)\",[$name , $level,$secret ?? $_SESSION['app']]);\n        if ($query->affected_rows > 0) {\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthSubscriptions:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\n","size_bytes":1242},"includes/misc/token.php":{"content":"<?php\n\nnamespace misc\\token;\n\nuse misc\\etc;\nuse misc\\cache;\nuse misc\\mysql;\n\nfunction IsAssignedToken($credential, $type, $secret = null, $return_token = false) {\n\n\t$type = strtolower($type);\n\n\tif ($type !== \"user\" && $type !== \"license\") { return \"invalid_type\"; }\n\n\t$row = cache\\fetch('KeyAuthUserTokenCheck:' . $secret ?? $_SESSION[\"app\"] . ':' . $credential, \"SELECT `token` FROM `tokens` WHERE `app` = ? AND `type` = ? AND `assigned` = ?\", [$secret ?? $_SESSION[\"app\"], $type, $credential], 0);\n\n\tif ($row === \"not_found\") {\n\t\treturn false;\n\t}\n\telse {\n\t\tif ($return_token) { return $row[\"token\"]; }\n\t\telse { return true; }\n\t}\n\n\n}\n\n\nfunction ModifyUserToken($credential, $type, $token = null, $username = null,  $secret = null) {\n\n\t$generated_token = bin2hex(random_bytes(16));\n\n\tswitch ($type) {\n\n\t\tcase 'User':\n\n\t\t\t$query = mysql\\query(\"INSERT INTO `tokens` (`app`, `token`, `type`, `assigned`) VALUES (?, ?, ?, ?)\", [$secret ?? $_SESSION[\"app\"], $generated_token, \"user\", $credential]);\n\n\t\t\tif ($query->affected_rows < 1) {\n\t\t\t\treturn \"failed\";\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn \"success\";\n\t\t\t}\n\n\t\tcase 'License':\n\n\t\t\t$query = mysql\\query(\"INSERT INTO `tokens` (`app`, `token`, `type`, `assigned`) VALUES (?, ?, ?, ?)\", [$secret ?? $_SESSION[\"app\"], $generated_token,  \"license\", $credential]);\n\n\t\t\tif ($query->affected_rows < 1) {\n\t\t\t\treturn \"failed\";\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn \"success\";\n\t\t\t}\n\n\t\tcase 'UpdateToUser':\n\t\t\t$query = mysql\\query(\"UPDATE `tokens` SET `type` = ?, SET `assigned` = ? WHERE `app` = ? AND `token` = ?\", [\"user\", $username, $secret ?? $_SESSION[\"app\"], $token]); \n\n\t\t\tif ($query->affected_rows < 1) {\n\t\t\t\treturn \"failed\";\n\t\t\t}\n\t\t\telse {\n\t\t\t\t\n\t\t\t\tcache\\purge('KeyAuthUserTokens:' . $secret . ':' . $token);\n\n\t\t\t\treturn \"success\";\n\t\t\t}\n\n\t\tcase 'UpdateStatus':\n\n\t\t\t$query = mysql\\query(\"UPDATE `tokens` SET `status` = ? WHERE `token` = ? AND `app` = ?\", [\"Used\", $token, $secret ?? $_SESSION[\"app\"]]);\n\n\t\t\tif ($query->affected_rows < 1) {\n\t\t\t\treturn \"failed\";\n\t\t\t}\n\t\t\telse {\n\n\t\t\t\tcache\\purge('KeyAuthUserTokens:'.$secret ?? $_SESSION[\"app\"] . ':' . $token);\n\n\t\t\t\treturn \"success\";\n\t\t\t}\n\n\t}\n\n}\n\nfunction checktoken($function, $token, $secret, $username = NULL, $token_hash = NULL) {\n\n\t$token = etc\\sanitize($token);\n\n\t$row = cache\\fetch('KeyAuthUserTokens:'.$secret.':'.$token ,\"SELECT * FROM `tokens` WHERE `token` = ? AND `app` = ?\", [$token, $secret], 0);\n\n\tif ($row === \"not_found\") {\n\t\treturn \"invalid_token\";\n\t}\n\n\tswitch ($function) {\n\n\t\tcase 'check_data':\n\n\t\t\tif ($row[\"banned\"]) {\n\t\t\t\treturn \"token_blacklisted, \" . $row[\"reason\"];\n\t\t\t}\n\n\t\t\tif (!is_null($row[\"hash\"]) && $row[\"hash\"] !== $token_hash) {\n\t\t\t\treturn \"hash_mismatch\";\n\t\t\t}\n\n\t\t\tif (is_null($row[\"hash\"]))\n\t\t\t{\n\t\t\t\tmysql\\query(\"UPDATE `tokens` SET `hash` = ? WHERE `token` = ? AND `app` = ?\", [$token_hash, $token, $secret]);\n\t\t\t\tcache\\purge('KeyAuthUserTokens:'.$secret ?? $_SESSION[\"app\"] . ':' . $token);\n\t\t\t}\n\n\t\t\treturn 'success';\n\n\t\tcase 'check_username':\n\n\t\t\tif (!is_null($username) && $row[\"assigned\"] !== $username) {\n\t\t\t\treturn \"token_reuse\";\n\t\t\t}\n\t}\n\n\n}\n\nfunction addtokenblacklist($token, $reason, $secret = null) {\n\n\t$token = etc\\sanitize($token);\n\n\t$reason = etc\\sanitize($reason);\n\n\t$query = mysql\\query(\"UPDATE `tokens` SET `reason` = ?, `status` = ? WHERE `token` = ? AND `app` = ?\", [$reason, 1, $token, $secret ?? $_SESSION[\"app\"]]);\n\tcache\\purge('KeyAuthUserTokens:'.$secret ?? $_SESSION[\"app\"] . ':' . $token);\n\n\n\tif ($query->affected_rows < 0) {\n\t\treturn \"failed\";\n\t}\n\n\tif ($query->affected_rows > 0) {\n\t\treturn \"success\";\n\t}\n\n}\n\nfunction removetokenblacklist($token, $secret = null) {\n\n\t$token = etc\\sanitize($token);\n\n\t$query = mysql\\query(\"UPDATE `tokens` SET `reason` = ?, `status` = ? WHERE `token` = ? AND `app` = ?\", [\"\", 0, $token, $secret ?? $_SESSION[\"app\"]]);\n\tcache\\purge('KeyAuthUserTokens:'.$secret ?? $_SESSION[\"app\"] . ':' . $token);\n\n\tif ($query->affected_rows < 0) {\n\t\treturn \"failed\";\n\t}\n\n\tif ($query->affected_rows > 0) {\n\t\treturn \"success\";\n\t}\n\n}\n\nfunction resettokenhash($token, $secret = null) {\n\n\t$token = etc\\sanitize($token);\n\n\t$query = mysql\\query(\"UPDATE `tokens` SET `hash` = ? WHERE `token` = ? AND `app` = ?\", [NULL, $token, $secret]);\n\tcache\\purge('KeyAuthUserTokens:'.$secret ?? $_SESSION[\"app\"] . ':' . $token);\n\n\tif ($query->affected_rows < 0) {\n\t\treturn \"failed\";\n\t}\n\n\tif ($query->affected_rows > 1) {\n\t\treturn \"success\";\n\t}\n\n}\n\n?>\n","size_bytes":4378},"includes/misc/upload.php":{"content":"<?php\n\nnamespace misc\\upload;\n\nuse misc\\etc;\nuse misc\\cache;\nuse misc\\mysql;\n\nfunction add($url, $authed, $secret = null)\n{\n  $url = etc\\sanitize($url);\n  $authed = etc\\sanitize($authed);\n\n  if (!filter_var($url, FILTER_VALIDATE_URL)) {\n    return 'invalid';\n  }\n\n  if (str_contains($url, \"cdn.discordapp.com\") !== false) {\n    $urlParts = explode(\"?\", $url);\n    $url = $urlParts[0];\n  }\n\n  if(str_contains($url, \"localhost\") || str_contains($url, \"127.0.0.1\") || str_contains($url, \"file:/\"))\n    return 'no_local';\n\n    $requiredExtension = array(\n    \".zip\", \".pdf\", \".tiff\", \".png\", \".exe\", \".psd\", \".mp3\", \".mp4\",\n    \".jar\", \".xls\", \".csv\", \".bmp\", \".txt\", \".xml\", \".rar\", \".jpg\", \n    \".doc\", \".eps\", \".avi\", \".mov\", \".apk\", \".ios\", \".sys\", \".dll\", \".js\",\n    \".cpp\", \".c\", \".java\", \".py\", \".php\", \".html\", \".css\", \".xml\", \".json\",\n    \".sql\", \".rb\", \".swift\", \".go\", \".pl\", \".bat\", \".cs\", \".gif\", \".txt\", \".efi\"\n  );\n\n  $linkExtension = strtolower(substr($url, strrpos($url, \".\")));\n\n  if (!in_array($linkExtension, $requiredExtension)){\n    return 'invalid_extension';\n  }\n\n  $file = file_get_contents($url);\n  $filesize = strlen($file);\n  if ($filesize > 10000000 && $_SESSION['role'] == \"tester\") {\n    return 'tester_file_exceed';\n  } else if ($filesize > 50000000 && ($_SESSION['role'] == \"developer\" || $_SESSION['role'] == \"Manager\")) {\n    return 'dev_file_exceed';\n  } else if ($filesize > 75000000) {\n    return 'seller_file_exceed';\n  }\n  $id = etc\\generateRandomNum();\n  $fn = basename($url);\n  $fs = etc\\formatBytes($filesize);\n\n  if (strlen($fn) > 49) {\n    return 'name_too_large';\n  }\n\n  $query = mysql\\query(\"INSERT INTO `files` (name, id, url, size, uploaddate, app, authed) VALUES (?, ?, ?, ?, ?, ?, ?)\", [$fn, $id, $url, $fs, time(), $secret ?? $_SESSION['app'], $authed]);\n  if ($query->affected_rows > 0) {\n    if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n      cache\\purge('KeyAuthFiles:' . ($secret ?? $_SESSION['app']));\n    }\n    return 'success';\n  } else {\n    return 'failure';\n  }\n}\nfunction deleteAll($secret = null)\n{\n  $query = mysql\\query(\"DELETE FROM `files` WHERE `app` = ?\", [$secret ?? $_SESSION['app']]);\n\n  if ($query->affected_rows > 0) {\n    cache\\purgePattern('KeyAuthFile:' . ($secret ?? $_SESSION['app']));\n    if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n      cache\\purge('KeyAuthFiles:' . ($secret ?? $_SESSION['app']));\n    }\n    return 'success';\n  } else {\n    return 'failure';\n  }\n}\nfunction deleteSingular($file, $secret = null)\n{\n  $file = etc\\sanitize($file);\n\n  $query = mysql\\query(\"DELETE FROM `files` WHERE `app` = ? AND `id` = ?\", [$secret ?? $_SESSION['app'], $file]);\n\n  if ($query->affected_rows > 0) {\n    cache\\purge('KeyAuthFile:' . ($secret ?? $_SESSION['app']) . ':' . $file);\n    if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n      cache\\purge('KeyAuthFiles:' . ($secret ?? $_SESSION['app']));\n    }\n    return 'success';\n  } else {\n    return 'failure';\n  }\n}\n","size_bytes":2978},"includes/misc/user.php":{"content":"<?php\n\nnamespace misc\\user;\n\nuse misc\\etc;\nuse misc\\cache;\nuse misc\\blacklist;\nuse misc\\mysql;\nuse misc\\token;\n\nfunction deleteSingular($username, $secret = null)\n{\n        $username = etc\\sanitize($username);\n\n        if ($_SESSION['role'] == \"Reseller\") {\n                $query = mysql\\query(\"SELECT 1 FROM `users` WHERE `app` = ? AND `username` = ? AND `owner` = ?\", [$secret ?? $_SESSION['app'], $username, $_SESSION['username']]);\n                if ($query->num_rows < 1) {\n                        return 'nope';\n                }\n        }\n\n        $query = mysql\\query(\"DELETE FROM `subs` WHERE `app` = ? AND `user` = ?\", [$secret ?? $_SESSION['app'], $username]);\n        $query = mysql\\query(\"DELETE FROM `uservars` WHERE `app` = ? AND `user` = ?\", [$secret ?? $_SESSION['app'], $username]);\n        $query = mysql\\query(\"DELETE FROM `tokens` WHERE `app` = ? AND `assigned` = ? AND `type` = ?\", [$secret ?? $_SESSION['app'], $username, \"user\"]);\n        $query = mysql\\query(\"DELETE FROM `users` WHERE `app` = ? AND `username` = ?\", [$secret ?? $_SESSION['app'], $username]);\n\n        if ($query->affected_rows > 0) {\n                cache\\purge('KeyAuthUser:' . ($secret ?? $_SESSION['app']) . ':' . $username);\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthUsernames:' . ($secret ?? $_SESSION['app']));\n                        cache\\purge('KeyAuthUsers:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction resetSingular($username, $secret = null)\n{\n        $username = etc\\sanitize($username);\n\n        if ($_SESSION['role'] == \"Reseller\") {\n                $query = mysql\\query(\"SELECT 1 FROM `users` WHERE `app` = ? AND `username` = ? AND `owner` = ?\", [$secret ?? $_SESSION['app'], $username, $_SESSION['username']]);\n                if ($query->num_rows < 1) {\n                        return 'nope';\n                }\n        }\n\n        $query = mysql\\query(\"UPDATE `users` SET `hwid` = NULL WHERE `app` = ? AND `username` = ?\", [$secret ?? $_SESSION['app'], $username]);\n        if ($query->affected_rows > 0) {\n                cache\\purge('KeyAuthUser:' . ($secret ?? $_SESSION['app']) . ':' . $username);\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthUsernames:' . ($secret ?? $_SESSION['app']));\n                        cache\\purge('KeyAuthUsers:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction setVariable($user, $var, $data, $secret = null, $readOnly = 0)\n{\n        $user = etc\\sanitize($user);\n        $var = etc\\sanitize($var);\n        $data = etc\\sanitize($data);\n        $readOnly = intval($readOnly);\n\n        if ($user == \"all\") {\n                $query = mysql\\query(\"SELECT `username` FROM `users` WHERE `app` = ?\", [$secret ?? $_SESSION['app']]);\n                if ($query->num_rows < 1) {\n                        return 'missing';\n                }\n                $rows = array();\n                while ($r = mysqli_fetch_assoc($query->result)) {\n                        $rows[] = $r;\n                }\n                foreach ($rows as $row) {\n                        $query = mysql\\query(\"REPLACE INTO `uservars` (`name`, `data`, `user`, `app`, `readOnly`) VALUES (?, ?, ?, ?, ?)\", [$var, $data, $row['username'], $secret ?? $_SESSION['app'], $readOnly]);\n                }\n                cache\\purgePattern('KeyAuthUserVar:' . ($secret ?? $_SESSION['app']));\n        } else {\n                $query = mysql\\query(\"REPLACE INTO `uservars` (`name`, `data`, `user`, `app`, `readOnly`) VALUES (?, ?, ?, ?, ?)\", [$var, $data, $user, $secret ?? $_SESSION['app'], $readOnly]);\n                cache\\purge('KeyAuthUserVar:' . ($secret ?? $_SESSION['app']) . ':' . $var . ':' . $user);\n        }\n        if ($query->affected_rows > 0) {\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthUserVars:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction ban($username, $reason, $secret = null)\n{\n        $username = etc\\sanitize($username);\n        $reason = etc\\sanitize($reason);\n\n        if ($_SESSION['role'] == \"Reseller\") {\n                $query = mysql\\query(\"SELECT 1 FROM `users` WHERE `app` = ? AND `username` = ? AND `owner` = ?\", [$secret ?? $_SESSION['app'], $username, $_SESSION['username']]);\n                if ($query->num_rows < 1) {\n                        return 'nope';\n                }\n        }\n\n        $query = mysql\\query(\"SELECT * FROM `users` WHERE `app` = ? AND `username` = ?\", [$secret ?? $_SESSION['app'], $username]);\n        if ($query->num_rows < 1) {\n                return 'missing';\n        }\n        $row = mysqli_fetch_array($query->result);\n        $hwid = $row[\"hwid\"];\n        $ip = $row[\"ip\"];\n        $query = mysql\\query(\"UPDATE `users` SET `banned` = ? WHERE `app` = ? AND `username` = ?\", [$reason, $secret ?? $_SESSION['app'], $username]);\n        if (!is_null($hwid)) {\n                blacklist\\add($hwid, \"Hardware ID\", ($secret ?? $_SESSION['app']));\n        }\n        if (!is_null($ip)) {\n                blacklist\\add($ip, \"IP Address\", ($secret ?? $_SESSION['app']));\n        }\n        if ($query->affected_rows > 0) {\n                mysql\\query(\"UPDATE `tokens` SET `banned` = ?, `reason` = ? WHERE `app` = ? AND `assigned` = ? AND `type` = ?\", [1, $reason, $secret ?? $_SESSION['app'], $username, \"user\"]);\n                cache\\purge('KeyAuthUser:' . ($secret ?? $_SESSION['app']) . ':' . $username);\n                cache\\purge('KeyAuthUserTokens:' . ($secret ?? $_SESSION['app']) . ':' . token\\IsAssignedToken($username, \"user\", $secret ?? $_SESSION[\"app\"], true));\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthUsernames:' . ($secret ?? $_SESSION['app']));\n                        cache\\purge('KeyAuthUsers:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction pauseUser($username, $secret = null){\n        $username = etc\\sanitize($username);\n        $query = mysql\\query(\"SELECT * FROM `subs` WHERE `app` = ? AND `expiry` > ? AND `user` = ?\", [$secret ?? $_SESSION['app'], time(), $username], \"sis\");\n        $updateQuery = NULL;\n        while ($row = mysqli_fetch_array($query->result)){\n                $expires = $row['expiry'];\n                $exp = (int)$expires - time();\n                $updateQuery = mysql\\query(\"UPDATE `subs` SET `paused` = 1, `expiry` = ? WHERE `app` = ? AND `id` = ?\", [$exp, $secret ?? $_SESSION['app'], $row['id']], \"iss\");\n        }\n        if ($updateQuery->affected_rows > 0){\n                cache\\purge('KeyAuthSubs:' . $secret ?? $_SESSION['app'] . ':' . $username);\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction unpauseUser($username, $secret = null){\n        $username = etc\\sanitize($username);\n        $query = mysql\\query(\"SELECT * FROM `subs` WHERE `app` = ? AND `user` = ? AND `paused` = 1\", [$secret ?? $_SESSION['app'], $username]);\n        $updateQuery = NULL;\n        while ($row = mysqli_fetch_array($query->result)){\n                $expires = $row['expiry'];\n                $exp = (int)$expires + time();\n                $updateQuery = mysql\\query(\"UPDATE `subs` SET `paused` = 0, `expiry` = ? WHERE `app` = ? AND `id` = ?\", [$exp, $secret ?? $_SESSION['app'], $row['id']], \"iss\");\n        }\n        if ($updateQuery->affected_rows > 0){\n                cache\\purge('KeyAuthSubs:' . $secret ?? $_SESSION['app'] . ':' . $username);\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction unban($username, $secret = null)\n{\n        $username = etc\\sanitize($username);\n\n        if ($_SESSION['role'] == \"Reseller\") {\n                $query = mysql\\query(\"SELECT 1 FROM `users` WHERE `app` = ? AND `username` = ? AND `owner` = ?\", [$secret ?? $_SESSION['app'], $username, $_SESSION['username']]);\n                if ($query->num_rows < 1) {\n                        return 'nope';\n                }\n        }\n\n        $query = mysql\\query(\"SELECT `hwid`, `ip` FROM `users` WHERE `app` = ? AND `username` = ?\", [$secret ?? $_SESSION['app'], $username]);\n        if ($query->num_rows < 1) {\n                return 'missing';\n        }\n        $row = mysqli_fetch_array($query->result);\n        $hwid = $row[\"hwid\"];\n        $ip = $row[\"ip\"];\n        cache\\purgePattern('KeyAuthBlacklist:' . ($secret ?? $_SESSION['app']) . ':' . $ip);\n        if (!is_null($hwid)) {\n                cache\\purgePattern('KeyAuthBlacklist:' . ($secret ?? $_SESSION['app']) . ':*:' . $hwid);\n        }\n\n        $query = mysql\\query(\"DELETE FROM `bans` WHERE `hwid` = ? OR `ip` = ? AND `app` = ?\", [$hwid, $ip, $secret ?? $_SESSION['app']]);\n        $query = mysql\\query(\"UPDATE `users` SET `banned` = NULL WHERE `app` = ? AND `username` = ?\", [$secret ?? $_SESSION['app'], $username]);\n        if ($query->affected_rows > 0) {\n                mysql\\query(\"UPDATE `tokens` SET `banned` = 0, `reason` = NULL WHERE `app` = ? AND `assigned` = ? AND `type` = ?\", [$secret ?? $_SESSION['app'], $username, \"user\"]);\n\n                cache\\purge('KeyAuthUserTokens:' . ($secret ?? $_SESSION['app']) . ':' . token\\IsAssignedToken($username, \"user\", $secret ?? $_SESSION[\"app\"], true));\n                cache\\purge('KeyAuthUser:' . ($secret ?? $_SESSION['app']) . ':' . $username);\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthUsernames:' . ($secret ?? $_SESSION['app']));\n                        cache\\purge('KeyAuthUsers:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction deleteVar($username, $var, $secret = null)\n{\n        $username = etc\\sanitize($username);\n        $var = etc\\sanitize($var);\n\n        $query = mysql\\query(\"DELETE FROM `uservars` WHERE `app` = ? AND `user` = ? AND `name` = ?\", [$secret ?? $_SESSION['app'], $username, $var]);\n        if ($query->affected_rows > 0) {\n                cache\\purge('KeyAuthUserVar:' . ($secret ?? $_SESSION['app']) . ':' . $var . ':' . $username);\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthUserVars:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction deleteSub($username, $sub, $secret = null)\n{\n        $username = etc\\sanitize($username);\n        $sub = etc\\sanitize($sub);\n\n        $query = mysql\\query(\"DELETE FROM `subs` WHERE `app` = ? AND `user` = ? AND `subscription` = ?\", [$secret ?? $_SESSION['app'], $username, $sub]);\n\n        if ($query->affected_rows > 0) {\n                cache\\purge('KeyAuthSubs:' . ($secret ?? $_SESSION['app']) . ':' . $username);\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction extend($username, $sub, $expiry, $activeOnly = 0, $secret = null)\n{\n        $username = etc\\sanitize($username);\n        $sub = etc\\sanitize($sub);\n        $expiry = etc\\sanitize($expiry);\n\n        $query = mysql\\query(\"SELECT 1 FROM `subscriptions` WHERE `name` = ? AND `app` = ?\", [$sub, $secret ?? $_SESSION['app']]);\n        if ($query->num_rows < 1) {\n                return 'sub_missing';\n        } else if ($expiry < time()) {\n                return 'date_past';\n        }\n        if ($username == \"all\") {\n                if (!$activeOnly) {\n                        $query = mysql\\query(\"SELECT `username` FROM `users` WHERE `username` NOT IN (SELECT `user` FROM `subs` WHERE `subscription` = ? AND `expiry` > ? AND `app` = ?) AND `app` = ?\", [$sub, time(), $secret ?? $_SESSION['app'], $secret ?? $_SESSION['app']]);\n\n                        $rows = array();\n                        while ($r = mysqli_fetch_assoc($query->result)) {\n                                $rows[] = $r;\n                        }\n                        foreach ($rows as $row) {\n                                $query = mysql\\query(\"INSERT INTO `subs` (`user`, `subscription`, `expiry`, `app`) VALUES (?, ?, ?, ?)\", [$row['username'], $sub, $expiry, $secret ?? $_SESSION['app']]);\n                        }\n                }\n                $appendExpiry = $expiry - time();\n                $query = mysql\\query(\"UPDATE `subs` SET `expiry` = `expiry`+? WHERE `subscription` = ? AND `expiry` > \" . time() . \" AND `app` = ?\", [$appendExpiry, $sub, $secret ?? $_SESSION['app']]);\n\n                cache\\purgePattern('KeyAuthSubs:' . ($secret ?? $_SESSION['app']));\n        } else {\n                $query = mysql\\query(\"SELECT `username` FROM `users` WHERE `username` = ? AND `app` = ?\", [$username, $secret ?? $_SESSION['app']]);\n\n                if ($query->num_rows < 1) {\n                        return 'missing';\n                }\n                $query = mysql\\query(\"SELECT `id` FROM `subs` WHERE `user` = ? AND `subscription` = ? AND `expiry` > \" . time() . \" AND `app` = ?\", [$username, $sub, $secret ?? $_SESSION['app']]);\n\n                if ($query->num_rows > 0) {\n                        $appendExpiry = $expiry - time();\n                        $query = mysql\\query(\"UPDATE `subs` SET `expiry` = `expiry`+? WHERE `user` = ? AND `subscription` = ? AND `app` = ?\", [$appendExpiry, $username, $sub, $secret ?? $_SESSION['app']]);\n                } else {\n                        $query = mysql\\query(\"INSERT INTO `subs` (`user`, `subscription`, `expiry`, `app`) VALUES (?, ?, ?, ?)\", [$username, $sub, $expiry, $secret ?? $_SESSION['app']]);\n                }\n                cache\\purge('KeyAuthSubs:' . ($secret ?? $_SESSION['app']) . ':' . $username);\n        }\n        if ($query->affected_rows > 0) {\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction subtract($username, $sub, $seconds, $secret = null)\n{\n        $username = etc\\sanitize($username);\n        $sub = etc\\sanitize($sub);\n        $seconds = etc\\sanitize($seconds);\n\n        if ($seconds <= 0) {\n                return 'invalid_seconds';\n        }\n\n        if ($username == \"all\") {\n                $query = mysql\\query(\"UPDATE `subs` SET `expiry` = `expiry`-? WHERE `subscription` = ? AND `app` = ?\", [$seconds, $sub, $secret ?? $_SESSION['app']]);\n        } else {\n                $query = mysql\\query(\"UPDATE `subs` SET `expiry` = `expiry`-? WHERE `user` = ? AND `subscription` = ? AND `app` = ?\", [$seconds, $username, $sub, $secret ?? $_SESSION['app']]);\n        }\n\n        if ($query->affected_rows > 0) {\n                cache\\purge('KeyAuthSubs:' . ($secret ?? $_SESSION['app']) . ':' . $username);\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction add($username, $sub, $expiry, $secret = null, $password = null)\n{\n        $username = etc\\sanitize($username);\n        $query = mysql\\query(\"SELECT 1 FROM `users` WHERE `username` = ? AND `app` = ?\", [$username, $secret ?? $_SESSION['app']]);\n\n        if ($query->num_rows > 0) {\n                return 'already_exist';\n        }\n\n        if (strtolower($username) === \"all\" || strtoupper($username) === \"ALL\"){\n                return 'username_not_allowed';\n       }\n\n        if (!empty($password))\n                $password = password_hash(etc\\sanitize($password), PASSWORD_BCRYPT);\n\n        $sub = etc\\sanitize($sub);\n        $expiry = etc\\sanitize($expiry);\n\n        $query = mysql\\query(\"SELECT 1 FROM `subscriptions` WHERE `name` = ? AND `app` = ?\", [$sub, $secret ?? $_SESSION['app']]);\n\n        if ($query->num_rows < 1) {\n                return 'sub_missing';\n        } else if ($expiry < time()) {\n                return 'date_past';\n        }\n\n        $query = mysql\\query(\"INSERT INTO `subs` (`user`, `subscription`, `expiry`, `app`) VALUES (?, ?, ?, ?)\", [$username, $sub, $expiry, $secret ?? $_SESSION['app']]);\n        $query = mysql\\query(\"INSERT INTO `users` (`username`, `password`, `hwid`, `app`,`owner`,`createdate`) VALUES (?, NULLIF(?, ''), NULL, ?, ?, ?);\", [$username, $password, $secret ?? $_SESSION['app'], $_SESSION['username'] ?? 'SellerAPI', time()]);\n        if ($query->affected_rows > 0) {\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthUsernames:' . ($secret ?? $_SESSION['app']));\n                        cache\\purge('KeyAuthUsers:' . ($secret ?? $_SESSION['app']));\n                        cache\\purge('KeyAuthUser:' . ($secret ?? $_SESSION['app']) . ':' . $username);\n                }\n                if (token\\ModifyUserToken($username, \"User\", null, null, $secret ?? $_SESSION[\"app\"]) === \"failed\") {\n                        return \"failure\";\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction deleteExpiredUsers($secret = null)\n{\n        $query = mysql\\query(\"SELECT `username` FROM `users` WHERE `app` = ?\", [$secret ?? $_SESSION['app']]);\n\n        if ($query->num_rows < 1) {\n                return 'missing';\n        }\n        $rows = array();\n        while ($r = mysqli_fetch_assoc($query->result)) {\n                $rows[] = $r;\n        }\n        $success = 0;\n        foreach ($rows as $row) {\n                $query = mysql\\query(\"SELECT 1 FROM `subs` WHERE `user` = ? AND `app` = ? AND `expiry` > ?\", [$row['username'], $secret ?? $_SESSION['app'], time()]);\n\n                if ($query->num_rows < 1) {\n                        $success = 1;\n                        $query = mysql\\query(\"DELETE FROM `users` WHERE `app` = ? AND `username` = ?\", [$secret ?? $_SESSION['app'], $row['username']]);\n                        cache\\purge('KeyAuthUser:' . ($secret ?? $_SESSION['app']) . ':' . $row['username']);\n                }\n        }\n        if ($success) {\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthUsernames:' . ($secret ?? $_SESSION['app']));\n                        cache\\purge('KeyAuthUsers:' . ($secret ?? $_SESSION['app']));\n                }\n                $query = mysql\\query(\"DELETE FROM `tokens` WHERE `app` = ? AND `assigned` = ? AND `type` = ?\", [$secret ?? $_SESSION['app'], $row['username'], \"user\"]);\n                if ($query->affected_rows > 0) { cache\\purgePattern('KeyAuthUserTokens:' . ($secret ?? $_SESSION['app'])); } else { return \"failure\"; }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction deleteAll($secret = null)\n{\n        $query = mysql\\query(\"DELETE FROM `users` WHERE `app` = ?\", [$secret ?? $_SESSION['app']]);\n        if ($query->affected_rows > 0) {\n                cache\\purgePattern('KeyAuthUser:' . ($secret ?? $_SESSION['app']));\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthUsernames:' . ($secret ?? $_SESSION['app']));\n                        cache\\purge('KeyAuthUsers:' . ($secret ?? $_SESSION['app']));\n                }\n                $query = mysql\\query(\"DELETE FROM `tokens` WHERE `app` = ? AND `type` = ?\", [$secret ?? $_SESSION['app'], \"user\"]);\n\n                if ($query->affected_rows > 0) { cache\\purgePattern('KeyAuthUserTokens:' . ($secret ?? $_SESSION['app'])); } else { return \"failure\"; }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction resetAll($secret = null)\n{\n        $query = mysql\\query(\"UPDATE `users` SET `hwid` = NULL WHERE `app` = ?\", [$secret ?? $_SESSION['app']]);\n        if ($query->affected_rows > 0) {\n                cache\\purgePattern('KeyAuthUser:' . ($secret ?? $_SESSION['app']));\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthUsernames:' . ($secret ?? $_SESSION['app']));\n                        cache\\purge('KeyAuthUsers:' . ($secret ?? $_SESSION['app']));\n                }\n                $query = mysql\\query(\"UPDATE `tokens` SET `hash` = NULL WHERE `app` = ? AND `type` = ?\", [$secret ?? $_SESSION['app'], \"user\"]);\n\n                if ($query->affected_rows > 0) { cache\\purgePattern('KeyAuthUserTokens:' . ($secret ?? $_SESSION['app'])); } else { return \"failure\"; }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction unbanAll($secret = null)\n{\n        $query = mysql\\query(\"UPDATE `users` SET `banned` = NULL WHERE `app` = ?\", [$secret ?? $_SESSION['app']]);\n        if ($query->affected_rows > 0) {\n                cache\\purgePattern('KeyAuthUser:' . ($secret ?? $_SESSION['app']));\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthUsernames:' . ($secret ?? $_SESSION['app']));\n                        cache\\purge('KeyAuthUsers:' . ($secret ?? $_SESSION['app']));\n                }\n                $query = mysql\\query(\"UPDATE `tokens` SET `banned` = 0, `reason` = NULL WHERE `app` = ?\", [$secret ?? $_SESSION['app']]);\n\n                if ($query->affected_rows > 0) { cache\\purgePattern('KeyAuthUserTokens:' . ($secret ?? $_SESSION['app'])); } else { return \"failure\"; }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction changeUsername($oldUsername, $newUsername, $secret = null)\n{\n        $oldUsername = etc\\sanitize($oldUsername);\n        $newUsername = etc\\sanitize($newUsername);\n\n        $query = mysql\\query(\"SELECT 1 FROM `users` WHERE `username` = ? AND `app` = ?\", [$newUsername, $secret ?? $_SESSION['app']]);\n        if ($query->num_rows > 0) {\n                return 'already_used';\n        }\n        $query = mysql\\query(\"UPDATE `users` SET `username` = ? WHERE `username` = ? AND `app` = ?\", [$newUsername, $oldUsername, $secret ?? $_SESSION['app']]);\n        if ($query->affected_rows > 0) {\n                mysql\\query(\"UPDATE `subs` SET `user` = ? WHERE `user` = ? AND `app` = ?\", [$newUsername, $oldUsername, $secret ?? $_SESSION['app']]);\n                mysql\\query(\"UPDATE `uservars` SET `user` = ? WHERE `user` = ? AND `app` = ?\", [$newUsername, $oldUsername, $secret ?? $_SESSION['app']]);\n                mysql\\query(\"UPDATE `chatmsgs` SET `author` = ? WHERE `author` = ? AND `app` = ?\", [$newUsername, $oldUsername, $secret ?? $_SESSION['app']]);\n                mysql\\query(\"UPDATE `keys` SET `usedby` = ? WHERE `usedby` = ? AND `app` = ?\", [$newUsername, $oldUsername, $secret ?? $_SESSION['app']]);\n                cache\\purge('KeyAuthUser:' . ($secret ?? $_SESSION['app']) . ':' . $oldUsername);\n                cache\\purge('KeyAuthSubs:' . ($secret ?? $_SESSION['app']) . ':' . $oldUsername);\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthUsernames:' . ($secret ?? $_SESSION['app']));\n                        cache\\purge('KeyAuthUsers:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction changePassword($username, $password, $secret = null)\n{\n        $username = etc\\sanitize($username);\n        $password = etc\\sanitize($password);\n\n        $query = mysql\\query(\"UPDATE `users` SET `password` = ? WHERE `username` = ? AND `app` = ?\", [password_hash($password, PASSWORD_BCRYPT), $username, $secret ?? $_SESSION['app']]);\n        if ($query->affected_rows > 0) {\n                cache\\purge('KeyAuthUser:' . ($secret ?? $_SESSION['app']) . ':' . $username);\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthUsers:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\n\nfunction disable2fa($username, $secret = null) {\n\n        $username = etc\\sanitize($username);\n\n        $query = mysql\\query(\"UPDATE `users` SET `googleAuthCode` = NULL, `2fa` = 0 WHERE `username` = ? AND `app` = ?\", [$username, $secret ?? $_SESSION['app']]);\n        if ($query->affected_rows > 0) {\n                cache\\purge('KeyAuthUser:' . ($secret ?? $_SESSION['app']) . ':' . $username);\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthUsers:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n\n}\n\n","size_bytes":24977},"includes/misc/variable.php":{"content":"<?php\n\nnamespace misc\\variable;\n\nuse misc\\etc;\nuse misc\\cache;\nuse misc\\mysql;\n\nfunction add($name, $data, $authed, $secret = null)\n{\n        $name = etc\\sanitize($name);\n        $data = etc\\sanitize($data);\n        $authed = etc\\sanitize($authed);\n\n        if(strlen($data) > 1000) {\n                return 'too_long';\n        }\n\n        $name_check = mysql\\query(\"SELECT 1 FROM `vars` WHERE `varid` = ? AND `app` = ?\",[$name, $secret ?? $_SESSION['app']]);\n        if ($name_check->num_rows > 0) {\n                return 'exists';\n        }\n        $query = mysql\\query(\"INSERT INTO `vars`(`varid`, `msg`, `app`, `authed`) VALUES (?, ?, ?, ?)\",[$name, $data,$secret ?? $_SESSION['app'], $authed]);\n        if ($query->affected_rows > 0) {\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthVars:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction deleteAll($secret = null)\n{\n        $query = mysql\\query(\"DELETE FROM `vars` WHERE `app` = ?\",[$secret ?? $_SESSION['app']]);\n        if ($query->affected_rows > 0) {\n                cache\\purgePattern('KeyAuthVar:' . ($secret ?? $_SESSION['app']));\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthVars:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction deleteSingular($var, $secret = null)\n{\n        $var = etc\\sanitize($var);\n\n        $query = mysql\\query(\"DELETE FROM `vars` WHERE `app` = ? AND `varid` = ?\",[$secret ?? $_SESSION['app'], $var]);\n        if ($query->affected_rows > 0) {\n                cache\\purge('KeyAuthVar:' . ($secret ?? $_SESSION['app']) . ':' . $var);\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthVars:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction edit($name, $data, $authed, $secret = null)\n{\n        $name = etc\\sanitize($name);\n        $data = etc\\sanitize($data);\n        $authed = etc\\sanitize($authed);\n\n        if(strlen($data) > 1000) {\n                return 'too_long';\n        }\n\n        $query = mysql\\query(\"UPDATE `vars` SET `msg` = ?, `authed` = ? WHERE `varid` = ? AND `app` = ?\",[$data, $authed, $name, $secret ?? $_SESSION['app']]);\n        if ($query->affected_rows > 0) {\n                cache\\purge('KeyAuthVar:' . ($secret ?? $_SESSION['app']) . ':' . $name);\n                if ($_SESSION['role'] == \"seller\" || !is_null($secret)) {\n                        cache\\purge('KeyAuthVars:' . ($secret ?? $_SESSION['app']));\n                }\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\n","size_bytes":2973},"includes/misc/webhook.php":{"content":"<?php\n\nnamespace misc\\webhook;\n\nuse misc\\etc;\nuse misc\\cache;\nuse misc\\mysql;\n\nfunction add($webhookName, $baseLink, $userAgent, $authed, $secret = null)\n{\n        $baseLink = etc\\sanitize($baseLink);\n        $userAgent = etc\\sanitize($userAgent);\n        $authed = intval($authed);\n\n        if (!filter_var($baseLink, FILTER_VALIDATE_URL))\n                return 'invalid_url';\n\n        if(str_contains($baseLink, \"localhost\") || str_contains($baseLink, \"127.0.0.1\"))\n                return 'no_local';\n\n            $webid = etc\\sanitize($webhookName) ?? etc\\generateRandomString();\n        if (is_null($userAgent))\n                $userAgent = \"KeyAuth\";\n        $query = mysql\\query(\"INSERT INTO `webhooks` (`webid`, `baselink`, `useragent`, `app`, `authed`) VALUES (?, ?, ?, ?, ?)\",[$webid, $baseLink, $userAgent, $secret ?? $_SESSION['app'], $authed]);\n        if ($query->affected_rows > 0) {\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\nfunction deleteSingular($webhook, $secret = null){\n        $webhook = etc\\sanitize($webhook);\n\n        $query = mysql\\query(\"DELETE FROM `webhooks` WHERE `app` = ? AND `webid` = ?\",[$secret ?? $_SESSION['app'], $webhook]);\n        if ($query->affected_rows > 0) {\n                cache\\purge('KeyAuthWebhook:' . ($secret ?? $_SESSION['app']) . ':' . $webhook);\n                return 'success';\n        } else {\n                return 'failure';\n        }\n}\n\nfunction deleteAll($secret = null){\n    $query = mysql\\query(\"DELETE FROM `webhooks` WHERE `app` = ?\", [$secret ?? $_SESSION['app']]);\n    if ($query->affected_rows > 0){\n        cache\\purge('KeyAuthWebhook:' . ($secret ?? $_SESSION['app']));\n        return 'success';\n    } else {\n        return 'failure';\n    }\n}\n","size_bytes":1771},"includes/api/1.0/index.php":{"content":"<?php\r\nnamespace api\\v1_0;\r\n\r\nuse api\\shared\\primary;\r\nuse misc\\etc;\r\nuse misc\\cache;\r\nuse misc\\mysql;\r\n\r\n#region enc region\r\nfunction Encrypt($string, $enckey)\r\n{\r\n    return bin2hex(openssl_encrypt($string, 'aes-256-cbc', substr(hash('sha256', $enckey), 0, 32), OPENSSL_RAW_DATA, substr(hash('sha256', $_POST['init_iv']), 0, 16)));\r\n}\r\nfunction Decrypt($string, $enckey)\r\n{\r\n    return openssl_decrypt(hex2bin($string), 'aes-256-cbc', substr(hash('sha256', $enckey), 0, 32), OPENSSL_RAW_DATA, substr(hash('sha256', $_POST['init_iv']), 0, 16));\r\n}\r\n#endregion\r\n#region rgstr region\r\nfunction register($un, $key, $pw, $email, $hwid, $secret)\r\n{\r\n    $query = mysql\\query(\"SELECT `minUsernameLength`, `blockLeakedPasswords` FROM `apps` WHERE `secret` = ?\",[$secret]);\r\n    $row = mysqli_fetch_array($query->result);\r\n    $minUsernameLength = $row['minUsernameLength'];\r\n    $blockLeakedPasswords = $row['blockLeakedPasswords'];\r\n\r\n    if (strlen($un) < $minUsernameLength) {\r\n        return 'un_too_short';\r\n    }\r\n\r\n    if ($blockLeakedPasswords && etc\\isBreached($pw)) {\r\n        return 'pw_leaked';\r\n    }\r\n\r\n    // search username\r\n    $query = mysql\\query(\"SELECT 1 FROM `users` WHERE `username` = ? AND `app` = ?\",[$un, $secret]);\r\n    // if username already in existence\r\n    if ($query->num_rows >= 1) {\r\n        return 'username_taken';\r\n    }\r\n    // search for key\r\n    $query = mysql\\query(\"SELECT `expires`, `status`, `level`, `genby` FROM `keys` WHERE `key` = ? AND `app` = ?\",[$key, $secret]);\r\n    // check if key exists\r\n    if ($query->num_rows < 1) {\r\n        return 'key_not_found';\r\n    }\r\n    // if key does exist\r\n    elseif ($query->num_rows > 0) {\r\n        // gather key info\r\n        while ($row = mysqli_fetch_array($query->result)) {\r\n            $expires = $row['expires'];\r\n            $status = $row['status'];\r\n            $level = $row['level'];\r\n            $genby = $row['genby'];\r\n        }\r\n        // check license status\r\n        switch ($status) {\r\n            case 'Used':\r\n                return 'key_already_used';\r\n            case 'Banned':\r\n                return 'key_banned';\r\n        }\r\n        $ip = primary\\getIp();\r\n        $hwidBlackCheck = mysql\\query(\"SELECT 1 FROM `bans` WHERE (`hwid` = ? OR `ip` = ?) AND `app` = ?\",[$hwid, $ip, $secret]);\r\n        if ($hwidBlackCheck->num_rows > 0) {\r\n            $query = mysql\\query(\"UPDATE `keys` SET `status` = 'Banned',`banned` = 'This key has been banned as the client was blacklisted.' WHERE `key` = ? AND `app` = ?\",[$un, $secret]);\r\n            cache\\purge('KeyAuthKeys:' . $secret);\r\n            return 'hwid_blacked';\r\n        }\r\n        // add current time to key time\r\n        $expiry = $expires + time();\r\n        $query = mysql\\query(\"SELECT `name` FROM `subscriptions` WHERE `app` = ? AND `level` = ?\", [$secret, $level]);\r\n        if ($query->num_rows == 0) {\r\n            return 'no_subs_for_level';\r\n        }\r\n        // update key to used\r\n        mysql\\query(\"UPDATE `keys` SET `status` = 'Used',`usedon` = ?,`usedby` = ? WHERE `key` = ? AND `app` = ?\",[time(), $un, $key, $secret]);\r\n\r\n        cache\\purge('KeyAuthKeys:' . $secret);\r\n        while ($row = mysqli_fetch_array($query->result)) {\r\n            // add each subscription that user's key applies to\r\n            $subname = $row['name'];\r\n            mysql\\query(\"INSERT INTO `subs` (`user`, `subscription`, `expiry`, `app`, `key`) VALUES (?, ?, ?, ?, ?)\",[$un, $subname, $expiry, $secret, $key]);\r\n\r\n        }\r\n        $password = password_hash($pw, PASSWORD_BCRYPT);\r\n        // create user\r\n        mysql\\query(\"INSERT INTO `users` (`username`, `email`, `password`, `hwid`, `app`,`owner`,`createdate`, `lastlogin`, `ip`) VALUES (?, SHA(LOWER(NULLIF(?, ''))), ?, NULLIF(?, ''), ?, ?, ?, ?, ?)\",[$un, $email, $password, $hwid, $secret, $genby, time(), time(), $ip]);\r\n        $query = mysql\\query(\"SELECT `subscription`, `key`, `expiry` FROM `subs` WHERE `user` = ? AND `app` = ? AND `expiry` > \" . time() . \"\",[$un, $secret]);\r\n        $rows = array();\r\n        if($query->num_rows > 0) {\r\n            while ($r = mysqli_fetch_assoc($query->result)) {\r\n                $timeleft = $expiry - time();\r\n                $r += [\"timeleft\" => $timeleft];\r\n                $rows[] = $r;\r\n            }\r\n        }\r\n        else {\r\n            $timeleft = $expiry - time();\r\n            $rows = array(\"subscription\" => \"$subname\", \"key\" => \"$key\", \"expiry\" => \"$expiry\", \"timeleft\" => \"$timeleft\");\r\n        }\r\n        \r\n        cache\\purge('KeyAuthUser:' . $secret . ':' . $un);\r\n        cache\\purge('KeyAuthSubs:' . $secret . ':' . $un);\r\n        // success\r\n        return array(\r\n            \"username\" => \"$un\",\r\n            \"subscriptions\" => $rows,\r\n            \"ip\" => $ip,\r\n            \"hwid\" => $hwid,\r\n            \"createdate\" => \"\". time() .\"\",\r\n            \"lastlogin\" => \"\" . time() . \"\"\r\n        );\r\n    }\r\n}\r\n#endregion\r\n#region login region\r\nfunction login($un, $pw, $hwid, $secret, $hwidenabled, $token = null, $_2fa = null)\r\n{\r\n    $row = cache\\fetch('KeyAuthUser:' . $secret . ':' . $un, \"SELECT * FROM `users` WHERE `username` = ? AND `app` = ?\", [$un, $secret], 0);\r\n\r\n    if ($row == \"not_found\") {\r\n        return 'un_not_found';\r\n    }\r\n\r\n    $pass = $row['password'];\r\n    $serverHwid = $row['hwid'];\r\n    $banned = $row['banned'];\r\n    $createdate = $row['createdate'];\r\n    if ($banned != NULL) {\r\n        return 'user_banned';\r\n    }\r\n    $ip = primary\\getIp();\r\n\r\n    if (!is_null($token)) {\r\n        $validToken = md5(substr($pass, -5));\r\n        if ($validToken != $token) {\r\n            return 'pw_mismatch';\r\n        }\r\n    } else if (!is_null($pass)) {\r\n        // check if pass matches\r\n        if (!password_verify($pw, $pass)) {\r\n            return 'pw_mismatch';\r\n        }\r\n    } else {\r\n        $pass_encrypted = password_hash($pw, PASSWORD_BCRYPT);\r\n        $query = mysql\\query(\"UPDATE `users` SET `password` = ? WHERE `username` = ? AND `app` = ?\",[$pass_encrypted, $un, $secret]);\r\n\r\n        cache\\purge('KeyAuthUser:' . $secret . ':' . $un);\r\n    }\r\n    // check if hwid enabled for application\r\n    if ($hwidenabled == \"1\") {\r\n        // check if hwid in db contains hwid recieved\r\n        if (!is_null($hwid) && !str_contains($serverHwid, $hwid) && !is_null($serverHwid)) {\r\n            return 'hwid_mismatch';\r\n        } else if (is_null($serverHwid) && !is_null($hwid)) {\r\n            $query = mysql\\query(\"UPDATE `users` SET `hwid` = NULLIF(?, '') WHERE `username` = ? AND `app` = ?\",[$hwid, $un, $secret]);\r\n\r\n            cache\\purge('KeyAuthUser:' . $secret . ':' . $un);\r\n        }\r\n    }\r\n    $rows = cache\\fetch('KeyAuthSubs:' . $secret . ':' . $un, \"SELECT `subscription`, `key`, `expiry` FROM `subs` WHERE `user` = ? AND `app` = ? AND `expiry` > ?\", [$un, $secret, time()], 1, null, \"ssi\");\r\n    if($_SERVER['HTTP_USER_AGENT'] == \"PostmanRuntime/7.31.3\") {\r\n        var_dump($rows);\r\n    }\r\n    \r\n    if ($rows == \"not_found\") {\r\n        $query = mysql\\query(\"SELECT `paused` FROM `subs` WHERE `user` = ? AND `app` = ? AND `paused` = 1\",[$un, $secret]);\r\n        if ($query->num_rows >= 1) {\r\n            return 'sub_paused';\r\n        }\r\n        return 'no_active_subs';\r\n    }\r\n\r\n    if ($_2fa) {\r\n\r\n        if (is_null($_2fa) || empty($_2fa)) { \r\n            return 'missing_2fa_code'; }\r\n\r\n        else {\r\n            require \"../../auth/GoogleAuthenticator.php\";\r\n\r\n            $auth = new \\GoogleAuthenticator();\r\n    \r\n            if (!$auth->verifyCode($google_secret, $_2fa, 5)) {\r\n                return 'invalid_2fa';\r\n            }\r\n        }\r\n    }\r\n\r\n    $rowsFinal = array(); \r\n    foreach ($rows as $row) {\r\n        $timeleft = $row[\"expiry\"] - time();\r\n\r\n        $levelquery = mysql\\query(\"SELECT `level` FROM `subscriptions` WHERE `name` = ? AND `app` = ?\", [$row[\"subscription\"], $secret]);\r\n        $level = mysqli_fetch_array($levelquery->result);\r\n\r\n\r\n        $row += [\"timeleft\" => $timeleft, \"level\" => $level[\"level\"]];\r\n        $rowsFinal[] = $row;\r\n    }\r\n\r\n    $ip = primary\\getIp();\r\n\r\n    $query = mysql\\query(\"UPDATE `users` SET `ip` = NULLIF(?, ''),`lastlogin` = \" . time() . \" WHERE `username` = ? AND `app` = ?\",[$ip, $un, $secret]);\r\n\r\n    return array(\r\n        \"username\" => \"$un\",\r\n        \"subscriptions\" => $rowsFinal,\r\n        \"ip\" => $ip,\r\n        \"hwid\" => $serverHwid,\r\n        \"createdate\" => \"$createdate\",\r\n        \"lastlogin\" => \"\" . time() . \"\"\r\n    );\r\n}\r\n#endregion\r\n","size_bytes":8442},"includes/api/shared/primary.php":{"content":"<?php\nnamespace api\\shared\\primary;\n\nuse misc\\etc;\nuse misc\\cache;\n\nfunction vpnCheck($ipaddr)\n{\n        $url = \"http://ip-api.com/json/{$ipaddr}?fields=16908288\"; // returns fields: proxy,hosting\n        \n        $curl = curl_init($url);\n        curl_setopt($curl, CURLOPT_URL, $url);\n        curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);\n        \n        $resp = curl_exec($curl);\n        $httpcode = curl_getinfo($curl, CURLINFO_HTTP_CODE);\n        $json = json_decode($resp);\n        \n        if($httpcode == 429) {\n                global $logwebhook;\n                $json_data = json_encode([\n                        // Message\n                        \"content\" => \"<@1131334631350878268> IP checking is rate limited\",\n                        // Username\n                        \"username\" => \"KeyAuth Logs\",\n                ], JSON_UNESCAPED_SLASHES | JSON_UNESCAPED_UNICODE);\n                $ch = curl_init($logwebhook);\n                curl_setopt($ch, CURLOPT_HTTPHEADER, array(\n                        'Content-type: application/json'\n                ));\n                curl_setopt($ch, CURLOPT_POST, 1);\n                curl_setopt($ch, CURLOPT_POSTFIELDS, $json_data);\n                curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);\n                curl_setopt($ch, CURLOPT_HEADER, 0);\n                curl_exec($ch);\n                curl_close($ch);\n                return false;\n        }\n        if($json->proxy || $json->hosting) {\n                return true;\n        }\n        return false;\n}\nfunction getIp()\n{\n    return etc\\sanitize($_SERVER['HTTP_CF_CONNECTING_IP'] ?? $_SERVER['HTTP_X_FORWARDED_FOR'] ?? $_SERVER['REMOTE_ADDR']);\n}\nfunction getSession($sessionid, $secret)\n{\n    // had to name it 'state' instead of 'session' because Redis wouldn't save key with 'session' in it\n    $row = cache\\fetch('KeyAuthState:' . $secret . ':' . $sessionid, \"SELECT * FROM `sessions` WHERE `id` = ? AND `app` = ? AND `expiry` > ?\", [$sessionid, $secret, time()], 0, NULL, \"ssi\");\n    if ($row == \"not_found\") {\n        die(json_encode(array(\n            \"success\" => false,\n            \"message\" => \"Session not found. If you get this frequently, ask the developer to use the latest example code\"\n        )));\n    }\n    return array(\n        \"credential\" => $row[\"credential\"],\n        \"enckey\" => $row[\"enckey\"],\n        \"validated\" => $row[\"validated\"]\n    );\n}\n","size_bytes":2381},"replit.md":{"content":"# GenZ Auth Source Code\n\n## Overview\n\nGenZ Auth is an open-source, cloud-hosted authentication system designed to protect software against piracy. It provides license key management, user authentication, and anti-piracy measures, built to handle substantial user loads while maintaining security and preventing unauthorized access to licensed software.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\nThe frontend utilizes static HTML pages with minimal JavaScript, styled using Tailwind CSS for responsive design and Flowbite for UI components. All assets are served from CDN endpoints. A custom ultra-modern theme system (app/assets/modern-theme.css) provides gradients, animations, and glass-morphism effects.\n\n### Backend Architecture\nBuilt on PHP, the backend supports Apache and Nginx. It implements WebAuthn for security key authentication and provides a RESTful API for authentication and license validation.\n\n### Database and Security\nThe system uses MySQL/MariaDB for user accounts, licenses, and application data, with Redis for caching and session management. Security features include FIDO2/WebAuthn integration, anti-piracy protection, and HTTPS-enforced communication.\n\n### Replit Environment\nThe Replit environment is configured with PHP 8.4.10, MySQL/MariaDB connection (us9.endercloud.in:6555), a Redis compatibility layer, and a PHP built-in server running on 0.0.0.0:5000.\n\n## External Dependencies\n\n### Core Infrastructure\n- **Web Servers**: Apache or Nginx\n- **Database Systems**: MySQL or MariaDB\n- **Caching**: Redis\n- **Runtime**: PHP\n\n### Frontend Libraries\n- **Tailwind CSS**: Utility-first CSS framework\n- **Flowbite**: Component library for UI elements\n- **Animate.css**: Animation library\n- **WebAuthn Library**: JavaScript for security key authentication\n- **Modern Theme System**: Custom design system (`app/assets/modern-theme.css`)\n\n### CDN Services\n- **GenZ Auth CDN**: `cdn.keyauth.cc` for static assets.\n\n### Third-Party Integrations\n- **Social Media**: Twitter and Telegram\n- **Analytics**: CodeFactor (for code quality)\n- **Security**: WebAuthn/FIDO2 standards","size_bytes":2182},"cleanup_and_setup.php":{"content":"<?php\n// Script to clear old data and create new accounts with strong passwords\nrequire_once 'includes/credentials.php';\nrequire_once 'includes/misc/user.php';\nrequire_once 'includes/misc/log.php';\nrequire_once 'includes/misc/account.php';\nrequire_once 'includes/misc/sub.php';\nrequire_once 'includes/misc/mysql.php';\n\necho \"Starting database cleanup and account creation...\\n\";\n\n// Start session for using existing functions\nsession_start();\n$_SESSION['app'] = 'main';\n$_SESSION['username'] = 'system';\n$_SESSION['role'] = 'seller';\n\necho \"Connected to database successfully.\\n\";\n\n// Function to generate strong password\nfunction generateStrongPassword($length = 16) {\n    $uppercase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\n    $lowercase = 'abcdefghijklmnopqrstuvwxyz';\n    $numbers = '0123456789';\n    $symbols = '!@#$%^&*';\n    \n    $password = '';\n    $password .= $uppercase[rand(0, strlen($uppercase) - 1)];\n    $password .= $lowercase[rand(0, strlen($lowercase) - 1)];\n    $password .= $numbers[rand(0, strlen($numbers) - 1)];\n    $password .= $symbols[rand(0, strlen($symbols) - 1)];\n    \n    $allChars = $uppercase . $lowercase . $numbers . $symbols;\n    for ($i = 4; $i < $length; $i++) {\n        $password .= $allChars[rand(0, strlen($allChars) - 1)];\n    }\n    \n    return str_shuffle($password);\n}\n\n// Clear old data from database tables\necho \"\\n=== CLEARING OLD DATA ===\\n\";\n\ntry {\n    // Clear users table using existing function\n    $result = misc\\user\\deleteAll();\n    echo \"Cleared users table: \" . $result . \"\\n\";\n    \n    // Clear logs using existing function\n    $result = misc\\logging\\deleteAll();\n    echo \"Cleared logs table: \" . $result . \"\\n\";\n    \n    // Clear other tables manually using existing MySQL functions\n    $result = misc\\mysql\\query(\"DELETE FROM `sessions` WHERE `app` = ?\", ['main']);\n    echo \"Cleared sessions table: \" . $result->affected_rows . \" rows deleted\\n\";\n    \n    $result = misc\\mysql\\query(\"DELETE FROM `auditLog` WHERE `app` = ?\", ['main']);\n    echo \"Cleared audit logs table: \" . $result->affected_rows . \" rows deleted\\n\";\n    \n    $result = misc\\mysql\\query(\"DELETE FROM `keys` WHERE `expires` < ? AND `app` = ?\", [time(), 'main']);\n    echo \"Cleared expired keys: \" . $result->affected_rows . \" rows deleted\\n\";\n    \n    $result = misc\\mysql\\query(\"DELETE FROM `subs` WHERE `expiry` < ? AND `app` = ?\", [time(), 'main']);\n    echo \"Cleared expired subscriptions: \" . $result->affected_rows . \" rows deleted\\n\";\n    \n    $result = misc\\mysql\\query(\"DELETE FROM `tokens` WHERE `app` = ?\", ['main']);\n    echo \"Cleared tokens table: \" . $result->affected_rows . \" rows deleted\\n\";\n    \n    $result = misc\\mysql\\query(\"DELETE FROM `uservars` WHERE `app` = ?\", ['main']);\n    echo \"Cleared user variables table: \" . $result->affected_rows . \" rows deleted\\n\";\n    \n    echo \"✓ Database cleanup completed successfully!\\n\";\n    \n} catch (Exception $e) {\n    echo \"Error during cleanup: \" . $e->getMessage() . \"\\n\";\n}\n\n// Create subscription plans if they don't exist\necho \"\\n=== SETTING UP SUBSCRIPTION PLANS ===\\n\";\n\n$plans = [\n    ['name' => 'Basic', 'level' => '1'],\n    ['name' => 'Premium', 'level' => '2'], \n    ['name' => 'VIP', 'level' => '3'],\n    ['name' => 'Seller', 'level' => '4'],\n    ['name' => 'Reseller', 'level' => '5'],\n    ['name' => 'Manager', 'level' => '6']\n];\n\nforeach ($plans as $plan) {\n    // Check if plan exists\n    $checkPlan = misc\\mysql\\query(\"SELECT 1 FROM `subscriptions` WHERE `name` = ? AND `app` = ?\", [$plan['name'], 'main']);\n    \n    if ($checkPlan->num_rows == 0) {\n        // Create new plan using existing function\n        $result = misc\\sub\\add($plan['name'], $plan['level'], 'main');\n        if ($result === 'success') {\n            echo \"✓ Created subscription plan: \" . $plan['name'] . \" (Level \" . $plan['level'] . \")\\n\";\n        } else {\n            echo \"✗ Failed to create plan: \" . $plan['name'] . \" - \" . $result . \"\\n\";\n        }\n    } else {\n        echo \"• Plan already exists: \" . $plan['name'] . \"\\n\";\n    }\n}\n\n// Create admin/seller accounts with strong passwords\necho \"\\n=== CREATING ADMIN/SELLER ACCOUNTS ===\\n\";\n\n$adminAccounts = [\n    [\n        'username' => 'admin_seller',\n        'role' => 'seller', \n        'email' => 'admin@keyauth.com',\n        'name' => 'Admin Seller',\n        'keyLevels' => '1,2,3,4,5,6',\n        'permissions' => 8191 // All permissions\n    ],\n    [\n        'username' => 'main_reseller',\n        'role' => 'Reseller',\n        'email' => 'reseller@keyauth.com', \n        'name' => 'Main Reseller',\n        'keyLevels' => '1,2,3,4',\n        'permissions' => 1023 // Limited permissions\n    ],\n    [\n        'username' => 'manager_01',\n        'role' => 'Manager',\n        'email' => 'manager@keyauth.com',\n        'name' => 'Manager Account', \n        'keyLevels' => '1,2,3',\n        'permissions' => 511 // Manager permissions\n    ]\n];\n\n$createdAccounts = [];\n\nforeach ($adminAccounts as $account) {\n    $password = generateStrongPassword(16);\n    \n    // Check if account exists\n    $checkAccount = misc\\mysql\\query(\"SELECT 1 FROM `accounts` WHERE `username` = ?\", [$account['username']]);\n    \n    if ($checkAccount->num_rows == 0) {\n        // Create new account using existing function\n        $result = misc\\account\\addAccount(\n            $account['username'],\n            $account['role'],\n            $account['email'],\n            $password,\n            $account['keyLevels'],\n            'system',\n            'main',\n            $account['permissions']\n        );\n        \n        if ($result === 'success') {\n            $createdAccounts[] = [\n                'username' => $account['username'],\n                'password' => $password,\n                'email' => $account['email'],\n                'role' => $account['role']\n            ];\n            echo \"✓ Created account: \" . $account['username'] . \" (\" . $account['role'] . \")\\n\";\n        } else {\n            echo \"✗ Failed to create account: \" . $account['username'] . \" - \" . $result . \"\\n\";\n        }\n    } else {\n        echo \"• Account already exists: \" . $account['username'] . \"\\n\";\n    }\n}\n\n// Create sample users for each plan with strong passwords\necho \"\\n=== CREATING SAMPLE USERS FOR EACH PLAN ===\\n\";\n\n$sampleUsers = [\n    ['username' => 'basic_user_01', 'plan' => 'Basic'],\n    ['username' => 'premium_user_01', 'plan' => 'Premium'],\n    ['username' => 'vip_user_01', 'plan' => 'VIP'],\n    ['username' => 'seller_user_01', 'plan' => 'Seller'],\n    ['username' => 'reseller_user_01', 'plan' => 'Reseller']\n];\n\nforeach ($sampleUsers as $user) {\n    $password = generateStrongPassword(14);\n    $expiry = time() + (30 * 24 * 60 * 60); // 30 days from now\n    \n    // Check if user exists\n    $checkUser = misc\\mysql\\query(\"SELECT 1 FROM `users` WHERE `username` = ? AND `app` = ?\", [$user['username'], 'main']);\n    \n    if ($checkUser->num_rows == 0) {\n        // Create user with subscription using existing function\n        $result = misc\\user\\add($user['username'], $user['plan'], $expiry, 'main', $password);\n        \n        if ($result === 'success') {\n            $createdAccounts[] = [\n                'username' => $user['username'],\n                'password' => $password,\n                'plan' => $user['plan'],\n                'type' => 'user'\n            ];\n            echo \"✓ Created user: \" . $user['username'] . \" with \" . $user['plan'] . \" plan\\n\";\n        } else {\n            echo \"✗ Failed to create user: \" . $user['username'] . \" - \" . $result . \"\\n\";\n        }\n    } else {\n        echo \"• User already exists: \" . $user['username'] . \"\\n\";\n    }\n}\n\n// Display all created accounts\necho \"\\n=== ACCOUNT SUMMARY ===\\n\";\necho \"All accounts created with strong passwords:\\n\\n\";\n\nforeach ($createdAccounts as $account) {\n    echo \"Username: \" . $account['username'] . \"\\n\";\n    echo \"Password: \" . $account['password'] . \"\\n\";\n    if (isset($account['email'])) {\n        echo \"Email: \" . $account['email'] . \"\\n\";\n        echo \"Role: \" . $account['role'] . \"\\n\";\n    } else {\n        echo \"Plan: \" . $account['plan'] . \"\\n\";\n        echo \"Type: User Account\\n\";\n    }\n    echo \"------------------------\\n\";\n}\n\necho \"\\n✓ SETUP COMPLETED SUCCESSFULLY!\\n\";\necho \"• Old data has been cleared from the database\\n\";\necho \"• \" . count($createdAccounts) . \" accounts created with strong passwords\\n\";\necho \"• All subscription plans are configured\\n\";\necho \"• Seller and admin accounts are ready\\n\\n\";\n\necho \"IMPORTANT: Save the above account credentials in a secure location!\\n\";\n\n// Script completed\n?>","size_bytes":8563},"app/pages/seller-api.php":{"content":"<?php\nrequire_once '../includes/csrf.php';\n\nif ($_SESSION['role'] == \"Reseller\") {\n    header(\"location: ./?page=reseller-licenses\");\n    die();\n}\nif ($role == \"Manager\" && !($permissions & 2048)) {\n    misc\\auditLog\\send(\"Attempted (and failed) to view Seller API settings.\");\n    dashboard\\primary\\error(\"You weren't granted permission to view this page.\");\n    die();\n}\nif (!isset($_SESSION['app'])) {\n    dashboard\\primary\\error(\"Application not selected\");\n    die(\"Application not selected.\");\n}\n\n// Get current app details\n$query = misc\\mysql\\query(\"SELECT `name`, `secret`, `sellerkey`, `ownerid` FROM `apps` WHERE `secret` = ?\", [$_SESSION['app']]);\n$app = mysqli_fetch_array($query->result);\n\n// Generate seller API key if not exists\nif (empty($app['sellerkey'])) {\n    $sellerkey = bin2hex(random_bytes(32));\n    misc\\mysql\\query(\"UPDATE `apps` SET `sellerkey` = ? WHERE `secret` = ?\", [$sellerkey, $_SESSION['app']]);\n    $app['sellerkey'] = $sellerkey;\n}\n\n// Handle regenerate API key\nif (isset($_POST['regenerate_key'])) {\n    csrf\\requireValidToken();\n    \n    $new_sellerkey = bin2hex(random_bytes(32));\n    misc\\mysql\\query(\"UPDATE `apps` SET `sellerkey` = ? WHERE `secret` = ?\", [$new_sellerkey, $_SESSION['app']]);\n    $app['sellerkey'] = $new_sellerkey;\n    dashboard\\primary\\success(\"Seller API key regenerated successfully!\");\n    misc\\auditLog\\send(\"Regenerated Seller API key for application \" . $app['name']);\n}\n\n$domain = $_SERVER['HTTP_HOST'];\n$api_base_url = \"https://{$domain}/api/seller/\";\n?>\n\n<div class=\"p-4 lg:p-8\">\n    <div class=\"max-w-6xl mx-auto\">\n        <!-- Header -->\n        <div class=\"flex items-center justify-between mb-8\">\n            <div>\n                <h1 class=\"text-2xl md:text-3xl font-bold text-white mb-2\">\n                    🔑 Seller API Access\n                </h1>\n                <p class=\"text-gray-400\">\n                    Manage your application programmatically with the Seller API\n                </p>\n            </div>\n            <div class=\"flex items-center space-x-2\">\n                <span class=\"bg-blue-500/20 text-blue-400 px-3 py-1 rounded-full text-sm font-medium\">\n                    Seller Plan Only\n                </span>\n            </div>\n        </div>\n\n        <!-- API Credentials Card -->\n        <div class=\"bg-[#0f0f17] border border-gray-700 rounded-lg p-6 mb-8\">\n            <h2 class=\"text-xl font-semibold text-white mb-4 flex items-center\">\n                <svg class=\"w-5 h-5 mr-2 text-green-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fill-rule=\"evenodd\" d=\"M18 8a6 6 0 01-7.743 5.743L10 14l-2 1-1 1H4v-6L10 4a6 6 0 018 4zm-6-2a1 1 0 11-2 0 1 1 0 012 0z\" clip-rule=\"evenodd\"></path>\n                </svg>\n                API Credentials\n            </h2>\n            \n            <div class=\"grid md:grid-cols-2 gap-6\">\n                <div>\n                    <label class=\"block text-sm font-medium text-gray-300 mb-2\">\n                        Application Name\n                    </label>\n                    <div class=\"bg-[#09090d] border border-gray-600 rounded-lg p-3\">\n                        <code class=\"text-blue-400\"><?php echo htmlspecialchars($app['name']); ?></code>\n                    </div>\n                </div>\n                \n                <div>\n                    <label class=\"block text-sm font-medium text-gray-300 mb-2\">\n                        Owner ID\n                    </label>\n                    <div class=\"bg-[#09090d] border border-gray-600 rounded-lg p-3\">\n                        <code class=\"text-blue-400\"><?php echo htmlspecialchars($app['ownerid']); ?></code>\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"mt-6\">\n                <label class=\"block text-sm font-medium text-gray-300 mb-2\">\n                    Seller API Key\n                </label>\n                <div class=\"flex gap-3\">\n                    <div class=\"flex-1 bg-[#09090d] border border-gray-600 rounded-lg p-3\">\n                        <code class=\"text-green-400 break-all\"><?php echo htmlspecialchars($app['sellerkey']); ?></code>\n                    </div>\n                    <form method=\"POST\" class=\"inline\">\n                        <?php echo csrf\\getTokenField(); ?>\n                        <button \n                            type=\"submit\" \n                            name=\"regenerate_key\"\n                            class=\"bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded-lg transition duration-200\"\n                            onclick=\"return confirm('Are you sure? This will invalidate your current API key!');\"\n                        >\n                            Regenerate\n                        </button>\n                    </form>\n                </div>\n                <p class=\"text-xs text-gray-500 mt-1\">Keep this key secure. It provides full access to your application.</p>\n            </div>\n        </div>\n\n        <!-- API Endpoints -->\n        <div class=\"grid md:grid-cols-2 gap-8 mb-8\">\n            <!-- User Management -->\n            <div class=\"bg-[#0f0f17] border border-gray-700 rounded-lg p-6\">\n                <h3 class=\"text-lg font-semibold text-white mb-4 flex items-center\">\n                    <svg class=\"w-5 h-5 mr-2 text-blue-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"></path>\n                    </svg>\n                    User Management\n                </h3>\n                \n                <div class=\"space-y-4 text-sm\">\n                    <div class=\"bg-[#09090d] p-3 rounded\">\n                        <div class=\"flex justify-between items-center mb-2\">\n                            <code class=\"text-blue-400\">POST /create-user</code>\n                            <span class=\"bg-green-500/20 text-green-400 px-2 py-1 rounded text-xs\">Active</span>\n                        </div>\n                        <p class=\"text-gray-400\">Create new users for your application</p>\n                    </div>\n                    <div class=\"bg-[#09090d] p-3 rounded\">\n                        <div class=\"flex justify-between items-center mb-2\">\n                            <code class=\"text-blue-400\">GET /users</code>\n                            <span class=\"bg-green-500/20 text-green-400 px-2 py-1 rounded text-xs\">Active</span>\n                        </div>\n                        <p class=\"text-gray-400\">Get list of all users</p>\n                    </div>\n                    <div class=\"bg-[#09090d] p-3 rounded\">\n                        <div class=\"flex justify-between items-center mb-2\">\n                            <code class=\"text-blue-400\">DELETE /user/{username}</code>\n                            <span class=\"bg-green-500/20 text-green-400 px-2 py-1 rounded text-xs\">Active</span>\n                        </div>\n                        <p class=\"text-gray-400\">Delete specific user</p>\n                    </div>\n                </div>\n            </div>\n\n            <!-- License Management -->\n            <div class=\"bg-[#0f0f17] border border-gray-700 rounded-lg p-6\">\n                <h3 class=\"text-lg font-semibold text-white mb-4 flex items-center\">\n                    <svg class=\"w-5 h-5 mr-2 text-yellow-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path fill-rule=\"evenodd\" d=\"M18 8a6 6 0 01-7.743 5.743L10 14l-2 1-1 1H4v-6L10 4a6 6 0 018 4zm-6-2a1 1 0 11-2 0 1 1 0 012 0z\" clip-rule=\"evenodd\"></path>\n                    </svg>\n                    License Management\n                </h3>\n                \n                <div class=\"space-y-4 text-sm\">\n                    <div class=\"bg-[#09090d] p-3 rounded\">\n                        <div class=\"flex justify-between items-center mb-2\">\n                            <code class=\"text-blue-400\">POST /create-license</code>\n                            <span class=\"bg-green-500/20 text-green-400 px-2 py-1 rounded text-xs\">Active</span>\n                        </div>\n                        <p class=\"text-gray-400\">Generate new license keys</p>\n                    </div>\n                    <div class=\"bg-[#09090d] p-3 rounded\">\n                        <div class=\"flex justify-between items-center mb-2\">\n                            <code class=\"text-blue-400\">GET /licenses</code>\n                            <span class=\"bg-green-500/20 text-green-400 px-2 py-1 rounded text-xs\">Active</span>\n                        </div>\n                        <p class=\"text-gray-400\">Get all license keys</p>\n                    </div>\n                    <div class=\"bg-[#09090d] p-3 rounded\">\n                        <div class=\"flex justify-between items-center mb-2\">\n                            <code class=\"text-blue-400\">DELETE /license/{key}</code>\n                            <span class=\"bg-green-500/20 text-green-400 px-2 py-1 rounded text-xs\">Active</span>\n                        </div>\n                        <p class=\"text-gray-400\">Delete specific license</p>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <!-- Code Examples -->\n        <div class=\"bg-[#0f0f17] border border-gray-700 rounded-lg p-6 mb-8\">\n            <h3 class=\"text-lg font-semibold text-white mb-4 flex items-center\">\n                <svg class=\"w-5 h-5 mr-2 text-purple-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fill-rule=\"evenodd\" d=\"M12.316 3.051a1 1 0 01.633 1.265l-4 12a1 1 0 11-1.898-.632l4-12a1 1 0 011.265-.633zM5.707 6.293a1 1 0 010 1.414L3.414 10l2.293 2.293a1 1 0 11-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0zm8.586 0a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 11-1.414-1.414L16.586 10l-2.293-2.293a1 1 0 010-1.414z\" clip-rule=\"evenodd\"></path>\n                </svg>\n                Code Examples\n            </h3>\n            \n            <div class=\"space-y-6\">\n                <!-- cURL Example -->\n                <div>\n                    <h4 class=\"text-md font-medium text-white mb-3\">cURL Example (Create User)</h4>\n                    <div class=\"bg-[#09090d] p-4 rounded-lg overflow-x-auto\">\n                        <pre class=\"text-sm text-gray-300\"><code>curl -X POST \"<?php echo $api_base_url; ?>create-user\" \\\n  -H \"Authorization: Bearer <?php echo $app['sellerkey']; ?>\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"username\": \"newuser123\",\n    \"password\": \"userpassword\",\n    \"email\": \"user@example.com\",\n    \"subscription\": \"monthly\"\n  }'</code></pre>\n                    </div>\n                </div>\n\n                <!-- Python Example -->\n                <div>\n                    <h4 class=\"text-md font-medium text-white mb-3\">Python Example</h4>\n                    <div class=\"bg-[#09090d] p-4 rounded-lg overflow-x-auto\">\n                        <pre class=\"text-sm text-gray-300\"><code>import requests\n\napi_key = \"<?php echo $app['sellerkey']; ?>\"\nbase_url = \"<?php echo $api_base_url; ?>\"\n\nheaders = {\n    \"Authorization\": f\"Bearer {api_key}\",\n    \"Content-Type\": \"application/json\"\n}\n\n# Create user\nresponse = requests.post(f\"{base_url}create-user\", \n    headers=headers,\n    json={\n        \"username\": \"newuser123\",\n        \"password\": \"userpassword\", \n        \"email\": \"user@example.com\"\n    }\n)\n\nprint(response.json())</code></pre>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <!-- Rate Limits & Security -->\n        <div class=\"grid md:grid-cols-2 gap-8\">\n            <!-- Rate Limits -->\n            <div class=\"bg-[#0f0f17] border border-gray-700 rounded-lg p-6\">\n                <h3 class=\"text-lg font-semibold text-white mb-4 flex items-center\">\n                    <svg class=\"w-5 h-5 mr-2 text-red-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clip-rule=\"evenodd\"></path>\n                    </svg>\n                    Rate Limits\n                </h3>\n                \n                <div class=\"space-y-3 text-sm\">\n                    <div class=\"flex justify-between\">\n                        <span class=\"text-gray-300\">Requests per minute:</span>\n                        <span class=\"text-green-400 font-medium\">1000</span>\n                    </div>\n                    <div class=\"flex justify-between\">\n                        <span class=\"text-gray-300\">Burst limit:</span>\n                        <span class=\"text-green-400 font-medium\">100</span>\n                    </div>\n                    <div class=\"flex justify-between\">\n                        <span class=\"text-gray-300\">Daily limit:</span>\n                        <span class=\"text-green-400 font-medium\">Unlimited</span>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Security -->\n            <div class=\"bg-[#0f0f17] border border-gray-700 rounded-lg p-6\">\n                <h3 class=\"text-lg font-semibold text-white mb-4 flex items-center\">\n                    <svg class=\"w-5 h-5 mr-2 text-green-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path fill-rule=\"evenodd\" d=\"M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clip-rule=\"evenodd\"></path>\n                    </svg>\n                    Security\n                </h3>\n                \n                <div class=\"space-y-3 text-sm\">\n                    <div class=\"flex items-center\">\n                        <span class=\"w-2 h-2 bg-green-400 rounded-full mr-2\"></span>\n                        <span class=\"text-gray-300\">HTTPS Required</span>\n                    </div>\n                    <div class=\"flex items-center\">\n                        <span class=\"w-2 h-2 bg-green-400 rounded-full mr-2\"></span>\n                        <span class=\"text-gray-300\">Bearer Token Auth</span>\n                    </div>\n                    <div class=\"flex items-center\">\n                        <span class=\"w-2 h-2 bg-green-400 rounded-full mr-2\"></span>\n                        <span class=\"text-gray-300\">Request Validation</span>\n                    </div>\n                    <div class=\"flex items-center\">\n                        <span class=\"w-2 h-2 bg-green-400 rounded-full mr-2\"></span>\n                        <span class=\"text-gray-300\">IP Whitelisting Available</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>","size_bytes":14820},"app/pages/telegram-bot.php":{"content":"<?php\nrequire_once '../includes/csrf.php';\n\nif ($_SESSION['role'] == \"Reseller\") {\n    header(\"location: ./?page=reseller-licenses\");\n    die();\n}\nif ($role == \"Manager\" && !($permissions & 2048)) {\n    misc\\auditLog\\send(\"Attempted (and failed) to view Telegram Bot settings.\");\n    dashboard\\primary\\error(\"You weren't granted permission to view this page.\");\n    die();\n}\nif (!isset($_SESSION['app'])) {\n    dashboard\\primary\\error(\"Application not selected\");\n    die(\"Application not selected.\");\n}\n\n// Handle Telegram Bot setup\nif (isset($_POST['setup_bot'])) {\n    csrf\\requireValidToken();\n    \n    $bot_token = misc\\etc\\sanitize($_POST['bot_token']);\n    $webhook_url = misc\\etc\\sanitize($_POST['webhook_url']);\n    \n    if (!empty($bot_token) && !empty($webhook_url)) {\n        // Validate bot token format\n        if (!preg_match('/^\\d+:[A-Za-z0-9_-]{35}$/', $bot_token)) {\n            dashboard\\primary\\error(\"Invalid bot token format!\");\n        } else {\n            // Test bot token by calling getMe API\n            $test_url = \"https://api.telegram.org/bot{$bot_token}/getMe\";\n            $test_response = file_get_contents($test_url);\n            $test_data = json_decode($test_response, true);\n            \n            if ($test_data && $test_data['ok']) {\n                // Set webhook\n                $webhook_set_url = \"https://api.telegram.org/bot{$bot_token}/setWebhook\";\n                $webhook_data = json_encode(['url' => $webhook_url]);\n                \n                $context = stream_context_create([\n                    'http' => [\n                        'method' => 'POST',\n                        'header' => 'Content-Type: application/json',\n                        'content' => $webhook_data\n                    ]\n                ]);\n                \n                $webhook_response = file_get_contents($webhook_set_url, false, $context);\n                $webhook_result = json_decode($webhook_response, true);\n                \n                if ($webhook_result && $webhook_result['ok']) {\n                    // Store bot settings in database\n                    $query = misc\\mysql\\query(\"UPDATE `apps` SET `telegram_bot_token` = ?, `telegram_webhook` = ? WHERE `secret` = ?\", [$bot_token, $webhook_url, $_SESSION['app']]);\n                    \n                    if ($query->affected_rows > 0) {\n                        dashboard\\primary\\success(\"Telegram Bot configured and webhook set successfully!\");\n                        misc\\auditLog\\send(\"Configured Telegram Bot for application \" . $_SESSION['name']);\n                    } else {\n                        dashboard\\primary\\error(\"Failed to save bot configuration!\");\n                    }\n                } else {\n                    dashboard\\primary\\error(\"Failed to set webhook: \" . ($webhook_result['description'] ?? 'Unknown error'));\n                }\n            } else {\n                dashboard\\primary\\error(\"Invalid bot token or bot not accessible!\");\n            }\n        }\n    } else {\n        dashboard\\primary\\error(\"Please fill in all required fields!\");\n    }\n}\n\nif (isset($_POST['test_bot'])) {\n    csrf\\requireValidToken();\n    \n    // Get bot settings\n    $query = misc\\mysql\\query(\"SELECT `telegram_bot_token`, `telegram_chat_id` FROM `apps` WHERE `secret` = ?\", [$_SESSION['app']]);\n    $bot_settings = mysqli_fetch_array($query->result);\n    \n    if (!empty($bot_settings['telegram_bot_token'])) {\n        $bot_token = $bot_settings['telegram_bot_token'];\n        $chat_id = $bot_settings['telegram_chat_id'] ?? 'YOUR_CHAT_ID'; // You can set a default test chat ID\n        \n        $test_message = \"🤖 KeyAuth Bot Test\\n\\n\" .\n                       \"Application: \" . $_SESSION['name'] . \"\\n\" .\n                       \"Time: \" . date('Y-m-d H:i:s') . \"\\n\" .\n                       \"Status: ✅ Bot is working correctly!\\n\\n\" .\n                       \"This is a test message from your KeyAuth Seller Plan.\";\n        \n        $send_url = \"https://api.telegram.org/bot{$bot_token}/sendMessage\";\n        $send_data = json_encode([\n            'chat_id' => $chat_id,\n            'text' => $test_message,\n            'parse_mode' => 'HTML'\n        ]);\n        \n        $context = stream_context_create([\n            'http' => [\n                'method' => 'POST',\n                'header' => 'Content-Type: application/json',\n                'content' => $send_data\n            ]\n        ]);\n        \n        $response = file_get_contents($send_url, false, $context);\n        $result = json_decode($response, true);\n        \n        if ($result && $result['ok']) {\n            dashboard\\primary\\success(\"Test message sent successfully! Check your Telegram chat.\");\n        } else {\n            dashboard\\primary\\error(\"Failed to send test message. Please check your chat ID.\");\n        }\n    } else {\n        dashboard\\primary\\error(\"Please configure your bot first!\");\n    }\n}\n?>\n\n<div class=\"p-4 lg:p-8\">\n    <div class=\"max-w-6xl mx-auto\">\n        <!-- Header -->\n        <div class=\"flex items-center justify-between mb-8\">\n            <div>\n                <h1 class=\"text-2xl md:text-3xl font-bold text-white mb-2\">\n                    🤖 Telegram Bot Integration\n                </h1>\n                <p class=\"text-gray-400\">\n                    Set up your Telegram bot to receive real-time notifications about your application\n                </p>\n            </div>\n            <div class=\"flex items-center space-x-2\">\n                <span class=\"bg-green-500/20 text-green-400 px-3 py-1 rounded-full text-sm font-medium\">\n                    Seller Feature\n                </span>\n            </div>\n        </div>\n\n        <!-- Bot Setup Card -->\n        <div class=\"bg-[#0f0f17] border border-gray-700 rounded-lg p-6 mb-8\">\n            <h2 class=\"text-xl font-semibold text-white mb-4 flex items-center\">\n                <svg class=\"w-5 h-5 mr-2 text-blue-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fill-rule=\"evenodd\" d=\"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z\" clip-rule=\"evenodd\"></path>\n                </svg>\n                Bot Configuration\n            </h2>\n            \n            <form method=\"POST\" class=\"space-y-6\">\n                <div class=\"grid md:grid-cols-2 gap-6\">\n                    <div>\n                        <label class=\"block text-sm font-medium text-gray-300 mb-2\">\n                            Bot Token\n                        </label>\n                        <input \n                            type=\"text\" \n                            name=\"bot_token\" \n                            placeholder=\"1234567890:ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijk\"\n                            class=\"w-full px-3 py-2 bg-[#09090d] border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none\"\n                            required\n                        >\n                        <p class=\"text-xs text-gray-500 mt-1\">Get this from @BotFather on Telegram</p>\n                    </div>\n                    \n                    <div>\n                        <label class=\"block text-sm font-medium text-gray-300 mb-2\">\n                            Webhook URL\n                        </label>\n                        <input \n                            type=\"url\" \n                            name=\"webhook_url\" \n                            placeholder=\"https://your-domain.com/telegram/webhook\"\n                            class=\"w-full px-3 py-2 bg-[#09090d] border border-gray-600 rounded-lg text-white focus:border-blue-500 focus:outline-none\"\n                            required\n                        >\n                        <p class=\"text-xs text-gray-500 mt-1\">URL where Telegram will send updates</p>\n                    </div>\n                </div>\n                \n                <div class=\"flex gap-4\">\n                    <button \n                        type=\"submit\" \n                        name=\"setup_bot\"\n                        class=\"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition duration-200\"\n                    >\n                        Configure Bot\n                    </button>\n                    \n                    <button \n                        type=\"submit\" \n                        name=\"test_bot\"\n                        class=\"bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition duration-200\"\n                    >\n                        Test Bot\n                    </button>\n                </div>\n            </form>\n        </div>\n\n        <!-- Bot Features -->\n        <div class=\"grid md:grid-cols-2 gap-8 mb-8\">\n            <!-- Available Notifications -->\n            <div class=\"bg-[#0f0f17] border border-gray-700 rounded-lg p-6\">\n                <h3 class=\"text-lg font-semibold text-white mb-4 flex items-center\">\n                    <svg class=\"w-5 h-5 mr-2 text-green-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path d=\"M10 2L3 7v11a1 1 0 001 1h3a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1h3a1 1 0 001-1V7l-7-5z\"></path>\n                    </svg>\n                    Available Notifications\n                </h3>\n                \n                <div class=\"space-y-3\">\n                    <div class=\"flex items-center justify-between\">\n                        <span class=\"text-gray-300\">New User Registrations</span>\n                        <span class=\"bg-green-500/20 text-green-400 px-2 py-1 rounded text-xs\">Active</span>\n                    </div>\n                    <div class=\"flex items-center justify-between\">\n                        <span class=\"text-gray-300\">License Activations</span>\n                        <span class=\"bg-green-500/20 text-green-400 px-2 py-1 rounded text-xs\">Active</span>\n                    </div>\n                    <div class=\"flex items-center justify-between\">\n                        <span class=\"text-gray-300\">Failed Login Attempts</span>\n                        <span class=\"bg-green-500/20 text-green-400 px-2 py-1 rounded text-xs\">Active</span>\n                    </div>\n                    <div class=\"flex items-center justify-between\">\n                        <span class=\"text-gray-300\">HWID Violations</span>\n                        <span class=\"bg-green-500/20 text-green-400 px-2 py-1 rounded text-xs\">Active</span>\n                    </div>\n                    <div class=\"flex items-center justify-between\">\n                        <span class=\"text-gray-300\">Subscription Expiries</span>\n                        <span class=\"bg-green-500/20 text-green-400 px-2 py-1 rounded text-xs\">Active</span>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Bot Commands -->\n            <div class=\"bg-[#0f0f17] border border-gray-700 rounded-lg p-6\">\n                <h3 class=\"text-lg font-semibold text-white mb-4 flex items-center\">\n                    <svg class=\"w-5 h-5 mr-2 text-blue-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path fill-rule=\"evenodd\" d=\"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z\" clip-rule=\"evenodd\"></path>\n                    </svg>\n                    Bot Commands\n                </h3>\n                \n                <div class=\"space-y-3 text-sm\">\n                    <div class=\"bg-[#09090d] p-3 rounded\">\n                        <code class=\"text-blue-400\">/stats</code>\n                        <p class=\"text-gray-400 mt-1\">Get application statistics</p>\n                    </div>\n                    <div class=\"bg-[#09090d] p-3 rounded\">\n                        <code class=\"text-blue-400\">/users</code>\n                        <p class=\"text-gray-400 mt-1\">Get total user count</p>\n                    </div>\n                    <div class=\"bg-[#09090d] p-3 rounded\">\n                        <code class=\"text-blue-400\">/licenses</code>\n                        <p class=\"text-gray-400 mt-1\">Get license information</p>\n                    </div>\n                    <div class=\"bg-[#09090d] p-3 rounded\">\n                        <code class=\"text-blue-400\">/ban [username]</code>\n                        <p class=\"text-gray-400 mt-1\">Ban a specific user</p>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <!-- Setup Instructions -->\n        <div class=\"bg-[#0f0f17] border border-gray-700 rounded-lg p-6\">\n            <h3 class=\"text-lg font-semibold text-white mb-4 flex items-center\">\n                <svg class=\"w-5 h-5 mr-2 text-yellow-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fill-rule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\" clip-rule=\"evenodd\"></path>\n                </svg>\n                Setup Instructions\n            </h3>\n            \n            <div class=\"prose prose-invert max-w-none\">\n                <ol class=\"list-decimal list-inside space-y-3 text-gray-300\">\n                    <li>\n                        <strong>Create a Telegram Bot:</strong>\n                        <ul class=\"list-disc list-inside ml-4 mt-2 space-y-1 text-sm text-gray-400\">\n                            <li>Message @BotFather on Telegram</li>\n                            <li>Send <code>/newbot</code> command</li>\n                            <li>Follow the instructions to create your bot</li>\n                            <li>Copy the bot token provided</li>\n                        </ul>\n                    </li>\n                    <li>\n                        <strong>Set up Webhook:</strong>\n                        <ul class=\"list-disc list-inside ml-4 mt-2 space-y-1 text-sm text-gray-400\">\n                            <li>Use your domain + <code>/telegram/webhook</code></li>\n                            <li>Make sure your server supports HTTPS</li>\n                            <li>The webhook will receive all bot updates</li>\n                        </ul>\n                    </li>\n                    <li>\n                        <strong>Configure Settings:</strong>\n                        <ul class=\"list-disc list-inside ml-4 mt-2 space-y-1 text-sm text-gray-400\">\n                            <li>Enter your bot token above</li>\n                            <li>Enter your webhook URL</li>\n                            <li>Click \"Configure Bot\" to save settings</li>\n                            <li>Use \"Test Bot\" to verify everything works</li>\n                        </ul>\n                    </li>\n                </ol>\n            </div>\n        </div>\n    </div>\n</div>","size_bytes":15198},"fix_database.php":{"content":"<?php\nrequire_once 'includes/credentials.php';\n\n// Connect to database\n$conn = mysqli_connect($databaseHost, $databaseUsername, $databasePassword, $databaseName, $databasePort);\n\nif (!$conn) {\n    die(\"Database connection failed: \" . mysqli_connect_error());\n}\n\necho \"🔧 KeyAuth Database Performance & Structure Fix\\n\";\necho \"================================================\\n\\n\";\n\n// 1. Check current seller_admin role\necho \"1. Checking seller_admin role:\\n\";\n$result = mysqli_query($conn, \"SELECT username, role FROM accounts WHERE username = 'seller_admin'\");\nif ($result && $row = mysqli_fetch_assoc($result)) {\n    echo \"   Current role: '{$row['role']}'\\n\";\n    \n    // Fix role to be consistent\n    if ($row['role'] !== 'seller') {\n        mysqli_query($conn, \"UPDATE accounts SET role = 'seller' WHERE username = 'seller_admin'\");\n        echo \"   ✅ Updated role to 'seller'\\n\";\n    } else {\n        echo \"   ✅ Role is correct\\n\";\n    }\n} else {\n    echo \"   ❌ seller_admin not found\\n\";\n}\n\n// 2. Show all tables\necho \"\\n2. Database Tables:\\n\";\n$result = mysqli_query($conn, \"SHOW TABLES\");\nwhile ($row = mysqli_fetch_array($result)) {\n    echo \"   - {$row[0]}\\n\";\n}\n\n// 3. Add Performance Indexes\necho \"\\n3. Adding Performance Indexes:\\n\";\n\n$indexes = [\n    \"users\" => [\n        \"ALTER TABLE `users` ADD INDEX `idx_app` (`app`)\",\n        \"ALTER TABLE `users` ADD INDEX `idx_app_username` (`app`, `username`)\",\n        \"ALTER TABLE `users` ADD UNIQUE KEY `unique_app_username` (`app`, `username`)\"\n    ],\n    \"subs\" => [\n        \"ALTER TABLE `subs` ADD INDEX `idx_app` (`app`)\",\n        \"ALTER TABLE `subs` ADD INDEX `idx_app_user` (`app`, `user`)\"\n    ],\n    \"uservars\" => [\n        \"ALTER TABLE `uservars` ADD INDEX `idx_app` (`app`)\",\n        \"ALTER TABLE `uservars` ADD INDEX `idx_app_user` (`app`, `user`)\"\n    ],\n    \"tokens\" => [\n        \"ALTER TABLE `tokens` ADD INDEX `idx_app` (`app`)\",\n        \"ALTER TABLE `tokens` ADD INDEX `idx_app_type` (`app`, `type`)\"\n    ],\n    \"logs\" => [\n        \"ALTER TABLE `logs` ADD INDEX `idx_app` (`app`)\",\n        \"ALTER TABLE `logs` ADD INDEX `idx_app_date` (`app`, `date`)\"\n    ],\n    \"sessions\" => [\n        \"ALTER TABLE `sessions` ADD INDEX `idx_app` (`app`)\",\n        \"ALTER TABLE `sessions` ADD INDEX `idx_app_credential` (`app`, `credential`)\"\n    ]\n];\n\nforeach ($indexes as $table => $table_indexes) {\n    echo \"   Adding indexes for '$table':\\n\";\n    foreach ($table_indexes as $index_sql) {\n        $result = mysqli_query($conn, $index_sql);\n        if ($result) {\n            echo \"     ✅ \" . substr($index_sql, strpos($index_sql, 'ADD') + 4) . \"\\n\";\n        } else {\n            $error = mysqli_error($conn);\n            if (strpos($error, 'Duplicate key name') !== false || strpos($error, 'already exists') !== false) {\n                echo \"     ⚠️ \" . substr($index_sql, strpos($index_sql, 'ADD') + 4) . \" (already exists)\\n\";\n            } else {\n                echo \"     ❌ \" . substr($index_sql, strpos($index_sql, 'ADD') + 4) . \" - Error: $error\\n\";\n            }\n        }\n    }\n}\n\n// 4. Check apps table structure and add missing columns\necho \"\\n4. Checking apps table structure:\\n\";\n$result = mysqli_query($conn, \"DESCRIBE apps\");\n$columns = [];\nwhile ($row = mysqli_fetch_assoc($result)) {\n    $columns[] = $row['Field'];\n}\n\n$required_columns = [\n    'telegram_bot_token' => \"VARCHAR(200) DEFAULT NULL\",\n    'telegram_webhook' => \"VARCHAR(300) DEFAULT NULL\", \n    'telegram_chat_id' => \"VARCHAR(50) DEFAULT NULL\",\n    'sellerkey' => \"VARCHAR(100) DEFAULT NULL\"\n];\n\nforeach ($required_columns as $col => $definition) {\n    if (!in_array($col, $columns)) {\n        $sql = \"ALTER TABLE `apps` ADD COLUMN `$col` $definition\";\n        if (mysqli_query($conn, $sql)) {\n            echo \"   ✅ Added column '$col'\\n\";\n        } else {\n            echo \"   ❌ Failed to add column '$col': \" . mysqli_error($conn) . \"\\n\";\n        }\n    } else {\n        echo \"   ✅ Column '$col' exists\\n\";\n    }\n}\n\n// 5. Check database statistics\necho \"\\n5. Database Statistics:\\n\";\n$tables_to_check = ['users', 'apps', 'subs', 'tokens', 'logs', 'sessions'];\n\nforeach ($tables_to_check as $table) {\n    $result = mysqli_query($conn, \"SELECT COUNT(*) as count FROM `$table`\");\n    if ($result && $row = mysqli_fetch_assoc($result)) {\n        echo \"   $table: {$row['count']} records\\n\";\n    }\n}\n\n// 6. Create test user if none exist\necho \"\\n6. Checking for test users:\\n\";\n$result = mysqli_query($conn, \"SELECT COUNT(*) as count FROM users\");\nif ($result && $row = mysqli_fetch_assoc($result)) {\n    echo \"   Total users: {$row['count']}\\n\";\n}\n\necho \"\\n🎉 Database optimization completed!\\n\";\necho \"Performance should be significantly improved now.\\n\";\n\nmysqli_close($conn);\n?>","size_bytes":4748},"telegram/webhook.php":{"content":"<?php\nrequire '../includes/misc/autoload.phtml';\nrequire '../includes/dashboard/autoload.phtml';\n\n// Set content type\nheader('Content-Type: application/json');\n\n// Get input data\n$input = file_get_contents('php://input');\n$update = json_decode($input, true);\n\n// Logging for debugging (optional)\nerror_log(\"Telegram webhook received: \" . $input);\n\n// Basic validation\nif (!$update || !isset($update['message'])) {\n    http_response_code(200);\n    exit('OK');\n}\n\n$message = $update['message'];\n$chat_id = $message['chat']['id'] ?? null;\n$text = $message['text'] ?? '';\n$from_username = $message['from']['username'] ?? 'Unknown';\n\n// Bot commands\nif (str_starts_with($text, '/')) {\n    $command = explode(' ', $text)[0];\n    $args = array_slice(explode(' ', $text), 1);\n    \n    $response_text = '';\n    \n    switch ($command) {\n        case '/start':\n            $response_text = \"🤖 Welcome to KeyAuth Bot!\\n\\n\" .\n                \"Available commands:\\n\" .\n                \"/stats - Get application statistics\\n\" .\n                \"/users - Get user count\\n\" .\n                \"/licenses - Get license information\\n\" .\n                \"/help - Show this message\";\n            break;\n            \n        case '/help':\n            $response_text = \"🔹 KeyAuth Bot Help 🔹\\n\\n\" .\n                \"Commands available:\\n\" .\n                \"• /stats - Application statistics\\n\" .\n                \"• /users - Total user count\\n\" .\n                \"• /licenses - License details\\n\" .\n                \"• /ping - Check bot status\\n\\n\" .\n                \"💡 This bot is part of your KeyAuth Seller Plan!\";\n            break;\n            \n        case '/ping':\n            $response_text = \"🟢 Bot is online and working!\\n\" .\n                \"Server time: \" . date('Y-m-d H:i:s');\n            break;\n            \n        case '/stats':\n            try {\n                // Get application stats (you'll need to adapt this to your database structure)\n                $total_users = \"N/A\"; // Add your query here\n                $total_licenses = \"N/A\"; // Add your query here\n                $active_sessions = \"N/A\"; // Add your query here\n                \n                $response_text = \"📊 KeyAuth Statistics\\n\\n\" .\n                    \"👥 Total Users: $total_users\\n\" .\n                    \"🔑 Total Licenses: $total_licenses\\n\" .\n                    \"🟢 Active Sessions: $active_sessions\\n\\n\" .\n                    \"📅 Generated: \" . date('Y-m-d H:i:s');\n            } catch (Exception $e) {\n                $response_text = \"❌ Error fetching statistics: \" . $e->getMessage();\n            }\n            break;\n            \n        case '/users':\n            try {\n                // Count total users across all apps (adapt to your needs)\n                $response_text = \"👥 User Information\\n\\n\" .\n                    \"Total registered users: Loading...\\n\" .\n                    \"Active subscriptions: Loading...\\n\\n\" .\n                    \"💡 Use your KeyAuth dashboard for detailed user management.\";\n            } catch (Exception $e) {\n                $response_text = \"❌ Error fetching user data: \" . $e->getMessage();\n            }\n            break;\n            \n        case '/licenses':\n            $response_text = \"🔑 License Overview\\n\\n\" .\n                \"Total licenses: Loading...\\n\" .\n                \"Used licenses: Loading...\\n\" .\n                \"Available licenses: Loading...\\n\\n\" .\n                \"📈 Use /stats for detailed analytics\";\n            break;\n            \n        default:\n            $response_text = \"❓ Unknown command: $command\\n\\n\" .\n                \"Type /help to see available commands.\";\n            break;\n    }\n    \n    // Send response back to Telegram\n    if ($response_text && $chat_id) {\n        sendTelegramMessage($chat_id, $response_text);\n    }\n}\n\n// Function to send message to Telegram\nfunction sendTelegramMessage($chat_id, $text, $bot_token = null) {\n    // You would get the bot token from your database/config\n    // For now, using a placeholder - replace with actual token retrieval\n    if (!$bot_token) {\n        // Get bot token from app settings (you'll need to implement this)\n        $bot_token = \"YOUR_BOT_TOKEN_HERE\"; // Replace with actual token from database\n    }\n    \n    $url = \"https://api.telegram.org/bot{$bot_token}/sendMessage\";\n    \n    $data = [\n        'chat_id' => $chat_id,\n        'text' => $text,\n        'parse_mode' => 'HTML'\n    ];\n    \n    $ch = curl_init();\n    curl_setopt($ch, CURLOPT_URL, $url);\n    curl_setopt($ch, CURLOPT_POST, true);\n    curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($data));\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);\n    \n    $response = curl_exec($ch);\n    $http_code = curl_getinfo($ch, CURLINFO_HTTP_CODE);\n    curl_close($ch);\n    \n    if ($http_code !== 200) {\n        error_log(\"Telegram API error: \" . $response);\n    }\n    \n    return $response;\n}\n\n// Send notification function (for external use)\nfunction sendTelegramNotification($message, $chat_id = null) {\n    // This function can be called from other parts of your application\n    // to send notifications via Telegram\n    if (!$chat_id) {\n        // Get default notification chat ID from settings\n        $chat_id = \"YOUR_NOTIFICATION_CHAT_ID\"; // Replace with actual implementation\n    }\n    \n    return sendTelegramMessage($chat_id, $message);\n}\n\n// Return OK to Telegram\nhttp_response_code(200);\necho 'OK';\n?>","size_bytes":5502},"includes/csrf.php":{"content":"<?php\nnamespace csrf;\n\nfunction generateToken() {\n    if (!isset($_SESSION['csrf_token'])) {\n        $_SESSION['csrf_token'] = bin2hex(random_bytes(32));\n    }\n    return $_SESSION['csrf_token'];\n}\n\nfunction validateToken($token) {\n    if (!isset($_SESSION['csrf_token'])) {\n        return false;\n    }\n    return hash_equals($_SESSION['csrf_token'], $token);\n}\n\nfunction getTokenField() {\n    $token = generateToken();\n    return '<input type=\"hidden\" name=\"csrf_token\" value=\"' . htmlspecialchars($token, ENT_QUOTES, 'UTF-8') . '\">';\n}\n\nfunction requireValidToken() {\n    if ($_SERVER['REQUEST_METHOD'] === 'POST') {\n        $token = $_POST['csrf_token'] ?? '';\n        if (!validateToken($token)) {\n            http_response_code(403);\n            die(json_encode(['error' => 'Invalid CSRF token. Please refresh and try again.']));\n        }\n    }\n}\n?>","size_bytes":855},"app/assets/modern-theme.css":{"content":"/* Modern GenZ Auth Theme - Ultra Beautiful Design */\n\n:root {\n  /* Base Colors */\n  --primary-bg: #09090d;\n  --secondary-bg: #0f0f17;\n  --tertiary-bg: #1a1a24;\n  --accent-color: #1c64f2;\n  --accent-hover: #3b82f6;\n  --accent-light: #60a5fa;\n  --text-primary: #ffffff;\n  --text-secondary: #9ca3af;\n  --text-muted: #6b7280;\n  --border-color: #374151;\n  --border-light: #4b5563;\n  \n  /* Status Colors */\n  --success-color: #10b981;\n  --success-light: #34d399;\n  --error-color: #ef4444;\n  --error-light: #f87171;\n  --warning-color: #f59e0b;\n  --warning-light: #fbbf24;\n  --info-color: #3b82f6;\n  \n  /* Shadows */\n  --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);\n  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);\n  --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);\n  --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);\n  --shadow-glow: 0 0 20px rgba(28, 100, 242, 0.3);\n  \n  /* Beautiful Gradients */\n  --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  --gradient-blue: linear-gradient(135deg, #1c64f2 0%, #3b82f6 100%);\n  --gradient-purple: linear-gradient(135deg, #a855f7 0%, #ec4899 100%);\n  --gradient-pink: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);\n  --gradient-orange: linear-gradient(135deg, #fa709a 0%, #fee140 100%);\n  --gradient-green: linear-gradient(135deg, #10b981 0%, #34d399 100%);\n  --gradient-cyan: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);\n  --gradient-dark: linear-gradient(135deg, #0f0f17 0%, #1a1a24 100%);\n  --gradient-rainbow: linear-gradient(135deg, #667eea 0%, #764ba2 33%, #f093fb 66%, #4facfe 100%);\n  \n  /* Glassmorphism */\n  --glass-bg: rgba(15, 15, 23, 0.7);\n  --glass-border: rgba(255, 255, 255, 0.1);\n}\n\n/* Global Styles */\n* {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\n\nbody {\n  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;\n  background: var(--primary-bg);\n  color: var(--text-primary);\n  line-height: 1.6;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n/* Enhanced Loading Animation */\n.loading-spinner {\n  display: inline-block;\n  width: 48px;\n  height: 48px;\n  border: 4px solid rgba(28, 100, 242, 0.1);\n  border-radius: 50%;\n  border-top-color: var(--accent-color);\n  animation: spin 1s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;\n}\n\n@keyframes spin {\n  to { transform: rotate(360deg); }\n}\n\n.loading-dots {\n  display: inline-flex;\n  gap: 8px;\n}\n\n.loading-dot {\n  width: 12px;\n  height: 12px;\n  background: var(--accent-color);\n  border-radius: 50%;\n  animation: bounce 1.4s infinite ease-in-out both;\n}\n\n.loading-dot:nth-child(1) { animation-delay: -0.32s; }\n.loading-dot:nth-child(2) { animation-delay: -0.16s; }\n\n@keyframes bounce {\n  0%, 80%, 100% { transform: scale(0); opacity: 0.5; }\n  40% { transform: scale(1); opacity: 1; }\n}\n\n/* Ultra Modern Card Components */\n.modern-card {\n  background: var(--secondary-bg);\n  border-radius: 16px;\n  padding: 28px;\n  box-shadow: var(--shadow-lg);\n  border: 1px solid var(--border-color);\n  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n  position: relative;\n  overflow: hidden;\n}\n\n.modern-card::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 3px;\n  background: var(--gradient-primary);\n  opacity: 0;\n  transition: opacity 0.3s ease;\n}\n\n.modern-card:hover {\n  box-shadow: var(--shadow-2xl);\n  transform: translateY(-4px);\n  border-color: var(--accent-color);\n}\n\n.modern-card:hover::before {\n  opacity: 1;\n}\n\n.modern-card-gradient {\n  background: var(--gradient-dark);\n  border: 1px solid var(--border-light);\n}\n\n.modern-card-glass {\n  background: var(--glass-bg);\n  backdrop-filter: blur(10px);\n  -webkit-backdrop-filter: blur(10px);\n  border: 1px solid var(--glass-border);\n}\n\n.modern-card-header {\n  border-bottom: 1px solid var(--border-color);\n  padding-bottom: 20px;\n  margin-bottom: 24px;\n}\n\n.modern-card-title {\n  font-size: 1.5rem;\n  font-weight: 700;\n  color: var(--text-primary);\n  margin: 0;\n  background: var(--gradient-blue);\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  background-clip: text;\n}\n\n.modern-card-subtitle {\n  font-size: 0.875rem;\n  color: var(--text-secondary);\n  margin-top: 6px;\n  line-height: 1.5;\n}\n\n/* Enhanced Buttons */\n.btn-modern {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  padding: 14px 28px;\n  border-radius: 12px;\n  font-weight: 600;\n  font-size: 15px;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  border: none;\n  cursor: pointer;\n  text-decoration: none;\n  gap: 10px;\n  position: relative;\n  overflow: hidden;\n}\n\n.btn-modern::before {\n  content: '';\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 0;\n  height: 0;\n  border-radius: 50%;\n  background: rgba(255, 255, 255, 0.2);\n  transform: translate(-50%, -50%);\n  transition: width 0.6s, height 0.6s;\n}\n\n.btn-modern:hover::before {\n  width: 300px;\n  height: 300px;\n}\n\n.btn-primary {\n  background: var(--gradient-blue);\n  color: white;\n  box-shadow: var(--shadow-md);\n}\n\n.btn-primary:hover {\n  transform: translateY(-2px);\n  box-shadow: var(--shadow-xl), var(--shadow-glow);\n}\n\n.btn-success {\n  background: var(--gradient-green);\n  color: white;\n  box-shadow: var(--shadow-md);\n}\n\n.btn-success:hover {\n  transform: translateY(-2px);\n  box-shadow: var(--shadow-xl), 0 0 20px rgba(16, 185, 129, 0.3);\n}\n\n.btn-danger {\n  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\n  color: white;\n  box-shadow: var(--shadow-md);\n}\n\n.btn-danger:hover {\n  transform: translateY(-2px);\n  box-shadow: var(--shadow-xl), 0 0 20px rgba(239, 68, 68, 0.3);\n}\n\n.btn-outline {\n  background: transparent;\n  border: 2px solid var(--accent-color);\n  color: var(--accent-color);\n}\n\n.btn-outline:hover {\n  background: var(--accent-color);\n  color: white;\n  box-shadow: var(--shadow-glow);\n}\n\n.btn-ghost {\n  background: rgba(28, 100, 242, 0.1);\n  color: var(--accent-color);\n  border: 1px solid transparent;\n}\n\n.btn-ghost:hover {\n  background: rgba(28, 100, 242, 0.2);\n  border-color: var(--accent-color);\n}\n\n/* Modern Form Inputs */\n.form-input-modern {\n  background: var(--secondary-bg);\n  border: 2px solid var(--border-color);\n  border-radius: 12px;\n  padding: 14px 18px;\n  color: var(--text-primary);\n  font-size: 15px;\n  transition: all 0.3s ease;\n  width: 100%;\n  font-family: inherit;\n}\n\n.form-input-modern:focus {\n  outline: none;\n  border-color: var(--accent-color);\n  box-shadow: 0 0 0 4px rgba(28, 100, 242, 0.1);\n  background: var(--tertiary-bg);\n}\n\n.form-input-modern::placeholder {\n  color: var(--text-muted);\n}\n\n.form-group-modern {\n  margin-bottom: 24px;\n}\n\n.form-label-modern {\n  display: block;\n  margin-bottom: 10px;\n  font-weight: 600;\n  color: var(--text-primary);\n  font-size: 14px;\n  letter-spacing: 0.3px;\n}\n\n.form-select-modern {\n  background: var(--secondary-bg);\n  border: 2px solid var(--border-color);\n  border-radius: 12px;\n  padding: 14px 18px;\n  color: var(--text-primary);\n  font-size: 15px;\n  width: 100%;\n  cursor: pointer;\n  transition: all 0.3s ease;\n}\n\n.form-select-modern:focus {\n  outline: none;\n  border-color: var(--accent-color);\n  box-shadow: 0 0 0 4px rgba(28, 100, 242, 0.1);\n}\n\n/* Enhanced Navigation */\n.nav-item-modern {\n  position: relative;\n  border-radius: 10px;\n  margin-bottom: 6px;\n  overflow: hidden;\n  transition: all 0.3s ease;\n}\n\n.nav-item-modern::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 0;\n  height: 100%;\n  background: var(--gradient-blue);\n  transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n  z-index: 0;\n}\n\n.nav-item-modern:hover::before {\n  width: 100%;\n}\n\n.nav-item-modern a {\n  position: relative;\n  z-index: 1;\n  display: flex;\n  align-items: center;\n  padding: 14px 18px;\n  color: var(--text-secondary);\n  text-decoration: none;\n  transition: all 0.3s ease;\n  font-weight: 500;\n  gap: 12px;\n}\n\n.nav-item-modern:hover a {\n  color: white;\n  transform: translateX(4px);\n}\n\n.nav-item-modern.active::before {\n  width: 100%;\n}\n\n.nav-item-modern.active a {\n  color: white;\n}\n\n.nav-icon {\n  font-size: 18px;\n  width: 24px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n/* Status Badges */\n.status-badge {\n  display: inline-flex;\n  align-items: center;\n  padding: 6px 14px;\n  border-radius: 24px;\n  font-size: 13px;\n  font-weight: 600;\n  gap: 8px;\n  letter-spacing: 0.3px;\n}\n\n.status-badge i {\n  font-size: 10px;\n}\n\n.status-success {\n  background: rgba(16, 185, 129, 0.15);\n  color: var(--success-light);\n  border: 1px solid rgba(16, 185, 129, 0.3);\n}\n\n.status-error {\n  background: rgba(239, 68, 68, 0.15);\n  color: var(--error-light);\n  border: 1px solid rgba(239, 68, 68, 0.3);\n}\n\n.status-warning {\n  background: rgba(245, 158, 11, 0.15);\n  color: var(--warning-light);\n  border: 1px solid rgba(245, 158, 11, 0.3);\n}\n\n.status-info {\n  background: rgba(59, 130, 246, 0.15);\n  color: var(--accent-light);\n  border: 1px solid rgba(59, 130, 246, 0.3);\n}\n\n.status-neutral {\n  background: rgba(156, 163, 175, 0.15);\n  color: var(--text-secondary);\n  border: 1px solid rgba(156, 163, 175, 0.3);\n}\n\n/* Data Tables Enhancement */\n.modern-table-container {\n  overflow-x: auto;\n  border-radius: 16px;\n  box-shadow: var(--shadow-lg);\n  border: 1px solid var(--border-color);\n}\n\n.modern-table {\n  width: 100%;\n  border-collapse: collapse;\n  background: var(--secondary-bg);\n}\n\n.modern-table thead {\n  background: var(--primary-bg);\n  border-bottom: 2px solid var(--accent-color);\n}\n\n.modern-table th {\n  padding: 18px 20px;\n  text-align: left;\n  font-weight: 700;\n  color: var(--text-primary);\n  font-size: 14px;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.modern-table td {\n  padding: 18px 20px;\n  color: var(--text-secondary);\n  border-bottom: 1px solid var(--border-color);\n  font-size: 14px;\n}\n\n.modern-table tbody tr {\n  transition: all 0.2s ease;\n}\n\n.modern-table tbody tr:hover {\n  background: rgba(28, 100, 242, 0.08);\n  transform: scale(1.01);\n}\n\n.modern-table tbody tr:last-child td {\n  border-bottom: none;\n}\n\n/* Modern Modal */\n.modal-modern {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.85);\n  backdrop-filter: blur(4px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  opacity: 0;\n  visibility: hidden;\n  transition: all 0.3s ease;\n}\n\n.modal-modern.active {\n  opacity: 1;\n  visibility: visible;\n}\n\n.modal-content-modern {\n  background: var(--secondary-bg);\n  border-radius: 20px;\n  padding: 36px;\n  max-width: 540px;\n  width: 90%;\n  max-height: 85vh;\n  overflow-y: auto;\n  box-shadow: var(--shadow-2xl);\n  border: 1px solid var(--border-color);\n  transform: scale(0.9) translateY(20px);\n  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.modal-modern.active .modal-content-modern {\n  transform: scale(1) translateY(0);\n}\n\n.modal-header {\n  margin-bottom: 24px;\n  padding-bottom: 20px;\n  border-bottom: 1px solid var(--border-color);\n}\n\n.modal-title {\n  font-size: 1.5rem;\n  font-weight: 700;\n  color: var(--text-primary);\n  margin: 0;\n}\n\n.modal-close {\n  position: absolute;\n  top: 20px;\n  right: 20px;\n  background: rgba(239, 68, 68, 0.1);\n  border: none;\n  color: var(--error-color);\n  width: 36px;\n  height: 36px;\n  border-radius: 50%;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.modal-close:hover {\n  background: var(--error-color);\n  color: white;\n  transform: rotate(90deg);\n}\n\n/* Progress Bar */\n.progress-modern {\n  width: 100%;\n  height: 10px;\n  background: var(--border-color);\n  border-radius: 5px;\n  overflow: hidden;\n  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);\n}\n\n.progress-bar-modern {\n  height: 100%;\n  background: var(--gradient-blue);\n  border-radius: 5px;\n  transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n  box-shadow: 0 0 10px rgba(28, 100, 242, 0.5);\n}\n\n/* Notification Toasts */\n.toast-modern {\n  position: fixed;\n  top: 24px;\n  right: 24px;\n  background: var(--secondary-bg);\n  border-radius: 14px;\n  padding: 18px 22px;\n  box-shadow: var(--shadow-2xl);\n  border-left: 5px solid;\n  display: flex;\n  align-items: center;\n  gap: 14px;\n  max-width: 420px;\n  z-index: 1001;\n  transform: translateX(calc(100% + 24px));\n  transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.toast-modern.show {\n  transform: translateX(0);\n}\n\n.toast-icon {\n  width: 24px;\n  height: 24px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-shrink: 0;\n}\n\n.toast-content {\n  flex: 1;\n}\n\n.toast-title {\n  font-weight: 600;\n  color: var(--text-primary);\n  margin-bottom: 4px;\n}\n\n.toast-message {\n  font-size: 14px;\n  color: var(--text-secondary);\n}\n\n.toast-success {\n  border-color: var(--success-color);\n}\n\n.toast-error {\n  border-color: var(--error-color);\n}\n\n.toast-warning {\n  border-color: var(--warning-color);\n}\n\n.toast-info {\n  border-color: var(--accent-color);\n}\n\n/* Animation Classes */\n.fade-in {\n  animation: fadeIn 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n@keyframes fadeIn {\n  from { \n    opacity: 0; \n    transform: translateY(30px); \n  }\n  to { \n    opacity: 1; \n    transform: translateY(0); \n  }\n}\n\n.slide-in-left {\n  animation: slideInLeft 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n@keyframes slideInLeft {\n  from { \n    opacity: 0; \n    transform: translateX(-40px); \n  }\n  to { \n    opacity: 1; \n    transform: translateX(0); \n  }\n}\n\n.slide-in-right {\n  animation: slideInRight 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n@keyframes slideInRight {\n  from { \n    opacity: 0; \n    transform: translateX(40px); \n  }\n  to { \n    opacity: 1; \n    transform: translateX(0); \n  }\n}\n\n.scale-in {\n  animation: scaleIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n@keyframes scaleIn {\n  from { \n    opacity: 0; \n    transform: scale(0.9); \n  }\n  to { \n    opacity: 1; \n    transform: scale(1); \n  }\n}\n\n.pulse {\n  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n}\n\n@keyframes pulse {\n  0%, 100% { opacity: 1; }\n  50% { opacity: 0.6; }\n}\n\n.glow {\n  animation: glow 2s ease-in-out infinite alternate;\n}\n\n@keyframes glow {\n  from { box-shadow: 0 0 10px rgba(28, 100, 242, 0.2); }\n  to { box-shadow: 0 0 20px rgba(28, 100, 242, 0.4), 0 0 30px rgba(28, 100, 242, 0.2); }\n}\n\n/* Modal Animations */\n.modal-animate-in {\n  animation: modalFadeIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.modal-animate-out {\n  animation: modalFadeOut 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n@keyframes modalFadeIn {\n  from {\n    opacity: 0;\n    transform: scale(0.95) translateY(-20px);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1) translateY(0);\n  }\n}\n\n@keyframes modalFadeOut {\n  from {\n    opacity: 1;\n    transform: scale(1) translateY(0);\n  }\n  to {\n    opacity: 0;\n    transform: scale(0.95) translateY(-20px);\n  }\n}\n\n/* Stats Card */\n.stats-card {\n  background: var(--gradient-dark);\n  border-radius: 16px;\n  padding: 24px;\n  border: 1px solid var(--border-color);\n  transition: all 0.3s ease;\n  position: relative;\n  overflow: hidden;\n}\n\n.stats-card::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: var(--gradient-blue);\n  opacity: 0;\n  transition: opacity 0.3s ease;\n}\n\n.stats-card:hover::before {\n  opacity: 0.05;\n}\n\n.stats-icon {\n  width: 56px;\n  height: 56px;\n  border-radius: 14px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 28px;\n  margin-bottom: 16px;\n  background: var(--gradient-blue);\n  color: white;\n  box-shadow: var(--shadow-md);\n}\n\n.stats-value {\n  font-size: 2.25rem;\n  font-weight: 700;\n  color: var(--text-primary);\n  margin-bottom: 8px;\n  line-height: 1;\n}\n\n.stats-label {\n  font-size: 0.875rem;\n  color: var(--text-secondary);\n  font-weight: 500;\n}\n\n.stats-change {\n  display: inline-flex;\n  align-items: center;\n  gap: 4px;\n  font-size: 0.875rem;\n  font-weight: 600;\n  margin-top: 12px;\n}\n\n.stats-change.positive {\n  color: var(--success-color);\n}\n\n.stats-change.negative {\n  color: var(--error-color);\n}\n\n/* Code Syntax Highlighting Enhancement */\n.code-block-modern {\n  background: var(--primary-bg);\n  border-radius: 14px;\n  padding: 24px;\n  font-family: 'Fira Code', 'Monaco', 'Consolas', monospace;\n  font-size: 14px;\n  line-height: 1.6;\n  overflow-x: auto;\n  border: 1px solid var(--border-color);\n  box-shadow: var(--shadow-md);\n}\n\n.code-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 18px;\n  padding-bottom: 14px;\n  border-bottom: 1px solid var(--border-color);\n}\n\n.code-language {\n  color: var(--accent-color);\n  font-weight: 600;\n  font-size: 12px;\n  text-transform: uppercase;\n  letter-spacing: 1px;\n}\n\n.copy-code-btn {\n  background: rgba(28, 100, 242, 0.1);\n  border: 1px solid var(--accent-color);\n  color: var(--accent-color);\n  padding: 8px 16px;\n  border-radius: 8px;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-weight: 600;\n}\n\n.copy-code-btn:hover {\n  background: var(--accent-color);\n  color: white;\n  box-shadow: var(--shadow-glow);\n}\n\n/* Dropdown Menu */\n.dropdown-modern {\n  position: relative;\n  display: inline-block;\n}\n\n.dropdown-menu {\n  position: absolute;\n  top: 100%;\n  right: 0;\n  background: var(--secondary-bg);\n  border: 1px solid var(--border-color);\n  border-radius: 12px;\n  box-shadow: var(--shadow-xl);\n  min-width: 200px;\n  padding: 8px;\n  margin-top: 8px;\n  opacity: 0;\n  visibility: hidden;\n  transform: translateY(-10px);\n  transition: all 0.3s ease;\n  z-index: 1000;\n}\n\n.dropdown-menu.show {\n  opacity: 1;\n  visibility: visible;\n  transform: translateY(0);\n}\n\n.dropdown-item {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 12px 14px;\n  border-radius: 8px;\n  color: var(--text-secondary);\n  text-decoration: none;\n  transition: all 0.2s ease;\n  font-size: 14px;\n  cursor: pointer;\n}\n\n.dropdown-item:hover {\n  background: rgba(28, 100, 242, 0.1);\n  color: var(--accent-color);\n}\n\n.dropdown-divider {\n  height: 1px;\n  background: var(--border-color);\n  margin: 8px 0;\n}\n\n/* Tabs */\n.tabs-modern {\n  display: flex;\n  gap: 8px;\n  border-bottom: 2px solid var(--border-color);\n  margin-bottom: 24px;\n}\n\n.tab-item {\n  padding: 14px 24px;\n  border: none;\n  background: transparent;\n  color: var(--text-secondary);\n  font-weight: 600;\n  font-size: 14px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  border-bottom: 2px solid transparent;\n  margin-bottom: -2px;\n  position: relative;\n}\n\n.tab-item:hover {\n  color: var(--accent-color);\n}\n\n.tab-item.active {\n  color: var(--accent-color);\n  border-bottom-color: var(--accent-color);\n}\n\n/* Alert Boxes */\n.alert-modern {\n  padding: 16px 20px;\n  border-radius: 12px;\n  border-left: 4px solid;\n  display: flex;\n  align-items: flex-start;\n  gap: 14px;\n  margin-bottom: 20px;\n}\n\n.alert-icon {\n  flex-shrink: 0;\n  width: 24px;\n  height: 24px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.alert-content {\n  flex: 1;\n}\n\n.alert-title {\n  font-weight: 600;\n  margin-bottom: 4px;\n  font-size: 15px;\n}\n\n.alert-message {\n  font-size: 14px;\n  line-height: 1.5;\n}\n\n.alert-success {\n  background: rgba(16, 185, 129, 0.1);\n  border-color: var(--success-color);\n  color: var(--success-light);\n}\n\n.alert-error {\n  background: rgba(239, 68, 68, 0.1);\n  border-color: var(--error-color);\n  color: var(--error-light);\n}\n\n.alert-warning {\n  background: rgba(245, 158, 11, 0.1);\n  border-color: var(--warning-color);\n  color: var(--warning-light);\n}\n\n.alert-info {\n  background: rgba(59, 130, 246, 0.1);\n  border-color: var(--accent-color);\n  color: var(--accent-light);\n}\n\n/* Search Bar */\n.search-bar-modern {\n  position: relative;\n  width: 100%;\n  max-width: 500px;\n}\n\n.search-input {\n  width: 100%;\n  padding: 14px 48px 14px 20px;\n  background: var(--secondary-bg);\n  border: 2px solid var(--border-color);\n  border-radius: 12px;\n  color: var(--text-primary);\n  font-size: 15px;\n  transition: all 0.3s ease;\n}\n\n.search-input:focus {\n  outline: none;\n  border-color: var(--accent-color);\n  box-shadow: 0 0 0 4px rgba(28, 100, 242, 0.1);\n}\n\n.search-icon {\n  position: absolute;\n  right: 18px;\n  top: 50%;\n  transform: translateY(-50%);\n  color: var(--text-muted);\n  font-size: 18px;\n}\n\n/* Pagination */\n.pagination-modern {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n  justify-content: center;\n  margin-top: 32px;\n}\n\n.page-item {\n  width: 40px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 10px;\n  border: 1px solid var(--border-color);\n  background: var(--secondary-bg);\n  color: var(--text-secondary);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-weight: 600;\n}\n\n.page-item:hover {\n  border-color: var(--accent-color);\n  color: var(--accent-color);\n  background: rgba(28, 100, 242, 0.1);\n}\n\n.page-item.active {\n  background: var(--gradient-blue);\n  border-color: transparent;\n  color: white;\n  box-shadow: var(--shadow-glow);\n}\n\n/* Responsive Utilities */\n@media (max-width: 768px) {\n  .modern-card {\n    padding: 16px;\n    border-radius: 12px;\n  }\n  \n  .btn-modern {\n    padding: 10px 20px;\n    font-size: 13px;\n  }\n  \n  .modern-table th,\n  .modern-table td {\n    padding: 12px 10px;\n    font-size: 12px;\n  }\n  \n  .modal-content-modern {\n    padding: 20px;\n    max-width: 95%;\n  }\n  \n  .stats-value {\n    font-size: 1.5rem;\n  }\n  \n  .tab-item {\n    padding: 10px 14px;\n    font-size: 12px;\n  }\n  \n  /* Mobile heading fixes */\n  h1 {\n    font-size: 1.5rem !important;\n    line-height: 1.3 !important;\n  }\n  \n  h2 {\n    font-size: 1.25rem !important;\n    line-height: 1.3 !important;\n  }\n  \n  h3 {\n    font-size: 1.1rem !important;\n    line-height: 1.3 !important;\n  }\n  \n  /* Mobile button group fixes */\n  .flex-wrap {\n    gap: 0.5rem !important;\n  }\n  \n  /* Mobile grid fixes for credentials */\n  .grid-cols-1.md\\:grid-cols-3 {\n    grid-template-columns: 1fr !important;\n  }\n  \n  /* Mobile text fixes */\n  p {\n    font-size: 0.875rem;\n    line-height: 1.4;\n  }\n  \n  /* Mobile padding fixes */\n  .p-4 {\n    padding: 0.75rem !important;\n  }\n  \n  .p-6 {\n    padding: 1rem !important;\n  }\n  \n  .px-6 {\n    padding-left: 0.75rem !important;\n    padding-right: 0.75rem !important;\n  }\n  \n  .py-4 {\n    padding-top: 0.75rem !important;\n    padding-bottom: 0.75rem !important;\n  }\n  \n  /* Mobile button text fixes */\n  button {\n    font-size: 0.8rem !important;\n    padding: 0.6rem 1rem !important;\n    white-space: nowrap;\n  }\n  \n  /* Mobile table overflow fix */\n  .overflow-x-auto {\n    overflow-x: auto;\n    -webkit-overflow-scrolling: touch;\n  }\n  \n  /* Mobile code/credential display fix */\n  code {\n    font-size: 0.75rem !important;\n    word-break: break-all;\n    display: block;\n    max-width: 100%;\n  }\n  \n  /* Mobile margin fixes */\n  .mb-8 {\n    margin-bottom: 1.5rem !important;\n  }\n  \n  .mb-6 {\n    margin-bottom: 1rem !important;\n  }\n  \n  .mb-4 {\n    margin-bottom: 0.75rem !important;\n  }\n  \n  /* Mobile icon fixes */\n  i {\n    font-size: 1rem;\n  }\n  \n  /* Mobile credential section fixes */\n  .text-xs {\n    font-size: 0.7rem !important;\n  }\n  \n  .text-sm {\n    font-size: 0.8rem !important;\n  }\n  \n  /* Mobile flex gap fixes */\n  .gap-4 {\n    gap: 0.75rem !important;\n  }\n  \n  .gap-3 {\n    gap: 0.5rem !important;\n  }\n}\n\n/* Extra small mobile devices */\n@media (max-width: 480px) {\n  h1 {\n    font-size: 1.25rem !important;\n  }\n  \n  h2 {\n    font-size: 1.1rem !important;\n  }\n  \n  h3 {\n    font-size: 1rem !important;\n  }\n  \n  button {\n    font-size: 0.75rem !important;\n    padding: 0.5rem 0.8rem !important;\n  }\n  \n  .modern-card {\n    padding: 12px;\n  }\n  \n  code {\n    font-size: 0.7rem !important;\n  }\n  \n  .p-4 {\n    padding: 0.5rem !important;\n  }\n  \n  .p-6 {\n    padding: 0.75rem !important;\n  }\n}\n\n/* Scrollbar Styling */\n::-webkit-scrollbar {\n  width: 10px;\n  height: 10px;\n}\n\n::-webkit-scrollbar-track {\n  background: var(--primary-bg);\n}\n\n::-webkit-scrollbar-thumb {\n  background: var(--border-color);\n  border-radius: 5px;\n}\n\n::-webkit-scrollbar-thumb:hover {\n  background: var(--accent-color);\n}\n\n/* Selection Styling */\n::selection {\n  background: rgba(28, 100, 242, 0.3);\n  color: var(--text-primary);\n}\n\n::-moz-selection {\n  background: rgba(28, 100, 242, 0.3);\n  color: var(--text-primary);\n}\n\n/* Utility Classes */\n.text-gradient {\n  background: var(--gradient-blue);\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  background-clip: text;\n}\n\n.shadow-glow {\n  box-shadow: var(--shadow-glow);\n}\n\n.glass-effect {\n  background: var(--glass-bg);\n  backdrop-filter: blur(10px);\n  -webkit-backdrop-filter: blur(10px);\n  border: 1px solid var(--glass-border);\n}\n","size_bytes":24647},"app/assets/modern-ui.js":{"content":"/**\n * Modern KeyAuth UI Enhancement Library\n * Properly integrates with Flowbite for modal management\n */\n\n// Wait for everything to load\ndocument.addEventListener('DOMContentLoaded', function() {\n    console.log('Modern UI initializing...');\n    \n    // Hide the loader immediately\n    const loader = document.getElementById('loader');\n    if (loader) {\n        loader.style.display = 'none';\n        console.log('Loader hidden successfully');\n    }\n    \n    // Wait a bit for Flowbite to fully load\n    setTimeout(() => {\n        initializeModals();\n        initializeEnhancements();\n    }, 500);\n});\n\n// Initialize all Flowbite modals manually\nfunction initializeModals() {\n    if (typeof Modal === 'undefined') {\n        console.error('Flowbite Modal not loaded');\n        return;\n    }\n\n    // List of modal IDs to initialize\n    const modalIds = [\n        'pause-app-modal',\n        'unpause-app-modal',\n        'refresh-app-modal',\n        'delete-app-modal',\n        'create-app-modal',\n        'rename-app-modal'\n    ];\n\n    modalIds.forEach(modalId => {\n        const modalElement = document.getElementById(modalId);\n        if (modalElement) {\n            try {\n                // Initialize modal with Flowbite\n                const modal = new Modal(modalElement, {\n                    placement: 'center',\n                    backdrop: 'dynamic',\n                    backdropClasses: 'bg-gray-900 bg-opacity-50 fixed inset-0 z-40',\n                    closable: true,\n                    onHide: () => {\n                        modalElement.classList.remove('modal-animate-in');\n                        modalElement.classList.add('modal-animate-out');\n                        setTimeout(() => {\n                            modalElement.classList.remove('modal-animate-out');\n                        }, 300);\n                    },\n                    onShow: () => {\n                        modalElement.classList.add('modal-animate-in');\n                        modalElement.classList.remove('modal-animate-out');\n                    }\n                });\n\n                console.log(`Modal initialized: ${modalId}`);\n\n                // Set up trigger buttons\n                const triggers = document.querySelectorAll(`[data-modal-target=\"${modalId}\"], [data-modal-toggle=\"${modalId}\"]`);\n                triggers.forEach(trigger => {\n                    trigger.addEventListener('click', (e) => {\n                        e.preventDefault();\n                        modal.show();\n                    });\n                });\n\n                // Set up close buttons\n                const closeButtons = modalElement.querySelectorAll(`[data-modal-hide=\"${modalId}\"]`);\n                closeButtons.forEach(btn => {\n                    btn.addEventListener('click', (e) => {\n                        // Only prevent default if it's not a form submit button\n                        if (btn.type !== 'submit') {\n                            e.preventDefault();\n                        }\n                        modal.hide();\n                    });\n                });\n\n            } catch (error) {\n                console.error(`Error initializing modal ${modalId}:`, error);\n            }\n        }\n    });\n}\n\n// Initialize other UI enhancements\nfunction initializeEnhancements() {\n    setupAnimations();\n    setupCopyButtons();\n    setupNotifications();\n}\n\n// Enhanced Animations\nfunction setupAnimations() {\n    // Intersection Observer for fade-in animations\n    const observerOptions = {\n        threshold: 0.1,\n        rootMargin: '0px 0px -50px 0px'\n    };\n\n    const observer = new IntersectionObserver((entries) => {\n        entries.forEach(entry => {\n            if (entry.isIntersecting) {\n                entry.target.classList.add('fade-in');\n                observer.unobserve(entry.target);\n            }\n        });\n    }, observerOptions);\n\n    // Observe all cards and sections\n    document.querySelectorAll('.modern-card, .content-section, .animate-on-scroll').forEach(el => {\n        observer.observe(el);\n    });\n}\n\n// Enhanced Copy to Clipboard\nfunction setupCopyButtons() {\n    document.querySelectorAll('.copy-button').forEach(button => {\n        button.addEventListener('click', async (e) => {\n            e.preventDefault();\n            \n            const targetId = button.getAttribute('data-copy-target');\n            const targetElement = document.getElementById(targetId);\n            \n            if (targetElement) {\n                try {\n                    await navigator.clipboard.writeText(targetElement.textContent);\n                    \n                    const originalHTML = button.innerHTML;\n                    button.innerHTML = '<svg class=\"w-5 h-5 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"></path></svg>Copied!';\n                    button.classList.add('bg-green-600');\n                    \n                    setTimeout(() => {\n                        button.innerHTML = originalHTML;\n                        button.classList.remove('bg-green-600');\n                    }, 2000);\n                    \n                    showToast('Copied to clipboard!', 'success');\n                } catch (err) {\n                    console.error('Failed to copy:', err);\n                    showToast('Failed to copy to clipboard', 'error');\n                }\n            }\n        });\n    });\n}\n\n// Notification System\nfunction setupNotifications() {\n    // Create notification container if it doesn't exist\n    if (!document.getElementById('toast-container')) {\n        const container = document.createElement('div');\n        container.id = 'toast-container';\n        container.className = 'fixed top-20 right-4 z-50 flex flex-col gap-2';\n        document.body.appendChild(container);\n    }\n}\n\nfunction showToast(message, type = 'info', duration = 3000) {\n    const container = document.getElementById('toast-container');\n    if (!container) return;\n\n    const colors = {\n        success: 'bg-green-500',\n        error: 'bg-red-500',\n        warning: 'bg-yellow-500',\n        info: 'bg-blue-500'\n    };\n\n    const icons = {\n        success: '<svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"></path></svg>',\n        error: '<svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clip-rule=\"evenodd\"></path></svg>',\n        warning: '<svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\" clip-rule=\"evenodd\"></path></svg>',\n        info: '<svg class=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\" clip-rule=\"evenodd\"></path></svg>'\n    };\n\n    const toast = document.createElement('div');\n    toast.className = `flex items-center gap-3 ${colors[type]} text-white px-4 py-3 rounded-lg shadow-lg transform translate-x-full transition-transform duration-300 max-w-sm`;\n    toast.innerHTML = `\n        ${icons[type] || icons.info}\n        <span class=\"flex-1\">${message}</span>\n        <button onclick=\"this.parentElement.remove()\" class=\"hover:opacity-75\">\n            <svg class=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clip-rule=\"evenodd\"></path></svg>\n        </button>\n    `;\n\n    container.appendChild(toast);\n\n    // Slide in\n    setTimeout(() => {\n        toast.classList.remove('translate-x-full');\n    }, 10);\n\n    // Auto remove\n    setTimeout(() => {\n        toast.classList.add('translate-x-full');\n        setTimeout(() => toast.remove(), 300);\n    }, duration);\n}\n\n// Make showToast available globally\nwindow.showToast = showToast;\n\nconsole.log('Modern UI loaded successfully');\n","size_bytes":8662},"includes/misc/enhanced_validation.php":{"content":"<?php\nnamespace misc\\enhanced;\n\n/**\n * Enhanced validation and security functions for KeyAuth\n * Provides additional security layers and input validation\n */\n\nfunction validateInput($input, $type = 'general', $maxLength = 255) {\n    // Handle null and non-string inputs\n    if ($input === null || is_array($input) || is_object($input)) {\n        return ['valid' => false, 'error' => 'Invalid input type'];\n    }\n    \n    // Convert to string and sanitize\n    $input = trim(strval($input));\n    \n    // Check length\n    if (strlen($input) > $maxLength) {\n        return ['valid' => false, 'error' => \"Input too long (max: {$maxLength} characters)\"];\n    }\n    \n    // Type-specific validation\n    switch ($type) {\n        case 'username':\n            if (!preg_match('/^[a-zA-Z0-9_-]+$/', $input)) {\n                return ['valid' => false, 'error' => 'Username can only contain letters, numbers, underscores, and hyphens'];\n            }\n            if (strlen($input) < 3) {\n                return ['valid' => false, 'error' => 'Username must be at least 3 characters long'];\n            }\n            break;\n            \n        case 'email':\n            if (!filter_var($input, FILTER_VALIDATE_EMAIL)) {\n                return ['valid' => false, 'error' => 'Invalid email format'];\n            }\n            break;\n            \n        case 'hex':\n            if (!ctype_xdigit($input)) {\n                return ['valid' => false, 'error' => 'Invalid hexadecimal format'];\n            }\n            break;\n            \n        case 'alphanumeric':\n            if (!preg_match('/^[a-zA-Z0-9]+$/', $input)) {\n                return ['valid' => false, 'error' => 'Only alphanumeric characters allowed'];\n            }\n            break;\n            \n        case 'sessionid':\n            if (!preg_match('/^[a-zA-Z0-9]{10,64}$/', $input)) {\n                return ['valid' => false, 'error' => 'Invalid session ID format'];\n            }\n            break;\n    }\n    \n    // Only check for obvious XSS attempts - SQL injection is handled by prepared statements\n    $xss_patterns = [\n        '/(\\<script[^>]*\\>|\\<\\/script\\>)/i',\n        '/(javascript:|vbscript:|data:text\\/html)/i',\n        '/(onload\\s*=|onerror\\s*=|onclick\\s*=)/i'\n    ];\n    \n    foreach ($xss_patterns as $pattern) {\n        if (preg_match($pattern, $input)) {\n            logSecurityEvent('xss_attempt_detected', ['input' => substr($input, 0, 100)]);\n            return ['valid' => false, 'error' => 'Invalid characters detected'];\n        }\n    }\n    \n    return ['valid' => true, 'value' => strip_tags($input)];\n}\n\nfunction enhancedSanitize($input, $type = 'general', $maxLength = 255) {\n    $result = validateInput($input, $type, $maxLength);\n    return $result['valid'] ? $result['value'] : null;\n}\n\nfunction rateLimitCheck($identifier, $limit = 10, $window = 60) {\n    // Enhanced rate limiting with Redis/cache\n    $key = \"rate_limit:$identifier\";\n    \n    try {\n        $current = \\misc\\cache\\select($key);\n        \n        if ($current === false || $current === null) {\n            \\misc\\cache\\insert($key, 1, $window);\n            return false; // Not rate limited\n        }\n        \n        if ($current >= $limit) {\n            logSecurityEvent('rate_limit_exceeded', ['identifier' => $identifier, 'limit' => $limit]);\n            return true; // Rate limited\n        }\n        \n        \\misc\\cache\\increment($key);\n        return false; // Not rate limited\n    } catch (\\Exception $e) {\n        // Fallback to allowing if cache fails\n        error_log(\"Rate limit check failed: \" . $e->getMessage());\n        return false;\n    }\n}\n\nfunction logSecurityEvent($event, $details = []) {\n    $logData = [\n        'timestamp' => date('Y-m-d H:i:s'),\n        'event' => $event,\n        'ip' => getClientIP(),\n        'user_agent' => $_SERVER['HTTP_USER_AGENT'] ?? 'unknown',\n        'details' => $details\n    ];\n    \n    error_log(\"SECURITY_EVENT: \" . json_encode($logData));\n}\n\nfunction getClientIP() {\n    // Use existing secure IP detection from shared/primary.php\n    return \\api\\shared\\primary\\getIp();\n}\n\nfunction validateApiRequest($requiredFields = [], $postData = null) {\n    $postData = $postData ?: $_POST;\n    $errors = [];\n    \n    // Check for required fields\n    foreach ($requiredFields as $field => $rules) {\n        if (!isset($postData[$field]) || empty($postData[$field])) {\n            $errors[$field] = \"Field '$field' is required\";\n            continue;\n        }\n        \n        $value = $postData[$field];\n        \n        // Apply validation rules\n        if (isset($rules['type'])) {\n            $validation = validateInput($value, $rules['type'], $rules['maxLength'] ?? 255);\n            if (!$validation['valid']) {\n                $errors[$field] = $validation['error'];\n            }\n        }\n    }\n    \n    return [\n        'valid' => empty($errors),\n        'errors' => $errors,\n        'sanitized' => array_map(function($value) {\n            return enhancedSanitize($value);\n        }, $postData)\n    ];\n}\n\nfunction createApiResponse($success, $message, $data = [], $httpCode = 200) {\n    http_response_code($httpCode);\n    header('Content-Type: application/json');\n    \n    $response = [\n        'success' => $success,\n        'message' => $message,\n        'timestamp' => time(),\n        'version' => '1.0'\n    ];\n    \n    if (!empty($data)) {\n        $response['data'] = $data;\n    }\n    \n    return json_encode($response, JSON_UNESCAPED_SLASHES);\n}\n\nfunction honeypotCheck($fieldName = 'bot_field') {\n    // Simple honeypot to catch bots\n    return !empty($_POST[$fieldName] ?? '');\n}\n\nfunction checkCSRF($token) {\n    return isset($_SESSION['csrf_token']) && hash_equals($_SESSION['csrf_token'], $token);\n}\n\nfunction generateCSRF() {\n    if (!isset($_SESSION['csrf_token'])) {\n        $_SESSION['csrf_token'] = bin2hex(random_bytes(32));\n    }\n    return $_SESSION['csrf_token'];\n}","size_bytes":5898},"auth/google-callback.php":{"content":"<?php\nrequire_once __DIR__ . '/../vendor/autoload.php';\nrequire_once __DIR__ . '/google-config.php';\nrequire_once __DIR__ . '/../includes/misc/autoload.phtml';\nrequire_once __DIR__ . '/../includes/dashboard/autoload.phtml';\n\nif (session_status() === PHP_SESSION_NONE) {\n    session_start();\n}\n\ntry {\n    if (!isset($_GET['code'])) {\n        throw new Exception('No authorization code received');\n    }\n    \n    if (!isset($_GET['state']) || !isset($_SESSION['google_oauth_state']) || $_GET['state'] !== $_SESSION['google_oauth_state']) {\n        throw new Exception('Invalid OAuth state parameter. Possible CSRF attack.');\n    }\n    \n    unset($_SESSION['google_oauth_state']);\n    \n    $client = getGoogleClient();\n    $token = $client->fetchAccessTokenWithAuthCode($_GET['code']);\n    \n    if (isset($token['error'])) {\n        throw new Exception('OAuth error: ' . $token['error_description']);\n    }\n    \n    $client->setAccessToken($token);\n    \n    $payload = $client->verifyIdToken();\n    if (!$payload) {\n        throw new Exception('Invalid ID token');\n    }\n    \n    if (!isset($payload['email_verified']) || !$payload['email_verified']) {\n        throw new Exception('Email not verified by Google');\n    }\n    \n    $oauth2 = new Google_Service_Oauth2($client);\n    $userInfo = $oauth2->userinfo->get();\n    \n    $googleId = $userInfo->id;\n    $email = $userInfo->email;\n    $name = $userInfo->name;\n    $picture = $userInfo->picture;\n    \n    $conn = \\misc\\mysql\\getConnection();\n    \n    $stmt = $conn->prepare(\"SELECT * FROM accounts WHERE google_id = ?\");\n    $stmt->bind_param(\"s\", $googleId);\n    $stmt->execute();\n    $result = $stmt->get_result();\n    $existingUser = $result->fetch_assoc();\n    \n    if (!$existingUser) {\n        $stmt = $conn->prepare(\"SELECT * FROM accounts WHERE email = ?\");\n        $stmt->bind_param(\"s\", $email);\n        $stmt->execute();\n        $result = $stmt->get_result();\n        \n        if ($result->num_rows > 1) {\n            throw new Exception('Multiple accounts with this email. Please contact support.');\n        }\n        \n        $existingUser = $result->fetch_assoc();\n    }\n    \n    if ($existingUser) {\n        if (!empty($existingUser['banned'])) {\n            throw new Exception('Account is banned: ' . $existingUser['banned']);\n        }\n        \n        if (!empty($existingUser['locked'])) {\n            throw new Exception('Account is locked. Please contact support.');\n        }\n        \n        if (!empty($existingUser['google_id']) && $existingUser['google_id'] !== $googleId) {\n            throw new Exception('This email is already linked to a different Google account.');\n        }\n        \n        if (!empty($existingUser['twofactor'])) {\n            if (empty($existingUser['google_id'])) {\n                throw new Exception('Two-factor authentication is enabled on this account. Please login with username/password first to link your Google account.');\n            }\n            \n            $_SESSION['temp_username'] = $existingUser['username'];\n            $_SESSION['temp_google_auth'] = true;\n            $_SESSION['temp_istwofamode'] = true;\n            \n            header(\"Location: ../login/\");\n            exit();\n        }\n        \n        if (empty($existingUser['google_id'])) {\n            $updateStmt = $conn->prepare(\"UPDATE accounts SET google_id = ? WHERE username = ?\");\n            $updateStmt->bind_param(\"ss\", $googleId, $existingUser['username']);\n            $updateStmt->execute();\n        }\n        \n        session_regenerate_id(true);\n        \n        $_SESSION['username'] = $existingUser['username'];\n        $_SESSION['email'] = $existingUser['email'];\n        \n        header(\"Location: ../app/\");\n        exit();\n    } else {\n        $_SESSION['google_id'] = $googleId;\n        $_SESSION['google_email'] = $email;\n        $_SESSION['google_name'] = $name;\n        $_SESSION['google_picture'] = $picture;\n        $_SESSION['pending_google_registration'] = true;\n        \n        header(\"Location: ../register/?google=1\");\n        exit();\n    }\n    \n} catch (Exception $e) {\n    error_log(\"Google OAuth callback error: \" . $e->getMessage());\n    $_SESSION['oauth_error'] = $e->getMessage();\n    header(\"Location: ../login/?error=oauth_failed\");\n    exit();\n}\n","size_bytes":4271},"auth/google-config.php":{"content":"<?php\nrequire_once __DIR__ . '/../vendor/autoload.php';\n\nfunction getGoogleClient() {\n    $client = new Google_Client();\n    \n    $clientId = getenv('GOOGLE_CLIENT_ID');\n    $clientSecret = getenv('GOOGLE_CLIENT_SECRET');\n    $redirectUri = getenv('REPLIT_DOMAINS') \n        ? 'https://' . explode(',', getenv('REPLIT_DOMAINS'))[0] . '/auth/google-callback.php'\n        : 'http://localhost:5000/auth/google-callback.php';\n    \n    if (!$clientId || !$clientSecret) {\n        throw new Exception('Google OAuth credentials not configured. Please set GOOGLE_CLIENT_ID and GOOGLE_CLIENT_SECRET environment variables.');\n    }\n    \n    $client->setClientId($clientId);\n    $client->setClientSecret($clientSecret);\n    $client->setRedirectUri($redirectUri);\n    $client->addScope('openid');\n    $client->addScope('email');\n    $client->addScope('profile');\n    $client->setAccessType('offline');\n    $client->setPrompt('select_account consent');\n    \n    return $client;\n}\n\nfunction getGoogleAuthUrl() {\n    try {\n        if (session_status() === PHP_SESSION_NONE) {\n            session_start();\n        }\n        \n        $client = getGoogleClient();\n        \n        $state = bin2hex(random_bytes(32));\n        $_SESSION['google_oauth_state'] = $state;\n        $client->setState($state);\n        \n        return $client->createAuthUrl();\n    } catch (Exception $e) {\n        error_log(\"Google OAuth error: \" . $e->getMessage());\n        return null;\n    }\n}\n","size_bytes":1454},"app/layout/components/alert-box.php":{"content":"<?php\nfunction renderAlert($type, $title, $message, $closeable = false) {\n    $allowedTypes = ['success', 'error', 'warning', 'info'];\n    $type = in_array($type, $allowedTypes) ? $type : 'info';\n    \n    $types = [\n        'success' => ['class' => 'alert-success', 'icon' => 'lni-checkmark-circle'],\n        'error' => ['class' => 'alert-error', 'icon' => 'lni-cross-circle'],\n        'warning' => ['class' => 'alert-warning', 'icon' => 'lni-warning'],\n        'info' => ['class' => 'alert-info', 'icon' => 'lni-information']\n    ];\n    \n    $config = $types[$type];\n    $title = htmlspecialchars($title, ENT_QUOTES, 'UTF-8');\n    $message = htmlspecialchars($message, ENT_QUOTES, 'UTF-8');\n    ?>\n    <div class=\"alert-modern <?= $config['class'] ?> fade-in\" role=\"alert\" id=\"alert-box\">\n        <div class=\"alert-icon\">\n            <i class=\"lni <?= $config['icon'] ?>\"></i>\n        </div>\n        <div class=\"alert-content\">\n            <div class=\"alert-title\"><?= $title ?></div>\n            <div class=\"alert-message\"><?= $message ?></div>\n        </div>\n        <?php if ($closeable) { ?>\n        <button \n            type=\"button\" \n            class=\"ml-auto p-2 rounded-lg hover:bg-opacity-20 hover:bg-white transition\"\n            onclick=\"document.getElementById('alert-box').style.display='none'\">\n            <i class=\"lni lni-close text-lg\"></i>\n        </button>\n        <?php } ?>\n    </div>\n    <?php\n}\n?>\n","size_bytes":1424},"app/layout/components/data-table.php":{"content":"<?php\nfunction renderDataTableHeader($title, $subtitle, $actions = [], $searchable = true) {\n    $title = htmlspecialchars($title, ENT_QUOTES, 'UTF-8');\n    $subtitle = htmlspecialchars($subtitle, ENT_QUOTES, 'UTF-8');\n    ?>\n    <div class=\"modern-card mb-6\">\n        <div class=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6\">\n            <div>\n                <h2 class=\"text-2xl font-bold text-white mb-1\"><?= $title ?></h2>\n                <p class=\"text-sm text-gray-400\"><?= $subtitle ?></p>\n            </div>\n            <div class=\"flex flex-wrap gap-3\">\n                <?php foreach ($actions as $action) { \n                    $modalId = isset($action['modal']) ? htmlspecialchars($action['modal'], ENT_QUOTES, 'UTF-8') : '';\n                    $btnClass = isset($action['class']) ? htmlspecialchars($action['class'], ENT_QUOTES, 'UTF-8') : 'btn-primary';\n                    $label = htmlspecialchars($action['label'], ENT_QUOTES, 'UTF-8');\n                    $icon = isset($action['icon']) ? htmlspecialchars($action['icon'], ENT_QUOTES, 'UTF-8') : '';\n                ?>\n                    <button \n                        type=\"button\"\n                        class=\"btn-modern <?= $btnClass ?>\"\n                        <?= $modalId ? 'data-modal-toggle=\"' . $modalId . '\"' : '' ?>>\n                        <?php if ($icon) { ?>\n                            <i class=\"<?= $icon ?>\"></i>\n                        <?php } ?>\n                        <?= $label ?>\n                    </button>\n                <?php } ?>\n            </div>\n        </div>\n        \n        <?php if ($searchable) { ?>\n        <div class=\"search-bar-modern mb-6\">\n            <input \n                type=\"text\" \n                class=\"search-input\" \n                placeholder=\"Search...\"\n                id=\"table-search\">\n            <i class=\"lni lni-search-alt search-icon\"></i>\n        </div>\n        <?php } ?>\n        \n        <div class=\"modern-table-container\">\n            <?php\n}\n\nfunction renderDataTableFooter() {\n    ?>\n        </div>\n    </div>\n    <?php\n}\n?>\n","size_bytes":2099},"app/layout/components/empty-state.php":{"content":"<?php\nfunction renderEmptyState($icon, $title, $message, $actionLabel = null, $actionModal = null) {\n    $icon = htmlspecialchars($icon, ENT_QUOTES, 'UTF-8');\n    $title = htmlspecialchars($title, ENT_QUOTES, 'UTF-8');\n    $message = htmlspecialchars($message, ENT_QUOTES, 'UTF-8');\n    $actionLabel = $actionLabel ? htmlspecialchars($actionLabel, ENT_QUOTES, 'UTF-8') : null;\n    $actionModal = $actionModal ? htmlspecialchars($actionModal, ENT_QUOTES, 'UTF-8') : null;\n    ?>\n    <div class=\"modern-card text-center py-16 fade-in\">\n        <div class=\"inline-flex items-center justify-center w-20 h-20 mb-6 rounded-full bg-gradient-blue\">\n            <i class=\"<?= $icon ?> text-4xl text-white\"></i>\n        </div>\n        <h3 class=\"text-2xl font-bold text-white mb-3\"><?= $title ?></h3>\n        <p class=\"text-gray-400 mb-6 max-w-md mx-auto\"><?= $message ?></p>\n        <?php if ($actionLabel && $actionModal) { ?>\n        <button \n            type=\"button\"\n            class=\"btn-modern btn-primary\"\n            data-modal-toggle=\"<?= $actionModal ?>\">\n            <i class=\"lni lni-plus\"></i>\n            <?= $actionLabel ?>\n        </button>\n        <?php } ?>\n    </div>\n    <?php\n}\n?>\n","size_bytes":1194},"app/layout/components/hero-header.php":{"content":"<?php\nfunction renderHeroHeader($title, $subtitle, $actions = []) {\n    ?>\n    <div class=\"modern-card mb-6 fade-in\">\n        <div class=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\n            <div class=\"flex-1\">\n                <h1 class=\"text-4xl font-bold text-gradient mb-2\"><?= htmlspecialchars($title, ENT_QUOTES, 'UTF-8') ?></h1>\n                <p class=\"modern-card-subtitle\"><?= htmlspecialchars($subtitle, ENT_QUOTES, 'UTF-8') ?></p>\n            </div>\n            <?php if (!empty($actions)) { ?>\n            <div class=\"flex flex-wrap gap-3\">\n                <?php foreach ($actions as $action) { \n                    $modalId = isset($action['modal']) ? htmlspecialchars($action['modal'], ENT_QUOTES, 'UTF-8') : '';\n                    $btnClass = isset($action['class']) ? htmlspecialchars($action['class'], ENT_QUOTES, 'UTF-8') : 'btn-primary';\n                    $label = htmlspecialchars($action['label'], ENT_QUOTES, 'UTF-8');\n                    $icon = isset($action['icon']) ? htmlspecialchars($action['icon'], ENT_QUOTES, 'UTF-8') : '';\n                ?>\n                    <button \n                        type=\"button\"\n                        class=\"btn-modern <?= $btnClass ?>\"\n                        <?= $modalId ? 'data-modal-toggle=\"' . $modalId . '\"' : '' ?>>\n                        <?php if ($icon) { ?>\n                            <i class=\"<?= $icon ?>\"></i>\n                        <?php } ?>\n                        <?= $label ?>\n                    </button>\n                <?php } ?>\n            </div>\n            <?php } ?>\n        </div>\n    </div>\n    <?php\n}\n?>\n","size_bytes":1637},"app/layout/components/stats-card.php":{"content":"<?php\nfunction renderStatsCard($icon, $value, $label, $change = null, $changeType = 'neutral', $gradient = 'gradient-blue') {\n    $icon = htmlspecialchars($icon, ENT_QUOTES, 'UTF-8');\n    $value = htmlspecialchars($value, ENT_QUOTES, 'UTF-8');\n    $label = htmlspecialchars($label, ENT_QUOTES, 'UTF-8');\n    $changeType = in_array($changeType, ['positive', 'negative', 'neutral']) ? $changeType : 'neutral';\n    $gradient = preg_match('/^[a-z-]+$/', $gradient) ? $gradient : 'gradient-blue';\n    $gradientClass = \"var(--$gradient)\";\n    ?>\n    <div class=\"stats-card scale-in\">\n        <div class=\"stats-icon\" style=\"background: <?= $gradientClass ?>;\">\n            <i class=\"<?= $icon ?>\"></i>\n        </div>\n        <div class=\"stats-value\"><?= $value ?></div>\n        <div class=\"stats-label\"><?= $label ?></div>\n        <?php if ($change !== null) { \n            $change = htmlspecialchars($change, ENT_QUOTES, 'UTF-8');\n        ?>\n            <div class=\"stats-change <?= $changeType ?>\">\n                <i class=\"lni <?= $changeType === 'positive' ? 'lni-arrow-up' : 'lni-arrow-down' ?>\"></i>\n                <?= $change ?>\n            </div>\n        <?php } ?>\n    </div>\n    <?php\n}\n\nfunction renderStatsGrid($stats) {\n    ?>\n    <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6\">\n        <?php foreach ($stats as $stat) { ?>\n            <?php renderStatsCard(\n                $stat['icon'] ?? 'lni-stats-up',\n                $stat['value'] ?? '0',\n                $stat['label'] ?? 'Stat',\n                $stat['change'] ?? null,\n                $stat['changeType'] ?? 'neutral',\n                $stat['gradient'] ?? 'gradient-blue'\n            ); ?>\n        <?php } ?>\n    </div>\n    <?php\n}\n?>\n","size_bytes":1728},"app/assets/mobile-fixes.css":{"content":"/* Mobile UI Fixes for KeyAuth Dashboard */\n\n/* Navigation Color Improvements - All Devices */\nnav {\n  background: linear-gradient(135deg, #0f0f17 0%, #1a1a24 100%) !important;\n  border-bottom: 1px solid rgba(96, 165, 250, 0.3) !important;\n}\n\n/* Sidebar Navigation Colors */\n#sidebar {\n  background: linear-gradient(180deg, #0f0f17 0%, #1a1a24 50%, #0f0f17 100%) !important;\n  border-right: 1px solid rgba(96, 165, 250, 0.3) !important;\n}\n\n/* Navigation Links */\n#sidebar a {\n  color: #e5e7eb !important;\n  transition: all 0.3s ease !important;\n}\n\n#sidebar a:hover {\n  background: linear-gradient(90deg, rgba(59, 130, 246, 0.2), rgba(147, 51, 234, 0.2)) !important;\n  color: #ffffff !important;\n  transform: translateX(4px);\n}\n\n#sidebar a.active,\n#sidebar a[aria-current=\"page\"] {\n  background: linear-gradient(90deg, rgba(59, 130, 246, 0.3), rgba(147, 51, 234, 0.3)) !important;\n  color: #ffffff !important;\n  border-left: 3px solid #3b82f6 !important;\n}\n\n/* Tab Navigation Colors */\nbutton[role=\"tab\"] {\n  color: #9ca3af !important;\n  border-bottom-color: transparent !important;\n  transition: all 0.3s ease !important;\n}\n\nbutton[role=\"tab\"]:hover {\n  color: #e5e7eb !important;\n  background: linear-gradient(180deg, rgba(59, 130, 246, 0.15), rgba(147, 51, 234, 0.15)) !important;\n}\n\nbutton[role=\"tab\"][aria-selected=\"true\"] {\n  color: #ffffff !important;\n  background: linear-gradient(180deg, rgba(59, 130, 246, 0.25), rgba(147, 51, 234, 0.25)) !important;\n  border-bottom: 2px solid #3b82f6 !important;\n}\n\n/* Navigation Icons */\n#sidebar i {\n  color: #60a5fa !important;\n  transition: all 0.3s ease !important;\n}\n\n#sidebar a:hover i {\n  color: #93c5fd !important;\n  transform: scale(1.1);\n}\n\n/* Breadcrumb styling */\nnav[aria-label=\"Breadcrumb\"] a {\n  color: #60a5fa !important;\n}\n\nnav[aria-label=\"Breadcrumb\"] a:hover {\n  color: #93c5fd !important;\n  text-decoration: underline !important;\n}\n\n/* Dropdown menu colors */\n#dropdown {\n  background: linear-gradient(135deg, #0f0f17 0%, #1a1a24 100%) !important;\n  border: 1px solid rgba(59, 130, 246, 0.4) !important;\n  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5) !important;\n}\n\n#dropdown a {\n  color: #d1d5db !important;\n}\n\n#dropdown a:hover {\n  background: linear-gradient(90deg, rgba(59, 130, 246, 0.25), rgba(147, 51, 234, 0.25)) !important;\n  color: #ffffff !important;\n}\n\n/* Mobile Navigation Button */\n#toggleSidebarMobile {\n  color: #ffffff !important;\n  background: rgba(59, 130, 246, 0.1) !important;\n  border: 1px solid rgba(59, 130, 246, 0.3) !important;\n}\n\n#toggleSidebarMobile:hover {\n  background: rgba(59, 130, 246, 0.2) !important;\n  border-color: rgba(59, 130, 246, 0.5) !important;\n}\n\n/* Top Navigation Height Reduction - All Devices */\nnav.fixed {\n  padding-top: 0.5rem !important;\n  padding-bottom: 0.5rem !important;\n}\n\nnav .py-3 {\n  padding-top: 0.5rem !important;\n  padding-bottom: 0.5rem !important;\n}\n\n/* Mobile Logo Size Reduction */\n@media (max-width: 768px) {\n  /* Reduce KeyAuth logo size on mobile */\n  nav img[alt=\"GenZ Auth\"],\n  nav img[src*=\"KeyauthBanner\"] {\n    max-width: 50px !important;\n    height: auto !important;\n  }\n  \n  /* Compact navigation on mobile */\n  nav.fixed {\n    padding-top: 0.25rem !important;\n    padding-bottom: 0.25rem !important;\n    min-height: auto !important;\n  }\n  \n  nav .py-3 {\n    padding-top: 0.25rem !important;\n    padding-bottom: 0.25rem !important;\n  }\n  \n  /* Reduce top padding for main content */\n  .pt-16 {\n    padding-top: 3rem !important;\n  }\n  \n  /* Reduce hamburger menu button size */\n  #toggleSidebarMobile {\n    padding: 0.4rem !important;\n  }\n  \n  #toggleSidebarMobile svg {\n    width: 1.25rem !important;\n    height: 1.25rem !important;\n  }\n}\n\n/* Extra small devices - even more compact */\n@media (max-width: 480px) {\n  nav img[alt=\"GenZ Auth\"],\n  nav img[src*=\"KeyauthBanner\"] {\n    max-width: 45px !important;\n  }\n  \n  nav.fixed {\n    padding: 0.2rem 0.5rem !important;\n  }\n  \n  .pt-16 {\n    padding-top: 2.75rem !important;\n  }\n}\n\n/* Ensure all buttons and interactive elements work */\nbutton, a, [data-modal-toggle], [data-modal-target] {\n  pointer-events: auto !important;\n  cursor: pointer !important;\n}\n\n/* Application Credentials Section - Mobile Optimization */\n@media (max-width: 768px) {\n  /* Credentials container improvements */\n  .mb-8.p-6 {\n    padding: 1rem !important;\n    margin-bottom: 1.5rem !important;\n  }\n  \n  /* Ensure buttons work on mobile */\n  button, a {\n    pointer-events: auto !important;\n    cursor: pointer !important;\n  }\n  \n  /* Grid layout fixes for credentials */\n  .grid.grid-cols-1.md\\:grid-cols-3 {\n    display: flex !important;\n    flex-direction: column !important;\n    gap: 0.75rem !important;\n  }\n  \n  /* Credential boxes */\n  .grid.grid-cols-1.md\\:grid-cols-3 > div {\n    padding: 0.75rem !important;\n    width: 100% !important;\n  }\n  \n  /* Application secret display */\n  .flex.items-center.justify-between {\n    flex-direction: column !important;\n    align-items: flex-start !important;\n    gap: 0.75rem !important;\n  }\n  \n  .flex.items-center.justify-between code {\n    width: 100%;\n    word-break: break-all;\n    font-size: 0.7rem !important;\n    padding-right: 0 !important;\n  }\n  \n  .flex.items-center.justify-between button {\n    width: 100%;\n    justify-content: center;\n    margin-left: 0 !important;\n  }\n  \n  /* Button group improvements */\n  .flex.flex-wrap.gap-3 {\n    display: flex !important;\n    flex-direction: column !important;\n    gap: 0.5rem !important;\n  }\n  \n  .flex.flex-wrap.gap-3 button {\n    width: 100% !important;\n    justify-content: center !important;\n    text-align: center !important;\n  }\n  \n  /* Header section improvements */\n  .flex.items-center.justify-between.mb-6 {\n    flex-direction: column !important;\n    align-items: flex-start !important;\n    gap: 1rem !important;\n  }\n  \n  .flex.items-center.justify-between.mb-6 button {\n    width: 100% !important;\n  }\n  \n  /* Table improvements */\n  .modern-table,\n  .w-full.text-sm {\n    font-size: 0.75rem !important;\n  }\n  \n  .modern-table th,\n  .w-full.text-sm th {\n    padding: 0.5rem !important;\n    font-size: 0.7rem !important;\n  }\n  \n  .modern-table td,\n  .w-full.text-sm td {\n    padding: 0.5rem !important;\n    font-size: 0.75rem !important;\n  }\n  \n  /* Icon improvements */\n  .w-10.h-10 {\n    width: 2rem !important;\n    height: 2rem !important;\n  }\n  \n  .w-10.h-10 i {\n    font-size: 0.9rem !important;\n  }\n  \n  /* Text gradient fixes */\n  .text-3xl {\n    font-size: 1.25rem !important;\n    line-height: 1.3 !important;\n  }\n  \n  .text-xl {\n    font-size: 1.1rem !important;\n    line-height: 1.3 !important;\n  }\n  \n  /* Blur effect on hover - make it always visible on mobile */\n  .blur-sm {\n    filter: blur(0) !important;\n  }\n  \n  /* Card header improvements */\n  .modern-card-header {\n    padding: 1rem !important;\n  }\n  \n  /* Main content padding */\n  .p-4.bg-\\[#09090d\\] {\n    padding: 0.75rem !important;\n  }\n  \n  /* Sidebar improvements for mobile */\n  #sidebar {\n    width: 16rem !important;\n  }\n  \n  /* Modal improvements */\n  .modal-content-modern {\n    margin: 1rem !important;\n    max-width: calc(100% - 2rem) !important;\n  }\n}\n\n/* Extra small devices (phones in portrait) */\n@media (max-width: 480px) {\n  /* Further reduce text sizes */\n  .text-3xl {\n    font-size: 1.1rem !important;\n  }\n  \n  .text-xl {\n    font-size: 1rem !important;\n  }\n  \n  .text-sm {\n    font-size: 0.7rem !important;\n  }\n  \n  .text-xs {\n    font-size: 0.65rem !important;\n  }\n  \n  /* Tighter spacing */\n  .p-4 {\n    padding: 0.5rem !important;\n  }\n  \n  .p-6 {\n    padding: 0.75rem !important;\n  }\n  \n  /* Smaller buttons */\n  button {\n    padding: 0.5rem 0.75rem !important;\n    font-size: 0.7rem !important;\n  }\n  \n  /* Smaller icons */\n  i {\n    font-size: 0.9rem !important;\n  }\n  \n  /* Code blocks */\n  code {\n    font-size: 0.65rem !important;\n  }\n  \n  /* Table improvements */\n  .modern-table th,\n  .w-full.text-sm th {\n    padding: 0.4rem !important;\n    font-size: 0.65rem !important;\n  }\n  \n  .modern-table td,\n  .w-full.text-sm td {\n    padding: 0.4rem !important;\n    font-size: 0.7rem !important;\n  }\n}\n\n/* Landscape mobile improvements */\n@media (max-width: 768px) and (orientation: landscape) {\n  .p-4.bg-\\[#09090d\\] {\n    padding: 0.5rem !important;\n  }\n  \n  .mb-8 {\n    margin-bottom: 1rem !important;\n  }\n  \n  .mb-6 {\n    margin-bottom: 0.75rem !important;\n  }\n}\n","size_bytes":8340}},"version":1}